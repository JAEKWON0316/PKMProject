"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/rag/conversations/route";
exports.ids = ["app/api/rag/conversations/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "@sparticuz/chromium":
/*!**************************************!*\
  !*** external "@sparticuz/chromium" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@sparticuz/chromium");

/***/ }),

/***/ "puppeteer-core":
/*!*********************************!*\
  !*** external "puppeteer-core" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("puppeteer-core");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frag%2Fconversations%2Froute&page=%2Fapi%2Frag%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frag%2Fconversations%2Froute&page=%2Fapi%2Frag%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_pmkProject_src_app_api_rag_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/rag/conversations/route.ts */ \"(rsc)/./src/app/api/rag/conversations/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/rag/conversations/route\",\n        pathname: \"/api/rag/conversations\",\n        filename: \"route\",\n        bundlePath: \"app/api/rag/conversations/route\"\n    },\n    resolvedPagePath: \"C:\\\\pmkProject\\\\src\\\\app\\\\api\\\\rag\\\\conversations\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_pmkProject_src_app_api_rag_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/rag/conversations/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyYWclMkZjb252ZXJzYXRpb25zJTJGcm91dGUmcGFnZT0lMkZhcGklMkZyYWclMkZjb252ZXJzYXRpb25zJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcmFnJTJGY29udmVyc2F0aW9ucyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDcG1rUHJvamVjdCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3Bta1Byb2plY3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ1c7QUFDeEY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8/ODhhOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxwbWtQcm9qZWN0XFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHJhZ1xcXFxjb252ZXJzYXRpb25zXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmFnL2NvbnZlcnNhdGlvbnMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9yYWcvY29udmVyc2F0aW9uc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcmFnL2NvbnZlcnNhdGlvbnMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxwbWtQcm9qZWN0XFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHJhZ1xcXFxjb252ZXJzYXRpb25zXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3JhZy9jb252ZXJzYXRpb25zL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frag%2Fconversations%2Froute&page=%2Fapi%2Frag%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/rag/conversations/route.ts":
/*!************************************************!*\
  !*** ./src/app/api/rag/conversations/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils/chatgpt */ \"(rsc)/./src/lib/utils/chatgpt.ts\");\n/* harmony import */ var _lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/utils/openai */ \"(rsc)/./src/lib/utils/openai.ts\");\n/* harmony import */ var _utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/utils/supabaseHandler */ \"(rsc)/./src/utils/supabaseHandler.ts\");\n/* harmony import */ var _utils_automation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/utils/automation */ \"(rsc)/./src/utils/automation.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n\n\n\n\n\n\n/**\r\n * ChatGPT 공유 URL로부터 대화를 가져와 처리하는 API 라우트\r\n * (1) 대화 크롤링\r\n * (2) GPT 요약 생성\r\n * (3) Obsidian에 저장\r\n * (4) Supabase에 저장 (임베딩 포함)\r\n * (5) GitHub에 변경사항 커밋/푸시\r\n */ async function POST(request) {\n    try {\n        console.log(\"=== RAG: 대화 처리 시작 ===\");\n        const body = await request.json().catch((e)=>{\n            console.error(\"요청 본문 파싱 실패:\", e);\n            return null;\n        });\n        if (!body || !body.url) {\n            console.error(\"URL 누락\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ChatGPT 공유 URL이 필요합니다.\"\n            }, {\n                status: 400\n            });\n        }\n        const { url } = body;\n        console.log(`처리할 URL: \"${url}\"`);\n        // URL 유효성 검사\n        if (!isValidChatGPTUrl(url)) {\n            console.error(\"유효하지 않은 URL 형식 또는 도메인\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"유효한 ChatGPT 공유 URL이 아닙니다.\"\n            }, {\n                status: 400\n            });\n        }\n        // 1. ChatGPT 링크 파싱 (Playwright 기반) -> Puppeteer로 변경됨\n        console.log(\"=== Puppeteer 기반 파싱 시작 ===\");\n        let result;\n        try {\n            result = await (0,_lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_1__.parseChatGPTLink)(url);\n            console.log(`파싱된 대화: \"${result.conversation.title}\" (메시지 ${result.conversation.messages.length}개)`);\n        } catch (error) {\n            console.error(\"대화 파싱 오류:\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: error instanceof Error ? error.message : \"대화 내용을 추출할 수 없습니다.\"\n            }, {\n                status: 422\n            });\n        }\n        const { conversation, rawText } = result;\n        // 메시지 유효성 검사\n        if (!conversation.messages || conversation.messages.length === 0) {\n            console.error(\"대화에서 메시지를 찾을 수 없음\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"대화 내용을 찾을 수 없습니다.\"\n            }, {\n                status: 404\n            });\n        }\n        // 각 메시지 간략히 로깅\n        conversation.messages.forEach((msg, idx)=>{\n            console.log(`메시지 #${idx + 1} (${msg.role}): ${msg.content.substring(0, 30)}... (${msg.content.length}자)`);\n        });\n        try {\n            // 2. 고유 ID 생성\n            const id = conversation.id || `${Date.now()}-${(0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])().substring(0, 8)}`;\n            // 3. OpenAI API로 대화 내용 요약 생성\n            console.log(\"대화 요약 생성 중...\");\n            let summaryResult;\n            try {\n                // 메시지가 20개 초과하면 긴 대화 요약 함수 사용\n                summaryResult = conversation.messages.length > 20 ? await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__.summarizeLongConversation)(conversation.title, conversation.messages) : await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__.summarizeConversation)(conversation.title, conversation.messages);\n                console.log(`요약 생성 완료 (${summaryResult.summary.length}자), 키워드: ${summaryResult.keywords.length}개`);\n                console.log(`키워드: ${summaryResult.keywords.join(\", \")}`);\n            } catch (summaryError) {\n                console.error(\"요약 생성 오류:\", summaryError);\n                summaryResult = {\n                    summary: \"요약을 생성하는 중 오류가 발생했습니다.\",\n                    keywords: [],\n                    modelUsed: \"unknown\"\n                };\n            }\n            // 4. URL 중복 체크 (Supabase)\n            console.log(\"URL 중복 체크 중...\");\n            const { exists: urlExists, session: existingSession } = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.checkUrlExists)(url);\n            if (urlExists) {\n                console.log(`URL 중복 감지: ${url}`);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    success: true,\n                    duplicate: true,\n                    message: \"이미 저장된 대화입니다.\",\n                    data: {\n                        id: existingSession?.id,\n                        title: existingSession?.title || conversation.title,\n                        url,\n                        createdAt: existingSession?.created_at\n                    }\n                });\n            }\n            // 5. Obsidian Vault에 마크다운으로 저장\n            console.log(\"Obsidian에 저장 중...\");\n            const obsidianResult = await (0,_utils_automation__WEBPACK_IMPORTED_MODULE_4__.saveToObsidian)(conversation, summaryResult, rawText, url);\n            // Obsidian 저장 중 중복 감지된 경우\n            if (obsidianResult.duplicate) {\n                console.log(`Obsidian 저장 중 중복 감지: ${url}`);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    success: true,\n                    duplicate: true,\n                    message: obsidianResult.message || \"이미 저장된 대화입니다.\",\n                    data: {\n                        id: existingSession?.id || `duplicate-${Date.now()}`,\n                        title: conversation.title,\n                        url\n                    }\n                });\n            }\n            console.log(`Obsidian 저장 완료: ${obsidianResult.fileName}`);\n            // 6. 대화 데이터 Supabase에 저장 (임베딩 포함)\n            console.log(\"Supabase에 대화 세션 저장 중...\");\n            const sessionData = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.insertChatSession)({\n                title: conversation.title,\n                url,\n                summary: summaryResult.summary,\n                messages: conversation.messages,\n                metadata: {\n                    model: summaryResult.modelUsed || conversation.metadata?.model || \"gpt-4\",\n                    keywords: summaryResult.keywords || [],\n                    createdAt: new Date().toISOString()\n                },\n                skipDuplicateCheck: true // 이미 위에서 중복 체크를 했으므로 건너뜀\n            });\n            console.log(`Supabase 세션 저장 완료: ${sessionData.id}`);\n            // 7. 대화 청크 처리 및 임베딩 저장\n            console.log(\"대화 청크 처리 및 임베딩 저장 중...\");\n            const chunksResult = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.processAndInsertChunks)(sessionData.id, conversation.messages);\n            console.log(`청크 처리 완료: ${chunksResult.count}개의 청크 저장됨`);\n            // 8. GitHub에 변경사항 커밋/푸시\n            console.log(\"GitHub에 변경사항 커밋 중...\");\n            try {\n                await (0,_utils_automation__WEBPACK_IMPORTED_MODULE_4__.commitToGitHub)(`Add: ${conversation.title} (${new Date().toISOString()})`);\n                console.log(\"GitHub 커밋 완료\");\n            } catch (gitError) {\n                console.error(\"GitHub 커밋 오류:\", gitError);\n            // 실패해도 진행 (나중에 수동으로 처리 가능)\n            }\n            // 성공 응답\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                data: {\n                    id: sessionData.id,\n                    title: conversation.title,\n                    url,\n                    summary: summaryResult.summary,\n                    keywords: summaryResult.keywords,\n                    obsidian: {\n                        fileName: obsidianResult.fileName\n                    },\n                    chunks: chunksResult.count\n                }\n            });\n        } catch (processError) {\n            console.error(\"데이터 처리 오류:\", processError);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: processError instanceof Error ? processError.message : \"데이터 처리 중 오류가 발생했습니다.\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"대화 처리 오류:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: error instanceof Error ? error.message : \"대화 처리 중 오류가 발생했습니다.\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\r\n * 관련 청크를 검색하여 질문에 답변하는 API\r\n */ async function PUT(request) {\n    try {\n        const body = await request.json();\n        if (!body.query) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"질문이 필요합니다.\"\n            }, {\n                status: 400\n            });\n        }\n        const { query, similarity = 0.7, limit = 5 } = body;\n        // 구현 예정: 유사한 청크 검색 및 LangChain/OpenAI로 응답 생성\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            message: \"검색 기능은 아직 구현 중입니다.\"\n        });\n    } catch (error) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n/**\r\n * ChatGPT URL 유효성 검사\r\n */ function isValidChatGPTUrl(url) {\n    try {\n        const parsed = new URL(url);\n        // 도메인 체크\n        const validDomains = [\n            \"chat.openai.com\",\n            \"chatgpt.com\"\n        ];\n        if (!validDomains.some((domain)=>parsed.hostname.includes(domain))) {\n            return false;\n        }\n        // 경로 체크\n        return parsed.pathname.includes(\"/share/\") || parsed.pathname.includes(\"/c/\");\n    } catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9yYWcvY29udmVyc2F0aW9ucy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUEyQztBQUNZO0FBQytCO0FBQ2M7QUFDaEM7QUFHaEM7QUFFcEM7Ozs7Ozs7Q0FPQyxHQUNNLGVBQWVXLEtBQUtDLE9BQWdCO0lBQ3pDLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDO1FBRVosTUFBTUMsT0FBTyxNQUFNSCxRQUFRSSxJQUFJLEdBQUdDLEtBQUssQ0FBQ0MsQ0FBQUE7WUFDdENMLFFBQVFNLEtBQUssQ0FBQyxnQkFBZ0JEO1lBQzlCLE9BQU87UUFDVDtRQUVBLElBQUksQ0FBQ0gsUUFBUSxDQUFDQSxLQUFLSyxHQUFHLEVBQUU7WUFDdEJQLFFBQVFNLEtBQUssQ0FBQztZQUNkLE9BQU9uQixrRkFBWUEsQ0FBQ2dCLElBQUksQ0FDdEI7Z0JBQUVLLFNBQVM7Z0JBQU9GLE9BQU87WUFBeUIsR0FDbEQ7Z0JBQUVHLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU0sRUFBRUYsR0FBRyxFQUFFLEdBQUdMO1FBQ2hCRixRQUFRQyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUVNLElBQUksQ0FBQyxDQUFDO1FBRS9CLGFBQWE7UUFDYixJQUFJLENBQUNHLGtCQUFrQkgsTUFBTTtZQUMzQlAsUUFBUU0sS0FBSyxDQUFDO1lBQ2QsT0FBT25CLGtGQUFZQSxDQUFDZ0IsSUFBSSxDQUN0QjtnQkFBRUssU0FBUztnQkFBT0YsT0FBTztZQUE0QixHQUNyRDtnQkFBRUcsUUFBUTtZQUFJO1FBRWxCO1FBRUEscURBQXFEO1FBQ3JEVCxRQUFRQyxHQUFHLENBQUM7UUFDWixJQUFJVTtRQUNKLElBQUk7WUFDRkEsU0FBUyxNQUFNdkIsb0VBQWdCQSxDQUFDbUI7WUFDaENQLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRVUsT0FBT0MsWUFBWSxDQUFDQyxLQUFLLENBQUMsT0FBTyxFQUFFRixPQUFPQyxZQUFZLENBQUNFLFFBQVEsQ0FB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YXBwL2FwaS9yYWcvY29udmVyc2F0aW9ucy9yb3V0ZS50cz9hYzRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgcGFyc2VDaGF0R1BUTGluayB9IGZyb20gJ0AvbGliL3V0aWxzL2NoYXRncHQnO1xyXG5pbXBvcnQgeyBzdW1tYXJpemVDb252ZXJzYXRpb24sIHN1bW1hcml6ZUxvbmdDb252ZXJzYXRpb24gfSBmcm9tICdAL2xpYi91dGlscy9vcGVuYWknO1xyXG5pbXBvcnQgeyBpbnNlcnRDaGF0U2Vzc2lvbiwgcHJvY2Vzc0FuZEluc2VydENodW5rcywgY2hlY2tVcmxFeGlzdHMgfSBmcm9tICdAL3V0aWxzL3N1cGFiYXNlSGFuZGxlcic7XHJcbmltcG9ydCB7IHNhdmVUb09ic2lkaWFuLCBjb21taXRUb0dpdEh1YiB9IGZyb20gJ0AvdXRpbHMvYXV0b21hdGlvbic7XHJcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcclxuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XHJcblxyXG4vKipcclxuICogQ2hhdEdQVCDqs7XsnKAgVVJM66Gc67aA7YSwIOuMgO2ZlOulvCDqsIDsoLjsmYAg7LKY66as7ZWY64qUIEFQSSDrnbzsmrDtirhcclxuICogKDEpIOuMgO2ZlCDtgazroaTrp4FcclxuICogKDIpIEdQVCDsmpTslb0g7IOd7ISxXHJcbiAqICgzKSBPYnNpZGlhbuyXkCDsoIDsnqVcclxuICogKDQpIFN1cGFiYXNl7JeQIOyggOyepSAo7J6E67Kg65SpIO2PrO2VqClcclxuICogKDUpIEdpdEh1YuyXkCDrs4Dqsr3sgqztla0g7Luk67CLL+2RuOyLnFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8UmVzcG9uc2U+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJz09PSBSQUc6IOuMgO2ZlCDsspjrpqwg7Iuc7J6RID09PScpO1xyXG4gICAgXHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCkuY2F0Y2goZSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+yalOyyrSDrs7jrrLgg7YyM7IuxIOyLpO2MqDonLCBlKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgaWYgKCFib2R5IHx8ICFib2R5LnVybCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdVUkwg64iE6529Jyk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0NoYXRHUFQg6rO17JygIFVSTOydtCDtlYTsmpTtlanri4jri6QuJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB7IHVybCB9ID0gYm9keTtcclxuICAgIGNvbnNvbGUubG9nKGDsspjrpqztlaAgVVJMOiBcIiR7dXJsfVwiYCk7XHJcblxyXG4gICAgLy8gVVJMIOycoO2aqOyEsSDqsoDsgqxcclxuICAgIGlmICghaXNWYWxpZENoYXRHUFRVcmwodXJsKSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfsnKDtmqjtlZjsp4Ag7JWK7J2AIFVSTCDtmJXsi50g65iQ64qUIOuPhOuplOyduCcpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfsnKDtmqjtlZwgQ2hhdEdQVCDqs7XsnKAgVVJM7J20IOyVhOuLmeuLiOuLpC4nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMS4gQ2hhdEdQVCDrp4Htgawg7YyM7IuxIChQbGF5d3JpZ2h0IOq4sOuwmCkgLT4gUHVwcGV0ZWVy66GcIOuzgOqyveuQqFxyXG4gICAgY29uc29sZS5sb2coJz09PSBQdXBwZXRlZXIg6riw67CYIO2MjOyLsSDsi5zsnpEgPT09Jyk7XHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgdHJ5IHtcclxuICAgICAgcmVzdWx0ID0gYXdhaXQgcGFyc2VDaGF0R1BUTGluayh1cmwpO1xyXG4gICAgICBjb25zb2xlLmxvZyhg7YyM7Iux65CcIOuMgO2ZlDogXCIke3Jlc3VsdC5jb252ZXJzYXRpb24udGl0bGV9XCIgKOuplOyLnOyngCAke3Jlc3VsdC5jb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RofeqwnClgKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+uMgO2ZlCDtjIzsi7Eg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4nIFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQyMiB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBjb252ZXJzYXRpb24sIHJhd1RleHQgfSA9IHJlc3VsdDtcclxuXHJcbiAgICAvLyDrqZTsi5zsp4Ag7Jyg7Zqo7ISxIOqygOyCrFxyXG4gICAgaWYgKCFjb252ZXJzYXRpb24ubWVzc2FnZXMgfHwgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfrjIDtmZTsl5DshJwg66mU7Iuc7KeA66W8IOywvuydhCDsiJgg7JeG7J2MJyk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ+uMgO2ZlCDrgrTsmqnsnYQg7LC+7J2EIOyImCDsl4bsirXri4jri6QuJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDqsIEg66mU7Iuc7KeAIOqwhOuete2eiCDroZzquYVcclxuICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5mb3JFYWNoKChtc2csIGlkeCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhg66mU7Iuc7KeAICMke2lkeCsxfSAoJHttc2cucm9sZX0pOiAke21zZy5jb250ZW50LnN1YnN0cmluZygwLCAzMCl9Li4uICgke21zZy5jb250ZW50Lmxlbmd0aH3snpApYCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyAyLiDqs6DsnKAgSUQg7IOd7ISxXHJcbiAgICAgIGNvbnN0IGlkID0gY29udmVyc2F0aW9uLmlkIHx8IGAke0RhdGUubm93KCl9LSR7dXVpZHY0KCkuc3Vic3RyaW5nKDAsIDgpfWA7XHJcbiAgICAgIFxyXG4gICAgICAvLyAzLiBPcGVuQUkgQVBJ66GcIOuMgO2ZlCDrgrTsmqkg7JqU7JW9IOyDneyEsVxyXG4gICAgICBjb25zb2xlLmxvZygn64yA7ZmUIOyalOyVvSDsg53shLEg7KSRLi4uJyk7XHJcbiAgICAgIGxldCBzdW1tYXJ5UmVzdWx0O1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIOuplOyLnOyngOqwgCAyMOqwnCDstIjqs7ztlZjrqbQg6ri0IOuMgO2ZlCDsmpTslb0g7ZWo7IiYIOyCrOyaqVxyXG4gICAgICAgIHN1bW1hcnlSZXN1bHQgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMjBcclxuICAgICAgICAgID8gYXdhaXQgc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbihjb252ZXJzYXRpb24udGl0bGUsIGNvbnZlcnNhdGlvbi5tZXNzYWdlcylcclxuICAgICAgICAgIDogYXdhaXQgc3VtbWFyaXplQ29udmVyc2F0aW9uKGNvbnZlcnNhdGlvbi50aXRsZSwgY29udmVyc2F0aW9uLm1lc3NhZ2VzKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDsmpTslb0g7IOd7ISxIOyZhOujjCAoJHtzdW1tYXJ5UmVzdWx0LnN1bW1hcnkubGVuZ3RofeyekCksIO2CpOybjOuTnDogJHtzdW1tYXJ5UmVzdWx0LmtleXdvcmRzLmxlbmd0aH3qsJxgKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhg7YKk7JuM65OcOiAke3N1bW1hcnlSZXN1bHQua2V5d29yZHMuam9pbignLCAnKX1gKTtcclxuICAgICAgfSBjYXRjaCAoc3VtbWFyeUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign7JqU7JW9IOyDneyEsSDsmKTrpZg6Jywgc3VtbWFyeUVycm9yKTtcclxuICAgICAgICBzdW1tYXJ5UmVzdWx0ID0ge1xyXG4gICAgICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlZjripQg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuJyxcclxuICAgICAgICAgIGtleXdvcmRzOiBbXSxcclxuICAgICAgICAgIG1vZGVsVXNlZDogJ3Vua25vd24nXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gNC4gVVJMIOykkeuztSDssrTtgawgKFN1cGFiYXNlKVxyXG4gICAgICBjb25zb2xlLmxvZygnVVJMIOykkeuztSDssrTtgawg7KSRLi4uJyk7XHJcbiAgICAgIGNvbnN0IHsgZXhpc3RzOiB1cmxFeGlzdHMsIHNlc3Npb246IGV4aXN0aW5nU2Vzc2lvbiB9ID0gYXdhaXQgY2hlY2tVcmxFeGlzdHModXJsKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh1cmxFeGlzdHMpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVVJMIOykkeuztSDqsJDsp4A6ICR7dXJsfWApO1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgZHVwbGljYXRlOiB0cnVlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLicsXHJcbiAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIGlkOiBleGlzdGluZ1Nlc3Npb24/LmlkLFxyXG4gICAgICAgICAgICB0aXRsZTogZXhpc3RpbmdTZXNzaW9uPy50aXRsZSB8fCBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgY3JlYXRlZEF0OiBleGlzdGluZ1Nlc3Npb24/LmNyZWF0ZWRfYXRcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gNS4gT2JzaWRpYW4gVmF1bHTsl5Ag66eI7YGs64uk7Jq07Jy866GcIOyggOyepVxyXG4gICAgICBjb25zb2xlLmxvZygnT2JzaWRpYW7sl5Ag7KCA7J6lIOykkS4uLicpO1xyXG4gICAgICBjb25zdCBvYnNpZGlhblJlc3VsdCA9IGF3YWl0IHNhdmVUb09ic2lkaWFuKFxyXG4gICAgICAgIGNvbnZlcnNhdGlvbixcclxuICAgICAgICBzdW1tYXJ5UmVzdWx0LFxyXG4gICAgICAgIHJhd1RleHQsXHJcbiAgICAgICAgdXJsXHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPYnNpZGlhbiDsoIDsnqUg7KSRIOykkeuztSDqsJDsp4DrkJwg6rK97JqwXHJcbiAgICAgIGlmIChvYnNpZGlhblJlc3VsdC5kdXBsaWNhdGUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgT2JzaWRpYW4g7KCA7J6lIOykkSDspJHrs7Ug6rCQ7KeAOiAke3VybH1gKTtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIGR1cGxpY2F0ZTogdHJ1ZSxcclxuICAgICAgICAgIG1lc3NhZ2U6IG9ic2lkaWFuUmVzdWx0Lm1lc3NhZ2UgfHwgJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLicsXHJcbiAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIGlkOiBleGlzdGluZ1Nlc3Npb24/LmlkIHx8IGBkdXBsaWNhdGUtJHtEYXRlLm5vdygpfWAsXHJcbiAgICAgICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgICAgIHVybFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZyhgT2JzaWRpYW4g7KCA7J6lIOyZhOujjDogJHtvYnNpZGlhblJlc3VsdC5maWxlTmFtZX1gKTtcclxuICAgICAgXHJcbiAgICAgIC8vIDYuIOuMgO2ZlCDrjbDsnbTthLAgU3VwYWJhc2Xsl5Ag7KCA7J6lICjsnoTrsqDrlKkg7Y+s7ZWoKVxyXG4gICAgICBjb25zb2xlLmxvZygnU3VwYWJhc2Xsl5Ag64yA7ZmUIOyEuOyFmCDsoIDsnqUg7KSRLi4uJyk7XHJcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gYXdhaXQgaW5zZXJ0Q2hhdFNlc3Npb24oe1xyXG4gICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgdXJsLFxyXG4gICAgICAgIHN1bW1hcnk6IHN1bW1hcnlSZXN1bHQuc3VtbWFyeSxcclxuICAgICAgICBtZXNzYWdlczogY29udmVyc2F0aW9uLm1lc3NhZ2VzLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICBtb2RlbDogc3VtbWFyeVJlc3VsdC5tb2RlbFVzZWQgfHwgY29udmVyc2F0aW9uLm1ldGFkYXRhPy5tb2RlbCB8fCAnZ3B0LTQnLFxyXG4gICAgICAgICAga2V5d29yZHM6IHN1bW1hcnlSZXN1bHQua2V5d29yZHMgfHwgW10sXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2tpcER1cGxpY2F0ZUNoZWNrOiB0cnVlIC8vIOydtOuvuCDsnITsl5DshJwg7KSR67O1IOyytO2BrOulvCDtlojsnLzrr4DroZwg6rG064SI65yAXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYFN1cGFiYXNlIOyEuOyFmCDsoIDsnqUg7JmE66OMOiAke3Nlc3Npb25EYXRhLmlkfWApO1xyXG4gICAgICBcclxuICAgICAgLy8gNy4g64yA7ZmUIOyyre2BrCDsspjrpqwg67CPIOyehOuyoOuUqSDsoIDsnqVcclxuICAgICAgY29uc29sZS5sb2coJ+uMgO2ZlCDssq3tgawg7LKY66asIOuwjyDsnoTrsqDrlKkg7KCA7J6lIOykkS4uLicpO1xyXG4gICAgICBjb25zdCBjaHVua3NSZXN1bHQgPSBhd2FpdCBwcm9jZXNzQW5kSW5zZXJ0Q2h1bmtzKFxyXG4gICAgICAgIHNlc3Npb25EYXRhLmlkLFxyXG4gICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlc1xyXG4gICAgICApO1xyXG4gICAgICBjb25zb2xlLmxvZyhg7LKt7YGsIOyymOumrCDsmYTro4w6ICR7Y2h1bmtzUmVzdWx0LmNvdW50feqwnOydmCDssq3tgawg7KCA7J6l65CoYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyA4LiBHaXRIdWLsl5Ag67OA6rK97IKs7ZWtIOy7pOuwiy/tkbjsi5xcclxuICAgICAgY29uc29sZS5sb2coJ0dpdEh1YuyXkCDrs4Dqsr3sgqztla0g7Luk67CLIOykkS4uLicpO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IGNvbW1pdFRvR2l0SHViKGBBZGQ6ICR7Y29udmVyc2F0aW9uLnRpdGxlfSAoJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9KWApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdHaXRIdWIg7Luk67CLIOyZhOujjCcpO1xyXG4gICAgICB9IGNhdGNoIChnaXRFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dpdEh1YiDsu6TrsIsg7Jik66WYOicsIGdpdEVycm9yKTtcclxuICAgICAgICAvLyDsi6TtjKjtlbTrj4Qg7KeE7ZaJICjrgpjspJHsl5Ag7IiY64+Z7Jy866GcIOyymOumrCDqsIDriqUpXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIOyEseqztSDsnZHri7VcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGlkOiBzZXNzaW9uRGF0YS5pZCxcclxuICAgICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5UmVzdWx0LnN1bW1hcnksXHJcbiAgICAgICAgICBrZXl3b3Jkczogc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyxcclxuICAgICAgICAgIG9ic2lkaWFuOiB7XHJcbiAgICAgICAgICAgIGZpbGVOYW1lOiBvYnNpZGlhblJlc3VsdC5maWxlTmFtZVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGNodW5rczogY2h1bmtzUmVzdWx0LmNvdW50XHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChwcm9jZXNzRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign642w7J207YSwIOyymOumrCDsmKTrpZg6JywgcHJvY2Vzc0Vycm9yKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgICAgICBlcnJvcjogcHJvY2Vzc0Vycm9yIGluc3RhbmNlb2YgRXJyb3IgXHJcbiAgICAgICAgICAgID8gcHJvY2Vzc0Vycm9yLm1lc3NhZ2UgXHJcbiAgICAgICAgICAgIDogJ+uNsOydtO2EsCDsspjrpqwg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuJyBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfrjIDtmZQg7LKY66asIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrjIDtmZQg7LKY66asIOykkSDsmKTrpZjqsIAg67Cc7IOd7ZaI7Iq164uI64ukLicgXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDqtIDroKgg7LKt7YGs66W8IOqygOyDie2VmOyXrCDsp4jrrLjsl5Ag64u167OA7ZWY64qUIEFQSVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBSZXF1ZXN0KTogUHJvbWlzZTxSZXNwb25zZT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBcclxuICAgIGlmICghYm9keS5xdWVyeSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfsp4jrrLjsnbQg7ZWE7JqU7ZWp64uI64ukLicgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgeyBxdWVyeSwgc2ltaWxhcml0eSA9IDAuNywgbGltaXQgPSA1IH0gPSBib2R5O1xyXG4gICAgXHJcbiAgICAvLyDqtaztmIQg7JiI7KCVOiDsnKDsgqztlZwg7LKt7YGsIOqygOyDiSDrsI8gTGFuZ0NoYWluL09wZW5BSeuhnCDsnZHri7Ug7IOd7ISxXHJcbiAgICBcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICfqsoDsg4kg6riw64ql7J2AIOyVhOyngSDqtaztmIQg7KSR7J6F64uI64ukLidcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBTdHJpbmcoZXJyb3IpIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGF0R1BUIFVSTCDsnKDtmqjshLEg6rKA7IKsXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1ZhbGlkQ2hhdEdQVFVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwYXJzZWQgPSBuZXcgVVJMKHVybCk7XHJcbiAgICBcclxuICAgIC8vIOuPhOuplOyduCDssrTtgaxcclxuICAgIGNvbnN0IHZhbGlkRG9tYWlucyA9IFsnY2hhdC5vcGVuYWkuY29tJywgJ2NoYXRncHQuY29tJ107XHJcbiAgICBpZiAoIXZhbGlkRG9tYWlucy5zb21lKGRvbWFpbiA9PiBwYXJzZWQuaG9zdG5hbWUuaW5jbHVkZXMoZG9tYWluKSkpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDqsr3roZwg7LK07YGsXHJcbiAgICByZXR1cm4gcGFyc2VkLnBhdGhuYW1lLmluY2x1ZGVzKCcvc2hhcmUvJykgfHwgcGFyc2VkLnBhdGhuYW1lLmluY2x1ZGVzKCcvYy8nKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicGFyc2VDaGF0R1BUTGluayIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsInN1bW1hcml6ZUxvbmdDb252ZXJzYXRpb24iLCJpbnNlcnRDaGF0U2Vzc2lvbiIsInByb2Nlc3NBbmRJbnNlcnRDaHVua3MiLCJjaGVja1VybEV4aXN0cyIsInNhdmVUb09ic2lkaWFuIiwiY29tbWl0VG9HaXRIdWIiLCJ2NCIsInV1aWR2NCIsIlBPU1QiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsImJvZHkiLCJqc29uIiwiY2F0Y2giLCJlIiwiZXJyb3IiLCJ1cmwiLCJzdWNjZXNzIiwic3RhdHVzIiwiaXNWYWxpZENoYXRHUFRVcmwiLCJyZXN1bHQiLCJjb252ZXJzYXRpb24iLCJ0aXRsZSIsIm1lc3NhZ2VzIiwibGVuZ3RoIiwiRXJyb3IiLCJtZXNzYWdlIiwicmF3VGV4dCIsImZvckVhY2giLCJtc2ciLCJpZHgiLCJyb2xlIiwiY29udGVudCIsInN1YnN0cmluZyIsImlkIiwiRGF0ZSIsIm5vdyIsInN1bW1hcnlSZXN1bHQiLCJzdW1tYXJ5Iiwia2V5d29yZHMiLCJqb2luIiwic3VtbWFyeUVycm9yIiwibW9kZWxVc2VkIiwiZXhpc3RzIiwidXJsRXhpc3RzIiwic2Vzc2lvbiIsImV4aXN0aW5nU2Vzc2lvbiIsImR1cGxpY2F0ZSIsImRhdGEiLCJjcmVhdGVkQXQiLCJjcmVhdGVkX2F0Iiwib2JzaWRpYW5SZXN1bHQiLCJmaWxlTmFtZSIsInNlc3Npb25EYXRhIiwibWV0YWRhdGEiLCJtb2RlbCIsInRvSVNPU3RyaW5nIiwic2tpcER1cGxpY2F0ZUNoZWNrIiwiY2h1bmtzUmVzdWx0IiwiY291bnQiLCJnaXRFcnJvciIsIm9ic2lkaWFuIiwiY2h1bmtzIiwicHJvY2Vzc0Vycm9yIiwiUFVUIiwicXVlcnkiLCJzaW1pbGFyaXR5IiwibGltaXQiLCJTdHJpbmciLCJwYXJzZWQiLCJVUkwiLCJ2YWxpZERvbWFpbnMiLCJzb21lIiwiZG9tYWluIiwiaG9zdG5hbWUiLCJpbmNsdWRlcyIsInBhdGhuYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/rag/conversations/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getClientSupabase: () => (/* binding */ getClientSupabase),\n/* harmony export */   getServerSupabase: () => (/* binding */ getServerSupabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   supabaseClient: () => (/* binding */ supabaseClient),\n/* harmony export */   testSupabaseConnection: () => (/* binding */ testSupabaseConnection)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Supabase Client\nconst supabaseUrl = \"https://ghtqqcoyakjozzhegktl.supabase.co\" || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY || \"\";\n// 서비스 키를 사용한 클라이언트 (백엔드 전용) - RLS 우회\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey);\n// 익명 키를 사용한 클라이언트 (프론트엔드 안전)\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdodHFxY295YWtqb=\\\"\\\"3p6aGVna3RsIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjA4NjkwMywiZXhwIjoyMDYxNjYyOTAzfQ.3Ygn7Ql9okDXtYnTblDXKLg2wXge1tHhm5Zok_N283k\" || 0;\nconst supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n/**\r\n * 백엔드 API에서 사용할 Supabase 클라이언트 인스턴스를 반환합니다.\r\n * RLS 정책을 우회할 수 있는 서비스 키를 사용합니다.\r\n */ function getServerSupabase() {\n    return supabaseAdmin;\n}\n/**\r\n * 브라우저에서 사용할 Supabase 클라이언트 인스턴스를 반환합니다.\r\n * RLS 정책이 적용된 익명 키를 사용합니다.\r\n */ function getClientSupabase() {\n    return supabaseClient;\n}\n// Supabase 연결 테스트 함수\nasync function testSupabaseConnection() {\n    try {\n        // 환경 변수만 확인\n        if (!supabaseUrl) {\n            throw new Error(\"Supabase URL이 설정되지 않았습니다\");\n        }\n        if (!supabaseServiceKey) {\n            throw new Error(\"Supabase 서비스 키가 설정되지 않았습니다\");\n        }\n        if (!supabaseAnonKey) {\n            throw new Error(\"Supabase 익명 키가 설정되지 않았습니다\");\n        }\n        return {\n            success: true,\n            message: \"Supabase 환경 변수 확인 완료, 마이그레이션을 진행합니다.\"\n        };\n    } catch (error) {\n        console.error(\"Supabase 연결 테스트 오류:\", error);\n        return {\n            success: false,\n            message: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFxRDtBQUVyRCxrQkFBa0I7QUFDbEIsTUFBTUMsY0FBY0MsMENBQW9DLElBQUk7QUFDNUQsTUFBTUcscUJBQXFCSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQixJQUFJO0FBRS9ELHFDQUFxQztBQUM5QixNQUFNQyxnQkFBZ0JQLG1FQUFZQSxDQUFDQyxhQUFhSSxvQkFBb0I7QUFFM0UsNkJBQTZCO0FBQzdCLE1BQU1HLGtCQUFrQk4sa09BQXlDLElBQUk7QUFDOUQsTUFBTVEsaUJBQWlCVixtRUFBWUEsQ0FBQ0MsYUFBYU8saUJBQWlCO0FBRXpFOzs7Q0FHQyxHQUNNLFNBQVNHO0lBQ2QsT0FBT0o7QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNLO0lBQ2QsT0FBT0Y7QUFDVDtBQUVBLHFCQUFxQjtBQUNkLGVBQWVHO0lBQ3BCLElBQUk7UUFDRixZQUFZO1FBQ1osSUFBSSxDQUFDWixhQUFhO1lBQ2hCLE1BQU0sSUFBSWEsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ1Qsb0JBQW9CO1lBQ3ZCLE1BQU0sSUFBSVMsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ04saUJBQWlCO1lBQ3BCLE1BQU0sSUFBSU0sTUFBTTtRQUNsQjtRQUVBLE9BQU87WUFDTEMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBTztZQUNMRixTQUFTO1lBQ1RDLFNBQVNDLGlCQUFpQkgsUUFBUUcsTUFBTUQsT0FBTyxHQUFHO1FBQ3BEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL2xpYi9zdXBhYmFzZS50cz8wNmUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcblxyXG4vLyBTdXBhYmFzZSBDbGllbnRcclxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJyc7XHJcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfS0VZIHx8ICcnO1xyXG5cclxuLy8g7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlZwg7YG065287J207Ja47Yq4ICjrsLHsl5Trk5wg7KCE7JqpKSAtIFJMUyDsmrDtmoxcclxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlQWRtaW4gPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSk7XHJcblxyXG4vLyDsnbXrqoUg7YKk66W8IOyCrOyaqe2VnCDtgbTrnbzsnbTslrjtirggKO2UhOuhoO2KuOyXlOuTnCDslYjsoIQpXHJcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICcnO1xyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VDbGllbnQgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcblxyXG4vKipcclxuICog67Cx7JeU65OcIEFQSeyXkOyEnCDsgqzsmqntlaAgU3VwYWJhc2Ug7YG065287J207Ja47Yq4IOyduOyKpO2EtOyKpOulvCDrsJjtmZjtlanri4jri6QuXHJcbiAqIFJMUyDsoJXssYXsnYQg7Jqw7ZqM7ZWgIOyImCDsnojripQg7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmVyU3VwYWJhc2UoKSB7XHJcbiAgcmV0dXJuIHN1cGFiYXNlQWRtaW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDruIzrnbzsmrDsoIDsl5DshJwg7IKs7Jqp7ZWgIFN1cGFiYXNlIO2BtOudvOydtOyWuO2KuCDsnbjsiqTthLTsiqTrpbwg67CY7ZmY7ZWp64uI64ukLlxyXG4gKiBSTFMg7KCV7LGF7J20IOyggeyaqeuQnCDsnbXrqoUg7YKk66W8IOyCrOyaqe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRTdXBhYmFzZSgpIHtcclxuICByZXR1cm4gc3VwYWJhc2VDbGllbnQ7XHJcbn1cclxuXHJcbi8vIFN1cGFiYXNlIOyXsOqysCDthYzsiqTtirgg7ZWo7IiYXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0U3VwYWJhc2VDb25uZWN0aW9uKCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDtmZjqsr0g67OA7IiY66eMIO2ZleyduFxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIFVSTOydtCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VTZXJ2aWNlS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7ISc67mE7IqkIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7J2166qFIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IFxyXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgbWVzc2FnZTogJ1N1cGFiYXNlIO2ZmOqyvSDrs4DsiJgg7ZmV7J24IOyZhOujjCwg66eI7J206re466CI7J207IWY7J2EIOynhO2Wie2VqeuLiOuLpC4nIFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU3VwYWJhc2Ug7Jew6rKwIO2FjOyKpO2KuCDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WYJyBcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX0tFWSIsInN1cGFiYXNlQWRtaW4iLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQ2xpZW50IiwiZ2V0U2VydmVyU3VwYWJhc2UiLCJnZXRDbGllbnRTdXBhYmFzZSIsInRlc3RTdXBhYmFzZUNvbm5lY3Rpb24iLCJFcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/chatgpt.ts":
/*!**********************************!*\
  !*** ./src/lib/utils/chatgpt.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseChatGPTLink: () => (/* binding */ parseChatGPTLink)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-action-proxy */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-proxy.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/next/dist/server/app-render/action-encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/types */ \"(rsc)/./src/types.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n// 서버 전용 컴포넌트/유틸 표시\n/* __next_internal_action_entry_do_not_use__ {\"491c471e7f9b8d25a45396e01470b054e19a90ee\":\"parseChatGPTLink\"} */ \n\n// Playwright 관련 import 주석 처리\n// import { chromium, Browser, Page } from 'playwright';\n\n\n\n// Puppeteer와 Chromium 추가 - 서버 사이드에서만 실행\n// @ts-ignore - @sparticuz/chromium 모듈 타입 선언 문제 해결\nconst puppeteer = __webpack_require__(/*! puppeteer-core */ \"puppeteer-core\");\n// @ts-ignore - 타입 오류 무시\nconst chromium = __webpack_require__(/*! @sparticuz/chromium */ \"@sparticuz/chromium\");\n// 클라이언트 측에서는 실행되지 않도록 함\nif (false) {}\n// 운영체제 감지\nconst isWindows = process.platform === \"win32\";\nconst isVercel = process.env.VERCEL === \"1\";\n/**\n * 환경에 맞는 Chromium 실행 경로 가져오기\n */ async function getChromiumPath() {\n    try {\n        // Windows 환경인 경우 로컬에서 Chrome 실행 시도\n        if (isWindows) {\n            // Windows 환경에서는 설치된 Chrome 사용 시도\n            const localChromePaths = [\n                \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                \"C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                process.env.LOCALAPPDATA + \"\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\"\n            ];\n            // 존재하는 Chrome 경로 찾기\n            for (const chromePath of localChromePaths){\n                if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(chromePath)) {\n                    console.log(`Using local Chrome at: ${chromePath}`);\n                    return chromePath;\n                }\n            }\n            console.log(\"No local Chrome installation found, using @sparticuz/chromium fallback\");\n        }\n        // @sparticuz/chromium의 executablePath 함수를 사용하여 바이너리 경로 가져오기\n        const execPath = await chromium.executablePath();\n        console.log(`Chromium executable path: ${execPath}`);\n        // Windows에서 로컬 폴더 생성\n        if (isWindows) {\n            const localChromiumPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \".chromium\");\n            if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(localChromiumPath)) {\n                console.log(`Creating local Chromium directory: ${localChromiumPath}`);\n                fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(localChromiumPath, {\n                    recursive: true\n                });\n            }\n        }\n        // 파일이 실제로 존재하는지 확인\n        if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(execPath)) {\n            throw new Error(`Chromium executable not found at path: ${execPath}`);\n        }\n        return execPath;\n    } catch (error) {\n        console.error(\"Error getting Chromium path:\", error);\n        // 오류 발생 시 로컬 Chrome 시도\n        if (isWindows) {\n            const defaultChromePath = \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\";\n            if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(defaultChromePath)) {\n                console.log(`Fallback to local Chrome: ${defaultChromePath}`);\n                return defaultChromePath;\n            }\n        }\n        throw error;\n    }\n}\n/**\n * 주어진 ChatGPT 대화 URL에서 대화 내용과 전체 페이지 내용을 스크래핑하는 함수\n */ async function parseChatGPTLink(url) {\n    console.log(`Scraping ChatGPT conversation from URL: ${url}`);\n    // let browser: Browser | null = null;\n    let browser = null;\n    try {\n        // 브라우저 경로 디버깅 로그\n        console.log(\"=== Browser Path Debug Info ===\");\n        console.log(\"CHROMIUM_PATH:\", \"C:\\\\pmkProject\\\\.chromium\");\n        // Playwright 코드 주석 처리\n        /*\n    // 가능한 실행 파일 경로들\n    const possiblePaths = [\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/chrome-linux/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-win/chrome.exe`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium/chrome-linux/chrome`,\n      // Ubuntu 20.04 fallback 경로 추가\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `/tmp/playwright/chromium-1169/chrome-linux/chrome`,\n      // Playwright 경로 자동 감지 시도\n      process.env.PLAYWRIGHT_BROWSERS_PATH ? undefined : 'chromium'\n    ].filter(Boolean);\n    \n    console.log('Checking possible executable paths:');\n    for (const path of possiblePaths) {\n      try {\n        const fs = require('fs');\n        const exists = fs.existsSync(path);\n        console.log(`- ${path}: ${exists ? 'EXISTS' : 'NOT FOUND'}`);\n      } catch (e) {\n        console.log(`- ${path}: ERROR checking path`);\n      }\n    }\n    \n    // 첫 번째 경로로 시도\n    let browserLaunchError = null;\n  \n    // Chromium 브라우저 시작 (headless 모드)\n    try {\n      console.log('Trying to launch browser with primary path...');\n      browser = await chromium.launch({\n        headless: true,  // 백그라운드에서 실행\n        args: [\n          '--disable-web-security',\n          '--disable-features=IsolateOrigins,site-per-process',\n          '--no-sandbox',\n          '--disable-setuid-sandbox',\n          '--disable-dev-shm-usage'\n        ],\n        timeout: 60000, // 60초 타임아웃\n        // 실행 파일 경로는 우선 지정하지 않고 Playwright가 자동 감지하도록 함\n        executablePath: undefined\n      });\n      console.log('Browser launched successfully with primary path');\n    } catch (e) {\n      console.error('Failed to launch with default path:', e);\n      browserLaunchError = e;\n      \n      // 자동 감지 실패 시 다른 경로 시도\n      for (let i = 0; i < possiblePaths.length; i++) {\n        try {\n          if (!possiblePaths[i]) continue; // undefined 경로 건너뛰기\n          \n          console.log(`Trying alternate path: ${possiblePaths[i]}`);\n          browser = await chromium.launch({\n            headless: true,\n            args: [\n              '--no-sandbox', \n              '--disable-setuid-sandbox',\n              '--disable-dev-shm-usage'\n            ],\n            timeout: 60000,\n            executablePath: possiblePaths[i]\n          });\n          console.log(`Browser launched successfully with alternate path: ${possiblePaths[i]}`);\n          browserLaunchError = null;\n          break;\n        } catch (err) {\n          console.error(`Failed with alternate path ${possiblePaths[i]}:`, err);\n        }\n      }\n      \n      // 모든 경로 실패 시 브라우저 재설치 시도\n      if (browserLaunchError) {\n        console.log('모든 경로 시도 실패, 브라우저 재설치 시도 중...');\n        try {\n          // 브라우저 설치 시도\n          const { execSync } = require('child_process');\n          execSync('npx playwright install chromium', { stdio: 'inherit' });\n          console.log('Chromium 재설치 완료, 다시 시도합니다.');\n          \n          // 설치 후 브라우저 실행 재시도\n          browser = await chromium.launch({\n            headless: true,\n            args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-dev-shm-usage'],\n            timeout: 60000\n          });\n          console.log('브라우저 시작 성공 (재설치 후)');\n          browserLaunchError = null;\n        } catch (installError) {\n          console.error('브라우저 재설치 실패:', installError);\n          throw new Error(`모든 브라우저 실행 경로 시도 실패 및 재설치 실패: ${browserLaunchError instanceof Error ? browserLaunchError.message : String(browserLaunchError)}`);\n        }\n      }\n    }\n\n    // browser가 null인 경우 처리 (모든 실행 경로 시도 후에도 실패한 경우)\n    if (!browser) {\n      throw new Error('브라우저를 시작할 수 없습니다. 실행 파일 경로를 확인하세요.');\n    }\n    */ // puppeteer-core + @sparticuz/chromium 사용하여 브라우저 시작\n        console.log(\"Launching browser with @sparticuz/chromium...\");\n        // 환경에 맞는 Chromium 경로 가져오기\n        const executablePath = await getChromiumPath();\n        console.log(`Using Chromium at: ${executablePath}`);\n        // 브라우저 실행 옵션\n        const options = {\n            args: chromium.args,\n            defaultViewport: chromium.defaultViewport,\n            executablePath,\n            headless: true,\n            ignoreHTTPSErrors: true\n        };\n        browser = await puppeteer.launch(options);\n        console.log(\"Browser launched successfully with @sparticuz/chromium\");\n        // 페이지 생성\n        const page = await browser.newPage();\n        // 사용자 에이전트 설정\n        await page.setUserAgent(\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\");\n        // 페이지 로드 시도 (여러 번 시도)\n        let maxRetries = 3;\n        let loaded = false;\n        for(let attempt = 1; attempt <= maxRetries; attempt++){\n            try {\n                console.log(`Loading page attempt ${attempt}/${maxRetries}...`);\n                // 모든 리소스를 로드하도록 설정\n                await page.goto(url, {\n                    timeout: 30000,\n                    waitUntil: \"networkidle0\" // 모든 리소스가 로드될 때까지 대기\n                });\n                loaded = true;\n                break;\n            } catch (navigationError) {\n                console.error(`Navigation error on attempt ${attempt}:`, navigationError);\n                // 마지막 시도가 아니면 잠시 대기 후 재시도\n                if (attempt < maxRetries) {\n                    await new Promise((resolve)=>setTimeout(resolve, 2000));\n                } else {\n                    throw new Error(`페이지 로드에 실패했습니다: ${navigationError instanceof Error ? navigationError.message : String(navigationError)}`);\n                }\n            }\n        }\n        if (!loaded) {\n            throw new Error(\"페이지 로드에 실패했습니다.\");\n        }\n        console.log(\"Page loaded successfully.\");\n        // 로그인 필요 여부 검사\n        if (url.includes(\"/share/\")) {\n            console.log(\"Shared URL detected, skipping login check\");\n        } else {\n            const isActualLoginPage = await page.evaluate(()=>{\n                return window.location.href.includes(\"/login\") || window.location.href.includes(\"auth0.openai.com\") || window.location.pathname === \"/auth/login\";\n            });\n            if (isActualLoginPage) {\n                console.log(\"Login page detected.\");\n                throw new Error(\"로그인이 필요한 페이지입니다. ChatGPT에 로그인 후 다시 시도해주세요.\");\n            }\n        }\n        // 페이지 내용이 충분히 로드될 때까지 추가 대기\n        await page.waitForTimeout(3000);\n        // 스크린샷 캡처 (디버깅용)\n        await page.screenshot({\n            path: \"chatgpt-capture.png\"\n        });\n        console.log(\"Screenshot saved to chatgpt-capture.png\");\n        // 전체 페이지 HTML 가져오기 - 모든 구조 그대로 유지\n        const rawHtml = await page.content();\n        // 페이지 텍스트 콘텐츠 가져오기\n        const rawText = await page.evaluate(()=>document.body.innerText);\n        // 대화 내용 추출 (메시지 구조화)\n        console.log(\"Extracting conversation data...\");\n        const conversationData = await extractConversationData(page);\n        // 대화 객체 생성\n        const conversation = {\n            id: extractConversationId(url),\n            title: conversationData.title,\n            messages: conversationData.messages,\n            createdAt: new Date().toISOString(),\n            source: _types__WEBPACK_IMPORTED_MODULE_2__.ChatSource.CHATGPT,\n            metadata: conversationData.metadata\n        };\n        // 빈 대화인지 확인\n        if (conversation.messages.length === 0) {\n            throw new Error(\"대화 내용을 추출할 수 없습니다.\");\n        }\n        console.log(`Extracted conversation: \"${conversation.title}\" with ${conversation.messages.length} messages`);\n        return {\n            conversation,\n            rawHtml,\n            rawText\n        };\n    } catch (error) {\n        console.error(\"Error during conversation extraction:\", error);\n        throw error instanceof Error ? error : new Error(`대화 추출 중 오류 발생: ${String(error)}`);\n    } finally{\n        // 브라우저 종료 - 리소스 정리\n        if (browser) {\n            await browser.close();\n            console.log(\"Browser closed.\");\n        }\n    }\n}\n/**\n * URL에서 대화 ID를 추출하는 헬퍼 함수\n */ function extractConversationId(url) {\n    const urlSegments = url.split(\"/\");\n    const potentialId = urlSegments.pop() || \"\";\n    // ID가 유효한지 확인 (공유 URL의 ID 형식은 다를 수 있음)\n    if (potentialId && potentialId.length > 5) {\n        return potentialId;\n    }\n    // 대체 ID 생성\n    return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n// Playwright Page 타입을 any로 변경\n// async function extractConversationData(page: Page): Promise<{\nasync function extractConversationData(page) {\n    return await page.evaluate(()=>{\n        console.log(\"Starting conversation extraction...\");\n        // 제목 추출 (여러 방법 시도)\n        let title = \"\";\n        // 1. h1 태그에서 제목 찾기\n        const h1Element = document.querySelector(\"h1\");\n        if (h1Element && h1Element.textContent) {\n            title = h1Element.textContent.trim();\n        }\n        // 2. 페이지 타이틀에서 제목 찾기\n        if (!title) {\n            const titleElement = document.querySelector(\"title\");\n            if (titleElement && titleElement.textContent) {\n                title = titleElement.textContent.replace(\" - ChatGPT\", \"\").replace(\" - OpenAI\", \"\").trim();\n            }\n        }\n        // 3. 메타 데이터에서 제목 찾기\n        if (!title) {\n            const metaTitle = document.querySelector('meta[property=\"og:title\"]');\n            if (metaTitle) {\n                const content = metaTitle.getAttribute(\"content\");\n                if (content) {\n                    title = content.trim();\n                }\n            }\n        }\n        // 제목을 찾지 못한 경우 기본값 사용\n        if (!title) {\n            title = \"ChatGPT Conversation \" + new Date().toLocaleString();\n        }\n        console.log(`Title extracted: ${title}`);\n        // 페이지 전체에서 모든 대화 요소 직접 추출 시도\n        // 1. assistant 메시지 찾기\n        const assistantElements = document.querySelectorAll('[data-message-author-role=\"assistant\"]');\n        console.log(`[DEBUG] Found ${assistantElements.length} assistant elements by attribute`);\n        // 2. user 메시지 찾기 (여러 방법 시도)\n        // 명시적인 user 역할 속성 찾기\n        const userByAttrElements = document.querySelectorAll('[data-message-author-role=\"user\"]');\n        console.log(`[DEBUG] Found ${userByAttrElements.length} user elements by attribute`);\n        // 대안: 특정 클래스와 위치로 user 메시지 추론\n        let userElements = [];\n        // 대화 메시지를 저장할 배열\n        let messages = [];\n        if (userByAttrElements.length === 0) {\n            // 여러 가능한 사용자 메시지 컨테이너 선택자 시도\n            for (const selector of [\n                \".whitespace-pre-wrap:not([data-message-author-role])\",\n                \".text-message:not([data-message-author-role])\",\n                '.chat-message[role=\"user\"]',\n                \".chat-message-user\",\n                \".message-user\",\n                \".human-message\"\n            ]){\n                const candidates = document.querySelectorAll(selector);\n                console.log(`[DEBUG] Found ${candidates.length} potential user elements with selector: ${selector}`);\n                if (candidates.length > 0) {\n                    userElements = Array.from(candidates);\n                    break;\n                }\n            }\n        } else {\n            userElements = Array.from(userByAttrElements);\n        }\n        console.log(`[DEBUG] Total user elements: ${userElements.length}`);\n        // 대화 수집\n        if (assistantElements.length > 0 && userElements.length > 0) {\n            // HTML 구조에서 모든 대화 요소 수집 및 순서 결정\n            const conversationElements = [];\n            // 어시스턴트 메시지 추가\n            Array.from(assistantElements).forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"assistant\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // 사용자 메시지 추가\n            userElements.forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"user\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // DOM 순서대로 정렬\n            conversationElements.sort((a, b)=>a.position - b.position);\n            console.log(`[DEBUG] Sorted conversation elements: ${conversationElements.length}`);\n            console.log(`[DEBUG] First few roles: ${conversationElements.slice(0, 3).map((e)=>e.role).join(\", \")}`);\n            // 정렬된 요소에서 대화 내용 추출\n            const extractedMessages = [];\n            for (const item of conversationElements){\n                const content = item.element.textContent?.trim() || \"\";\n                if (content && content.length > 0) {\n                    // 일부 UI 요소 제외\n                    if (!content.includes(\"Skip to content\") && !content.includes(\"Log in\") && !content.includes(\"Sign up\")) {\n                        extractedMessages.push({\n                            role: item.role,\n                            content\n                        });\n                    }\n                }\n            }\n            console.log(`[DEBUG] Extracted ${extractedMessages.length} messages`);\n            if (extractedMessages.length > 0) {\n                console.log(`[DEBUG] First message role: ${extractedMessages[0].role}`);\n                console.log(`[DEBUG] First message preview: ${extractedMessages[0].content.substring(0, 30)}...`);\n            }\n            // 최소한 하나의 사용자와 어시스턴트 메시지가 있는지 확인\n            const hasUser = extractedMessages.some((m)=>m.role === \"user\");\n            const hasAssistant = extractedMessages.some((m)=>m.role === \"assistant\");\n            if (hasUser && hasAssistant && extractedMessages.length >= 2) {\n                console.log(`[DEBUG] Found valid conversation with ${extractedMessages.length} messages`);\n                messages = extractedMessages;\n            } else {\n                console.log(`[DEBUG] Extracted messages don't form a valid conversation (user: ${hasUser}, assistant: ${hasAssistant})`);\n            }\n        }\n        // 페이지에서 요소의 위치를 결정하는 함수\n        function getPositionInDocument(element) {\n            // 요소의 부모들을 모두 찾아서 깊이 계산\n            let depth = 0;\n            let parent = element.parentElement;\n            while(parent){\n                depth++;\n                parent = parent.parentElement;\n            }\n            // DOM에서의 순서를 계산 (형제 요소 중 위치)\n            let siblingPosition = 0;\n            let sibling = element.previousElementSibling;\n            while(sibling){\n                siblingPosition++;\n                sibling = sibling.previousElementSibling;\n            }\n            // 요소의 대략적인 Y 위치를 반환 (if available)\n            const rect = element.getBoundingClientRect();\n            const yPosition = rect ? rect.top : 0;\n            // 깊이, 형제 위치, Y위치를 조합하여 최종 위치 반환\n            return yPosition + siblingPosition * 10000 + depth * 1000000;\n        }\n        // 메시지가 없으면 기본 오류 메시지 추가\n        if (messages.length === 0) {\n            // 최후의 방법: 페이지에서 이전/다음 메시지 패턴 찾기\n            try {\n                // 일반적인 사용자 입력 패턴 (최소 3개 이상의 단어를 가진 문단)\n                const potentialUserMessages = Array.from(document.querySelectorAll(\"p, div, span\")).map((el)=>el.textContent?.trim() || \"\").filter((text)=>text && text.split(\" \").length >= 3 && text.length > 20).filter((text)=>!text.includes(\"ChatGPT\") && !text.includes(\"Log in\") && !text.includes(\"Sign up\"));\n                if (potentialUserMessages.length > 0) {\n                    // 첫 번째 메시지를 사용자 메시지로 추가\n                    const userMessage = potentialUserMessages[0];\n                    messages.push({\n                        role: \"user\",\n                        content: userMessage\n                    });\n                    // 나머지 텍스트를 어시스턴트 응답으로 추가\n                    const remainingText = document.body.innerText.replace(title, \"\").replace(userMessage, \"\").replace(/Log in|Sign up|Attach|Search|Reason|Voice|By messaging ChatGPT|Skip to content|ChatGPT/g, \"\").replace(/window\\.__oai_.*?;/g, \"\").trim();\n                    if (remainingText.length > 0) {\n                        messages.push({\n                            role: \"assistant\",\n                            content: remainingText\n                        });\n                    }\n                } else {\n                    messages.push({\n                        role: \"assistant\",\n                        content: \"대화 내용을 추출할 수 없습니다. ChatGPT 공유 링크가 유효한지 확인해주세요.\"\n                    });\n                }\n            } catch (error) {\n                messages.push({\n                    role: \"assistant\",\n                    content: \"대화 내용을 추출할 수 없습니다. ChatGPT 공유 링크가 유효한지 확인해주세요.\"\n                });\n            }\n        }\n        // 대화형 구조 확인 - 먼저 유저 메시지로 시작하는지 확인\n        if (messages.length > 0 && messages[0].role !== \"user\") {\n            // ChatGPT 대화는 항상 사용자 질문으로 시작해야 함\n            // 대화가 어시스턴트로 시작하면 첫 메시지를 사용자 메시지로 변경\n            console.log(\"첫 메시지가 사용자 메시지가 아닙니다. 대화 구조를 수정합니다.\");\n            // 새 대화 구조 생성\n            const alternatingMessages = [];\n            // 첫 번째 메시지가 assistant인 경우, 가짜 user 메시지를 추가하고 시작\n            alternatingMessages.push({\n                role: \"user\",\n                content: \"대화를 시작합니다.\"\n            });\n            // 기존 메시지 복사\n            messages.forEach((msg)=>{\n                alternatingMessages.push(msg);\n            });\n            // 수정된 메시지로 교체\n            messages = alternatingMessages;\n        }\n        // 올바른 대화 구조 확인 (user와 assistant가 번갈아 나타나야 함)\n        const correctedMessages = [];\n        let expectedRole = \"user\"; // 대화는 user로 시작해야 함\n        messages.forEach((msg, index)=>{\n            if (index === 0 && msg.role !== \"user\") {\n                // 첫 메시지는 항상 사용자여야 함\n                correctedMessages.push({\n                    role: \"user\",\n                    content: \"대화를 시작합니다.\"\n                });\n                expectedRole = \"assistant\";\n            }\n            if (msg.role === expectedRole) {\n                // 역할이 예상대로인 경우 그대로 추가\n                correctedMessages.push(msg);\n                // 다음 예상 역할 전환\n                expectedRole = expectedRole === \"user\" ? \"assistant\" : \"user\";\n            } else {\n                // 같은 역할이 연속으로 나타나는 경우, 빈 메시지를 중간에 삽입\n                if (expectedRole === \"user\") {\n                    correctedMessages.push({\n                        role: \"user\",\n                        content: \"(계속)\"\n                    });\n                } else {\n                    correctedMessages.push({\n                        role: \"assistant\",\n                        content: \"(계속)\"\n                    });\n                }\n                // 현재 메시지 추가\n                correctedMessages.push(msg);\n                // 다음 예상 역할 설정\n                expectedRole = msg.role === \"user\" ? \"assistant\" : \"user\";\n            }\n        });\n        // 수정된 메시지로 교체\n        messages = correctedMessages;\n        // GPT-4 모델인지 확인\n        const isGPT4 = document.body.innerText.includes(\"GPT-4\") || document.body.innerText.includes(\"gpt-4\") || document.querySelector('img[alt*=\"GPT-4\"]') !== null;\n        return {\n            title,\n            messages,\n            metadata: {\n                date: new Date().toISOString(),\n                model: isGPT4 ? \"gpt-4\" : \"gpt-3.5-turbo\",\n                tags: []\n            }\n        };\n    });\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    parseChatGPTLink\n]);\n(0,private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__.createActionProxy)(\"491c471e7f9b8d25a45396e01470b054e19a90ee\", parseChatGPTLink);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxJQUFJLENBQUNpQztnQkFDdkIsY0FBYztnQkFDZEUsZUFBZUYsSUFBSS9CLElBQUksS0FBSyxTQUFTLGNBQWM7WUFDckQ7UUFDRjtRQUVBLGNBQWM7UUFDZHhDLFdBQVd3RTtRQUVULGdCQUFnQjtRQUNoQixNQUFNRyxTQUFTcEYsU0FBU0MsSUFBSSxDQUFDQyxTQUFTLENBQUNkLFFBQVEsQ0FBQyxZQUNsQ1ksU0FBU0MsSUFBSSxDQUFDQyxTQUFTLENBQUNkLFFBQVEsQ0FBQyxZQUNqQ1ksU0FBUzRCLGFBQWEsQ0FBQyx5QkFBeUI7UUFFOUQsT0FBTztZQUNMcEI7WUFDQUM7WUFDQU0sVUFBVTtnQkFDUnNFLE1BQU0sSUFBSTFFLE9BQU9DLFdBQVc7Z0JBQzVCMEUsT0FBT0YsU0FBUyxVQUFVO2dCQUMxQkcsTUFBTSxFQUFFO1lBQ1Y7UUFDRjtJQUNKO0FBU0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8uL3NyYy9saWIvdXRpbHMvY2hhdGdwdC50cz9kZmUxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOyEnOuyhCDsoITsmqkg7Lu07Y+s64SM7Yq4L+ycoO2LuCDtkZzsi5xcbid1c2Ugc2VydmVyJztcblxuLy8gUGxheXdyaWdodCDqtIDroKggaW1wb3J0IOyjvOyEnSDsspjrpqxcbi8vIGltcG9ydCB7IGNocm9taXVtLCBCcm93c2VyLCBQYWdlIH0gZnJvbSAncGxheXdyaWdodCc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb24sIENoYXRNZXNzYWdlLCBDaGF0U291cmNlIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5cbi8vIFB1cHBldGVlcuyZgCBDaHJvbWl1bSDstpTqsIAgLSDshJzrsoQg7IKs7J2065Oc7JeQ7ISc66eMIOyLpO2WiVxuLy8gQHRzLWlnbm9yZSAtIEBzcGFydGljdXovY2hyb21pdW0g66qo65OIIO2DgOyehSDshKDslrgg66y47KCcIO2VtOqysFxuY29uc3QgcHVwcGV0ZWVyID0gcmVxdWlyZSgncHVwcGV0ZWVyLWNvcmUnKTtcbi8vIEB0cy1pZ25vcmUgLSDtg4DsnoUg7Jik66WYIOustOyLnFxuY29uc3QgY2hyb21pdW0gPSByZXF1aXJlKCdAc3BhcnRpY3V6L2Nocm9taXVtJyk7XG5cbi8vIO2BtOudvOydtOyWuO2KuCDsuKHsl5DshJzripQg7Iuk7ZaJ65CY7KeAIOyViuuPhOuhnSDtlahcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbW9kdWxlIGlzIHNlcnZlci1zaWRlIG9ubHknKTtcbn1cblxuLy8g7Jq07JiB7LK07KCcIOqwkOyngFxuY29uc3QgaXNXaW5kb3dzID0gcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJztcbmNvbnN0IGlzVmVyY2VsID0gcHJvY2Vzcy5lbnYuVkVSQ0VMID09PSAnMSc7XG5cbi8qKlxuICog7ZmY6rK97JeQIOunnuuKlCBDaHJvbWl1bSDsi6Ttlokg6rK966GcIOqwgOyguOyYpOq4sFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRDaHJvbWl1bVBhdGgoKSB7XG4gIHRyeSB7XG4gICAgLy8gV2luZG93cyDtmZjqsr3snbgg6rK97JqwIOuhnOy7rOyXkOyEnCBDaHJvbWUg7Iuk7ZaJIOyLnOuPhFxuICAgIGlmIChpc1dpbmRvd3MpIHtcbiAgICAgIC8vIFdpbmRvd3Mg7ZmY6rK97JeQ7ISc64qUIOyEpOy5mOuQnCBDaHJvbWUg7IKs7JqpIOyLnOuPhFxuICAgICAgY29uc3QgbG9jYWxDaHJvbWVQYXRocyA9IFtcbiAgICAgICAgJ0M6XFxcXFByb2dyYW0gRmlsZXNcXFxcR29vZ2xlXFxcXENocm9tZVxcXFxBcHBsaWNhdGlvblxcXFxjaHJvbWUuZXhlJyxcbiAgICAgICAgJ0M6XFxcXFByb2dyYW0gRmlsZXMgKHg4NilcXFxcR29vZ2xlXFxcXENocm9tZVxcXFxBcHBsaWNhdGlvblxcXFxjaHJvbWUuZXhlJyxcbiAgICAgICAgcHJvY2Vzcy5lbnYuTE9DQUxBUFBEQVRBICsgJ1xcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnLFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgLy8g7KG07J6s7ZWY64qUIENocm9tZSDqsr3roZwg7LC+6riwXG4gICAgICBmb3IgKGNvbnN0IGNocm9tZVBhdGggb2YgbG9jYWxDaHJvbWVQYXRocykge1xuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhjaHJvbWVQYXRoKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBsb2NhbCBDaHJvbWUgYXQ6ICR7Y2hyb21lUGF0aH1gKTtcbiAgICAgICAgICByZXR1cm4gY2hyb21lUGF0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnTm8gbG9jYWwgQ2hyb21lIGluc3RhbGxhdGlvbiBmb3VuZCwgdXNpbmcgQHNwYXJ0aWN1ei9jaHJvbWl1bSBmYWxsYmFjaycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBAc3BhcnRpY3V6L2Nocm9taXVt7J2YIGV4ZWN1dGFibGVQYXRoIO2VqOyImOulvCDsgqzsmqntlZjsl6wg67CU7J2064SI66asIOqyveuhnCDqsIDsoLjsmKTquLBcbiAgICBjb25zdCBleGVjUGF0aCA9IGF3YWl0IGNocm9taXVtLmV4ZWN1dGFibGVQYXRoKCk7XG4gICAgY29uc29sZS5sb2coYENocm9taXVtIGV4ZWN1dGFibGUgcGF0aDogJHtleGVjUGF0aH1gKTtcbiAgICBcbiAgICAvLyBXaW5kb3dz7JeQ7IScIOuhnOy7rCDtj7TrjZQg7IOd7ISxXG4gICAgaWYgKGlzV2luZG93cykge1xuICAgICAgY29uc3QgbG9jYWxDaHJvbWl1bVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJy5jaHJvbWl1bScpO1xuICAgICAgaWYgKCFmcy5leGlzdHNTeW5jKGxvY2FsQ2hyb21pdW1QYXRoKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgQ3JlYXRpbmcgbG9jYWwgQ2hyb21pdW0gZGlyZWN0b3J5OiAke2xvY2FsQ2hyb21pdW1QYXRofWApO1xuICAgICAgICBmcy5ta2RpclN5bmMobG9jYWxDaHJvbWl1bVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDtjIzsnbzsnbQg7Iuk7KCc66GcIOyhtOyerO2VmOuKlOyngCDtmZXsnbhcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZXhlY1BhdGgpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENocm9taXVtIGV4ZWN1dGFibGUgbm90IGZvdW5kIGF0IHBhdGg6ICR7ZXhlY1BhdGh9YCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBleGVjUGF0aDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIENocm9taXVtIHBhdGg6JywgZXJyb3IpO1xuICAgIFxuICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOuhnOy7rCBDaHJvbWUg7Iuc64+EXG4gICAgaWYgKGlzV2luZG93cykge1xuICAgICAgY29uc3QgZGVmYXVsdENocm9tZVBhdGggPSAnQzpcXFxcUHJvZ3JhbSBGaWxlc1xcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnO1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZGVmYXVsdENocm9tZVBhdGgpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBGYWxsYmFjayB0byBsb2NhbCBDaHJvbWU6ICR7ZGVmYXVsdENocm9tZVBhdGh9YCk7XG4gICAgICAgIHJldHVybiBkZWZhdWx0Q2hyb21lUGF0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiDso7zslrTsp4QgQ2hhdEdQVCDrjIDtmZQgVVJM7JeQ7IScIOuMgO2ZlCDrgrTsmqnqs7wg7KCE7LK0IO2OmOydtOyngCDrgrTsmqnsnYQg7Iqk7YGs656Y7ZWR7ZWY64qUIO2VqOyImFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VDaGF0R1BUTGluayh1cmw6IHN0cmluZyk6IFByb21pc2U8eyBcbiAgY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb247IFxuICByYXdIdG1sOiBzdHJpbmc7IFxuICByYXdUZXh0OiBzdHJpbmc7XG59PiB7XG4gIGNvbnNvbGUubG9nKGBTY3JhcGluZyBDaGF0R1BUIGNvbnZlcnNhdGlvbiBmcm9tIFVSTDogJHt1cmx9YCk7XG4gIFxuICAvLyBsZXQgYnJvd3NlcjogQnJvd3NlciB8IG51bGwgPSBudWxsO1xuICBsZXQgYnJvd3NlcjogYW55ID0gbnVsbDtcbiAgXG4gIHRyeSB7XG4gICAgLy8g67iM65287Jqw7KCAIOqyveuhnCDrlJTrsoTquYUg66Gc6re4XG4gICAgY29uc29sZS5sb2coJz09PSBCcm93c2VyIFBhdGggRGVidWcgSW5mbyA9PT0nKTtcbiAgICBjb25zb2xlLmxvZygnQ0hST01JVU1fUEFUSDonLCBwcm9jZXNzLmVudi5DSFJPTUlVTV9QQVRIKTtcbiAgICBcbiAgICAvLyBQbGF5d3JpZ2h0IOy9lOuTnCDso7zshJ0g7LKY66asXG4gICAgLypcbiAgICAvLyDqsIDriqXtlZwg7Iuk7ZaJIO2MjOydvCDqsr3roZzrk6RcbiAgICBjb25zdCBwb3NzaWJsZVBhdGhzID0gW1xuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bV9oZWFkbGVzc19zaGVsbC0xMTY5L2hlYWRsZXNzX3NoZWxsYCxcbiAgICAgIGAke3Byb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSH0vY2hyb21pdW1faGVhZGxlc3Nfc2hlbGwtMTE2OS9jaHJvbWUtbGludXgvaGVhZGxlc3Nfc2hlbGxgLFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bS0xMTY5L2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bS0xMTY5L2Nocm9tZS13aW4vY2hyb21lLmV4ZWAsXG4gICAgICBgJHtwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEh9L2Nocm9taXVtL2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgLy8gVWJ1bnR1IDIwLjA0IGZhbGxiYWNrIOqyveuhnCDstpTqsIBcbiAgICAgIGAke3Byb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSH0vY2hyb21pdW0tMTE2OS9jaHJvbWUtbGludXgvY2hyb21lYCxcbiAgICAgIGAvdG1wL3BsYXl3cmlnaHQvY2hyb21pdW0tMTE2OS9jaHJvbWUtbGludXgvY2hyb21lYCxcbiAgICAgIC8vIFBsYXl3cmlnaHQg6rK966GcIOyekOuPmSDqsJDsp4Ag7Iuc64+EXG4gICAgICBwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEggPyB1bmRlZmluZWQgOiAnY2hyb21pdW0nXG4gICAgXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NoZWNraW5nIHBvc3NpYmxlIGV4ZWN1dGFibGUgcGF0aHM6Jyk7XG4gICAgZm9yIChjb25zdCBwYXRoIG9mIHBvc3NpYmxlUGF0aHMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgICAgICAgY29uc3QgZXhpc3RzID0gZnMuZXhpc3RzU3luYyhwYXRoKTtcbiAgICAgICAgY29uc29sZS5sb2coYC0gJHtwYXRofTogJHtleGlzdHMgPyAnRVhJU1RTJyA6ICdOT1QgRk9VTkQnfWApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgLSAke3BhdGh9OiBFUlJPUiBjaGVja2luZyBwYXRoYCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOyyqyDrsojsp7gg6rK966Gc66GcIOyLnOuPhFxuICAgIGxldCBicm93c2VyTGF1bmNoRXJyb3IgPSBudWxsO1xuICBcbiAgICAvLyBDaHJvbWl1bSDruIzrnbzsmrDsoIAg7Iuc7J6RIChoZWFkbGVzcyDrqqjrk5wpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdUcnlpbmcgdG8gbGF1bmNoIGJyb3dzZXIgd2l0aCBwcmltYXJ5IHBhdGguLi4nKTtcbiAgICAgIGJyb3dzZXIgPSBhd2FpdCBjaHJvbWl1bS5sYXVuY2goe1xuICAgICAgICBoZWFkbGVzczogdHJ1ZSwgIC8vIOuwseq3uOudvOyatOuTnOyXkOyEnCDsi6TtlolcbiAgICAgICAgYXJnczogW1xuICAgICAgICAgICctLWRpc2FibGUtd2ViLXNlY3VyaXR5JyxcbiAgICAgICAgICAnLS1kaXNhYmxlLWZlYXR1cmVzPUlzb2xhdGVPcmlnaW5zLHNpdGUtcGVyLXByb2Nlc3MnLFxuICAgICAgICAgICctLW5vLXNhbmRib3gnLFxuICAgICAgICAgICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLFxuICAgICAgICAgICctLWRpc2FibGUtZGV2LXNobS11c2FnZSdcbiAgICAgICAgXSxcbiAgICAgICAgdGltZW91dDogNjAwMDAsIC8vIDYw7LSIIO2DgOyehOyVhOybg1xuICAgICAgICAvLyDsi6Ttlokg7YyM7J28IOqyveuhnOuKlCDsmrDshKAg7KeA7KCV7ZWY7KeAIOyViuqzoCBQbGF5d3JpZ2h06rCAIOyekOuPmSDqsJDsp4DtlZjrj4TroZ0g7ZWoXG4gICAgICAgIGV4ZWN1dGFibGVQYXRoOiB1bmRlZmluZWRcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coJ0Jyb3dzZXIgbGF1bmNoZWQgc3VjY2Vzc2Z1bGx5IHdpdGggcHJpbWFyeSBwYXRoJyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxhdW5jaCB3aXRoIGRlZmF1bHQgcGF0aDonLCBlKTtcbiAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IGU7XG4gICAgICBcbiAgICAgIC8vIOyekOuPmSDqsJDsp4Ag7Iuk7YyoIOyLnCDri6Trpbgg6rK966GcIOyLnOuPhFxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKCFwb3NzaWJsZVBhdGhzW2ldKSBjb250aW51ZTsgLy8gdW5kZWZpbmVkIOqyveuhnCDqsbTrhIjrm7DquLBcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZyhgVHJ5aW5nIGFsdGVybmF0ZSBwYXRoOiAke3Bvc3NpYmxlUGF0aHNbaV19YCk7XG4gICAgICAgICAgYnJvd3NlciA9IGF3YWl0IGNocm9taXVtLmxhdW5jaCh7XG4gICAgICAgICAgICBoZWFkbGVzczogdHJ1ZSxcbiAgICAgICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICAgICAgJy0tbm8tc2FuZGJveCcsIFxuICAgICAgICAgICAgICAnLS1kaXNhYmxlLXNldHVpZC1zYW5kYm94JyxcbiAgICAgICAgICAgICAgJy0tZGlzYWJsZS1kZXYtc2htLXVzYWdlJ1xuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwLFxuICAgICAgICAgICAgZXhlY3V0YWJsZVBhdGg6IHBvc3NpYmxlUGF0aHNbaV1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQnJvd3NlciBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBhbHRlcm5hdGUgcGF0aDogJHtwb3NzaWJsZVBhdGhzW2ldfWApO1xuICAgICAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IG51bGw7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB3aXRoIGFsdGVybmF0ZSBwYXRoICR7cG9zc2libGVQYXRoc1tpXX06YCwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDrqqjrk6Ag6rK966GcIOyLpO2MqCDsi5wg67iM65287Jqw7KCAIOyerOyEpOy5mCDsi5zrj4RcbiAgICAgIGlmIChicm93c2VyTGF1bmNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+uqqOuToCDqsr3roZwg7Iuc64+EIOyLpO2MqCwg67iM65287Jqw7KCAIOyerOyEpOy5mCDsi5zrj4Qg7KSRLi4uJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g67iM65287Jqw7KCAIOyEpOy5mCDsi5zrj4RcbiAgICAgICAgICBjb25zdCB7IGV4ZWNTeW5jIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG4gICAgICAgICAgZXhlY1N5bmMoJ25weCBwbGF5d3JpZ2h0IGluc3RhbGwgY2hyb21pdW0nLCB7IHN0ZGlvOiAnaW5oZXJpdCcgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Nocm9taXVtIOyerOyEpOy5mCDsmYTro4wsIOuLpOyLnCDsi5zrj4Ttlanri4jri6QuJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8g7ISk7LmYIO2bhCDruIzrnbzsmrDsoIAg7Iuk7ZaJIOyerOyLnOuPhFxuICAgICAgICAgIGJyb3dzZXIgPSBhd2FpdCBjaHJvbWl1bS5sYXVuY2goe1xuICAgICAgICAgICAgaGVhZGxlc3M6IHRydWUsXG4gICAgICAgICAgICBhcmdzOiBbJy0tbm8tc2FuZGJveCcsICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLCAnLS1kaXNhYmxlLWRldi1zaG0tdXNhZ2UnXSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+u4jOudvOyasOyggCDsi5zsnpEg7ISx6rO1ICjsnqzshKTsuZgg7ZuEKScpO1xuICAgICAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGluc3RhbGxFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+u4jOudvOyasOyggCDsnqzshKTsuZgg7Iuk7YyoOicsIGluc3RhbGxFcnJvcik7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDrqqjrk6Ag67iM65287Jqw7KCAIOyLpO2WiSDqsr3roZwg7Iuc64+EIOyLpO2MqCDrsI8g7J6s7ISk7LmYIOyLpO2MqDogJHticm93c2VyTGF1bmNoRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGJyb3dzZXJMYXVuY2hFcnJvci5tZXNzYWdlIDogU3RyaW5nKGJyb3dzZXJMYXVuY2hFcnJvcil9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBicm93c2Vy6rCAIG51bGzsnbgg6rK97JqwIOyymOumrCAo66qo65OgIOyLpO2WiSDqsr3roZwg7Iuc64+EIO2bhOyXkOuPhCDsi6TtjKjtlZwg6rK97JqwKVxuICAgIGlmICghYnJvd3Nlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfruIzrnbzsmrDsoIDrpbwg7Iuc7J6R7ZWgIOyImCDsl4bsirXri4jri6QuIOyLpO2WiSDtjIzsnbwg6rK966Gc66W8IO2ZleyduO2VmOyEuOyalC4nKTtcbiAgICB9XG4gICAgKi9cblxuICAgIC8vIHB1cHBldGVlci1jb3JlICsgQHNwYXJ0aWN1ei9jaHJvbWl1bSDsgqzsmqntlZjsl6wg67iM65287Jqw7KCAIOyLnOyekVxuICAgIGNvbnNvbGUubG9nKCdMYXVuY2hpbmcgYnJvd3NlciB3aXRoIEBzcGFydGljdXovY2hyb21pdW0uLi4nKTtcbiAgICBcbiAgICAvLyDtmZjqsr3sl5Ag66ee64qUIENocm9taXVtIOqyveuhnCDqsIDsoLjsmKTquLBcbiAgICBjb25zdCBleGVjdXRhYmxlUGF0aCA9IGF3YWl0IGdldENocm9taXVtUGF0aCgpO1xuICAgIGNvbnNvbGUubG9nKGBVc2luZyBDaHJvbWl1bSBhdDogJHtleGVjdXRhYmxlUGF0aH1gKTtcbiAgICBcbiAgICAvLyDruIzrnbzsmrDsoIAg7Iuk7ZaJIOyYteyFmFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBhcmdzOiBjaHJvbWl1bS5hcmdzLFxuICAgICAgZGVmYXVsdFZpZXdwb3J0OiBjaHJvbWl1bS5kZWZhdWx0Vmlld3BvcnQsXG4gICAgICBleGVjdXRhYmxlUGF0aCxcbiAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgaWdub3JlSFRUUFNFcnJvcnM6IHRydWUsXG4gICAgfTtcbiAgICBcbiAgICBicm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyLmxhdW5jaChvcHRpb25zKTtcbiAgICBjb25zb2xlLmxvZygnQnJvd3NlciBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBAc3BhcnRpY3V6L2Nocm9taXVtJyk7XG5cbiAgICAvLyDtjpjsnbTsp4Ag7IOd7ISxXG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuICAgIFxuICAgIC8vIOyCrOyaqeyekCDsl5DsnbTsoITtirgg7ISk7KCVXG4gICAgYXdhaXQgcGFnZS5zZXRVc2VyQWdlbnQoJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjAuMC4wLjAgU2FmYXJpLzUzNy4zNicpO1xuICAgIFxuICAgIC8vIO2OmOydtOyngCDroZzrk5wg7Iuc64+EICjsl6zrn6wg67KIIOyLnOuPhClcbiAgICBsZXQgbWF4UmV0cmllcyA9IDM7XG4gICAgbGV0IGxvYWRlZCA9IGZhbHNlO1xuICAgIFxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgcGFnZSBhdHRlbXB0ICR7YXR0ZW1wdH0vJHttYXhSZXRyaWVzfS4uLmApO1xuICAgICAgICAvLyDrqqjrk6Ag66as7IaM7Iqk66W8IOuhnOuTnO2VmOuPhOuhnSDshKTsoJVcbiAgICAgICAgYXdhaXQgcGFnZS5nb3RvKHVybCwgeyBcbiAgICAgICAgICB0aW1lb3V0OiAzMDAwMCwgXG4gICAgICAgICAgd2FpdFVudGlsOiAnbmV0d29ya2lkbGUwJyAvLyDrqqjrk6Ag66as7IaM7Iqk6rCAIOuhnOuTnOuQoCDrlYzquYzsp4Ag64yA6riwXG4gICAgICAgIH0pO1xuICAgICAgICBsb2FkZWQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gY2F0Y2ggKG5hdmlnYXRpb25FcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBOYXZpZ2F0aW9uIGVycm9yIG9uIGF0dGVtcHQgJHthdHRlbXB0fTpgLCBuYXZpZ2F0aW9uRXJyb3IpO1xuICAgICAgICBcbiAgICAgICAgLy8g66eI7KeA66eJIOyLnOuPhOqwgCDslYTri4jrqbQg7J6g7IucIOuMgOq4sCDtm4Qg7J6s7Iuc64+EXG4gICAgICAgIGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDtjpjsnbTsp4Ag66Gc65Oc7JeQIOyLpO2MqO2WiOyKteuLiOuLpDogJHtuYXZpZ2F0aW9uRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IG5hdmlnYXRpb25FcnJvci5tZXNzYWdlIDogU3RyaW5nKG5hdmlnYXRpb25FcnJvcil9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWxvYWRlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCftjpjsnbTsp4Ag66Gc65Oc7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnUGFnZSBsb2FkZWQgc3VjY2Vzc2Z1bGx5LicpO1xuICAgIFxuICAgIC8vIOuhnOq3uOyduCDtlYTsmpQg7Jes67aAIOqygOyCrFxuICAgIGlmICh1cmwuaW5jbHVkZXMoJy9zaGFyZS8nKSkge1xuICAgICAgY29uc29sZS5sb2coJ1NoYXJlZCBVUkwgZGV0ZWN0ZWQsIHNraXBwaW5nIGxvZ2luIGNoZWNrJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGlzQWN0dWFsTG9naW5QYWdlID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnL2xvZ2luJykgfHwgXG4gICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnYXV0aDAub3BlbmFpLmNvbScpIHx8XG4gICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvYXV0aC9sb2dpbic7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKGlzQWN0dWFsTG9naW5QYWdlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdMb2dpbiBwYWdlIGRldGVjdGVkLicpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+uhnOq3uOyduOydtCDtlYTsmpTtlZwg7Y6Y7J207KeA7J6F64uI64ukLiBDaGF0R1BU7JeQIOuhnOq3uOyduCDtm4Qg64uk7IucIOyLnOuPhO2VtOyjvOyEuOyalC4nKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7Y6Y7J207KeAIOuCtOyaqeydtCDstqnrtoTtnogg66Gc65Oc65CgIOuVjOq5jOyngCDstpTqsIAg64yA6riwXG4gICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCgzMDAwKTtcbiAgICBcbiAgICAvLyDsiqTtgazrprDsg7cg7Lqh7LKYICjrlJTrsoTquYXsmqkpXG4gICAgYXdhaXQgcGFnZS5zY3JlZW5zaG90KHsgcGF0aDogJ2NoYXRncHQtY2FwdHVyZS5wbmcnIH0pO1xuICAgIGNvbnNvbGUubG9nKCdTY3JlZW5zaG90IHNhdmVkIHRvIGNoYXRncHQtY2FwdHVyZS5wbmcnKTtcbiAgICBcbiAgICAvLyDsoITssrQg7Y6Y7J207KeAIEhUTUwg6rCA7KC47Jik6riwIC0g66qo65OgIOq1rOyhsCDqt7jrjIDroZwg7Jyg7KeAXG4gICAgY29uc3QgcmF3SHRtbCA9IGF3YWl0IHBhZ2UuY29udGVudCgpO1xuICAgIFxuICAgIC8vIO2OmOydtOyngCDthY3siqTtirgg7L2Y7YWQ7LigIOqwgOyguOyYpOq4sFxuICAgIGNvbnN0IHJhd1RleHQgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0KTtcblxuICAgIC8vIOuMgO2ZlCDrgrTsmqkg7LaU7LacICjrqZTsi5zsp4Ag6rWs7KGw7ZmUKVxuICAgIGNvbnNvbGUubG9nKCdFeHRyYWN0aW5nIGNvbnZlcnNhdGlvbiBkYXRhLi4uJyk7XG4gICAgY29uc3QgY29udmVyc2F0aW9uRGF0YSA9IGF3YWl0IGV4dHJhY3RDb252ZXJzYXRpb25EYXRhKHBhZ2UpO1xuXG4gICAgLy8g64yA7ZmUIOqwneyytCDsg53shLFcbiAgICBjb25zdCBjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbiA9IHtcbiAgICAgIGlkOiBleHRyYWN0Q29udmVyc2F0aW9uSWQodXJsKSxcbiAgICAgIHRpdGxlOiBjb252ZXJzYXRpb25EYXRhLnRpdGxlLFxuICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbkRhdGEubWVzc2FnZXMgYXMgQ2hhdE1lc3NhZ2VbXSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgc291cmNlOiBDaGF0U291cmNlLkNIQVRHUFQsXG4gICAgICBtZXRhZGF0YTogY29udmVyc2F0aW9uRGF0YS5tZXRhZGF0YVxuICAgIH07XG5cbiAgICAvLyDruYgg64yA7ZmU7J247KeAIO2ZleyduFxuICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+uMgO2ZlCDrgrTsmqnsnYQg7LaU7Lac7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYEV4dHJhY3RlZCBjb252ZXJzYXRpb246IFwiJHtjb252ZXJzYXRpb24udGl0bGV9XCIgd2l0aCAke2NvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGh9IG1lc3NhZ2VzYCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udmVyc2F0aW9uLFxuICAgICAgcmF3SHRtbCxcbiAgICAgIHJhd1RleHRcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBjb252ZXJzYXRpb24gZXh0cmFjdGlvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciBcbiAgICAgID8gZXJyb3IgXG4gICAgICA6IG5ldyBFcnJvcihg64yA7ZmUIOy2lOy2nCDspJEg7Jik66WYIOuwnOyDnTogJHtTdHJpbmcoZXJyb3IpfWApO1xuICB9IGZpbmFsbHkge1xuICAgIC8vIOu4jOudvOyasOyggCDsooXro4wgLSDrpqzshozsiqQg7KCV66asXG4gICAgaWYgKGJyb3dzZXIpIHtcbiAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcbiAgICAgIGNvbnNvbGUubG9nKCdCcm93c2VyIGNsb3NlZC4nKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBVUkzsl5DshJwg64yA7ZmUIElE66W8IOy2lOy2nO2VmOuKlCDtl6ztjbwg7ZWo7IiYXG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RDb252ZXJzYXRpb25JZCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHVybFNlZ21lbnRzID0gdXJsLnNwbGl0KCcvJyk7XG4gIGNvbnN0IHBvdGVudGlhbElkID0gdXJsU2VnbWVudHMucG9wKCkgfHwgJyc7XG4gIFxuICAvLyBJROqwgCDsnKDtmqjtlZzsp4Ag7ZmV7J24ICjqs7XsnKAgVVJM7J2YIElEIO2YleyLneydgCDri6Trpbwg7IiYIOyeiOydjClcbiAgaWYgKHBvdGVudGlhbElkICYmIHBvdGVudGlhbElkLmxlbmd0aCA+IDUpIHtcbiAgICByZXR1cm4gcG90ZW50aWFsSWQ7XG4gIH1cbiAgXG4gIC8vIOuMgOyytCBJRCDsg53shLFcbiAgcmV0dXJuIGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpfWA7XG59XG5cbi8vIFBsYXl3cmlnaHQgUGFnZSDtg4DsnoXsnYQgYW5566GcIOuzgOqyvVxuLy8gYXN5bmMgZnVuY3Rpb24gZXh0cmFjdENvbnZlcnNhdGlvbkRhdGEocGFnZTogUGFnZSk6IFByb21pc2U8e1xuYXN5bmMgZnVuY3Rpb24gZXh0cmFjdENvbnZlcnNhdGlvbkRhdGEocGFnZTogYW55KTogUHJvbWlzZTx7XG4gIHRpdGxlOiBzdHJpbmc7IFxuICBtZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT47IFxuICBtZXRhZGF0YTogeyBcbiAgICBkYXRlOiBzdHJpbmc7IFxuICAgIG1vZGVsOiBzdHJpbmc7IFxuICAgIHRhZ3M6IHN0cmluZ1tdOyBcbiAgfTsgXG59PiB7XG4gIHJldHVybiBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnU3RhcnRpbmcgY29udmVyc2F0aW9uIGV4dHJhY3Rpb24uLi4nKTtcbiAgICAgIFxuICAgICAgLy8g7KCc66qpIOy2lOy2nCAo7Jes65+sIOuwqeuylSDsi5zrj4QpXG4gICAgICBsZXQgdGl0bGUgPSAnJztcbiAgICAgIFxuICAgICAgLy8gMS4gaDEg7YOc6re47JeQ7IScIOygnOuqqSDssL7quLBcbiAgICAgIGNvbnN0IGgxRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gxJyk7XG4gICAgICBpZiAoaDFFbGVtZW50ICYmIGgxRWxlbWVudC50ZXh0Q29udGVudCkge1xuICAgICAgICB0aXRsZSA9IGgxRWxlbWVudC50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIDIuIO2OmOydtOyngCDtg4DsnbTti4Dsl5DshJwg7KCc66qpIOywvuq4sFxuICAgICAgaWYgKCF0aXRsZSkge1xuICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0aXRsZScpO1xuICAgICAgICBpZiAodGl0bGVFbGVtZW50ICYmIHRpdGxlRWxlbWVudC50ZXh0Q29udGVudCkge1xuICAgICAgICAgIHRpdGxlID0gdGl0bGVFbGVtZW50LnRleHRDb250ZW50XG4gICAgICAgICAgICAucmVwbGFjZSgnIC0gQ2hhdEdQVCcsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoJyAtIE9wZW5BSScsICcnKVxuICAgICAgICAgICAgLnRyaW0oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyAzLiDrqZTtg4Ag642w7J207YSw7JeQ7IScIOygnOuqqSDssL7quLBcbiAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgY29uc3QgbWV0YVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtwcm9wZXJ0eT1cIm9nOnRpdGxlXCJdJyk7XG4gICAgICAgIGlmIChtZXRhVGl0bGUpIHtcbiAgICAgICAgICBjb25zdCBjb250ZW50ID0gbWV0YVRpdGxlLmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xuICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICB0aXRsZSA9IGNvbnRlbnQudHJpbSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDsoJzrqqnsnYQg7LC+7KeAIOuqu+2VnCDqsr3smrAg6riw67O46rCSIOyCrOyaqVxuICAgICAgaWYgKCF0aXRsZSkge1xuICAgICAgdGl0bGUgPSAnQ2hhdEdQVCBDb252ZXJzYXRpb24gJyArIG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFRpdGxlIGV4dHJhY3RlZDogJHt0aXRsZX1gKTtcbiAgICAgIFxuICAgIC8vIO2OmOydtOyngCDsoITssrTsl5DshJwg66qo65OgIOuMgO2ZlCDsmpTshowg7KeB7KCRIOy2lOy2nCDsi5zrj4RcbiAgICAvLyAxLiBhc3Npc3RhbnQg66mU7Iuc7KeAIOywvuq4sFxuICAgIGNvbnN0IGFzc2lzdGFudEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbWVzc2FnZS1hdXRob3Itcm9sZT1cImFzc2lzdGFudFwiXScpO1xuICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZvdW5kICR7YXNzaXN0YW50RWxlbWVudHMubGVuZ3RofSBhc3Npc3RhbnQgZWxlbWVudHMgYnkgYXR0cmlidXRlYCk7XG4gICAgXG4gICAgLy8gMi4gdXNlciDrqZTsi5zsp4Ag7LC+6riwICjsl6zrn6wg67Cp67KVIOyLnOuPhClcbiAgICAvLyDrqoXsi5zsoIHsnbggdXNlciDsl63tlaAg7IaN7ISxIOywvuq4sFxuICAgIGNvbnN0IHVzZXJCeUF0dHJFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lc3NhZ2UtYXV0aG9yLXJvbGU9XCJ1c2VyXCJdJyk7XG4gICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHt1c2VyQnlBdHRyRWxlbWVudHMubGVuZ3RofSB1c2VyIGVsZW1lbnRzIGJ5IGF0dHJpYnV0ZWApO1xuICAgIFxuICAgIC8vIOuMgOyViDog7Yq57KCVIO2BtOuemOyKpOyZgCDsnITsuZjroZwgdXNlciDrqZTsi5zsp4Ag7LaU66GgXG4gICAgbGV0IHVzZXJFbGVtZW50czogRWxlbWVudFtdID0gW107XG4gICAgXG4gICAgLy8g64yA7ZmUIOuplOyLnOyngOulvCDsoIDsnqXtlaAg67Cw7Je0XG4gICAgbGV0IG1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgIFxuICAgIGlmICh1c2VyQnlBdHRyRWxlbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyDsl6zrn6wg6rCA64ql7ZWcIOyCrOyaqeyekCDrqZTsi5zsp4Ag7Luo7YWM7J2064SIIOyEoO2DneyekCDsi5zrj4RcbiAgICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgW1xuICAgICAgICAnLndoaXRlc3BhY2UtcHJlLXdyYXA6bm90KFtkYXRhLW1lc3NhZ2UtYXV0aG9yLXJvbGVdKScsIFxuICAgICAgICAnLnRleHQtbWVzc2FnZTpub3QoW2RhdGEtbWVzc2FnZS1hdXRob3Itcm9sZV0pJyxcbiAgICAgICAgJy5jaGF0LW1lc3NhZ2Vbcm9sZT1cInVzZXJcIl0nLFxuICAgICAgICAnLmNoYXQtbWVzc2FnZS11c2VyJyxcbiAgICAgICAgJy5tZXNzYWdlLXVzZXInLFxuICAgICAgICAnLmh1bWFuLW1lc3NhZ2UnXG4gICAgICBdKSB7XG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHtjYW5kaWRhdGVzLmxlbmd0aH0gcG90ZW50aWFsIHVzZXIgZWxlbWVudHMgd2l0aCBzZWxlY3RvcjogJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB1c2VyRWxlbWVudHMgPSBBcnJheS5mcm9tKGNhbmRpZGF0ZXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHVzZXJFbGVtZW50cyA9IEFycmF5LmZyb20odXNlckJ5QXR0ckVsZW1lbnRzKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYFtERUJVR10gVG90YWwgdXNlciBlbGVtZW50czogJHt1c2VyRWxlbWVudHMubGVuZ3RofWApO1xuICAgIFxuICAgIC8vIOuMgO2ZlCDsiJjsp5FcbiAgICBpZiAoYXNzaXN0YW50RWxlbWVudHMubGVuZ3RoID4gMCAmJiB1c2VyRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gSFRNTCDqtazsobDsl5DshJwg66qo65OgIOuMgO2ZlCDsmpTshowg7IiY7KeRIOuwjyDsiJzshJwg6rKw7KCVXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25FbGVtZW50czogQXJyYXk8e1xuICAgICAgICBlbGVtZW50OiBFbGVtZW50O1xuICAgICAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgICAgICAgcG9zaXRpb246IG51bWJlcjtcbiAgICAgIH0+ID0gW107XG4gICAgICBcbiAgICAgIC8vIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICBBcnJheS5mcm9tKGFzc2lzdGFudEVsZW1lbnRzKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgcG9zaXRpb246IGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbClcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g7IKs7Jqp7J6QIOuplOyLnOyngCDstpTqsIBcbiAgICAgIHVzZXJFbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIHBvc2l0aW9uOiBnZXRQb3NpdGlvbkluRG9jdW1lbnQoZWwpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIERPTSDsiJzshJzrjIDroZwg7KCV66CsXG4gICAgICBjb252ZXJzYXRpb25FbGVtZW50cy5zb3J0KChhLCBiKSA9PiBhLnBvc2l0aW9uIC0gYi5wb3NpdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIFNvcnRlZCBjb252ZXJzYXRpb24gZWxlbWVudHM6ICR7Y29udmVyc2F0aW9uRWxlbWVudHMubGVuZ3RofWApO1xuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgZmV3IHJvbGVzOiAke2NvbnZlcnNhdGlvbkVsZW1lbnRzLnNsaWNlKDAsIDMpLm1hcChlID0+IGUucm9sZSkuam9pbignLCAnKX1gKTtcbiAgICAgIFxuICAgICAgLy8g7KCV66Cs65CcIOyalOyGjOyXkOyEnCDrjIDtmZQg64K07JqpIOy2lOy2nFxuICAgICAgY29uc3QgZXh0cmFjdGVkTWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY29udmVyc2F0aW9uRWxlbWVudHMpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGl0ZW0uZWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xuICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyDsnbzrtoAgVUkg7JqU7IaMIOygnOyZuFxuICAgICAgICAgIGlmICghY29udGVudC5pbmNsdWRlcygnU2tpcCB0byBjb250ZW50JykgJiYgXG4gICAgICAgICAgICAgICFjb250ZW50LmluY2x1ZGVzKCdMb2cgaW4nKSAmJiBcbiAgICAgICAgICAgICAgIWNvbnRlbnQuaW5jbHVkZXMoJ1NpZ24gdXAnKSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHRyYWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgcm9sZTogaXRlbS5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRXh0cmFjdGVkICR7ZXh0cmFjdGVkTWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlc2ApO1xuICAgICAgaWYgKGV4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgbWVzc2FnZSByb2xlOiAke2V4dHJhY3RlZE1lc3NhZ2VzWzBdLnJvbGV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZpcnN0IG1lc3NhZ2UgcHJldmlldzogJHtleHRyYWN0ZWRNZXNzYWdlc1swXS5jb250ZW50LnN1YnN0cmluZygwLCAzMCl9Li4uYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOy1nOyGjO2VnCDtlZjrgpjsnZgg7IKs7Jqp7J6Q7JmAIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4DqsIAg7J6I64qU7KeAIO2ZleyduFxuICAgICAgY29uc3QgaGFzVXNlciA9IGV4dHJhY3RlZE1lc3NhZ2VzLnNvbWUobSA9PiBtLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgICBjb25zdCBoYXNBc3Npc3RhbnQgPSBleHRyYWN0ZWRNZXNzYWdlcy5zb21lKG0gPT4gbS5yb2xlID09PSAnYXNzaXN0YW50Jyk7XG4gICAgICBcbiAgICAgIGlmIChoYXNVc2VyICYmIGhhc0Fzc2lzdGFudCAmJiBleHRyYWN0ZWRNZXNzYWdlcy5sZW5ndGggPj0gMikge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGb3VuZCB2YWxpZCBjb252ZXJzYXRpb24gd2l0aCAke2V4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXNgKTtcbiAgICAgICAgbWVzc2FnZXMgPSBleHRyYWN0ZWRNZXNzYWdlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEV4dHJhY3RlZCBtZXNzYWdlcyBkb24ndCBmb3JtIGEgdmFsaWQgY29udmVyc2F0aW9uICh1c2VyOiAke2hhc1VzZXJ9LCBhc3Npc3RhbnQ6ICR7aGFzQXNzaXN0YW50fSlgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7Y6Y7J207KeA7JeQ7IScIOyalOyGjOydmCDsnITsuZjrpbwg6rKw7KCV7ZWY64qUIO2VqOyImFxuICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbGVtZW50OiBFbGVtZW50KTogbnVtYmVyIHtcbiAgICAgIC8vIOyalOyGjOydmCDrtoDrqqjrk6TsnYQg66qo65GQIOywvuyVhOyEnCDquYrsnbQg6rOE7IKwXG4gICAgICBsZXQgZGVwdGggPSAwO1xuICAgICAgbGV0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgZGVwdGgrKztcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIERPTeyXkOyEnOydmCDsiJzshJzrpbwg6rOE7IKwICjtmJXsoJwg7JqU7IaMIOykkSDsnITsuZgpXG4gICAgICBsZXQgc2libGluZ1Bvc2l0aW9uID0gMDtcbiAgICAgIGxldCBzaWJsaW5nID0gZWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgd2hpbGUgKHNpYmxpbmcpIHtcbiAgICAgICAgc2libGluZ1Bvc2l0aW9uKys7XG4gICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOyalOyGjOydmCDrjIDrnrXsoIHsnbggWSDsnITsuZjrpbwg67CY7ZmYIChpZiBhdmFpbGFibGUpXG4gICAgICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHlQb3NpdGlvbiA9IHJlY3QgPyByZWN0LnRvcCA6IDA7XG4gICAgICBcbiAgICAgIC8vIOq5iuydtCwg7ZiV7KCcIOychOy5mCwgWeychOy5mOulvCDsobDtlantlZjsl6wg7LWc7KKFIOychOy5mCDrsJjtmZhcbiAgICAgIHJldHVybiB5UG9zaXRpb24gKyAoc2libGluZ1Bvc2l0aW9uICogMTAwMDApICsgKGRlcHRoICogMTAwMDAwMCk7XG4gICAgfVxuICAgIFxuICAgIC8vIOuplOyLnOyngOqwgCDsl4bsnLzrqbQg6riw67O4IOyYpOulmCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyDstZztm4TsnZgg67Cp67KVOiDtjpjsnbTsp4Dsl5DshJwg7J207KCEL+uLpOydjCDrqZTsi5zsp4Ag7Yyo7YS0IOywvuq4sFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8g7J2867CY7KCB7J24IOyCrOyaqeyekCDsnoXroKUg7Yyo7YS0ICjstZzshowgM+qwnCDsnbTsg4HsnZgg64uo7Ja066W8IOqwgOynhCDrrLjri6gpXG4gICAgICAgIGNvbnN0IHBvdGVudGlhbFVzZXJNZXNzYWdlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgncCwgZGl2LCBzcGFuJykpXG4gICAgICAgICAgLm1hcChlbCA9PiBlbC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnKVxuICAgICAgICAgIC5maWx0ZXIodGV4dCA9PiB0ZXh0ICYmIHRleHQuc3BsaXQoJyAnKS5sZW5ndGggPj0gMyAmJiB0ZXh0Lmxlbmd0aCA+IDIwKVxuICAgICAgICAgIC5maWx0ZXIodGV4dCA9PiAhdGV4dC5pbmNsdWRlcygnQ2hhdEdQVCcpICYmICF0ZXh0LmluY2x1ZGVzKCdMb2cgaW4nKSAmJiAhdGV4dC5pbmNsdWRlcygnU2lnbiB1cCcpKTtcbiAgICAgICAgICBcbiAgICAgICAgaWYgKHBvdGVudGlhbFVzZXJNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8g7LKrIOuyiOynuCDrqZTsi5zsp4Drpbwg7IKs7Jqp7J6QIOuplOyLnOyngOuhnCDstpTqsIBcbiAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZSA9IHBvdGVudGlhbFVzZXJNZXNzYWdlc1swXTtcbiAgICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHVzZXJNZXNzYWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8g64KY66i47KeAIO2FjeyKpO2KuOulvCDslrTsi5zsiqTthLTtirgg7J2R64u17Jy866GcIOy2lOqwgFxuICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1RleHQgPSBkb2N1bWVudC5ib2R5LmlubmVyVGV4dFxuICAgICAgICAgICAgLnJlcGxhY2UodGl0bGUsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UodXNlck1lc3NhZ2UsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL0xvZyBpbnxTaWduIHVwfEF0dGFjaHxTZWFyY2h8UmVhc29ufFZvaWNlfEJ5IG1lc3NhZ2luZyBDaGF0R1BUfFNraXAgdG8gY29udGVudHxDaGF0R1BUL2csICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL3dpbmRvd1xcLl9fb2FpXy4qPzsvZywgJycpXG4gICAgICAgICAgLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgICAgaWYgKHJlbWFpbmluZ1RleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgICBjb250ZW50OiByZW1haW5pbmdUZXh0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWVzc2FnZXMucHVzaCh7IFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50OiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4gQ2hhdEdQVCDqs7XsnKAg66eB7YGs6rCAIOycoO2aqO2VnOyngCDtmZXsnbjtlbTso7zshLjsmpQuJyBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbWVzc2FnZXMucHVzaCh7IFxuICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLCBcbiAgICAgICAgICBjb250ZW50OiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4gQ2hhdEdQVCDqs7XsnKAg66eB7YGs6rCAIOycoO2aqO2VnOyngCDtmZXsnbjtlbTso7zshLjsmpQuJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOuMgO2ZlO2YlSDqtazsobAg7ZmV7J24IC0g66i87KCAIOycoOyggCDrqZTsi5zsp4DroZwg7Iuc7J6R7ZWY64qU7KeAIO2ZleyduFxuICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPiAwICYmIG1lc3NhZ2VzWzBdLnJvbGUgIT09ICd1c2VyJykge1xuICAgICAgLy8gQ2hhdEdQVCDrjIDtmZTripQg7ZWt7IOBIOyCrOyaqeyekCDsp4jrrLjsnLzroZwg7Iuc7J6R7ZW07JW8IO2VqFxuICAgICAgLy8g64yA7ZmU6rCAIOyWtOyLnOyKpO2EtO2KuOuhnCDsi5zsnpHtlZjrqbQg7LKrIOuplOyLnOyngOulvCDsgqzsmqnsnpAg66mU7Iuc7KeA66GcIOuzgOqyvVxuICAgICAgY29uc29sZS5sb2coJ+yyqyDrqZTsi5zsp4DqsIAg7IKs7Jqp7J6QIOuplOyLnOyngOqwgCDslYTri5nri4jri6QuIOuMgO2ZlCDqtazsobDrpbwg7IiY7KCV7ZWp64uI64ukLicpO1xuICAgICAgXG4gICAgICAvLyDsg4gg64yA7ZmUIOq1rOyhsCDsg53shLFcbiAgICAgIGNvbnN0IGFsdGVybmF0aW5nTWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJzsgY29udGVudDogc3RyaW5nIH0+ID0gW107XG4gICAgICBcbiAgICAgIC8vIOyyqyDrsojsp7gg66mU7Iuc7KeA6rCAIGFzc2lzdGFudOyduCDqsr3smrAsIOqwgOynnCB1c2VyIOuplOyLnOyngOulvCDstpTqsIDtlZjqs6Ag7Iuc7J6RXG4gICAgICBhbHRlcm5hdGluZ01lc3NhZ2VzLnB1c2goe1xuICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgIGNvbnRlbnQ6ICfrjIDtmZTrpbwg7Iuc7J6R7ZWp64uI64ukLidcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyDquLDsobQg66mU7Iuc7KeAIOuzteyCrFxuICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICBhbHRlcm5hdGluZ01lc3NhZ2VzLnB1c2gobXNnKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyDsiJjsoJXrkJwg66mU7Iuc7KeA66GcIOq1kOyytFxuICAgICAgbWVzc2FnZXMgPSBhbHRlcm5hdGluZ01lc3NhZ2VzO1xuICAgIH1cbiAgICBcbiAgICAvLyDsmKzrsJTrpbgg64yA7ZmUIOq1rOyhsCDtmZXsnbggKHVzZXLsmYAgYXNzaXN0YW506rCAIOuyiOqwiOyVhCDrgpjtg4Drgpjslbwg7ZWoKVxuICAgIGNvbnN0IGNvcnJlY3RlZE1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgIGxldCBleHBlY3RlZFJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnID0gJ3VzZXInOyAvLyDrjIDtmZTripQgdXNlcuuhnCDsi5zsnpHtlbTslbwg7ZWoXG4gICAgXG4gICAgbWVzc2FnZXMuZm9yRWFjaCgobXNnLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGluZGV4ID09PSAwICYmIG1zZy5yb2xlICE9PSAndXNlcicpIHtcbiAgICAgICAgLy8g7LKrIOuplOyLnOyngOuKlCDtla3sg4Eg7IKs7Jqp7J6Q7Jes7JW8IO2VqFxuICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogJ+uMgO2ZlOulvCDsi5zsnpHtlanri4jri6QuJ1xuICAgICAgICB9KTtcbiAgICAgICAgZXhwZWN0ZWRSb2xlID0gJ2Fzc2lzdGFudCc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChtc2cucm9sZSA9PT0gZXhwZWN0ZWRSb2xlKSB7XG4gICAgICAgIC8vIOyXre2VoOydtCDsmIjsg4HrjIDroZzsnbgg6rK97JqwIOq3uOuMgOuhnCDstpTqsIBcbiAgICAgICAgY29ycmVjdGVkTWVzc2FnZXMucHVzaChtc2cpO1xuICAgICAgICAvLyDri6TsnYwg7JiI7IOBIOyXre2VoCDsoITtmZhcbiAgICAgICAgZXhwZWN0ZWRSb2xlID0gZXhwZWN0ZWRSb2xlID09PSAndXNlcicgPyAnYXNzaXN0YW50JyA6ICd1c2VyJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOqwmeydgCDsl63tlaDsnbQg7Jew7IaN7Jy866GcIOuCmO2DgOuCmOuKlCDqsr3smrAsIOu5iCDrqZTsi5zsp4Drpbwg7KSR6rCE7JeQIOyCveyehVxuICAgICAgICBpZiAoZXhwZWN0ZWRSb2xlID09PSAndXNlcicpIHtcbiAgICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICco6rOE7IaNKSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgY29udGVudDogJyjqs4Tsho0pJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIO2YhOyerCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICAgIGNvcnJlY3RlZE1lc3NhZ2VzLnB1c2gobXNnKTtcbiAgICAgICAgLy8g64uk7J2MIOyYiOyDgSDsl63tlaAg7ISk7KCVXG4gICAgICAgIGV4cGVjdGVkUm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnYXNzaXN0YW50JyA6ICd1c2VyJztcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICAvLyDsiJjsoJXrkJwg66mU7Iuc7KeA66GcIOq1kOyytFxuICAgIG1lc3NhZ2VzID0gY29ycmVjdGVkTWVzc2FnZXM7XG4gICAgICBcbiAgICAgIC8vIEdQVC00IOuqqOuNuOyduOyngCDtmZXsnbhcbiAgICAgIGNvbnN0IGlzR1BUNCA9IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0LmluY2x1ZGVzKCdHUFQtNCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVyVGV4dC5pbmNsdWRlcygnZ3B0LTQnKSB8fFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbWdbYWx0Kj1cIkdQVC00XCJdJykgIT09IG51bGw7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlLFxuICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgbW9kZWw6IGlzR1BUNCA/ICdncHQtNCcgOiAnZ3B0LTMuNS10dXJibycsXG4gICAgICAgICAgdGFnczogW11cbiAgICAgICAgfVxuICAgICAgfTtcbiAgfSkgYXMgeyBcbiAgICB0aXRsZTogc3RyaW5nOyBcbiAgICBtZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT47IFxuICAgIG1ldGFkYXRhOiB7IFxuICAgICAgZGF0ZTogc3RyaW5nOyBcbiAgICAgIG1vZGVsOiBzdHJpbmc7IFxuICAgICAgdGFnczogc3RyaW5nW107IFxuICAgIH07IFxuICB9O1xufSJdLCJuYW1lcyI6WyJDaGF0U291cmNlIiwicGF0aCIsImZzIiwicHVwcGV0ZWVyIiwicmVxdWlyZSIsImNocm9taXVtIiwiRXJyb3IiLCJpc1dpbmRvd3MiLCJwcm9jZXNzIiwicGxhdGZvcm0iLCJpc1ZlcmNlbCIsImVudiIsIlZFUkNFTCIsImdldENocm9taXVtUGF0aCIsImxvY2FsQ2hyb21lUGF0aHMiLCJMT0NBTEFQUERBVEEiLCJjaHJvbWVQYXRoIiwiZXhpc3RzU3luYyIsImNvbnNvbGUiLCJsb2ciLCJleGVjUGF0aCIsImV4ZWN1dGFibGVQYXRoIiwibG9jYWxDaHJvbWl1bVBhdGgiLCJqb2luIiwiY3dkIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiZXJyb3IiLCJkZWZhdWx0Q2hyb21lUGF0aCIsInBhcnNlQ2hhdEdQVExpbmsiLCJ1cmwiLCJicm93c2VyIiwiQ0hST01JVU1fUEFUSCIsIm9wdGlvbnMiLCJhcmdzIiwiZGVmYXVsdFZpZXdwb3J0IiwiaGVhZGxlc3MiLCJpZ25vcmVIVFRQU0Vycm9ycyIsImxhdW5jaCIsInBhZ2UiLCJuZXdQYWdlIiwic2V0VXNlckFnZW50IiwibWF4UmV0cmllcyIsImxvYWRlZCIsImF0dGVtcHQiLCJnb3RvIiwidGltZW91dCIsIndhaXRVbnRpbCIsIm5hdmlnYXRpb25FcnJvciIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm1lc3NhZ2UiLCJTdHJpbmciLCJpbmNsdWRlcyIsImlzQWN0dWFsTG9naW5QYWdlIiwiZXZhbHVhdGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJwYXRobmFtZSIsIndhaXRGb3JUaW1lb3V0Iiwic2NyZWVuc2hvdCIsInJhd0h0bWwiLCJjb250ZW50IiwicmF3VGV4dCIsImRvY3VtZW50IiwiYm9keSIsImlubmVyVGV4dCIsImNvbnZlcnNhdGlvbkRhdGEiLCJleHRyYWN0Q29udmVyc2F0aW9uRGF0YSIsImNvbnZlcnNhdGlvbiIsImlkIiwiZXh0cmFjdENvbnZlcnNhdGlvbklkIiwidGl0bGUiLCJtZXNzYWdlcyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNvdXJjZSIsIkNIQVRHUFQiLCJtZXRhZGF0YSIsImxlbmd0aCIsImNsb3NlIiwidXJsU2VnbWVudHMiLCJzcGxpdCIsInBvdGVudGlhbElkIiwicG9wIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiaDFFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwidHJpbSIsInRpdGxlRWxlbWVudCIsInJlcGxhY2UiLCJtZXRhVGl0bGUiLCJnZXRBdHRyaWJ1dGUiLCJ0b0xvY2FsZVN0cmluZyIsImFzc2lzdGFudEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsInVzZXJCeUF0dHJFbGVtZW50cyIsInVzZXJFbGVtZW50cyIsInNlbGVjdG9yIiwiY2FuZGlkYXRlcyIsIkFycmF5IiwiZnJvbSIsImNvbnZlcnNhdGlvbkVsZW1lbnRzIiwiZm9yRWFjaCIsImVsIiwicHVzaCIsImVsZW1lbnQiLCJyb2xlIiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbkluRG9jdW1lbnQiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsIm1hcCIsImUiLCJleHRyYWN0ZWRNZXNzYWdlcyIsIml0ZW0iLCJoYXNVc2VyIiwic29tZSIsIm0iLCJoYXNBc3Npc3RhbnQiLCJkZXB0aCIsInBhcmVudCIsInBhcmVudEVsZW1lbnQiLCJzaWJsaW5nUG9zaXRpb24iLCJzaWJsaW5nIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ5UG9zaXRpb24iLCJ0b3AiLCJwb3RlbnRpYWxVc2VyTWVzc2FnZXMiLCJmaWx0ZXIiLCJ0ZXh0IiwidXNlck1lc3NhZ2UiLCJyZW1haW5pbmdUZXh0IiwiYWx0ZXJuYXRpbmdNZXNzYWdlcyIsIm1zZyIsImNvcnJlY3RlZE1lc3NhZ2VzIiwiZXhwZWN0ZWRSb2xlIiwiaW5kZXgiLCJpc0dQVDQiLCJkYXRlIiwibW9kZWwiLCJ0YWdzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/chatgpt.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/openai.ts":
/*!*********************************!*\
  !*** ./src/lib/utils/openai.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   summarizeConversation: () => (/* binding */ summarizeConversation),\n/* harmony export */   summarizeLongConversation: () => (/* binding */ summarizeLongConversation)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n// OpenAI API 클라이언트 초기화\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// 사용할 모델 정의\nconst MODEL = \"gpt-4.1-nano\";\n/**\r\n * 대화 내용을 요약하고 키워드를 추출하는 함수\r\n * @param title 대화 제목\r\n * @param messages 대화 메시지 배열\r\n * @returns 요약된 내용과 키워드, 사용된 모델 정보\r\n */ async function summarizeConversation(title, messages) {\n    try {\n        const conversationText = messages.map((msg)=>`${msg.role === \"user\" ? \"\\uD83D\\uDC64 사용자\" : \"\\uD83E\\uDD16 AI\"}: ${msg.content}`).join(\"\\n\\n\");\n        // API 요청 - 요약 및 키워드 추출\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"당신은 대화 내용을 요약하고 주요 키워드를 추출하는 assistant입니다. 요약은 3-5문장으로, 키워드는 최대 5개까지 추출해주세요. JSON 형식으로 응답해주세요.\"\n                },\n                {\n                    role: \"user\",\n                    content: `제목: \"${title}\"\\n\\n다음 대화 내용을 요약하고, 관련 키워드를 추출해주세요. JSON 형식으로 응답해야 합니다. 다음 형식으로 응답하세요: {\"summary\": \"요약 내용...\", \"keywords\": [\"키워드1\", \"키워드2\", ...]}:\\n\\n${conversationText}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        // 응답 처리\n        try {\n            const content = response.choices[0]?.message?.content || \"\";\n            console.log(\"API 응답 내용:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"요약을 생성할 수 없습니다.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : [],\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"JSON 파싱 오류:\", parseError);\n            console.log(\"파싱 실패한 내용:\", response.choices[0]?.message?.content);\n            return {\n                summary: \"요약을 생성할 수 없습니다.\",\n                keywords: [],\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"대화 요약 중 오류 발생:\", error);\n        return {\n            summary: \"요약을 생성할 수 없습니다.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n/**\r\n * 긴 대화를 요약하는 함수 (토큰 제한에 걸리는 경우 사용)\r\n * @param title 대화 제목\r\n * @param messages 대화 메시지 배열\r\n * @returns 요약된 내용과 키워드, 사용된 모델 정보\r\n */ async function summarizeLongConversation(title, messages) {\n    try {\n        // 대화를 여러 파트로 나누기 (10개 메시지씩)\n        const messageParts = [];\n        const partSize = 10;\n        for(let i = 0; i < messages.length; i += partSize){\n            messageParts.push(messages.slice(i, i + partSize));\n        }\n        // 각 파트별로 요약 생성\n        const partSummaries = [];\n        let allKeywords = [];\n        for(let i = 0; i < messageParts.length; i++){\n            try {\n                const result = await summarizeConversation(`${title} (파트 ${i + 1}/${messageParts.length})`, messageParts[i]);\n                partSummaries.push(`파트 ${i + 1}: ${result.summary}`);\n                // 키워드 수집\n                if (Array.isArray(result.keywords)) {\n                    allKeywords = [\n                        ...allKeywords,\n                        ...result.keywords\n                    ];\n                }\n            } catch (error) {\n                console.error(`파트 ${i + 1} 요약 중 오류:`, error);\n                partSummaries.push(`파트 ${i + 1}: 요약 실패`);\n            }\n        }\n        // 부분 요약들을 조합하여 최종 요약 생성\n        const finalResponse = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"여러 대화 요약을 하나의 통합된 요약으로 만들고, 가장 중요한 키워드를 5개 이내로 추출해주세요. JSON 형식으로 응답해주세요.\"\n                },\n                {\n                    role: \"user\",\n                    content: `다음은 긴 대화를 나눈 부분별 요약입니다. 이들을 결합하여 전체 대화의 핵심을 담은 통합 요약을 5문장 이내로 작성하고, 가장 중요한 키워드 5개를 추출해주세요. JSON 형식으로 응답해야 합니다. {\"summary\": \"요약 내용...\", \"keywords\": [\"키워드1\", \"키워드2\", ...]} 형식으로 응답하세요:\\n\\n${partSummaries.join(\"\\n\\n\")}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        try {\n            const content = finalResponse.choices[0]?.message?.content || \"\";\n            console.log(\"최종 API 응답 내용:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"요약을 생성할 수 없습니다.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : allKeywords,\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"최종 요약 JSON 파싱 오류:\", parseError);\n            console.log(\"파싱 실패한 내용:\", finalResponse.choices[0]?.message?.content);\n            // 키워드 중복 제거 및 최대 5개로 제한\n            const uniqueKeywords = Array.from(new Set(allKeywords)).slice(0, 5);\n            return {\n                summary: \"요약을 생성할 수 없습니다.\",\n                keywords: uniqueKeywords,\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"긴 대화 요약 중 오류 발생:\", error);\n        return {\n            summary: \"요약을 생성할 수 없습니다.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxDQUFDLGNBQWNxQixjQUFjeEIsT0FBTyxDQUFDLEVBQUUsRUFBRUMsU0FBU1o7WUFFN0Qsd0JBQXdCO1lBQ3hCLE1BQU1vQyxpQkFBaUJoQixNQUFNaUIsSUFBSSxDQUFDLElBQUlDLElBQUlMLGNBQWNGLEtBQUssQ0FBQyxHQUFHO1lBRWpFLE9BQU87Z0JBQ0xiLFNBQVM7Z0JBQ1RDLFVBQVVpQjtnQkFDVmQsV0FBVzlCO1lBQ2I7UUFDRjtJQUNGLEVBQUUsT0FBT2dDLE9BQVk7UUFDbkJYLFFBQVFXLEtBQUssQ0FBQyxvQkFBb0JBO1FBQ2xDLE9BQU87WUFDTE4sU0FBUztZQUNUQyxVQUFVLEVBQUU7WUFDWkcsV0FBVzlCO1FBQ2I7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvbGliL3V0aWxzL29wZW5haS50cz9iNjgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuXHJcbi8vIE9wZW5BSSBBUEkg7YG065287J207Ja47Yq4IOy0iOq4sO2ZlFxyXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcclxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxyXG59KTtcclxuXHJcbi8vIOyCrOyaqe2VoCDrqqjrjbgg7KCV7J2YXHJcbmNvbnN0IE1PREVMID0gJ2dwdC00LjEtbmFubyc7XHJcblxyXG4vLyDsmpTslb0g6rKw6rO8IO2DgOyehSDsoJXsnZhcclxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJ5UmVzdWx0IHtcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIG1vZGVsVXNlZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7YKk7JuM65Oc66W8IOy2lOy2nO2VmOuKlCDtlajsiJhcclxuICogQHBhcmFtIHRpdGxlIOuMgO2ZlCDsoJzrqqlcclxuICogQHBhcmFtIG1lc3NhZ2VzIOuMgO2ZlCDrqZTsi5zsp4Ag67Cw7Je0XHJcbiAqIEByZXR1cm5zIOyalOyVveuQnCDrgrTsmqnqs7wg7YKk7JuM65OcLCDsgqzsmqnrkJwg66qo6424IOygleuztFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjb252ZXJzYXRpb25UZXh0ID0gbWVzc2FnZXNcclxuICAgICAgLm1hcChtc2cgPT4gYCR7bXNnLnJvbGUgPT09ICd1c2VyJyA/ICfwn5GkIOyCrOyaqeyekCcgOiAn8J+kliBBSSd9OiAke21zZy5jb250ZW50fWApXHJcbiAgICAgIC5qb2luKCdcXG5cXG4nKTtcclxuXHJcbiAgICAvLyBBUEkg7JqU7LKtIC0g7JqU7JW9IOuwjyDtgqTsm4zrk5wg7LaU7LacXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsOiBNT0RFTCxcclxuICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcclxuICAgICAgICAgIGNvbnRlbnQ6ICfri7nsi6DsnYAg64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7KO87JqUIO2CpOybjOuTnOulvCDstpTstpztlZjripQgYXNzaXN0YW507J6F64uI64ukLiDsmpTslb3snYAgMy0166y47J6l7Jy866GcLCDtgqTsm4zrk5zripQg7LWc64yAIDXqsJzquYzsp4Ag7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOygnOuqqTogXCIke3RpdGxlfVwiXFxuXFxu64uk7J2MIOuMgO2ZlCDrgrTsmqnsnYQg7JqU7JW97ZWY6rOgLCDqtIDroKgg7YKk7JuM65Oc66W8IOy2lOy2nO2VtOyjvOyEuOyalC4gSlNPTiDtmJXsi53snLzroZwg7J2R64u17ZW07JW8IO2VqeuLiOuLpC4g64uk7J2MIO2YleyLneycvOuhnCDsnZHri7XtlZjshLjsmpQ6IHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX06XFxuXFxuJHtjb252ZXJzYXRpb25UZXh0fWBcclxuICAgICAgICB9XHJcbiAgICAgIF0sXHJcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjUsXHJcbiAgICAgIG1heF90b2tlbnM6IDQwMCxcclxuICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDsnZHri7Ug7LKY66asXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcclxuICAgICAgY29uc29sZS5sb2coJ0FQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBbXSxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7IuxIOyYpOulmDonLCBwYXJzZUVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ+2MjOyLsSDsi6TtjKjtlZwg64K07JqpOicsIHJlc3BvbnNlLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1bW1hcnk6ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgICAgbW9kZWxVc2VkOiBNT0RFTFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+uMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog6ri0IOuMgO2ZlOulvCDsmpTslb3tlZjripQg7ZWo7IiYICjthqDtgbAg7KCc7ZWc7JeQIOqxuOumrOuKlCDqsr3smrAg7IKs7JqpKVxyXG4gKiBAcGFyYW0gdGl0bGUg64yA7ZmUIOygnOuqqVxyXG4gKiBAcGFyYW0gbWVzc2FnZXMg64yA7ZmUIOuplOyLnOyngCDrsLDsl7RcclxuICogQHJldHVybnMg7JqU7JW965CcIOuCtOyaqeqzvCDtgqTsm4zrk5wsIOyCrOyaqeuQnCDrqqjrjbgg7KCV67O0XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrjIDtmZTrpbwg7Jes65+sIO2MjO2KuOuhnCDrgpjriITquLAgKDEw6rCcIOuplOyLnOyngOyUqSlcclxuICAgIGNvbnN0IG1lc3NhZ2VQYXJ0czogQ2hhdE1lc3NhZ2VbXVtdID0gW107XHJcbiAgICBjb25zdCBwYXJ0U2l6ZSA9IDEwO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VzLmxlbmd0aDsgaSArPSBwYXJ0U2l6ZSkge1xyXG4gICAgICBtZXNzYWdlUGFydHMucHVzaChtZXNzYWdlcy5zbGljZShpLCBpICsgcGFydFNpemUpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g6rCBIO2MjO2KuOuzhOuhnCDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBwYXJ0U3VtbWFyaWVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgbGV0IGFsbEtleXdvcmRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VQYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICAgICAgICAgIGAke3RpdGxlfSAo7YyM7Yq4ICR7aSsxfS8ke21lc3NhZ2VQYXJ0cy5sZW5ndGh9KWAsXHJcbiAgICAgICAgICBtZXNzYWdlUGFydHNbaV1cclxuICAgICAgICApO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTogJHtyZXN1bHQuc3VtbWFyeX1gKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDtgqTsm4zrk5wg7IiY7KeRXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0LmtleXdvcmRzKSkge1xyXG4gICAgICAgICAgYWxsS2V5d29yZHMgPSBbLi4uYWxsS2V5d29yZHMsIC4uLnJlc3VsdC5rZXl3b3Jkc107XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYO2MjO2KuCAke2krMX0g7JqU7JW9IOykkSDsmKTrpZg6YCwgZXJyb3IpO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTog7JqU7JW9IOyLpO2MqGApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOu2gOu2hCDsmpTslb3rk6TsnYQg7KGw7ZWp7ZWY7JesIOy1nOyihSDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBmaW5hbFJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgbW9kZWw6IE1PREVMLFxyXG4gICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxyXG4gICAgICAgICAgY29udGVudDogJ+yXrOufrCDrjIDtmZQg7JqU7JW97J2EIO2VmOuCmOydmCDthrXtlanrkJwg7JqU7JW97Jy866GcIOunjOuTpOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5zrpbwgNeqwnCDsnbTrgrTroZwg7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOuLpOydjOydgCDquLQg64yA7ZmU66W8IOuCmOuIiCDrtoDrtoTrs4Qg7JqU7JW97J6F64uI64ukLiDsnbTrk6TsnYQg6rKw7ZWp7ZWY7JesIOyghOyytCDrjIDtmZTsnZgg7ZW17Ius7J2EIOuLtOydgCDthrXtlakg7JqU7JW97J2EIDXrrLjsnqUg7J2064K066GcIOyekeyEse2VmOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5wgNeqwnOulvCDstpTstpztlbTso7zshLjsmpQuIEpTT04g7ZiV7Iud7Jy866GcIOydkeuLte2VtOyVvCDtlanri4jri6QuIHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX0g7ZiV7Iud7Jy866GcIOydkeuLte2VmOyEuOyalDpcXG5cXG4ke3BhcnRTdW1tYXJpZXMuam9pbignXFxuXFxuJyl9YFxyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgdGVtcGVyYXR1cmU6IDAuNSxcclxuICAgICAgbWF4X3Rva2VuczogNDAwLFxyXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IHsgdHlwZTogXCJqc29uX29iamVjdFwiIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnO1xyXG4gICAgICBjb25zb2xlLmxvZygn7LWc7KKFIEFQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBhbGxLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyihSDsmpTslb0gSlNPTiDtjIzsi7Eg7Jik66WYOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICBjb25zb2xlLmxvZygn7YyM7IuxIOyLpO2MqO2VnCDrgrTsmqk6JywgZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50KTtcclxuICAgICAgXHJcbiAgICAgIC8vIO2CpOybjOuTnCDspJHrs7Ug7KCc6rGwIOuwjyDstZzrjIAgNeqwnOuhnCDsoJztlZxcclxuICAgICAgY29uc3QgdW5pcXVlS2V5d29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoYWxsS2V5d29yZHMpKS5zbGljZSgwLCA1KTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICAgIGtleXdvcmRzOiB1bmlxdWVLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcign6ri0IOuMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJPcGVuQUkiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJNT0RFTCIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsInRpdGxlIiwibWVzc2FnZXMiLCJjb252ZXJzYXRpb25UZXh0IiwibWFwIiwibXNnIiwicm9sZSIsImNvbnRlbnQiLCJqb2luIiwicmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInJlc3BvbnNlX2Zvcm1hdCIsInR5cGUiLCJjaG9pY2VzIiwibWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZWRDb250ZW50IiwiSlNPTiIsInBhcnNlIiwic3VtbWFyeSIsImtleXdvcmRzIiwiQXJyYXkiLCJpc0FycmF5IiwibW9kZWxVc2VkIiwicGFyc2VFcnJvciIsImVycm9yIiwic3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbiIsIm1lc3NhZ2VQYXJ0cyIsInBhcnRTaXplIiwiaSIsImxlbmd0aCIsInB1c2giLCJzbGljZSIsInBhcnRTdW1tYXJpZXMiLCJhbGxLZXl3b3JkcyIsInJlc3VsdCIsImZpbmFsUmVzcG9uc2UiLCJ1bmlxdWVLZXl3b3JkcyIsImZyb20iLCJTZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/openai.ts\n");

/***/ }),

/***/ "(rsc)/./src/types.ts":
/*!**********************!*\
  !*** ./src/types.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatSource: () => (/* binding */ ChatSource)\n/* harmony export */ });\nvar ChatSource;\n(function(ChatSource) {\n    ChatSource[\"CHATGPT\"] = \"chatgpt\";\n    ChatSource[\"USER_INPUT\"] = \"user_input\";\n    ChatSource[\"API\"] = \"api\";\n})(ChatSource || (ChatSource = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdHlwZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7VUFBWUE7Ozs7R0FBQUEsZUFBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8uL3NyYy90eXBlcy50cz8yNjljIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBlbnVtIENoYXRTb3VyY2Uge1xyXG4gIENIQVRHUFQgPSAnY2hhdGdwdCcsXHJcbiAgVVNFUl9JTlBVVCA9ICd1c2VyX2lucHV0JyxcclxuICBBUEkgPSAnYXBpJyxcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZSB7XHJcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udmVyc2F0aW9uIHtcclxuICBpZD86IHN0cmluZztcclxuICB0aXRsZTogc3RyaW5nO1xyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZSB8IHN0cmluZztcclxuICBzb3VyY2U6IENoYXRTb3VyY2U7XHJcbiAgdGFncz86IHN0cmluZ1tdO1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb25TdW1tYXJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xyXG4gIHNvdXJjZTogQ2hhdFNvdXJjZTtcclxuICB0YWdzPzogc3RyaW5nW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2V0dGluZ3Mge1xyXG4gIG9ic2lkaWFuVmF1bHRQYXRoOiBzdHJpbmc7XHJcbiAgb3BlbmFpQXBpS2V5OiBzdHJpbmc7XHJcbiAgZGVmYXVsdFRhZ3M6IHN0cmluZ1tdO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBBcGlSZXNwb25zZTxUPiA9IHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGRhdGE/OiBUO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJ5UmVzdWx0IHtcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIG1vZGVsVXNlZDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENoYXRDaHVuayB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBjaGF0X3Nlc3Npb25faWQ6IHN0cmluZztcclxuICBjaHVua19pbmRleDogbnVtYmVyO1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuICBlbWJlZGRpbmc/OiBudW1iZXJbXTtcclxuICBzaW1pbGFyaXR5PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENoYXRTZXNzaW9uIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICBjcmVhdGVkX2F0Pzogc3RyaW5nO1xyXG4gIGVtYmVkZGluZz86IG51bWJlcltdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhZ1NvdXJjZSB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHNpbWlsYXJpdHk/OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmFnUmVzcG9uc2Uge1xyXG4gIGFuc3dlcjogc3RyaW5nO1xyXG4gIHNvdXJjZXM6IFJhZ1NvdXJjZVtdO1xyXG59ICJdLCJuYW1lcyI6WyJDaGF0U291cmNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/types.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/automation.ts":
/*!*********************************!*\
  !*** ./src/utils/automation.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   commitToGitHub: () => (/* binding */ commitToGitHub),\n/* harmony export */   saveToObsidian: () => (/* binding */ saveToObsidian)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _supabaseHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./supabaseHandler */ \"(rsc)/./src/utils/supabaseHandler.ts\");\n// 전역 MCP 타입 선언 추가\n\n\n\n\n// fs 함수를 Promise 기반으로 변환\nconst writeFileAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().writeFile));\nconst mkdirAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().mkdir));\nconst readFileAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().readFile));\nconst existsAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().exists));\n// 기본 저장 경로 설정 (Obsidian Vault 경로)\nconst DEFAULT_VAULT_PATH = \"C:/Users/user/Documents/Obsidian Vault\";\nconst CHATGPT_FOLDER = \"ChatGPT\";\nconst CONVERSATIONS_FOLDER = \"conversations\";\n/**\r\n * MCP가 사용 가능한지 확인합니다.\r\n */ function isMcpAvailable(mcpFunction) {\n    return typeof global.mcp !== \"undefined\" && typeof global.mcp[mcpFunction] === \"function\";\n}\n/**\r\n * 디렉토리가 존재하는지 확인하고 없으면 생성합니다.\r\n */ async function ensureDirectoryExists(dirPath) {\n    try {\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dirPath)) {\n            await mkdirAsync(dirPath, {\n                recursive: true\n            });\n        }\n    } catch (error) {\n        console.error(`디렉토리 생성 오류 (${dirPath}):`, error);\n        throw error;\n    }\n}\n/**\r\n * URL이 이미 저장된 JSON 파일이 있는지 확인합니다.\r\n */ async function checkJsonFileExists(url) {\n    try {\n        // conversations 폴더 경로\n        const projectConversationPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), CONVERSATIONS_FOLDER);\n        // 폴더가 없으면 false 반환\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(projectConversationPath)) {\n            return false;\n        }\n        // URL 정규화 (쿼리 파라미터 등 제거)\n        const parsedUrl = new URL(url);\n        const normalizedUrl = parsedUrl.origin + parsedUrl.pathname;\n        const shareId = parsedUrl.pathname.split(\"/\").pop() || \"\";\n        // 모든 JSON 파일 목록 가져오기\n        const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(projectConversationPath).filter((file)=>file.endsWith(\".json\"));\n        // 각 파일을 확인하여 URL이 일치하는지 검사\n        for (const file of files){\n            const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(projectConversationPath, file);\n            const content = await readFileAsync(filePath, \"utf8\");\n            const data = JSON.parse(content);\n            if (data.url) {\n                // 완전히 일치하는 경우\n                if (data.url === url) {\n                    console.log(`완전히 일치하는 URL 발견: ${file}`);\n                    return true;\n                }\n                // 경로의 마지막 부분 (share ID) 비교\n                try {\n                    const existingParsedUrl = new URL(data.url);\n                    const existingShareId = existingParsedUrl.pathname.split(\"/\").pop() || \"\";\n                    if (shareId && existingShareId && shareId === existingShareId) {\n                        console.log(`공유 ID가 일치하는 URL 발견: ${file}`);\n                        return true;\n                    }\n                    // 정규화된 URL로 비교\n                    const existingNormalizedUrl = existingParsedUrl.origin + existingParsedUrl.pathname;\n                    if (normalizedUrl === existingNormalizedUrl) {\n                        console.log(`정규화된 URL이 일치하는 파일 발견: ${file}`);\n                        return true;\n                    }\n                } catch (parseError) {\n                    // URL 파싱 오류, 계속 진행\n                    console.error(\"기존 URL 파싱 오류:\", parseError);\n                }\n            }\n        }\n        return false;\n    } catch (error) {\n        console.error(\"JSON 파일 중복 확인 중 오류:\", error);\n        // 오류 발생 시 안전하게 중복이 아닌 것으로 처리\n        return false;\n    }\n}\n/**\r\n * 로컬 파일 시스템에 대화를 저장합니다.\r\n */ async function saveToFileSystem(fileName, markdownContent, rawText, conversation, summaryResult, url, skipJsonSave = false) {\n    try {\n        // Obsidian Vault 경로와 프로젝트 폴더 경로\n        const obsidianFolderPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(DEFAULT_VAULT_PATH, CHATGPT_FOLDER);\n        const projectConversationPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), CONVERSATIONS_FOLDER);\n        // 필요한 폴더 생성\n        await ensureDirectoryExists(obsidianFolderPath);\n        await ensureDirectoryExists(projectConversationPath);\n        // 마크다운 파일 저장 (Obsidian Vault에)\n        const markdownFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(obsidianFolderPath, fileName);\n        await writeFileAsync(markdownFilePath, markdownContent, \"utf8\");\n        console.log(`마크다운 파일 저장 완료: ${markdownFilePath}`);\n        // 원본 텍스트 저장 (Obsidian Vault에)\n        const textFileName = fileName.replace(\".md\", \"-original.txt\");\n        const textFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(obsidianFolderPath, textFileName);\n        await writeFileAsync(textFilePath, rawText, \"utf8\");\n        console.log(`원본 텍스트 파일 저장 완료: ${textFilePath}`);\n        // JSON 파일 저장 여부 확인 (중복 URL이면 저장하지 않음)\n        if (skipJsonSave) {\n            console.log(\"중복 URL이므로 JSON 파일 저장을 건너뜁니다.\");\n            return {\n                success: true,\n                files: {\n                    markdown: markdownFilePath,\n                    text: textFilePath\n                },\n                duplicate: true\n            };\n        }\n        // URL 중복 체크 (Supabase 및 로컬 JSON 파일)\n        const { exists: dbExists } = await (0,_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.checkUrlExists)(url);\n        const jsonExists = await checkJsonFileExists(url);\n        if (dbExists || jsonExists) {\n            console.log(\"이미 저장된 URL이므로 JSON 파일 저장을 건너뜁니다.\");\n            return {\n                success: true,\n                files: {\n                    markdown: markdownFilePath,\n                    text: textFilePath\n                },\n                duplicate: true\n            };\n        }\n        // JSON 형식으로 대화 저장 (PMKProject/conversations에)\n        const jsonFileName = `${conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\")}-${Date.now()}.json`;\n        const jsonFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(projectConversationPath, jsonFileName);\n        // 메타데이터에 model 필드 추가 또는 수정\n        const metadataWithModel = {\n            ...conversation.metadata || {},\n            model: conversation.metadata?.model || \"gpt-4.1-nano\",\n            savedAt: new Date().toISOString()\n        };\n        await writeFileAsync(jsonFilePath, JSON.stringify({\n            title: conversation.title,\n            url,\n            summary: summaryResult.summary,\n            keywords: summaryResult.keywords,\n            messages: conversation.messages,\n            metadata: metadataWithModel,\n            createdAt: new Date().toISOString()\n        }, null, 2), \"utf8\");\n        console.log(`JSON 파일 저장 완료: ${jsonFilePath}`);\n        return {\n            success: true,\n            files: {\n                markdown: markdownFilePath,\n                text: textFilePath,\n                json: jsonFilePath\n            }\n        };\n    } catch (error) {\n        console.error(\"파일 시스템 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * Obsidian Vault에 마크다운 노트를 생성합니다.\r\n */ async function saveToObsidian(conversation, summaryResult, rawText, url, skipDuplicateCheck = false) {\n    try {\n        // URL 중복 체크 (skipDuplicateCheck가 false일 때만)\n        if (!skipDuplicateCheck && url) {\n            // Supabase에서 중복 체크\n            const { exists, session } = await (0,_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.checkUrlExists)(url);\n            // 로컬 JSON 파일에서 중복 체크\n            const jsonExists = await checkJsonFileExists(url);\n            if (exists || jsonExists) {\n                console.log(`URL이 이미 존재합니다: ${url}`);\n                return {\n                    success: true,\n                    fileName: `${conversation.title.substring(0, 30)}.md (중복)`,\n                    duplicate: true,\n                    message: \"이미 저장된 대화입니다.\"\n                };\n            }\n        }\n        // 파일명 생성 (제목을 파일명으로 변환)\n        const fileName = conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100) + \".md\";\n        // 태그 목록 준비 (요약에서 추출한 키워드 + ChatGPT 모델)\n        const tags = [\n            ...summaryResult.keywords || [],\n            \"gpt-4.1-nano\"\n        ].filter(Boolean); // 빈 값 제거\n        // YAML 프론트매터 생성\n        const frontmatter = `---\r\ntitle: ${conversation.title}\r\ndate: ${new Date().toISOString()}\r\nsource: ${url}\r\ntags: [${tags.map((tag)=>`\"${tag}\"`).join(\", \")}]\r\nmodel: gpt-4.1-nano\r\n---\r\n\r\n`;\n        // 대화 내용을 마크다운으로 변환\n        let markdownContent = frontmatter;\n        // 대화 내용 추가\n        markdownContent += `# ${conversation.title}\\n\\n`;\n        // URL과 날짜 정보 추가\n        markdownContent += `> [원본 URL](${url})\\n\\n`;\n        markdownContent += `> 저장 시간: ${new Date().toLocaleString(\"ko-KR\")}\\n\\n`;\n        if (tags.length > 0) {\n            markdownContent += `> 태그: ${tags.join(\", \")}\\n\\n`;\n        }\n        markdownContent += `---\\n\\n`;\n        // 사용자-어시스턴트 대화 내용을 마크다운으로 포맷팅\n        conversation.messages.forEach((message, index)=>{\n            const isUser = message.role === \"user\";\n            const messageHeader = isUser ? \"## \\uD83D\\uDC64 사용자\" : \"## \\uD83E\\uDD16 assistant\";\n            // 역할과 내용을 구분하여 표시\n            markdownContent += `${messageHeader}\\n\\n${message.content}\\n\\n`;\n            // 마지막 메시지가 아니면 구분선 추가\n            if (index < conversation.messages.length - 1) {\n                markdownContent += `---\\n\\n`;\n            }\n        });\n        // 요약 섹션 추가\n        markdownContent += `\\n\\n---\\n\\n## 💡 요약\\n\\n${summaryResult.summary}\\n`;\n        // 키워드 섹션 추가\n        if (summaryResult.keywords && summaryResult.keywords.length > 0) {\n            markdownContent += `\\n## 🔑 키워드\\n\\n${summaryResult.keywords.map((k)=>`\\`${k}\\``).join(\" \")}\\n`;\n        }\n        // MCP 사용이 가능한지 확인\n        if (isMcpAvailable(\"obsidian-mcp_create-note\")) {\n            try {\n                // Obsidian MCP로 파일 저장\n                await new Promise((resolve, reject)=>{\n                    try {\n                        // @ts-ignore - MCP 타입 정의 없음\n                        global.mcp[\"obsidian-mcp_create-note\"]({\n                            vault: \"obsidian-vault\",\n                            folder: \"ChatGPT\",\n                            filename: fileName,\n                            content: markdownContent\n                        }, (result)=>{\n                            if (result.error) {\n                                reject(new Error(`Obsidian 저장 실패: ${result.error}`));\n                            } else {\n                                resolve(result);\n                            }\n                        });\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n                // 원본 텍스트 내용 저장\n                const textFileName = fileName.replace(\".md\", \"-original.txt\");\n                await new Promise((resolve, reject)=>{\n                    try {\n                        // @ts-ignore - MCP 타입 정의 없음\n                        global.mcp[\"obsidian-mcp_create-note\"]({\n                            vault: \"obsidian-vault\",\n                            folder: \"ChatGPT\",\n                            filename: textFileName,\n                            content: rawText\n                        }, (result)=>{\n                            if (result.error) {\n                                reject(new Error(`Obsidian 원본 텍스트 저장 실패: ${result.error}`));\n                            } else {\n                                resolve(result);\n                            }\n                        });\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n                return {\n                    success: true,\n                    fileName,\n                    method: \"mcp\"\n                };\n            } catch (mcpError) {\n                console.error(\"MCP 저장 실패, 파일 시스템으로 대체합니다:\", mcpError);\n            // MCP 실패 시 아래의 파일 시스템 방식으로 진행\n            }\n        }\n        // MCP가 없거나 실패한 경우, 파일 시스템 사용하여 저장\n        console.log(\"MCP를 사용할 수 없습니다. 파일 시스템을 사용하여 저장합니다.\");\n        // 파일 시스템에 저장 (URL 중복 여부 전달)\n        const fileSystemResult = await saveToFileSystem(fileName, markdownContent, rawText, conversation, summaryResult, url, skipDuplicateCheck // 중복 URL이면 JSON 저장 건너뛰기\n        );\n        return {\n            success: true,\n            fileName,\n            method: \"filesystem\",\n            files: fileSystemResult.files,\n            duplicate: fileSystemResult.duplicate\n        };\n    } catch (error) {\n        console.error(\"Obsidian 저장 중 오류:\", error);\n        // 오류가 발생해도 RAG 시스템 진행에는 영향을 주지 않도록 성공 상태 반환\n        return {\n            success: true,\n            fileName: `${conversation.title.substring(0, 30)}.md (저장 실패)`,\n            error: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n/**\r\n * GitHub 저장소에 변경사항을 커밋하고 푸시합니다.\r\n */ async function commitToGitHub(message = \"Update ChatGPT conversations\") {\n    try {\n        // MCP 사용이 가능한지 확인\n        if (isMcpAvailable(\"mcp_github_push_files\")) {\n            // GitHub 저장소의 변경사항 확인\n            const result = await new Promise((resolve, reject)=>{\n                try {\n                    // @ts-ignore - MCP 타입 정의 없음\n                    global.mcp[\"mcp_github_push_files\"]({\n                        repo: \"PKMProjet\",\n                        branch: \"main\",\n                        message,\n                        files: [\n                            {\n                                path: \"ChatGPT\",\n                                recursive: true // 하위 파일 포함\n                            }\n                        ]\n                    }, (result)=>{\n                        if (result.error) {\n                            reject(new Error(`GitHub 커밋 실패: ${result.error}`));\n                        } else {\n                            resolve(result);\n                        }\n                    });\n                } catch (error) {\n                    reject(error);\n                }\n            });\n            return {\n                success: true,\n                result,\n                method: \"mcp\"\n            };\n        } else {\n            // MCP를 사용할 수 없는 경우 로그만 남기고 성공으로 처리\n            console.log(\"GitHub MCP를 사용할 수 없습니다. 커밋 작업은 건너뜁니다.\");\n            return {\n                success: true,\n                method: \"skipped\",\n                message: \"GitHub 커밋 기능은 MCP 환경에서만 사용 가능합니다.\"\n            };\n        }\n    } catch (error) {\n        console.error(\"GitHub 커밋 중 오류:\", error);\n        // 오류가 발생해도 RAG 시스템 진행에는 영향을 주지 않도록 성공 상태 반환\n        return {\n            success: true,\n            method: \"failed\",\n            error: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTQztnQkFDekMsSUFBSTtvQkFDRiw0QkFBNEI7b0JBQzVCNUYsT0FBT0MsR0FBRyxDQUFDLHdCQUF3QixDQUFDO3dCQUNsQ3FHLE1BQU07d0JBQ05DLFFBQVE7d0JBQ1IzQjt3QkFDQXRELE9BQU87NEJBQ0w7Z0NBQ0V0QyxNQUFNO2dDQUNOcUIsV0FBVyxLQUFXLFdBQVc7NEJBQ25DO3lCQUNEO29CQUNILEdBQUcsQ0FBQzJGO3dCQUNGLElBQUlBLE9BQU8xRixLQUFLLEVBQUU7NEJBQ2hCc0YsT0FBTyxJQUFJSyxNQUFNLENBQUMsY0FBYyxFQUFFRCxPQUFPMUYsS0FBSyxDQUFDLENBQUM7d0JBQ2xELE9BQU87NEJBQ0xxRixRQUFRSzt3QkFDVjtvQkFDRjtnQkFDRixFQUFFLE9BQU8xRixPQUFPO29CQUNkc0YsT0FBT3RGO2dCQUNUO1lBQ0Y7WUFFQSxPQUFPO2dCQUFFMkMsU0FBUztnQkFBTStDO2dCQUFRRSxRQUFRO1lBQU07UUFDaEQsT0FBTztZQUNMLG1DQUFtQztZQUNuQzNGLFFBQVF5QixHQUFHLENBQUM7WUFDWixPQUFPO2dCQUNMaUIsU0FBUztnQkFDVGlELFFBQVE7Z0JBQ1J0QixTQUFTO1lBQ1g7UUFDRjtJQUNGLEVBQUUsT0FBT3RFLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsNENBQTRDO1FBQzVDLE9BQU87WUFDTDJDLFNBQVM7WUFDVGlELFFBQVE7WUFDUjVGLE9BQU9BLGlCQUFpQjJGLFFBQVEzRixNQUFNc0UsT0FBTyxHQUFHO1FBQ2xEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL3V0aWxzL2F1dG9tYXRpb24udHM/ZjE5YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDsoITsl60gTUNQIO2DgOyehSDshKDslrgg7LaU6rCAXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgIG1jcDogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZDtcclxuICB9XHJcbiAgdmFyIG1jcDogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZDtcclxufVxyXG5cclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgU3VtbWFyeVJlc3VsdCB9IGZyb20gJ0AvbGliL3V0aWxzL29wZW5haSc7XHJcbmltcG9ydCBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IHsgY2hlY2tVcmxFeGlzdHMgfSBmcm9tICcuL3N1cGFiYXNlSGFuZGxlcic7XHJcblxyXG4vLyBmcyDtlajsiJjrpbwgUHJvbWlzZSDquLDrsJjsnLzroZwg67OA7ZmYXHJcbmNvbnN0IHdyaXRlRmlsZUFzeW5jID0gcHJvbWlzaWZ5KGZzLndyaXRlRmlsZSk7XHJcbmNvbnN0IG1rZGlyQXN5bmMgPSBwcm9taXNpZnkoZnMubWtkaXIpO1xyXG5jb25zdCByZWFkRmlsZUFzeW5jID0gcHJvbWlzaWZ5KGZzLnJlYWRGaWxlKTtcclxuY29uc3QgZXhpc3RzQXN5bmMgPSBwcm9taXNpZnkoZnMuZXhpc3RzKTtcclxuXHJcbi8vIOq4sOuzuCDsoIDsnqUg6rK966GcIOyEpOyglSAoT2JzaWRpYW4gVmF1bHQg6rK966GcKVxyXG5jb25zdCBERUZBVUxUX1ZBVUxUX1BBVEggPSBcIkM6L1VzZXJzL3VzZXIvRG9jdW1lbnRzL09ic2lkaWFuIFZhdWx0XCI7XHJcbmNvbnN0IENIQVRHUFRfRk9MREVSID0gJ0NoYXRHUFQnO1xyXG5jb25zdCBDT05WRVJTQVRJT05TX0ZPTERFUiA9ICdjb252ZXJzYXRpb25zJztcclxuXHJcbi8qKlxyXG4gKiBNQ1DqsIAg7IKs7JqpIOqwgOuKpe2VnOyngCDtmZXsnbjtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc01jcEF2YWlsYWJsZShtY3BGdW5jdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHR5cGVvZiBnbG9iYWwubWNwICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZ2xvYmFsLm1jcFttY3BGdW5jdGlvbl0gPT09ICdmdW5jdGlvbic7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrlJTroInthqDrpqzqsIAg7KG07J6s7ZWY64qU7KeAIO2ZleyduO2VmOqzoCDsl4bsnLzrqbQg7IOd7ISx7ZWp64uI64ukLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGlyZWN0b3J5RXhpc3RzKGRpclBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyUGF0aCkpIHtcclxuICAgICAgYXdhaXQgbWtkaXJBc3luYyhkaXJQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihg65SU66CJ7Yag66asIOyDneyEsSDsmKTrpZggKCR7ZGlyUGF0aH0pOmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVSTOydtCDsnbTrr7gg7KCA7J6l65CcIEpTT04g7YyM7J287J20IOyeiOuKlOyngCDtmZXsnbjtlanri4jri6QuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBjaGVja0pzb25GaWxlRXhpc3RzKHVybDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIGNvbnZlcnNhdGlvbnMg7Y+0642UIOqyveuhnFxyXG4gICAgY29uc3QgcHJvamVjdENvbnZlcnNhdGlvblBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgQ09OVkVSU0FUSU9OU19GT0xERVIpO1xyXG4gICAgXHJcbiAgICAvLyDtj7TrjZTqsIAg7JeG7Jy866m0IGZhbHNlIOuwmO2ZmFxyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHByb2plY3RDb252ZXJzYXRpb25QYXRoKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFVSTCDsoJXqt5ztmZQgKOy/vOumrCDtjIzrnbzrr7jthLAg65OxIOygnOqxsClcclxuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBwYXJzZWRVcmwub3JpZ2luICsgcGFyc2VkVXJsLnBhdGhuYW1lO1xyXG4gICAgY29uc3Qgc2hhcmVJZCA9IHBhcnNlZFVybC5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpIHx8ICcnO1xyXG4gICAgXHJcbiAgICAvLyDrqqjrk6AgSlNPTiDtjIzsnbwg66qp66GdIOqwgOyguOyYpOq4sFxyXG4gICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhwcm9qZWN0Q29udmVyc2F0aW9uUGF0aCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5lbmRzV2l0aCgnLmpzb24nKSk7XHJcbiAgICBcclxuICAgIC8vIOqwgSDtjIzsnbzsnYQg7ZmV7J247ZWY7JesIFVSTOydtCDsnbzsuZjtlZjripTsp4Ag6rKA7IKsXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4ocHJvamVjdENvbnZlcnNhdGlvblBhdGgsIGZpbGUpO1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVhZEZpbGVBc3luYyhmaWxlUGF0aCwgJ3V0ZjgnKTtcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZGF0YS51cmwpIHtcclxuICAgICAgICAvLyDsmYTsoITtnogg7J287LmY7ZWY64qUIOqyveyasFxyXG4gICAgICAgIGlmIChkYXRhLnVybCA9PT0gdXJsKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg7JmE7KCE7Z6IIOydvOy5mO2VmOuKlCBVUkwg67Cc6rKsOiAke2ZpbGV9YCk7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g6rK966Gc7J2YIOuniOyngOuniSDrtoDrtoQgKHNoYXJlIElEKSDruYTqtZBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmdQYXJzZWRVcmwgPSBuZXcgVVJMKGRhdGEudXJsKTtcclxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nU2hhcmVJZCA9IGV4aXN0aW5nUGFyc2VkVXJsLnBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCkgfHwgJyc7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChzaGFyZUlkICYmIGV4aXN0aW5nU2hhcmVJZCAmJiBzaGFyZUlkID09PSBleGlzdGluZ1NoYXJlSWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOqzteycoCBJROqwgCDsnbzsuZjtlZjripQgVVJMIOuwnOqyrDogJHtmaWxlfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8g7KCV6rec7ZmU65CcIFVSTOuhnCDruYTqtZBcclxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTm9ybWFsaXplZFVybCA9IGV4aXN0aW5nUGFyc2VkVXJsLm9yaWdpbiArIGV4aXN0aW5nUGFyc2VkVXJsLnBhdGhuYW1lO1xyXG4gICAgICAgICAgaWYgKG5vcm1hbGl6ZWRVcmwgPT09IGV4aXN0aW5nTm9ybWFsaXplZFVybCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg7KCV6rec7ZmU65CcIFVSTOydtCDsnbzsuZjtlZjripQg7YyM7J28IOuwnOqyrDogJHtmaWxlfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgICAgICAvLyBVUkwg7YyM7IuxIOyYpOulmCwg6rOE7IaNIOynhO2WiVxyXG4gICAgICAgICAgY29uc29sZS5lcnJvcign6riw7KG0IFVSTCDtjIzsi7Eg7Jik66WYOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7J28IOykkeuztSDtmZXsnbgg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICAvLyDsmKTrpZgg67Cc7IOdIOyLnCDslYjsoITtlZjqsowg7KSR67O17J20IOyVhOuLjCDqsoPsnLzroZwg7LKY66asXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog66Gc7LusIO2MjOydvCDsi5zsiqTthZzsl5Ag64yA7ZmU66W8IOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNhdmVUb0ZpbGVTeXN0ZW0oXHJcbiAgZmlsZU5hbWU6IHN0cmluZyxcclxuICBtYXJrZG93bkNvbnRlbnQ6IHN0cmluZyxcclxuICByYXdUZXh0OiBzdHJpbmcsXHJcbiAgY29udmVyc2F0aW9uOiB7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5UmVzdWx0LFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIHNraXBKc29uU2F2ZTogYm9vbGVhbiA9IGZhbHNlXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBPYnNpZGlhbiBWYXVsdCDqsr3roZzsmYAg7ZSE66Gc7KCd7Yq4IO2PtOuNlCDqsr3roZxcclxuICAgIGNvbnN0IG9ic2lkaWFuRm9sZGVyUGF0aCA9IHBhdGguam9pbihERUZBVUxUX1ZBVUxUX1BBVEgsIENIQVRHUFRfRk9MREVSKTtcclxuICAgIGNvbnN0IHByb2plY3RDb252ZXJzYXRpb25QYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIENPTlZFUlNBVElPTlNfRk9MREVSKTtcclxuICAgIFxyXG4gICAgLy8g7ZWE7JqU7ZWcIO2PtOuNlCDsg53shLFcclxuICAgIGF3YWl0IGVuc3VyZURpcmVjdG9yeUV4aXN0cyhvYnNpZGlhbkZvbGRlclBhdGgpO1xyXG4gICAgYXdhaXQgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKHByb2plY3RDb252ZXJzYXRpb25QYXRoKTtcclxuICAgIFxyXG4gICAgLy8g66eI7YGs64uk7Jq0IO2MjOydvCDsoIDsnqUgKE9ic2lkaWFuIFZhdWx07JeQKVxyXG4gICAgY29uc3QgbWFya2Rvd25GaWxlUGF0aCA9IHBhdGguam9pbihvYnNpZGlhbkZvbGRlclBhdGgsIGZpbGVOYW1lKTtcclxuICAgIGF3YWl0IHdyaXRlRmlsZUFzeW5jKG1hcmtkb3duRmlsZVBhdGgsIG1hcmtkb3duQ29udGVudCwgJ3V0ZjgnKTtcclxuICAgIGNvbnNvbGUubG9nKGDrp4jtgazri6TsmrQg7YyM7J28IOyggOyepSDsmYTro4w6ICR7bWFya2Rvd25GaWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgLy8g7JuQ67O4IO2FjeyKpO2KuCDsoIDsnqUgKE9ic2lkaWFuIFZhdWx07JeQKVxyXG4gICAgY29uc3QgdGV4dEZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgnLm1kJywgJy1vcmlnaW5hbC50eHQnKTtcclxuICAgIGNvbnN0IHRleHRGaWxlUGF0aCA9IHBhdGguam9pbihvYnNpZGlhbkZvbGRlclBhdGgsIHRleHRGaWxlTmFtZSk7XHJcbiAgICBhd2FpdCB3cml0ZUZpbGVBc3luYyh0ZXh0RmlsZVBhdGgsIHJhd1RleHQsICd1dGY4Jyk7XHJcbiAgICBjb25zb2xlLmxvZyhg7JuQ67O4IO2FjeyKpO2KuCDtjIzsnbwg7KCA7J6lIOyZhOujjDogJHt0ZXh0RmlsZVBhdGh9YCk7XHJcbiAgICBcclxuICAgIC8vIEpTT04g7YyM7J28IOyggOyepSDsl6zrtoAg7ZmV7J24ICjspJHrs7UgVVJM7J2066m0IOyggOyepe2VmOyngCDslYrsnYwpXHJcbiAgICBpZiAoc2tpcEpzb25TYXZlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfspJHrs7UgVVJM7J2066+A66GcIEpTT04g7YyM7J28IOyggOyepeydhCDqsbTrhIjrnIHri4jri6QuJyk7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICAgIGZpbGVzOiB7XHJcbiAgICAgICAgICBtYXJrZG93bjogbWFya2Rvd25GaWxlUGF0aCwgXHJcbiAgICAgICAgICB0ZXh0OiB0ZXh0RmlsZVBhdGhcclxuICAgICAgICB9LFxyXG4gICAgICAgIGR1cGxpY2F0ZTogdHJ1ZVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVUkwg7KSR67O1IOyytO2BrCAoU3VwYWJhc2Ug67CPIOuhnOy7rCBKU09OIO2MjOydvClcclxuICAgIGNvbnN0IHsgZXhpc3RzOiBkYkV4aXN0cyB9ID0gYXdhaXQgY2hlY2tVcmxFeGlzdHModXJsKTtcclxuICAgIGNvbnN0IGpzb25FeGlzdHMgPSBhd2FpdCBjaGVja0pzb25GaWxlRXhpc3RzKHVybCk7XHJcbiAgICBcclxuICAgIGlmIChkYkV4aXN0cyB8fCBqc29uRXhpc3RzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfsnbTrr7gg7KCA7J6l65CcIFVSTOydtOuvgOuhnCBKU09OIO2MjOydvCDsoIDsnqXsnYQg6rG064SI65yB64uI64ukLicpO1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgICBmaWxlczoge1xyXG4gICAgICAgICAgbWFya2Rvd246IG1hcmtkb3duRmlsZVBhdGgsIFxyXG4gICAgICAgICAgdGV4dDogdGV4dEZpbGVQYXRoXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkdXBsaWNhdGU6IHRydWVcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSlNPTiDtmJXsi53snLzroZwg64yA7ZmUIOyggOyepSAoUE1LUHJvamVjdC9jb252ZXJzYXRpb25z7JeQKVxyXG4gICAgY29uc3QganNvbkZpbGVOYW1lID0gYCR7Y29udmVyc2F0aW9uLnRpdGxlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTnqsIAt7Z6jXS9nLCAnLScpfS0ke0RhdGUubm93KCl9Lmpzb25gO1xyXG4gICAgY29uc3QganNvbkZpbGVQYXRoID0gcGF0aC5qb2luKHByb2plY3RDb252ZXJzYXRpb25QYXRoLCBqc29uRmlsZU5hbWUpO1xyXG4gICAgXHJcbiAgICAvLyDrqZTtg4DrjbDsnbTthLDsl5AgbW9kZWwg7ZWE65OcIOy2lOqwgCDrmJDripQg7IiY7KCVXHJcbiAgICBjb25zdCBtZXRhZGF0YVdpdGhNb2RlbCA9IHtcclxuICAgICAgLi4uKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSB8fCB7fSksXHJcbiAgICAgIG1vZGVsOiBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8ICdncHQtNC4xLW5hbm8nLFxyXG4gICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIGF3YWl0IHdyaXRlRmlsZUFzeW5jKFxyXG4gICAgICBqc29uRmlsZVBhdGgsXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5UmVzdWx0LnN1bW1hcnksXHJcbiAgICAgICAgICBrZXl3b3Jkczogc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyxcclxuICAgICAgICAgIG1lc3NhZ2VzOiBjb252ZXJzYXRpb24ubWVzc2FnZXMsXHJcbiAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGFXaXRoTW9kZWwsXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbnVsbCxcclxuICAgICAgICAyXHJcbiAgICAgICksXHJcbiAgICAgICd1dGY4J1xyXG4gICAgKTtcclxuICAgIGNvbnNvbGUubG9nKGBKU09OIO2MjOydvCDsoIDsnqUg7JmE66OMOiAke2pzb25GaWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlczoge1xyXG4gICAgICAgIG1hcmtkb3duOiBtYXJrZG93bkZpbGVQYXRoLCBcclxuICAgICAgICB0ZXh0OiB0ZXh0RmlsZVBhdGgsIFxyXG4gICAgICAgIGpzb246IGpzb25GaWxlUGF0aFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCftjIzsnbwg7Iuc7Iqk7YWcIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIFZhdWx07JeQIOuniO2BrOuLpOyatCDrhbjtirjrpbwg7IOd7ISx7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVUb09ic2lkaWFuKFxyXG4gIGNvbnZlcnNhdGlvbjoge1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gICAgaWQ/OiBzdHJpbmc7XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5UmVzdWx0LFxyXG4gIHJhd1RleHQ6IHN0cmluZyxcclxuICB1cmw6IHN0cmluZyxcclxuICBza2lwRHVwbGljYXRlQ2hlY2s6IGJvb2xlYW4gPSBmYWxzZVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgLy8gVVJMIOykkeuztSDssrTtgawgKHNraXBEdXBsaWNhdGVDaGVja+qwgCBmYWxzZeydvCDrlYzrp4wpXHJcbiAgICBpZiAoIXNraXBEdXBsaWNhdGVDaGVjayAmJiB1cmwpIHtcclxuICAgICAgLy8gU3VwYWJhc2Xsl5DshJwg7KSR67O1IOyytO2BrFxyXG4gICAgICBjb25zdCB7IGV4aXN0cywgc2Vzc2lvbiB9ID0gYXdhaXQgY2hlY2tVcmxFeGlzdHModXJsKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOuhnOy7rCBKU09OIO2MjOydvOyXkOyEnCDspJHrs7Ug7LK07YGsXHJcbiAgICAgIGNvbnN0IGpzb25FeGlzdHMgPSBhd2FpdCBjaGVja0pzb25GaWxlRXhpc3RzKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXhpc3RzIHx8IGpzb25FeGlzdHMpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVVJM7J20IOydtOuvuCDsobTsnqztlanri4jri6Q6ICR7dXJsfWApO1xyXG4gICAgICAgIHJldHVybiB7IFxyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgICAgICBmaWxlTmFtZTogYCR7Y29udmVyc2F0aW9uLnRpdGxlLnN1YnN0cmluZygwLCAzMCl9Lm1kICjspJHrs7UpYCxcclxuICAgICAgICAgIGR1cGxpY2F0ZTogdHJ1ZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICfsnbTrr7gg7KCA7J6l65CcIOuMgO2ZlOyeheuLiOuLpC4nXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDtjIzsnbzrqoUg7IOd7ISxICjsoJzrqqnsnYQg7YyM7J2866qF7Jy866GcIOuzgO2ZmClcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gY29udmVyc2F0aW9uLnRpdGxlXHJcbiAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgIC5yZXBsYWNlKC9bXmEtejAtOeqwgC3tnqNdL2csICctJylcclxuICAgICAgLnJlcGxhY2UoLy0rL2csICctJylcclxuICAgICAgLnJlcGxhY2UoL14tfC0kL2csICcnKVxyXG4gICAgICAuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLm1kJztcclxuICAgIFxyXG4gICAgLy8g7YOc6re4IOuqqeuhnSDspIDruYQgKOyalOyVveyXkOyEnCDstpTstpztlZwg7YKk7JuM65OcICsgQ2hhdEdQVCDrqqjrjbgpXHJcbiAgICBjb25zdCB0YWdzID0gW1xyXG4gICAgICAuLi4oc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyB8fCBbXSksXHJcbiAgICAgICdncHQtNC4xLW5hbm8nXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKTsgLy8g67mIIOqwkiDsoJzqsbBcclxuICAgIFxyXG4gICAgLy8gWUFNTCDtlITroaDtirjrp6TthLAg7IOd7ISxXHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGAtLS1cclxudGl0bGU6ICR7Y29udmVyc2F0aW9uLnRpdGxlfVxyXG5kYXRlOiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cclxuc291cmNlOiAke3VybH1cclxudGFnczogWyR7dGFncy5tYXAodGFnID0+IGBcIiR7dGFnfVwiYCkuam9pbignLCAnKX1dXHJcbm1vZGVsOiBncHQtNC4xLW5hbm9cclxuLS0tXHJcblxyXG5gO1xyXG4gICAgXHJcbiAgICAvLyDrjIDtmZQg64K07Jqp7J2EIOuniO2BrOuLpOyatOycvOuhnCDrs4DtmZhcclxuICAgIGxldCBtYXJrZG93bkNvbnRlbnQgPSBmcm9udG1hdHRlcjtcclxuICAgIFxyXG4gICAgLy8g64yA7ZmUIOuCtOyaqSDstpTqsIBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgIyAke2NvbnZlcnNhdGlvbi50aXRsZX1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICAvLyBVUkzqs7wg64Kg7KecIOygleuztCDstpTqsIBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgPiBb7JuQ67O4IFVSTF0oJHt1cmx9KVxcblxcbmA7XHJcbiAgICBtYXJrZG93bkNvbnRlbnQgKz0gYD4g7KCA7J6lIOyLnOqwhDogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdrby1LUicpfVxcblxcbmA7XHJcbiAgICBcclxuICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGA+IO2DnOq3uDogJHt0YWdzLmpvaW4oJywgJyl9XFxuXFxuYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICAvLyDsgqzsmqnsnpAt7Ja07Iuc7Iqk7YS07Yq4IOuMgO2ZlCDrgrTsmqnsnYQg66eI7YGs64uk7Jq07Jy866GcIO2PrOunt+2MhVxyXG4gICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XHJcbiAgICAgIGNvbnN0IGlzVXNlciA9IG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInO1xyXG4gICAgICBjb25zdCBtZXNzYWdlSGVhZGVyID0gaXNVc2VyID8gJyMjIPCfkaQg7IKs7Jqp7J6QJyA6ICcjIyDwn6SWIGFzc2lzdGFudCc7XHJcbiAgICAgIFxyXG4gICAgICAvLyDsl63tlaDqs7wg64K07Jqp7J2EIOq1rOu2hO2VmOyXrCDtkZzsi5xcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGAke21lc3NhZ2VIZWFkZXJ9XFxuXFxuJHttZXNzYWdlLmNvbnRlbnR9XFxuXFxuYDtcclxuICAgICAgXHJcbiAgICAgIC8vIOuniOyngOuniSDrqZTsi5zsp4DqsIAg7JWE64uI66m0IOq1rOu2hOyEoCDstpTqsIBcclxuICAgICAgaWYgKGluZGV4IDwgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICBtYXJrZG93bkNvbnRlbnQgKz0gYC0tLVxcblxcbmA7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyDsmpTslb0g7IS57IWYIOy2lOqwgFxyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGBcXG5cXG4tLS1cXG5cXG4jIyDwn5KhIOyalOyVvVxcblxcbiR7c3VtbWFyeVJlc3VsdC5zdW1tYXJ5fVxcbmA7XHJcbiAgICBcclxuICAgIC8vIO2CpOybjOuTnCDshLnshZgg7LaU6rCAXHJcbiAgICBpZiAoc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyAmJiBzdW1tYXJ5UmVzdWx0LmtleXdvcmRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGBcXG4jIyDwn5SRIO2CpOybjOuTnFxcblxcbiR7c3VtbWFyeVJlc3VsdC5rZXl3b3Jkcy5tYXAoayA9PiBgXFxgJHtrfVxcYGApLmpvaW4oJyAnKX1cXG5gO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBNQ1Ag7IKs7Jqp7J20IOqwgOuKpe2VnOyngCDtmZXsnbhcclxuICAgIGlmIChpc01jcEF2YWlsYWJsZSgnb2JzaWRpYW4tbWNwX2NyZWF0ZS1ub3RlJykpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBPYnNpZGlhbiBNQ1DroZwg7YyM7J28IOyggOyepVxyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgLSBNQ1Ag7YOA7J6FIOygleydmCDsl4bsnYxcclxuICAgICAgICAgICAgZ2xvYmFsLm1jcFsnb2JzaWRpYW4tbWNwX2NyZWF0ZS1ub3RlJ10oe1xyXG4gICAgICAgICAgICAgIHZhdWx0OiAnb2JzaWRpYW4tdmF1bHQnLCAvLyDsmLXsi5zrlJTslrggVmF1bHQg7J2066aEXHJcbiAgICAgICAgICAgICAgZm9sZGVyOiAnQ2hhdEdQVCcsICAgICAgICAvLyDsoIDsnqUg7Y+0642UIOqyveuhnFxyXG4gICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlTmFtZSxcclxuICAgICAgICAgICAgICBjb250ZW50OiBtYXJrZG93bkNvbnRlbnRcclxuICAgICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgT2JzaWRpYW4g7KCA7J6lIOyLpO2MqDogJHtyZXN1bHQuZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g7JuQ67O4IO2FjeyKpO2KuCDrgrTsmqkg7KCA7J6lXHJcbiAgICAgICAgY29uc3QgdGV4dEZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgnLm1kJywgJy1vcmlnaW5hbC50eHQnKTtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIC0gTUNQIO2DgOyehSDsoJXsnZgg7JeG7J2MXHJcbiAgICAgICAgICAgIGdsb2JhbC5tY3BbJ29ic2lkaWFuLW1jcF9jcmVhdGUtbm90ZSddKHtcclxuICAgICAgICAgICAgICB2YXVsdDogJ29ic2lkaWFuLXZhdWx0JywgLy8g7Ji17Iuc65SU7Ja4IFZhdWx0IOydtOumhFxyXG4gICAgICAgICAgICAgIGZvbGRlcjogJ0NoYXRHUFQnLCAgICAgICAgLy8g7KCA7J6lIO2PtOuNlCDqsr3roZxcclxuICAgICAgICAgICAgICBmaWxlbmFtZTogdGV4dEZpbGVOYW1lLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHJhd1RleHRcclxuICAgICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgT2JzaWRpYW4g7JuQ67O4IO2FjeyKpO2KuCDsoIDsnqUg7Iuk7YyoOiAke3Jlc3VsdC5lcnJvcn1gKSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBmaWxlTmFtZSwgbWV0aG9kOiAnbWNwJyB9O1xyXG4gICAgICB9IGNhdGNoIChtY3BFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ01DUCDsoIDsnqUg7Iuk7YyoLCDtjIzsnbwg7Iuc7Iqk7YWc7Jy866GcIOuMgOyytO2VqeuLiOuLpDonLCBtY3BFcnJvcik7XHJcbiAgICAgICAgLy8gTUNQIOyLpO2MqCDsi5wg7JWE656Y7J2YIO2MjOydvCDsi5zsiqTthZwg67Cp7Iud7Jy866GcIOynhO2WiVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIE1DUOqwgCDsl4bqsbDrgpgg7Iuk7Yyo7ZWcIOqyveyasCwg7YyM7J28IOyLnOyKpO2FnCDsgqzsmqntlZjsl6wg7KCA7J6lXHJcbiAgICBjb25zb2xlLmxvZygnTUNQ66W8IOyCrOyaqe2VoCDsiJgg7JeG7Iq164uI64ukLiDtjIzsnbwg7Iuc7Iqk7YWc7J2EIOyCrOyaqe2VmOyXrCDsoIDsnqXtlanri4jri6QuJyk7XHJcbiAgICBcclxuICAgIC8vIO2MjOydvCDsi5zsiqTthZzsl5Ag7KCA7J6lIChVUkwg7KSR67O1IOyXrOu2gCDsoITri6wpXHJcbiAgICBjb25zdCBmaWxlU3lzdGVtUmVzdWx0ID0gYXdhaXQgc2F2ZVRvRmlsZVN5c3RlbShcclxuICAgICAgZmlsZU5hbWUsXHJcbiAgICAgIG1hcmtkb3duQ29udGVudCxcclxuICAgICAgcmF3VGV4dCxcclxuICAgICAgY29udmVyc2F0aW9uLFxyXG4gICAgICBzdW1tYXJ5UmVzdWx0LFxyXG4gICAgICB1cmwsXHJcbiAgICAgIHNraXBEdXBsaWNhdGVDaGVjayAvLyDspJHrs7UgVVJM7J2066m0IEpTT04g7KCA7J6lIOqxtOuEiOubsOq4sFxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlTmFtZSwgXHJcbiAgICAgIG1ldGhvZDogJ2ZpbGVzeXN0ZW0nLFxyXG4gICAgICBmaWxlczogZmlsZVN5c3RlbVJlc3VsdC5maWxlcyxcclxuICAgICAgZHVwbGljYXRlOiBmaWxlU3lzdGVtUmVzdWx0LmR1cGxpY2F0ZVxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignT2JzaWRpYW4g7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgLy8g7Jik66WY6rCAIOuwnOyDne2VtOuPhCBSQUcg7Iuc7Iqk7YWcIOynhO2WieyXkOuKlCDsmIHtlqXsnYQg7KO87KeAIOyViuuPhOuhnSDshLHqs7Ug7IOB7YOcIOuwmO2ZmFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlTmFtZTogYCR7Y29udmVyc2F0aW9uLnRpdGxlLnN1YnN0cmluZygwLCAzMCl9Lm1kICjsoIDsnqUg7Iuk7YyoKWAsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfslYwg7IiYIOyXhuuKlCDsmKTrpZgnXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdpdEh1YiDsoIDsnqXshozsl5Ag67OA6rK97IKs7ZWt7J2EIOy7pOuwi+2VmOqzoCDtkbjsi5ztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWl0VG9HaXRIdWIobWVzc2FnZTogc3RyaW5nID0gJ1VwZGF0ZSBDaGF0R1BUIGNvbnZlcnNhdGlvbnMnKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIE1DUCDsgqzsmqnsnbQg6rCA64ql7ZWc7KeAIO2ZleyduFxyXG4gICAgaWYgKGlzTWNwQXZhaWxhYmxlKCdtY3BfZ2l0aHViX3B1c2hfZmlsZXMnKSkge1xyXG4gICAgICAvLyBHaXRIdWIg7KCA7J6l7IaM7J2YIOuzgOqyveyCrO2VrSDtmZXsnbhcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBAdHMtaWdub3JlIC0gTUNQIO2DgOyehSDsoJXsnZgg7JeG7J2MXHJcbiAgICAgICAgICBnbG9iYWwubWNwWydtY3BfZ2l0aHViX3B1c2hfZmlsZXMnXSh7XHJcbiAgICAgICAgICAgIHJlcG86ICdQS01Qcm9qZXQnLCAgICAgICAgLy8gR2l0SHViIOyggOyepeyGjCDsnbTrpoRcclxuICAgICAgICAgICAgYnJhbmNoOiAnbWFpbicsICAgICAgICAgICAvLyDruIzrnpzsuZgg7J2066aEXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsICAgICAgICAgICAgICAgICAgLy8g7Luk67CLIOuplOyLnOyngFxyXG4gICAgICAgICAgICBmaWxlczogWyAgICAgICAgICAgICAgICAgIC8vIO2RuOyLnO2VoCDtjIzsnbwg66qp66GdIChPYnNpZGlhbiBWYXVsdOydmCBDaGF0R1BUIO2PtOuNlCDrgrQg67OA6rK97IKs7ZWtKVxyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBhdGg6ICdDaGF0R1BUJywgICAgICAvLyDqsr3roZxcclxuICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZTogdHJ1ZSAgICAgICAvLyDtlZjsnIQg7YyM7J28IO2PrO2VqFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcclxuICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBHaXRIdWIg7Luk67CLIOyLpO2MqDogJHtyZXN1bHQuZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHJlc3VsdCwgbWV0aG9kOiAnbWNwJyB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gTUNQ66W8IOyCrOyaqe2VoCDsiJgg7JeG64qUIOqyveyasCDroZzqt7jrp4wg64Ko6riw6rOgIOyEseqzteycvOuhnCDsspjrpqxcclxuICAgICAgY29uc29sZS5sb2coJ0dpdEh1YiBNQ1Drpbwg7IKs7Jqp7ZWgIOyImCDsl4bsirXri4jri6QuIOy7pOuwiyDsnpHsl4XsnYAg6rG064SI65yB64uI64ukLicpO1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgICBtZXRob2Q6ICdza2lwcGVkJywgXHJcbiAgICAgICAgbWVzc2FnZTogJ0dpdEh1YiDsu6TrsIsg6riw64ql7J2AIE1DUCDtmZjqsr3sl5DshJzrp4wg7IKs7JqpIOqwgOuKpe2VqeuLiOuLpC4nIFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdHaXRIdWIg7Luk67CLIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgLy8g7Jik66WY6rCAIOuwnOyDne2VtOuPhCBSQUcg7Iuc7Iqk7YWcIOynhO2WieyXkOuKlCDsmIHtlqXsnYQg7KO87KeAIOyViuuPhOuhnSDshLHqs7Ug7IOB7YOcIOuwmO2ZmFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBtZXRob2Q6ICdmYWlsZWQnLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WYJ1xyXG4gICAgfTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsInByb21pc2lmeSIsImNoZWNrVXJsRXhpc3RzIiwid3JpdGVGaWxlQXN5bmMiLCJ3cml0ZUZpbGUiLCJta2RpckFzeW5jIiwibWtkaXIiLCJyZWFkRmlsZUFzeW5jIiwicmVhZEZpbGUiLCJleGlzdHNBc3luYyIsImV4aXN0cyIsIkRFRkFVTFRfVkFVTFRfUEFUSCIsIkNIQVRHUFRfRk9MREVSIiwiQ09OVkVSU0FUSU9OU19GT0xERVIiLCJpc01jcEF2YWlsYWJsZSIsIm1jcEZ1bmN0aW9uIiwiZ2xvYmFsIiwibWNwIiwiZW5zdXJlRGlyZWN0b3J5RXhpc3RzIiwiZGlyUGF0aCIsImV4aXN0c1N5bmMiLCJyZWN1cnNpdmUiLCJlcnJvciIsImNvbnNvbGUiLCJjaGVja0pzb25GaWxlRXhpc3RzIiwidXJsIiwicHJvamVjdENvbnZlcnNhdGlvblBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsInBhcnNlZFVybCIsIlVSTCIsIm5vcm1hbGl6ZWRVcmwiLCJvcmlnaW4iLCJwYXRobmFtZSIsInNoYXJlSWQiLCJzcGxpdCIsInBvcCIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaWx0ZXIiLCJmaWxlIiwiZW5kc1dpdGgiLCJmaWxlUGF0aCIsImNvbnRlbnQiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwibG9nIiwiZXhpc3RpbmdQYXJzZWRVcmwiLCJleGlzdGluZ1NoYXJlSWQiLCJleGlzdGluZ05vcm1hbGl6ZWRVcmwiLCJwYXJzZUVycm9yIiwic2F2ZVRvRmlsZVN5c3RlbSIsImZpbGVOYW1lIiwibWFya2Rvd25Db250ZW50IiwicmF3VGV4dCIsImNvbnZlcnNhdGlvbiIsInN1bW1hcnlSZXN1bHQiLCJza2lwSnNvblNhdmUiLCJvYnNpZGlhbkZvbGRlclBhdGgiLCJtYXJrZG93bkZpbGVQYXRoIiwidGV4dEZpbGVOYW1lIiwicmVwbGFjZSIsInRleHRGaWxlUGF0aCIsInN1Y2Nlc3MiLCJtYXJrZG93biIsInRleHQiLCJkdXBsaWNhdGUiLCJkYkV4aXN0cyIsImpzb25FeGlzdHMiLCJqc29uRmlsZU5hbWUiLCJ0aXRsZSIsInRvTG93ZXJDYXNlIiwiRGF0ZSIsIm5vdyIsImpzb25GaWxlUGF0aCIsIm1ldGFkYXRhV2l0aE1vZGVsIiwibWV0YWRhdGEiLCJtb2RlbCIsInNhdmVkQXQiLCJ0b0lTT1N0cmluZyIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJrZXl3b3JkcyIsIm1lc3NhZ2VzIiwiY3JlYXRlZEF0IiwianNvbiIsInNhdmVUb09ic2lkaWFuIiwic2tpcER1cGxpY2F0ZUNoZWNrIiwic2Vzc2lvbiIsInN1YnN0cmluZyIsIm1lc3NhZ2UiLCJ0YWdzIiwiQm9vbGVhbiIsImZyb250bWF0dGVyIiwibWFwIiwidGFnIiwidG9Mb2NhbGVTdHJpbmciLCJsZW5ndGgiLCJmb3JFYWNoIiwiaW5kZXgiLCJpc1VzZXIiLCJyb2xlIiwibWVzc2FnZUhlYWRlciIsImsiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInZhdWx0IiwiZm9sZGVyIiwiZmlsZW5hbWUiLCJyZXN1bHQiLCJFcnJvciIsIm1ldGhvZCIsIm1jcEVycm9yIiwiZmlsZVN5c3RlbVJlc3VsdCIsImNvbW1pdFRvR2l0SHViIiwicmVwbyIsImJyYW5jaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/automation.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/embeddings.ts":
/*!*********************************!*\
  !*** ./src/utils/embeddings.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chunkMessages: () => (/* binding */ chunkMessages),\n/* harmony export */   getEmbedding: () => (/* binding */ getEmbedding),\n/* harmony export */   truncateText: () => (/* binding */ truncateText)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gpt-tokenizer */ \"(rsc)/./node_modules/gpt-tokenizer/esm/main.js\");\n\n\n// OpenAI API 클라이언트 초기화\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n/**\r\n * 텍스트에서 유효하지 않은 문자를 제거합니다.\r\n * 특히 \\u0000(NULL) 문자와 기타 PostgreSQL에서 문제를 일으킬 수 있는 문자를 제거합니다.\r\n */ function sanitizeText(text) {\n    if (!text) return \"\";\n    // null 문자 및 제어 문자 제거\n    let sanitized = text.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \");\n    // PostgreSQL에서 문제가 될 수 있는 특수 이스케이프 시퀀스 처리\n    sanitized = sanitized.replace(/\\\\u0000/g, \"\");\n    // 연속된 공백 제거\n    sanitized = sanitized.replace(/\\s+/g, \" \");\n    return sanitized.trim();\n}\n/**\r\n * 텍스트에 대한 임베딩 벡터를 생성합니다.\r\n * @param text 임베딩할 텍스트\r\n * @returns 임베딩 벡터\r\n */ async function getEmbedding(text) {\n    try {\n        // 텍스트 정제\n        const sanitizedText = sanitizeText(text);\n        if (!sanitizedText) {\n            console.warn(\"임베딩 생성을 위한 텍스트가 비어있습니다.\");\n            // 빈 텍스트의 경우 기본 임베딩 값 반환 (모두 0)\n            return Array(1536).fill(0);\n        }\n        // 텍스트가 너무 짧은 경우 (1-2글자) 처리\n        if (sanitizedText.length < 3) {\n            console.warn(`임베딩 생성을 위한 텍스트가 너무 짧습니다: \"${sanitizedText}\"`);\n            // 짧은 텍스트 확장 (의미를 유지하면서 컨텍스트 추가)\n            const expandedText = `질문: ${sanitizedText} 에 대한 정보를 찾습니다.`;\n            console.log(`확장된 텍스트로 임베딩 생성: \"${expandedText}\"`);\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-3-small\",\n                input: expandedText\n            });\n            return response.data[0].embedding;\n        }\n        // 일반적인 경우 임베딩 생성\n        const response = await openai.embeddings.create({\n            model: \"text-embedding-3-small\",\n            input: sanitizedText\n        });\n        return response.data[0].embedding;\n    } catch (error) {\n        console.error(\"임베딩 생성 중 오류:\", error);\n        // 오류 발생 시 재시도 (다른 모델 사용)\n        try {\n            console.log(\"대체 임베딩 모델로 재시도합니다.\");\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-ada-002\",\n                input: sanitizeText(text) || \"빈 쿼리\"\n            });\n            return response.data[0].embedding;\n        } catch (retryError) {\n            console.error(\"대체 임베딩 생성 중 오류:\", retryError);\n            // 모든 시도 실패 시 기본 임베딩 반환\n            return Array(1536).fill(0);\n        }\n    }\n}\n/**\r\n * 토큰 제한에 맞게 텍스트를 자릅니다.\r\n * @param text 원본 텍스트\r\n * @param maxTokens 최대 토큰 수 (기본값 8000)\r\n * @returns 잘린 텍스트\r\n */ function truncateText(text, maxTokens = 8000) {\n    const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(text);\n    if (tokens.length <= maxTokens) {\n        return text;\n    }\n    // 수정된 부분\n    const truncatedTokens = tokens.slice(0, maxTokens);\n    return (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(truncatedTokens); // 잘못된 직접 구현 함수가 아니라 공식 함수 사용\n}\n/**\r\n * 대화 메시지를 청크로 분할합니다.\r\n * @param messages 메시지 배열\r\n * @param maxTokensPerChunk 청크당 최대 토큰 수 (기본값 500)\r\n * @returns 청크 배열\r\n */ function chunkMessages(messages, maxTokensPerChunk = 500) {\n    const chunks = [];\n    let currentChunk = \"\";\n    let currentTokens = 0;\n    let chunkIndex = 0;\n    for(let i = 0; i < messages.length; i++){\n        const message = messages[i];\n        const messageText = `[${message.role}]: ${message.content}`;\n        const messageTokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText).length;\n        // 단일 메시지가 청크 제한을 초과하는 경우 (분할 필요)\n        if (messageTokens > maxTokensPerChunk) {\n            // 현재 축적된 청크가 있다면 먼저 저장\n            if (currentTokens > 0) {\n                chunks.push({\n                    content: currentChunk.trim(),\n                    chunk_index: chunkIndex++\n                });\n                currentChunk = \"\";\n                currentTokens = 0;\n            }\n            // 긴 메시지를 여러 청크로 분할\n            const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText);\n            for(let j = 0; j < tokens.length; j += maxTokensPerChunk){\n                const chunkTokens = tokens.slice(j, j + maxTokensPerChunk);\n                chunks.push({\n                    content: (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(chunkTokens).trim(),\n                    chunk_index: chunkIndex++\n                });\n            }\n        } else if (currentTokens + messageTokens <= maxTokensPerChunk) {\n            currentChunk += (currentChunk ? \"\\n\\n\" : \"\") + messageText;\n            currentTokens += messageTokens;\n        } else {\n            chunks.push({\n                content: currentChunk.trim(),\n                chunk_index: chunkIndex++\n            });\n            currentChunk = messageText;\n            currentTokens = messageTokens;\n        }\n    }\n    // 마지막 청크 추가\n    if (currentTokens > 0) {\n        chunks.push({\n            content: currentChunk.trim(),\n            chunk_index: chunkIndex\n        });\n    }\n    return chunks;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxJQUFJLENBQUM7WUFDVkYsU0FBU1AsYUFBYTVCLElBQUk7WUFDMUJzQyxhQUFhUjtRQUNmO0lBQ0Y7SUFFQSxPQUFPSDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvdXRpbHMvZW1iZWRkaW5ncy50cz8zNmIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgZW5jb2RlLCBkZWNvZGUgfSBmcm9tICdncHQtdG9rZW5pemVyJztcclxuXHJcbi8vIE9wZW5BSSBBUEkg7YG065287J207Ja47Yq4IOy0iOq4sO2ZlFxyXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcclxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiDthY3siqTtirjsl5DshJwg7Jyg7Zqo7ZWY7KeAIOyViuydgCDrrLjsnpDrpbwg7KCc6rGw7ZWp64uI64ukLlxyXG4gKiDtirntnoggXFx1MDAwMChOVUxMKSDrrLjsnpDsmYAg6riw7YOAIFBvc3RncmVTUUzsl5DshJwg66y47KCc66W8IOydvOycvO2CrCDsiJgg7J6I64qUIOusuOyekOulvCDsoJzqsbDtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBpZiAoIXRleHQpIHJldHVybiAnJztcclxuICBcclxuICAvLyBudWxsIOusuOyekCDrsI8g7KCc7Ja0IOusuOyekCDsoJzqsbBcclxuICBsZXQgc2FuaXRpemVkID0gdGV4dC5yZXBsYWNlKC9bXFx1MDAwMC1cXHUwMDFGXFx1MDA3Ri1cXHUwMDlGXS9nLCAnICcpO1xyXG4gIFxyXG4gIC8vIFBvc3RncmVTUUzsl5DshJwg66y47KCc6rCAIOuQoCDsiJgg7J6I64qUIO2KueyImCDsnbTsiqTsvIDsnbTtlIQg7Iuc7YCA7IqkIOyymOumrFxyXG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC9cXFxcdTAwMDAvZywgJycpO1xyXG4gIFxyXG4gIC8vIOyXsOyGjeuQnCDqs7XrsLEg7KCc6rGwXHJcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL1xccysvZywgJyAnKTtcclxuICBcclxuICByZXR1cm4gc2FuaXRpemVkLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIO2FjeyKpO2KuOyXkCDrjIDtlZwg7J6E67Kg65SpIOuyoe2EsOulvCDsg53shLHtlanri4jri6QuXHJcbiAqIEBwYXJhbSB0ZXh0IOyehOuyoOuUqe2VoCDthY3siqTtirhcclxuICogQHJldHVybnMg7J6E67Kg65SpIOuyoe2EsFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVtYmVkZGluZyh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcltdPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIO2FjeyKpO2KuCDsoJXsoJxcclxuICAgIGNvbnN0IHNhbml0aXplZFRleHQgPSBzYW5pdGl6ZVRleHQodGV4dCk7XHJcbiAgICBcclxuICAgIGlmICghc2FuaXRpemVkVGV4dCkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+yehOuyoOuUqSDsg53shLHsnYQg7JyE7ZWcIO2FjeyKpO2KuOqwgCDruYTslrTsnojsirXri4jri6QuJyk7XHJcbiAgICAgIC8vIOu5iCDthY3siqTtirjsnZgg6rK97JqwIOq4sOuzuCDsnoTrsqDrlKkg6rCSIOuwmO2ZmCAo66qo65GQIDApXHJcbiAgICAgIHJldHVybiBBcnJheSgxNTM2KS5maWxsKDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDthY3siqTtirjqsIAg64SI66y0IOynp+ydgCDqsr3smrAgKDEtMuq4gOyekCkg7LKY66asXHJcbiAgICBpZiAoc2FuaXRpemVkVGV4dC5sZW5ndGggPCAzKSB7XHJcbiAgICAgIGNvbnNvbGUud2Fybihg7J6E67Kg65SpIOyDneyEseydhCDsnITtlZwg7YWN7Iqk7Yq46rCAIOuEiOustCDsp6fsirXri4jri6Q6IFwiJHtzYW5pdGl6ZWRUZXh0fVwiYCk7XHJcbiAgICAgIC8vIOynp+ydgCDthY3siqTtirgg7ZmV7J6lICjsnZjrr7jrpbwg7Jyg7KeA7ZWY66m07IScIOy7qO2FjeyKpO2KuCDstpTqsIApXHJcbiAgICAgIGNvbnN0IGV4cGFuZGVkVGV4dCA9IGDsp4jrrLg6ICR7c2FuaXRpemVkVGV4dH0g7JeQIOuMgO2VnCDsoJXrs7Trpbwg7LC+7Iq164uI64ukLmA7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDtmZXsnqXrkJwg7YWN7Iqk7Yq466GcIOyehOuyoOuUqSDsg53shLE6IFwiJHtleHBhbmRlZFRleHR9XCJgKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogJ3RleHQtZW1iZWRkaW5nLTMtc21hbGwnLFxyXG4gICAgICAgIGlucHV0OiBleHBhbmRlZFRleHQsXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFbMF0uZW1iZWRkaW5nO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDsnbzrsJjsoIHsnbgg6rK97JqwIOyehOuyoOuUqSDsg53shLFcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcclxuICAgICAgbW9kZWw6ICd0ZXh0LWVtYmVkZGluZy0zLXNtYWxsJyxcclxuICAgICAgaW5wdXQ6IHNhbml0aXplZFRleHQsXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFbMF0uZW1iZWRkaW5nO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfsnoTrsqDrlKkg7IOd7ISxIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyDsmKTrpZgg67Cc7IOdIOyLnCDsnqzsi5zrj4QgKOuLpOuluCDrqqjrjbgg7IKs7JqpKVxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ+uMgOyytCDsnoTrsqDrlKkg66qo642466GcIOyerOyLnOuPhO2VqeuLiOuLpC4nKTtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuZW1iZWRkaW5ncy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiAndGV4dC1lbWJlZGRpbmctYWRhLTAwMicsIC8vIOuMgOyytCDrqqjrjbhcclxuICAgICAgICBpbnB1dDogc2FuaXRpemVUZXh0KHRleHQpIHx8ICfruYgg7L+866asJyxcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVswXS5lbWJlZGRpbmc7XHJcbiAgICB9IGNhdGNoIChyZXRyeUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+uMgOyytCDsnoTrsqDrlKkg7IOd7ISxIOykkSDsmKTrpZg6JywgcmV0cnlFcnJvcik7XHJcbiAgICAgIC8vIOuqqOuToCDsi5zrj4Qg7Iuk7YyoIOyLnCDquLDrs7gg7J6E67Kg65SpIOuwmO2ZmFxyXG4gICAgICByZXR1cm4gQXJyYXkoMTUzNikuZmlsbCgwKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDthqDtgbAg7KCc7ZWc7JeQIOunnuqyjCDthY3siqTtirjrpbwg7J6Q66aF64uI64ukLlxyXG4gKiBAcGFyYW0gdGV4dCDsm5Drs7gg7YWN7Iqk7Yq4XHJcbiAqIEBwYXJhbSBtYXhUb2tlbnMg7LWc64yAIO2GoO2BsCDsiJggKOq4sOuzuOqwkiA4MDAwKVxyXG4gKiBAcmV0dXJucyDsnpjrprAg7YWN7Iqk7Yq4XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdHJ1bmNhdGVUZXh0KHRleHQ6IHN0cmluZywgbWF4VG9rZW5zOiBudW1iZXIgPSA4MDAwKTogc3RyaW5nIHtcclxuICBjb25zdCB0b2tlbnMgPSBlbmNvZGUodGV4dCk7XHJcbiAgXHJcbiAgaWYgKHRva2Vucy5sZW5ndGggPD0gbWF4VG9rZW5zKSB7XHJcbiAgICByZXR1cm4gdGV4dDtcclxuICB9XHJcbiAgXHJcbiAgLy8g7IiY7KCV65CcIOu2gOu2hFxyXG5jb25zdCB0cnVuY2F0ZWRUb2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbWF4VG9rZW5zKTtcclxucmV0dXJuIGRlY29kZSh0cnVuY2F0ZWRUb2tlbnMpOyAvLyDsnpjrqrvrkJwg7KeB7KCRIOq1rO2YhCDtlajsiJjqsIAg7JWE64uI6528IOqzteyLnSDtlajsiJgg7IKs7JqpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrjIDtmZQg66mU7Iuc7KeA66W8IOyyre2BrOuhnCDrtoTtlaDtlanri4jri6QuXHJcbiAqIEBwYXJhbSBtZXNzYWdlcyDrqZTsi5zsp4Ag67Cw7Je0XHJcbiAqIEBwYXJhbSBtYXhUb2tlbnNQZXJDaHVuayDssq3tgazri7kg7LWc64yAIO2GoO2BsCDsiJggKOq4sOuzuOqwkiA1MDApXHJcbiAqIEByZXR1cm5zIOyyre2BrCDrsLDsl7RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjaHVua01lc3NhZ2VzKFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdLCBcclxuICBtYXhUb2tlbnNQZXJDaHVuazogbnVtYmVyID0gNTAwXHJcbik6IHtjb250ZW50OiBzdHJpbmc7IGNodW5rX2luZGV4OiBudW1iZXJ9W10ge1xyXG4gIGNvbnN0IGNodW5rczoge2NvbnRlbnQ6IHN0cmluZzsgY2h1bmtfaW5kZXg6IG51bWJlcn1bXSA9IFtdO1xyXG4gIGxldCBjdXJyZW50Q2h1bmsgPSAnJztcclxuICBsZXQgY3VycmVudFRva2VucyA9IDA7XHJcbiAgbGV0IGNodW5rSW5kZXggPSAwO1xyXG4gIFxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1tpXTtcclxuICAgIGNvbnN0IG1lc3NhZ2VUZXh0ID0gYFske21lc3NhZ2Uucm9sZX1dOiAke21lc3NhZ2UuY29udGVudH1gO1xyXG4gICAgY29uc3QgbWVzc2FnZVRva2VucyA9IGVuY29kZShtZXNzYWdlVGV4dCkubGVuZ3RoO1xyXG4gICAgXHJcbiAgICAvLyDri6jsnbwg66mU7Iuc7KeA6rCAIOyyre2BrCDsoJztlZzsnYQg7LSI6rO87ZWY64qUIOqyveyasCAo67aE7ZWgIO2VhOyalClcclxuICAgIGlmIChtZXNzYWdlVG9rZW5zID4gbWF4VG9rZW5zUGVyQ2h1bmspIHtcclxuICAgICAgLy8g7ZiE7J6sIOy2leyggeuQnCDssq3tgazqsIAg7J6I64uk66m0IOuovOyggCDsoIDsnqVcclxuICAgICAgaWYgKGN1cnJlbnRUb2tlbnMgPiAwKSB7XHJcbiAgICAgICAgY2h1bmtzLnB1c2goe1xyXG4gICAgICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcclxuICAgICAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4KytcclxuICAgICAgICB9KTtcclxuICAgICAgICBjdXJyZW50Q2h1bmsgPSAnJztcclxuICAgICAgICBjdXJyZW50VG9rZW5zID0gMDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g6ri0IOuplOyLnOyngOulvCDsl6zrn6wg7LKt7YGs66GcIOu2hO2VoFxyXG4gICAgICBjb25zdCB0b2tlbnMgPSBlbmNvZGUobWVzc2FnZVRleHQpO1xyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRva2Vucy5sZW5ndGg7IGogKz0gbWF4VG9rZW5zUGVyQ2h1bmspIHtcclxuICAgICAgICBjb25zdCBjaHVua1Rva2VucyA9IHRva2Vucy5zbGljZShqLCBqICsgbWF4VG9rZW5zUGVyQ2h1bmspO1xyXG4gICAgICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgICAgIGNvbnRlbnQ6IGRlY29kZShjaHVua1Rva2VucykudHJpbSgpLCAvLyDqs7Xsi50gZGVjb2RlIOyCrOyaqVxyXG4gICAgICAgICAgY2h1bmtfaW5kZXg6IGNodW5rSW5kZXgrK1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgLy8g7ZiE7J6sIOyyre2BrOyXkCDrqZTsi5zsp4Drpbwg7LaU6rCA7ZWgIOyImCDsnojripTsp4Ag7ZmV7J24XHJcbiAgICBlbHNlIGlmIChjdXJyZW50VG9rZW5zICsgbWVzc2FnZVRva2VucyA8PSBtYXhUb2tlbnNQZXJDaHVuaykge1xyXG4gICAgICBjdXJyZW50Q2h1bmsgKz0gKGN1cnJlbnRDaHVuayA/ICdcXG5cXG4nIDogJycpICsgbWVzc2FnZVRleHQ7XHJcbiAgICAgIGN1cnJlbnRUb2tlbnMgKz0gbWVzc2FnZVRva2VucztcclxuICAgIH0gXHJcbiAgICAvLyDsg4gg7LKt7YGsIOyLnOyekVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgICBjb250ZW50OiBjdXJyZW50Q2h1bmsudHJpbSgpLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4KytcclxuICAgICAgfSk7XHJcbiAgICAgIGN1cnJlbnRDaHVuayA9IG1lc3NhZ2VUZXh0O1xyXG4gICAgICBjdXJyZW50VG9rZW5zID0gbWVzc2FnZVRva2VucztcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8g66eI7KeA66eJIOyyre2BrCDstpTqsIBcclxuICBpZiAoY3VycmVudFRva2VucyA+IDApIHtcclxuICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcclxuICAgICAgY2h1bmtfaW5kZXg6IGNodW5rSW5kZXhcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gY2h1bmtzO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJlbmNvZGUiLCJkZWNvZGUiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJzYW5pdGl6ZVRleHQiLCJ0ZXh0Iiwic2FuaXRpemVkIiwicmVwbGFjZSIsInRyaW0iLCJnZXRFbWJlZGRpbmciLCJzYW5pdGl6ZWRUZXh0IiwiY29uc29sZSIsIndhcm4iLCJBcnJheSIsImZpbGwiLCJsZW5ndGgiLCJleHBhbmRlZFRleHQiLCJsb2ciLCJyZXNwb25zZSIsImVtYmVkZGluZ3MiLCJjcmVhdGUiLCJtb2RlbCIsImlucHV0IiwiZGF0YSIsImVtYmVkZGluZyIsImVycm9yIiwicmV0cnlFcnJvciIsInRydW5jYXRlVGV4dCIsIm1heFRva2VucyIsInRva2VucyIsInRydW5jYXRlZFRva2VucyIsInNsaWNlIiwiY2h1bmtNZXNzYWdlcyIsIm1lc3NhZ2VzIiwibWF4VG9rZW5zUGVyQ2h1bmsiLCJjaHVua3MiLCJjdXJyZW50Q2h1bmsiLCJjdXJyZW50VG9rZW5zIiwiY2h1bmtJbmRleCIsImkiLCJtZXNzYWdlIiwibWVzc2FnZVRleHQiLCJyb2xlIiwiY29udGVudCIsIm1lc3NhZ2VUb2tlbnMiLCJwdXNoIiwiY2h1bmtfaW5kZXgiLCJqIiwiY2h1bmtUb2tlbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/embeddings.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/supabaseHandler.ts":
/*!**************************************!*\
  !*** ./src/utils/supabaseHandler.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkUrlExists: () => (/* binding */ checkUrlExists),\n/* harmony export */   getAllChatSessions: () => (/* binding */ getAllChatSessions),\n/* harmony export */   getChatSessionById: () => (/* binding */ getChatSessionById),\n/* harmony export */   getChunksBySessionId: () => (/* binding */ getChunksBySessionId),\n/* harmony export */   insertChatSession: () => (/* binding */ insertChatSession),\n/* harmony export */   processAndInsertChunks: () => (/* binding */ processAndInsertChunks),\n/* harmony export */   searchChatSessions: () => (/* binding */ searchChatSessions),\n/* harmony export */   searchSimilarChunks: () => (/* binding */ searchSimilarChunks),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _embeddings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./embeddings */ \"(rsc)/./src/utils/embeddings.ts\");\n\n\n// Supabase 클라이언트 재사용\nconst supabase = _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin;\n/**\r\n * JSON 데이터를 안전하게 처리합니다.\r\n * PostgreSQL에 저장하기 전 유효하지 않은 문자나 구조를 제거합니다.\r\n */ function sanitizeJsonData(data) {\n    if (!data) return null;\n    if (typeof data === \"string\") {\n        // 문자열에서 제어 문자 제거 및 유니코드 문자 처리 개선\n        return data.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \") // 제어 문자 제거\n        .replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, (match)=>match) // 올바른 유니코드 이모지 유지\n        .replace(/\\uFFFD/g, \"\") // 대체 문자 제거\n        .replace(/\\s+/g, \" \") // 연속된 공백 제거\n        .trim();\n    }\n    if (Array.isArray(data)) {\n        // 배열의 각 항목 정제\n        return data.map((item)=>sanitizeJsonData(item));\n    }\n    if (typeof data === \"object\" && data !== null) {\n        // 객체의 각 필드 정제\n        const sanitized = {};\n        for(const key in data){\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                sanitized[key] = sanitizeJsonData(data[key]);\n            }\n        }\n        return sanitized;\n    }\n    // 기본 자료형은 그대로 반환\n    return data;\n}\n/**\r\n * URL이 이미 저장되어 있는지 확인합니다.\r\n * @param url 확인할 URL\r\n * @returns 중복 여부와 기존 세션 정보\r\n */ async function checkUrlExists(url) {\n    try {\n        // URL 정규화 (쿼리 파라미터 등 제거)\n        const normalizedUrl = new URL(url).origin + new URL(url).pathname;\n        // 정규화된 URL로 시작하는 세션 검색\n        const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at\").ilike(\"url\", `${normalizedUrl}%`).limit(1);\n        if (error) {\n            console.error(\"URL 중복 확인 중 오류:\", error);\n            throw error;\n        }\n        if (data && data.length > 0) {\n            return {\n                exists: true,\n                session: data[0]\n            };\n        }\n        return {\n            exists: false\n        };\n    } catch (error) {\n        console.error(\"URL 중복 확인 중 오류:\", error);\n        // 오류 발생 시 안전하게 중복이 아닌 것으로 처리\n        return {\n            exists: false\n        };\n    }\n}\n/**\r\n * 대화 세션을 Supabase에 저장합니다.\r\n */ async function insertChatSession({ title, url, summary, messages, metadata = {}, skipDuplicateCheck = false }) {\n    try {\n        // URL 중복 확인 (skipDuplicateCheck가 false일 때만)\n        if (!skipDuplicateCheck && url) {\n            const { exists, session } = await checkUrlExists(url);\n            if (exists) {\n                console.log(`URL이 이미 존재합니다: ${url}`);\n                console.log(`기존 세션 정보: ${session?.title} (${session?.id})`);\n                return {\n                    id: session?.id,\n                    duplicate: true,\n                    message: \"이미 저장된 대화입니다.\"\n                };\n            }\n        }\n        // 데이터 정제\n        const sanitizedTitle = sanitizeJsonData(title);\n        const sanitizedSummary = sanitizeJsonData(summary);\n        const sanitizedMessages = sanitizeJsonData(messages);\n        const sanitizedMetadata = sanitizeJsonData(metadata);\n        // 요약 텍스트 임베딩 생성\n        const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedSummary);\n        // 세션 데이터 삽입\n        const { data, error } = await supabase.from(\"chat_sessions\").insert({\n            title: sanitizedTitle,\n            url,\n            summary: sanitizedSummary,\n            messages: sanitizedMessages,\n            metadata: sanitizedMetadata,\n            embedding\n        }).select(\"id\").single();\n        if (error) throw error;\n        return {\n            ...data,\n            duplicate: false\n        };\n    } catch (error) {\n        console.error(\"대화 세션 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 대화 청크를 생성하고 Supabase에 저장합니다.\r\n */ async function processAndInsertChunks(sessionId, messages) {\n    try {\n        // 메시지 정제\n        const sanitizedMessages = sanitizeJsonData(messages);\n        // 메시지를 청크로 분할\n        const chunks = (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.chunkMessages)(sanitizedMessages);\n        console.log(\"\\uD83E\\uDDF1 분할된 청크:\", chunks);\n        // 각 청크에 대해 임베딩 생성 및 저장\n        const chunkPromises = chunks.map(async (chunk)=>{\n            // 청크 내용 정제\n            const sanitizedContent = sanitizeJsonData(chunk.content);\n            const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedContent);\n            return {\n                chat_session_id: sessionId,\n                chunk_index: chunk.chunk_index,\n                content: sanitizedContent,\n                embedding\n            };\n        });\n        // 모든 청크 임베딩 처리 완료 대기\n        const chunksWithEmbeddings = await Promise.all(chunkPromises);\n        // 청크 데이터 삽입 (최대 1MB 제한으로 청크 10개씩 배치 처리)\n        const batchSize = 10;\n        const results = [];\n        for(let i = 0; i < chunksWithEmbeddings.length; i += batchSize){\n            const batch = chunksWithEmbeddings.slice(i, i + batchSize);\n            try {\n                const { data, error } = await supabase.from(\"chat_chunks\").insert(batch);\n                if (error) throw error;\n                results.push(data);\n            } catch (error) {\n                console.error(`청크 배치 ${i}/${chunksWithEmbeddings.length} 저장 중 오류:`, error);\n            // 개별 청크 에러를 기록하되 전체 프로세스는 계속 진행\n            }\n        }\n        return {\n            success: true,\n            count: chunksWithEmbeddings.length\n        };\n    } catch (error) {\n        console.error(\"청크 처리 및 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 유사한 청크를 검색합니다.\r\n */ async function searchSimilarChunks(query, similarity = 0.3, limit = 10) {\n    try {\n        // 메타 질문 감지 (예: \"이 대화의 핵심이 뭐야?\", \"요약해줘\" 등)\n        const metaQuestionPatterns = [\n            /이\\s*대화의?\\s*(핵심|요약|내용|주제)/i,\n            /대화를?\\s*(요약|정리)/i,\n            /요약해\\s*줘/i,\n            /핵심\\s*(내용|포인트)/i,\n            /주요\\s*(내용|포인트)/i\n        ];\n        const isMetaQuestion = metaQuestionPatterns.some((pattern)=>pattern.test(query));\n        if (isMetaQuestion) {\n            console.log(\"메타 질문 감지됨, 모든 세션의 요약 정보를 검색합니다.\");\n            // 메타 질문인 경우 가장 최근 세션의 요약 정보를 가져오기\n            const { data: sessionData, error: sessionError } = await supabase.from(\"chat_sessions\").select(\"id, title, summary\").order(\"created_at\", {\n                ascending: false\n            }).limit(1);\n            if (sessionError || !sessionData || sessionData.length === 0) {\n                console.warn(\"세션 데이터를 찾을 수 없습니다.\");\n                return [];\n            }\n            // 세션의 요약 정보를 청크로 변환하여 반환\n            const session = sessionData[0];\n            const fakeChunk = {\n                id: \"meta-question-chunk\",\n                chat_session_id: session.id,\n                chunk_index: 0,\n                content: `[요약]: ${session.summary}`,\n                similarity: 1.0\n            };\n            return [\n                fakeChunk\n            ];\n        }\n        console.log(`검색 쿼리: \"${query}\", 유사도 임계값: ${similarity}, 제한: ${limit}`);\n        // 쿼리 텍스트 정제\n        const sanitizedQuery = sanitizeJsonData(query);\n        console.log(`정제된 쿼리: \"${sanitizedQuery}\"`);\n        if (!sanitizedQuery || sanitizedQuery.trim().length < 2) {\n            console.warn(\"쿼리가 너무 짧거나 비어 있습니다\");\n            return [];\n        }\n        // 쿼리 텍스트 임베딩 생성\n        const queryEmbedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedQuery);\n        console.log(`임베딩 생성 완료: ${queryEmbedding.length} 차원`);\n        // 유사한 청크 검색\n        const { data, error } = await supabase.rpc(\"match_chunks\", {\n            query_embedding: queryEmbedding,\n            match_threshold: similarity,\n            match_count: limit\n        });\n        if (error) {\n            console.error(\"유사 청크 검색 오류:\", error);\n            throw error;\n        }\n        console.log(`검색된 청크 수: ${data?.length || 0}`);\n        // 검색 결과가 없는 경우 유사도 임계값을 낮춰서 다시 시도 (2단계로 낮춤)\n        if (!data || data.length === 0) {\n            // 첫 번째 재시도: 임계값을 50% 낮춤\n            const lowerThreshold = similarity * 0.5;\n            console.log(`결과가 없어 유사도 임계값을 ${lowerThreshold.toFixed(2)}로 낮춰 재시도`);\n            const { data: retryData, error: retryError } = await supabase.rpc(\"match_chunks\", {\n                query_embedding: queryEmbedding,\n                match_threshold: lowerThreshold,\n                match_count: limit\n            });\n            if (retryError) {\n                console.error(\"낮은 임계값으로 재시도 중 오류:\", retryError);\n            } else if (retryData && retryData.length > 0) {\n                console.log(`낮은 임계값으로 ${retryData.length}개 청크 검색됨`);\n                return retryData;\n            } else {\n                // 두 번째 재시도: 매우 낮은 임계값 (0.1)으로 시도\n                const lowestThreshold = 0.1;\n                console.log(`결과가 여전히 없어 최저 임계값 ${lowestThreshold.toFixed(2)}로 재시도`);\n                const { data: lastRetryData, error: lastRetryError } = await supabase.rpc(\"match_chunks\", {\n                    query_embedding: queryEmbedding,\n                    match_threshold: lowestThreshold,\n                    match_count: limit\n                });\n                if (lastRetryError) {\n                    console.error(\"최저 임계값으로 재시도 중 오류:\", lastRetryError);\n                } else if (lastRetryData && lastRetryData.length > 0) {\n                    console.log(`최저 임계값으로 ${lastRetryData.length}개 청크 검색됨`);\n                    return lastRetryData;\n                }\n            }\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"유사 청크 검색 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 세션 ID로 대화 세션을 조회합니다.\r\n */ async function getChatSessionById(id) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"*\").eq(\"id\", id).single();\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 모든 대화 세션을 조회합니다.\r\n * 요약 정보만 반환합니다 (전체 메시지는 제외).\r\n */ async function getAllChatSessions() {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 대화 세션의 모든 청크를 가져옵니다.\r\n */ async function getChunksBySessionId(sessionId) {\n    const { data, error } = await supabase.from(\"chat_chunks\").select(\"*\").eq(\"chat_session_id\", sessionId).order(\"chunk_index\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 키워드로 대화 세션을 검색합니다.\r\n */ async function searchChatSessions(keyword) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").or(`title.ilike.%${keyword}%,summary.ilike.%${keyword}%`).order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxFQUFFLEdBQUcsTUFBTXRCLFNBQzNCdUIsSUFBSSxDQUFDLGVBQ0xDLE1BQU0sQ0FBQyxLQUNQd0UsRUFBRSxDQUFDLG1CQUFtQi9DLFdBQ3RCNkIsS0FBSyxDQUFDLGVBQWU7UUFBRUMsV0FBVztJQUFLO0lBRTFDLElBQUl6RCxPQUFPLE1BQU1BO0lBRWpCLE9BQU9wQjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlaUcsbUJBQW1CQyxPQUFlO0lBQ3RELE1BQU0sRUFBRWxHLElBQUksRUFBRW9CLEtBQUssRUFBRSxHQUFHLE1BQU10QixTQUMzQnVCLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLGlEQUNQNkUsRUFBRSxDQUFDLENBQUMsYUFBYSxFQUFFRCxRQUFRLGlCQUFpQixFQUFFQSxRQUFRLENBQUMsQ0FBQyxFQUN4RHRCLEtBQUssQ0FBQyxjQUFjO1FBQUVDLFdBQVc7SUFBTTtJQUUxQyxJQUFJekQsT0FBTyxNQUFNQTtJQUVqQixPQUFPcEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL3V0aWxzL3N1cGFiYXNlSGFuZGxlci50cz85YmZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XHJcbmltcG9ydCB7IENoYXRNZXNzYWdlLCBDaGF0Q2h1bmssIENoYXRTZXNzaW9uIH0gZnJvbSAnQC90eXBlcyc7XHJcbmltcG9ydCB7IGdldEVtYmVkZGluZywgY2h1bmtNZXNzYWdlcyB9IGZyb20gJy4vZW1iZWRkaW5ncyc7XHJcblxyXG4vLyBTdXBhYmFzZSDtgbTrnbzsnbTslrjtirgg7J6s7IKs7JqpXHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IHN1cGFiYXNlQWRtaW47XHJcblxyXG4vKipcclxuICogSlNPTiDrjbDsnbTthLDrpbwg7JWI7KCE7ZWY6rKMIOyymOumrO2VqeuLiOuLpC5cclxuICogUG9zdGdyZVNRTOyXkCDsoIDsnqXtlZjquLAg7KCEIOycoO2aqO2VmOyngCDslYrsnYAg66y47J6Q64KYIOq1rOyhsOulvCDsoJzqsbDtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZUpzb25EYXRhKGRhdGE6IGFueSk6IGFueSB7XHJcbiAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcclxuICBcclxuICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAvLyDrrLjsnpDsl7Tsl5DshJwg7KCc7Ja0IOusuOyekCDsoJzqsbAg67CPIOycoOuLiOy9lOuTnCDrrLjsnpAg7LKY66asIOqwnOyEoFxyXG4gICAgcmV0dXJuIGRhdGFcclxuICAgICAgLnJlcGxhY2UoL1tcXHUwMDAwLVxcdTAwMUZcXHUwMDdGLVxcdTAwOUZdL2csICcgJykgIC8vIOygnOyWtCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9bXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdL2csIG1hdGNoID0+IG1hdGNoKSAvLyDsmKzrsJTrpbgg7Jyg64uI7L2U65OcIOydtOuqqOyngCDsnKDsp4BcclxuICAgICAgLnJlcGxhY2UoL1xcdUZGRkQvZywgJycpIC8vIOuMgOyytCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8g7Jew7IaN65CcIOqzteuwsSDsoJzqsbBcclxuICAgICAgLnRyaW0oKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcclxuICAgIC8vIOuwsOyXtOydmCDqsIEg7ZWt66qpIOygleygnFxyXG4gICAgcmV0dXJuIGRhdGEubWFwKGl0ZW0gPT4gc2FuaXRpemVKc29uRGF0YShpdGVtKSk7XHJcbiAgfVxyXG4gIFxyXG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkge1xyXG4gICAgLy8g6rCd7LK07J2YIOqwgSDtlYTrk5wg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWQ6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XHJcbiAgICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUpzb25EYXRhKGRhdGFba2V5XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzYW5pdGl6ZWQ7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIOq4sOuzuCDsnpDro4ztmJXsnYAg6re464yA66GcIOuwmO2ZmFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICogVVJM7J20IOydtOuvuCDsoIDsnqXrkJjslrQg7J6I64qU7KeAIO2ZleyduO2VqeuLiOuLpC5cclxuICogQHBhcmFtIHVybCDtmZXsnbjtlaAgVVJMXHJcbiAqIEByZXR1cm5zIOykkeuztSDsl6zrtoDsmYAg6riw7KG0IOyEuOyFmCDsoJXrs7RcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1VybEV4aXN0cyh1cmw6IHN0cmluZyk6IFByb21pc2U8eyBleGlzdHM6IGJvb2xlYW47IHNlc3Npb24/OiBQYXJ0aWFsPENoYXRTZXNzaW9uPiB9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFVSTCDsoJXqt5ztmZQgKOy/vOumrCDtjIzrnbzrr7jthLAg65OxIOygnOqxsClcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBuZXcgVVJMKHVybCkub3JpZ2luICsgbmV3IFVSTCh1cmwpLnBhdGhuYW1lO1xyXG4gICAgXHJcbiAgICAvLyDsoJXqt5ztmZTrkJwgVVJM66GcIOyLnOyeke2VmOuKlCDshLjshZgg6rKA7IOJXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0JylcclxuICAgICAgLmlsaWtlKCd1cmwnLCBgJHtub3JtYWxpemVkVXJsfSVgKVxyXG4gICAgICAubGltaXQoMSk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4geyBleGlzdHM6IHRydWUsIHNlc3Npb246IGRhdGFbMF0gfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgZXhpc3RzOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOyViOyghO2VmOqyjCDspJHrs7XsnbQg7JWE64uMIOqyg+ycvOuhnCDsspjrpqxcclxuICAgIHJldHVybiB7IGV4aXN0czogZmFsc2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrjIDtmZQg7IS47IWY7J2EIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRDaGF0U2Vzc2lvbih7XHJcbiAgdGl0bGUsXHJcbiAgdXJsLFxyXG4gIHN1bW1hcnksXHJcbiAgbWVzc2FnZXMsXHJcbiAgbWV0YWRhdGEgPSB7fSxcclxuICBza2lwRHVwbGljYXRlQ2hlY2sgPSBmYWxzZVxyXG59OiB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIHNraXBEdXBsaWNhdGVDaGVjaz86IGJvb2xlYW47XHJcbn0pIHtcclxuICB0cnkge1xyXG4gICAgLy8gVVJMIOykkeuztSDtmZXsnbggKHNraXBEdXBsaWNhdGVDaGVja+qwgCBmYWxzZeydvCDrlYzrp4wpXHJcbiAgICBpZiAoIXNraXBEdXBsaWNhdGVDaGVjayAmJiB1cmwpIHtcclxuICAgICAgY29uc3QgeyBleGlzdHMsIHNlc3Npb24gfSA9IGF3YWl0IGNoZWNrVXJsRXhpc3RzKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFVSTOydtCDsnbTrr7gg7KG07J6s7ZWp64uI64ukOiAke3VybH1gKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhg6riw7KG0IOyEuOyFmCDsoJXrs7Q6ICR7c2Vzc2lvbj8udGl0bGV9ICgke3Nlc3Npb24/LmlkfSlgKTtcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgIGlkOiBzZXNzaW9uPy5pZCwgXHJcbiAgICAgICAgICBkdXBsaWNhdGU6IHRydWUsIFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLicgXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDrjbDsnbTthLAg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRUaXRsZSA9IHNhbml0aXplSnNvbkRhdGEodGl0bGUpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkU3VtbWFyeSA9IHNhbml0aXplSnNvbkRhdGEoc3VtbWFyeSk7XHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkTWV0YWRhdGEgPSBzYW5pdGl6ZUpzb25EYXRhKG1ldGFkYXRhKTtcclxuICAgIFxyXG4gICAgLy8g7JqU7JW9IO2FjeyKpO2KuCDsnoTrsqDrlKkg7IOd7ISxXHJcbiAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkU3VtbWFyeSk7XHJcbiAgICBcclxuICAgIC8vIOyEuOyFmCDrjbDsnbTthLAg7IK97J6FXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgIHRpdGxlOiBzYW5pdGl6ZWRUaXRsZSxcclxuICAgICAgICB1cmwsXHJcbiAgICAgICAgc3VtbWFyeTogc2FuaXRpemVkU3VtbWFyeSxcclxuICAgICAgICBtZXNzYWdlczogc2FuaXRpemVkTWVzc2FnZXMsXHJcbiAgICAgICAgbWV0YWRhdGE6IHNhbml0aXplZE1ldGFkYXRhLFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9KVxyXG4gICAgICAuc2VsZWN0KCdpZCcpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgLi4uZGF0YSwgZHVwbGljYXRlOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfrjIDtmZQg7IS47IWYIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlCDssq3tgazrpbwg7IOd7ISx7ZWY6rOgIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzQW5kSW5zZXJ0Q2h1bmtzKFxyXG4gIHNlc3Npb25JZDogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTsi5zsp4Ag7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgXHJcbiAgICAvLyDrqZTsi5zsp4Drpbwg7LKt7YGs66GcIOu2hO2VoFxyXG4gICAgY29uc3QgY2h1bmtzID0gY2h1bmtNZXNzYWdlcyhzYW5pdGl6ZWRNZXNzYWdlcyk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+nsSDrtoTtlaDrkJwg7LKt7YGsOicsIGNodW5rcyk7XHJcbiAgICBcclxuICAgIC8vIOqwgSDssq3tgazsl5Ag64yA7ZW0IOyehOuyoOuUqSDsg53shLEg67CPIOyggOyepVxyXG4gICAgY29uc3QgY2h1bmtQcm9taXNlcyA9IGNodW5rcy5tYXAoYXN5bmMgKGNodW5rKSA9PiB7XHJcbiAgICAgIC8vIOyyre2BrCDrgrTsmqkg7KCV7KCcXHJcbiAgICAgIGNvbnN0IHNhbml0aXplZENvbnRlbnQgPSBzYW5pdGl6ZUpzb25EYXRhKGNodW5rLmNvbnRlbnQpO1xyXG4gICAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkQ29udGVudCk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGNoYXRfc2Vzc2lvbl9pZDogc2Vzc2lvbklkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiBjaHVuay5jaHVua19pbmRleCxcclxuICAgICAgICBjb250ZW50OiBzYW5pdGl6ZWRDb250ZW50LFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIOuqqOuToCDssq3tgawg7J6E67Kg65SpIOyymOumrCDsmYTro4wg64yA6riwXHJcbiAgICBjb25zdCBjaHVua3NXaXRoRW1iZWRkaW5ncyA9IGF3YWl0IFByb21pc2UuYWxsKGNodW5rUHJvbWlzZXMpO1xyXG4gICAgXHJcbiAgICAvLyDssq3tgawg642w7J207YSwIOyCveyehSAo7LWc64yAIDFNQiDsoJztlZzsnLzroZwg7LKt7YGsIDEw6rCc7JSpIOuwsOy5mCDsspjrpqwpXHJcbiAgICBjb25zdCBiYXRjaFNpemUgPSAxMDtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XHJcbiAgICAgIGNvbnN0IGJhdGNoID0gY2h1bmtzV2l0aEVtYmVkZGluZ3Muc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2hhdF9jaHVua3MnKVxyXG4gICAgICAgICAgLmluc2VydChiYXRjaCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICByZXN1bHRzLnB1c2goZGF0YSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg7LKt7YGsIOuwsOy5mCAke2l9LyR7Y2h1bmtzV2l0aEVtYmVkZGluZ3MubGVuZ3RofSDsoIDsnqUg7KSRIOyYpOulmDpgLCBlcnJvcik7XHJcbiAgICAgICAgLy8g6rCc67OEIOyyre2BrCDsl5Drn6zrpbwg6riw66Gd7ZWY65CYIOyghOyytCDtlITroZzshLjsiqTripQg6rOE7IaNIOynhO2WiVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGNvdW50OiBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGggfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7LKt7YGsIOyymOumrCDrsI8g7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog7Jyg7IKs7ZWcIOyyre2BrOulvCDqsoDsg4ntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoU2ltaWxhckNodW5rcyhcclxuICBxdWVyeTogc3RyaW5nLFxyXG4gIHNpbWlsYXJpdHk6IG51bWJlciA9IDAuMywgIC8vIOq4sOuzuOqwkiAwLjXsl5DshJwgMC4z7Jy866GcIOuNlCDrgq7stqRcclxuICBsaW1pdDogbnVtYmVyID0gMTBcclxuKTogUHJvbWlzZTxDaGF0Q2h1bmtbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTtg4Ag7KeI66y4IOqwkOyngCAo7JiIOiBcIuydtCDrjIDtmZTsnZgg7ZW17Ius7J20IOutkOyVvD9cIiwgXCLsmpTslb3tlbTspJhcIiDrk7EpXHJcbiAgICBjb25zdCBtZXRhUXVlc3Rpb25QYXR0ZXJucyA9IFtcclxuICAgICAgL+ydtFxccyrrjIDtmZTsnZg/XFxzKijtlbXsi6x87JqU7JW9fOuCtOyaqXzso7zsoJwpL2ksXHJcbiAgICAgIC/rjIDtmZTrpbw/XFxzKijsmpTslb187KCV66asKS9pLFxyXG4gICAgICAv7JqU7JW97ZW0XFxzKuykmC9pLFxyXG4gICAgICAv7ZW17IusXFxzKijrgrTsmql87Y+s7J247Yq4KS9pLFxyXG4gICAgICAv7KO87JqUXFxzKijrgrTsmql87Y+s7J247Yq4KS9pXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBjb25zdCBpc01ldGFRdWVzdGlvbiA9IG1ldGFRdWVzdGlvblBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QocXVlcnkpKTtcclxuICAgIFxyXG4gICAgaWYgKGlzTWV0YVF1ZXN0aW9uKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfrqZTtg4Ag7KeI66y4IOqwkOyngOuQqCwg66qo65OgIOyEuOyFmOydmCDsmpTslb0g7KCV67O066W8IOqygOyDie2VqeuLiOuLpC4nKTtcclxuICAgICAgLy8g66mU7YOAIOyniOusuOyduCDqsr3smrAg6rCA7J6lIOy1nOq3vCDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDqsIDsoLjsmKTquLBcclxuICAgICAgY29uc3QgeyBkYXRhOiBzZXNzaW9uRGF0YSwgZXJyb3I6IHNlc3Npb25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQsIHRpdGxlLCBzdW1tYXJ5JylcclxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgICAubGltaXQoMSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uRGF0YSB8fCBzZXNzaW9uRGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ+yEuOyFmCDrjbDsnbTthLDrpbwg7LC+7J2EIOyImCDsl4bsirXri4jri6QuJyk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDssq3tgazroZwg67OA7ZmY7ZWY7JesIOuwmO2ZmFxyXG4gICAgICBjb25zdCBzZXNzaW9uID0gc2Vzc2lvbkRhdGFbMF07XHJcbiAgICAgIGNvbnN0IGZha2VDaHVuazogQ2hhdENodW5rID0ge1xyXG4gICAgICAgIGlkOiAnbWV0YS1xdWVzdGlvbi1jaHVuaycsXHJcbiAgICAgICAgY2hhdF9zZXNzaW9uX2lkOiBzZXNzaW9uLmlkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiAwLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBb7JqU7JW9XTogJHtzZXNzaW9uLnN1bW1hcnl9YCxcclxuICAgICAgICBzaW1pbGFyaXR5OiAxLjBcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBbZmFrZUNodW5rXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOqygOyDiSDsv7zrpqw6IFwiJHtxdWVyeX1cIiwg7Jyg7IKs64+EIOyehOqzhOqwkjogJHtzaW1pbGFyaXR5fSwg7KCc7ZWcOiAke2xpbWl0fWApO1xyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOygleygnFxyXG4gICAgY29uc3Qgc2FuaXRpemVkUXVlcnkgPSBzYW5pdGl6ZUpzb25EYXRhKHF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsoJXsoJzrkJwg7L+866asOiBcIiR7c2FuaXRpemVkUXVlcnl9XCJgKTtcclxuICAgIFxyXG4gICAgaWYgKCFzYW5pdGl6ZWRRdWVyeSB8fCBzYW5pdGl6ZWRRdWVyeS50cmltKCkubGVuZ3RoIDwgMikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+y/vOumrOqwgCDrhIjrrLQg7Ken6rGw64KYIOu5hOyWtCDsnojsirXri4jri6QnKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOyehOuyoOuUqSDsg53shLFcclxuICAgIGNvbnN0IHF1ZXJ5RW1iZWRkaW5nID0gYXdhaXQgZ2V0RW1iZWRkaW5nKHNhbml0aXplZFF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsnoTrsqDrlKkg7IOd7ISxIOyZhOujjDogJHtxdWVyeUVtYmVkZGluZy5sZW5ndGh9IOywqOybkGApO1xyXG4gICAgXHJcbiAgICAvLyDsnKDsgqztlZwg7LKt7YGsIOqygOyDiVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFxyXG4gICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAge1xyXG4gICAgICAgIHF1ZXJ5X2VtYmVkZGluZzogcXVlcnlFbWJlZGRpbmcsXHJcbiAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBzaW1pbGFyaXR5LFxyXG4gICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGDqsoDsg4nrkJwg7LKt7YGsIOyImDogJHtkYXRhPy5sZW5ndGggfHwgMH1gKTtcclxuICAgIFxyXG4gICAgLy8g6rKA7IOJIOqysOqzvOqwgCDsl4bripQg6rK97JqwIOycoOyCrOuPhCDsnoTqs4TqsJLsnYQg64Ku7Law7IScIOuLpOyLnCDsi5zrj4QgKDLri6jqs4TroZwg64Ku7LakKVxyXG4gICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIC8vIOyyqyDrsojsp7gg7J6s7Iuc64+EOiDsnoTqs4TqsJLsnYQgNTAlIOuCruy2pFxyXG4gICAgICBjb25zdCBsb3dlclRocmVzaG9sZCA9IHNpbWlsYXJpdHkgKiAwLjU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDqsrDqs7zqsIAg7JeG7Ja0IOycoOyCrOuPhCDsnoTqs4TqsJLsnYQgJHtsb3dlclRocmVzaG9sZC50b0ZpeGVkKDIpfeuhnCDrgq7strAg7J6s7Iuc64+EYCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB7IGRhdGE6IHJldHJ5RGF0YSwgZXJyb3I6IHJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBsb3dlclRocmVzaG9sZCxcclxuICAgICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign64Ku7J2AIOyehOqzhOqwkuycvOuhnCDsnqzsi5zrj4Qg7KSRIOyYpOulmDonLCByZXRyeUVycm9yKTtcclxuICAgICAgfSBlbHNlIGlmIChyZXRyeURhdGEgJiYgcmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg64Ku7J2AIOyehOqzhOqwkuycvOuhnCAke3JldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICByZXR1cm4gcmV0cnlEYXRhO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOuRkCDrsojsp7gg7J6s7Iuc64+EOiDrp6TsmrAg64Ku7J2AIOyehOqzhOqwkiAoMC4xKeycvOuhnCDsi5zrj4RcclxuICAgICAgICBjb25zdCBsb3dlc3RUaHJlc2hvbGQgPSAwLjE7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOqysOqzvOqwgCDsl6zsoITtnogg7JeG7Ja0IOy1nOyggCDsnoTqs4TqsJIgJHtsb3dlc3RUaHJlc2hvbGQudG9GaXhlZCgyKX3roZwg7J6s7Iuc64+EYCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBsYXN0UmV0cnlEYXRhLCBlcnJvcjogbGFzdFJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAgICdtYXRjaF9jaHVua3MnLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgICBtYXRjaF90aHJlc2hvbGQ6IGxvd2VzdFRocmVzaG9sZCxcclxuICAgICAgICAgICAgbWF0Y2hfY291bnQ6IGxpbWl0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGFzdFJldHJ5RXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyggCDsnoTqs4TqsJLsnLzroZwg7J6s7Iuc64+EIOykkSDsmKTrpZg6JywgbGFzdFJldHJ5RXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGFzdFJldHJ5RGF0YSAmJiBsYXN0UmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDstZzsoIAg7J6E6rOE6rCS7Jy866GcICR7bGFzdFJldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICAgIHJldHVybiBsYXN0UmV0cnlEYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDshLjshZggSUTroZwg64yA7ZmUIOyEuOyFmOydhCDsobDtmoztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdFNlc3Npb25CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPENoYXRTZXNzaW9uPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgLnNpbmdsZSgpO1xyXG4gICAgXHJcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICBcclxuICByZXR1cm4gZGF0YTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOuqqOuToCDrjIDtmZQg7IS47IWY7J2EIOyhsO2ajO2VqeuLiOuLpC5cclxuICog7JqU7JW9IOygleuztOunjCDrsJjtmZjtlanri4jri6QgKOyghOyytCDrqZTsi5zsp4DripQg7KCc7Jm4KS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxDaGF0U2Vzc2lvbnMoKTogUHJvbWlzZTxQYXJ0aWFsPENoYXRTZXNzaW9uPltdPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0LCBtZXRhZGF0YScpXHJcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOyEuOyFmOydmCDrqqjrk6Ag7LKt7YGs66W8IOqwgOyguOyYteuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaHVua3NCeVNlc3Npb25JZChzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Q2hhdENodW5rW10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfY2h1bmtzJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdjaGF0X3Nlc3Npb25faWQnLCBzZXNzaW9uSWQpXHJcbiAgICAub3JkZXIoJ2NodW5rX2luZGV4JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog7YKk7JuM65Oc66GcIOuMgO2ZlCDshLjshZjsnYQg6rKA7IOJ7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaENoYXRTZXNzaW9ucyhrZXl3b3JkOiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8Q2hhdFNlc3Npb24+W10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfc2Vzc2lvbnMnKVxyXG4gICAgLnNlbGVjdCgnaWQsIHRpdGxlLCB1cmwsIHN1bW1hcnksIGNyZWF0ZWRfYXQsIG1ldGFkYXRhJylcclxuICAgIC5vcihgdGl0bGUuaWxpa2UuJSR7a2V5d29yZH0lLHN1bW1hcnkuaWxpa2UuJSR7a2V5d29yZH0lYClcclxuICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuICAgIFxyXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGE7XHJcbn0gIl0sIm5hbWVzIjpbInN1cGFiYXNlQWRtaW4iLCJnZXRFbWJlZGRpbmciLCJjaHVua01lc3NhZ2VzIiwic3VwYWJhc2UiLCJzYW5pdGl6ZUpzb25EYXRhIiwiZGF0YSIsInJlcGxhY2UiLCJtYXRjaCIsInRyaW0iLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJpdGVtIiwic2FuaXRpemVkIiwia2V5IiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY2hlY2tVcmxFeGlzdHMiLCJ1cmwiLCJub3JtYWxpemVkVXJsIiwiVVJMIiwib3JpZ2luIiwicGF0aG5hbWUiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJpbGlrZSIsImxpbWl0IiwiY29uc29sZSIsImxlbmd0aCIsImV4aXN0cyIsInNlc3Npb24iLCJpbnNlcnRDaGF0U2Vzc2lvbiIsInRpdGxlIiwic3VtbWFyeSIsIm1lc3NhZ2VzIiwibWV0YWRhdGEiLCJza2lwRHVwbGljYXRlQ2hlY2siLCJsb2ciLCJpZCIsImR1cGxpY2F0ZSIsIm1lc3NhZ2UiLCJzYW5pdGl6ZWRUaXRsZSIsInNhbml0aXplZFN1bW1hcnkiLCJzYW5pdGl6ZWRNZXNzYWdlcyIsInNhbml0aXplZE1ldGFkYXRhIiwiZW1iZWRkaW5nIiwiaW5zZXJ0Iiwic2luZ2xlIiwicHJvY2Vzc0FuZEluc2VydENodW5rcyIsInNlc3Npb25JZCIsImNodW5rcyIsImNodW5rUHJvbWlzZXMiLCJjaHVuayIsInNhbml0aXplZENvbnRlbnQiLCJjb250ZW50IiwiY2hhdF9zZXNzaW9uX2lkIiwiY2h1bmtfaW5kZXgiLCJjaHVua3NXaXRoRW1iZWRkaW5ncyIsIlByb21pc2UiLCJhbGwiLCJiYXRjaFNpemUiLCJyZXN1bHRzIiwiaSIsImJhdGNoIiwic2xpY2UiLCJwdXNoIiwic3VjY2VzcyIsImNvdW50Iiwic2VhcmNoU2ltaWxhckNodW5rcyIsInF1ZXJ5Iiwic2ltaWxhcml0eSIsIm1ldGFRdWVzdGlvblBhdHRlcm5zIiwiaXNNZXRhUXVlc3Rpb24iLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJzZXNzaW9uRGF0YSIsInNlc3Npb25FcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwid2FybiIsImZha2VDaHVuayIsInNhbml0aXplZFF1ZXJ5IiwicXVlcnlFbWJlZGRpbmciLCJycGMiLCJxdWVyeV9lbWJlZGRpbmciLCJtYXRjaF90aHJlc2hvbGQiLCJtYXRjaF9jb3VudCIsImxvd2VyVGhyZXNob2xkIiwidG9GaXhlZCIsInJldHJ5RGF0YSIsInJldHJ5RXJyb3IiLCJsb3dlc3RUaHJlc2hvbGQiLCJsYXN0UmV0cnlEYXRhIiwibGFzdFJldHJ5RXJyb3IiLCJnZXRDaGF0U2Vzc2lvbkJ5SWQiLCJlcSIsImdldEFsbENoYXRTZXNzaW9ucyIsImdldENodW5rc0J5U2Vzc2lvbklkIiwic2VhcmNoQ2hhdFNlc3Npb25zIiwia2V5d29yZCIsIm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/supabaseHandler.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/gpt-tokenizer","vendor-chunks/@supabase","vendor-chunks/openai","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/webidl-conversions","vendor-chunks/abort-controller","vendor-chunks/ms","vendor-chunks/humanize-ms","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frag%2Fconversations%2Froute&page=%2Fapi%2Frag%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frag%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();