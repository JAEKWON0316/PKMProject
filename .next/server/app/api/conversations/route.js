"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/conversations/route";
exports.ids = ["app/api/conversations/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "@sparticuz/chromium":
/*!**************************************!*\
  !*** external "@sparticuz/chromium" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@sparticuz/chromium");

/***/ }),

/***/ "puppeteer-core":
/*!*********************************!*\
  !*** external "puppeteer-core" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("puppeteer-core");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_pmkProject_src_app_api_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/conversations/route.ts */ \"(rsc)/./src/app/api/conversations/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/conversations/route\",\n        pathname: \"/api/conversations\",\n        filename: \"route\",\n        bundlePath: \"app/api/conversations/route\"\n    },\n    resolvedPagePath: \"C:\\\\pmkProject\\\\src\\\\app\\\\api\\\\conversations\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_pmkProject_src_app_api_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/conversations/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb252ZXJzYXRpb25zJTJGcm91dGUmcGFnZT0lMkZhcGklMkZjb252ZXJzYXRpb25zJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY29udmVyc2F0aW9ucyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDcG1rUHJvamVjdCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3Bta1Byb2plY3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ007QUFDbkY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8/OTMyOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxwbWtQcm9qZWN0XFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNvbnZlcnNhdGlvbnNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY29udmVyc2F0aW9uc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY29udmVyc2F0aW9ucy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXHBta1Byb2plY3RcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY29udmVyc2F0aW9uc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/conversations/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/conversations/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils/chatgpt */ \"(rsc)/./src/lib/utils/chatgpt.ts\");\n/* harmony import */ var _lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/utils/openai */ \"(rsc)/./src/lib/utils/openai.ts\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\n/* harmony import */ var _utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/utils/supabaseHandler */ \"(rsc)/./src/utils/supabaseHandler.ts\");\n\n\n\n\n\n\n\nasync function POST(request) {\n    try {\n        console.log(\"=== Processing conversation request ===\");\n        const body = await request.json().catch((e)=>{\n            console.error(\"Failed to parse request body:\", e);\n            return null;\n        });\n        if (!body || !body.url) {\n            console.error(\"Missing URL in request body\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ChatGPT Í≥µÏú† URLÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.\"\n            }, {\n                status: 400\n            });\n        }\n        const { url } = body;\n        console.log(`Processing URL: \"${url}\"`);\n        // URL Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨\n        if (!isValidChatGPTUrl(url)) {\n            console.error(\"Invalid URL format or domain\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Ïú†Ìö®Ìïú ChatGPT Í≥µÏú† URLÏù¥ ÏïÑÎãôÎãàÎã§.\"\n            }, {\n                status: 400\n            });\n        }\n        // URL Ï§ëÎ≥µ Ï≤¥ÌÅ¨ (Supabase)\n        console.log(\"Checking for URL duplicates...\");\n        const { exists: urlExists, session: existingSession } = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_5__.checkUrlExists)(url);\n        if (urlExists) {\n            console.log(`Duplicate URL detected: ${url}`);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                duplicate: true,\n                message: \"Ïù¥ÎØ∏ Ï†ÄÏû•Îêú ÎåÄÌôîÏûÖÎãàÎã§.\",\n                data: {\n                    id: existingSession?.id,\n                    title: existingSession?.title,\n                    url,\n                    createdAt: existingSession?.created_at\n                }\n            });\n        }\n        // Î°úÏª¨ conversations Ìè¥ÎçîÏóêÏÑúÎèÑ URL Ï§ëÎ≥µ Ï≤¥ÌÅ¨\n        const conversationsDir = path__WEBPACK_IMPORTED_MODULE_4__.join(process.cwd(), \"conversations\");\n        try {\n            // Ìè¥ÎçîÍ∞Ä Ï°¥Ïû¨ÌïòÎäîÏßÄ ÌôïÏù∏\n            await fs_promises__WEBPACK_IMPORTED_MODULE_3__.access(conversationsDir);\n            // Î™®Îì† JSON ÌååÏùº ÏùΩÍ∏∞\n            const files = await fs_promises__WEBPACK_IMPORTED_MODULE_3__.readdir(conversationsDir);\n            const jsonFiles = files.filter((file)=>file.endsWith(\".json\"));\n            // Í∞Å ÌååÏùºÏóêÏÑú URL ÌôïÏù∏\n            for (const file of jsonFiles){\n                try {\n                    const filePath = path__WEBPACK_IMPORTED_MODULE_4__.join(conversationsDir, file);\n                    const content = await fs_promises__WEBPACK_IMPORTED_MODULE_3__.readFile(filePath, \"utf-8\");\n                    const data = JSON.parse(content);\n                    if (data.url === url) {\n                        console.log(`Duplicate URL found in local file: ${file}`);\n                        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                            success: true,\n                            duplicate: true,\n                            message: \"Ïù¥ÎØ∏ Ï†ÄÏû•Îêú ÎåÄÌôîÏûÖÎãàÎã§.\",\n                            data: {\n                                id: data.id,\n                                title: data.title,\n                                url,\n                                createdAt: data.createdAt\n                            }\n                        });\n                    }\n                } catch (e) {\n                    // ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•òÎäî Î¨¥ÏãúÌïòÍ≥† Í≥ÑÏÜç ÏßÑÌñâ\n                    console.error(`Error checking file ${file}:`, e);\n                }\n            }\n        } catch (e) {\n            // Ìè¥ÎçîÍ∞Ä ÏóÜÍ±∞ÎÇò Ï†ëÍ∑ºÌï† Ïàò ÏóÜÏúºÎ©¥ Ï§ëÎ≥µ Ï≤¥ÌÅ¨Î•º Í±¥ÎÑàÎõ∞Í≥† Í≥ÑÏÜç ÏßÑÌñâ\n            console.log(\"No conversations directory yet, skipping local duplicate check\");\n        }\n        // ChatGPT ÎßÅÌÅ¨ ÌååÏã± (Playwright Í∏∞Î∞ò) -> PuppeteerÎ°ú Î≥ÄÍ≤ΩÎê®\n        console.log(\"=== Starting Puppeteer-based parsing ===\");\n        let result;\n        try {\n            result = await (0,_lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_1__.parseChatGPTLink)(url);\n            console.log(`Parsed conversation: \"${result.conversation.title}\" with ${result.conversation.messages.length} messages`);\n            console.log(`Raw HTML length: ${result.rawHtml.length} characters`);\n        } catch (error) {\n            console.error(\"Error parsing conversation:\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: error instanceof Error ? error.message : \"ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ Ï∂îÏ∂úÌï† Ïàò ÏóÜÏäµÎãàÎã§.\"\n            }, {\n                status: 422\n            });\n        }\n        const { conversation, rawText } = result;\n        // Î©îÏãúÏßÄ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨\n        if (!conversation.messages || conversation.messages.length === 0) {\n            console.error(\"No messages found in conversation\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\"\n            }, {\n                status: 404\n            });\n        }\n        // Í∞Å Î©îÏãúÏßÄ ÎÇ¥Ïö© Í∞ÑÎûµÌûà Î°úÍπÖ\n        conversation.messages.forEach((msg, idx)=>{\n            console.log(`Message #${idx + 1} (${msg.role}): ${msg.content.substring(0, 30)}... (${msg.content.length} chars)`);\n        });\n        // Obsidian Vault Í≤ΩÎ°ú ÌôïÏù∏\n        const vaultPath = process.env.OBSIDIAN_VAULT_PATH;\n        console.log(`Using Obsidian vault path: ${vaultPath}`);\n        if (!vaultPath) {\n            console.error(\"Obsidian Vault path is not configured\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Obsidian Vault Í≤ΩÎ°úÍ∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.\"\n            }, {\n                status: 500\n            });\n        }\n        try {\n            // Í≥†Ïú† ID ÏÉùÏÑ±\n            const id = conversation.id || `${Date.now()}-${(0,uuid__WEBPACK_IMPORTED_MODULE_6__[\"default\"])().substring(0, 8)}`;\n            // ÌååÏùºÎ™Ö ÏÉùÏÑ± (Ï†úÎ™©ÏùÑ ÌååÏùºÎ™ÖÏúºÎ°ú Î≥ÄÌôò)\n            const fileName = conversation.title.toLowerCase().replace(/[^a-z0-9Í∞Ä-Ìû£]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100) // Í∏∏Ïù¥ Ï†úÌïú\n             + \".md\";\n            // ÏòµÏãúÎîîÏñ∏ ChatGPT Ìè¥Îçî Í≤ΩÎ°ú\n            const obsidianFolder = path__WEBPACK_IMPORTED_MODULE_4__.join(vaultPath, \"ChatGPT\");\n            // Ìè¥Îçî ÏÉùÏÑ± (ÏóÜÎäî Í≤ΩÏö∞)\n            await fs_promises__WEBPACK_IMPORTED_MODULE_3__.mkdir(obsidianFolder, {\n                recursive: true\n            });\n            // OpenAI APIÎ•º ÏÇ¨Ïö©ÌïòÏó¨ ÎåÄÌôî ÎÇ¥Ïö© ÏöîÏïΩ ÏÉùÏÑ±\n            console.log(\"Generating conversation summary...\");\n            console.log(`Ï≤òÎ¶¨Ìï† ÎåÄÌôî Î©îÏãúÏßÄ Ïàò: ${conversation.messages.length}`);\n            // ÎåÄÌôî ÏöîÏïΩ ÏÉùÏÑ± (Î©îÏãúÏßÄÍ∞Ä 20Í∞ú Ï¥àÍ≥ºÌïòÎ©¥ Í∏¥ ÎåÄÌôî ÏöîÏïΩ Ìï®Ïàò ÏÇ¨Ïö©)\n            const summaryResult = conversation.messages.length > 20 ? await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__.summarizeLongConversation)(conversation.title, conversation.messages) : await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_2__.summarizeConversation)(conversation.title, conversation.messages);\n            console.log(`ÏÉùÏÑ±Îêú ÏöîÏïΩ (${summaryResult.summary.length} Ïûê) - ÌÇ§ÏõåÎìú: ${summaryResult.keywords.length}Í∞ú`);\n            console.log(\"ÌÇ§ÏõåÎìú:\", summaryResult.keywords.join(\", \"));\n            // ÌÉúÍ∑∏ Î™©Î°ù Ï§ÄÎπÑ (ÏöîÏïΩÏóêÏÑú Ï∂îÏ∂úÌïú ÌÇ§ÏõåÎìú + ChatGPT Î™®Îç∏)\n            const tags = [\n                ...summaryResult.keywords || [],\n                conversation.metadata?.model || \"ChatGPT\"\n            ].filter(Boolean); // Îπà Í∞í Ï†úÍ±∞\n            // YAML ÌîÑÎ°†Ìä∏Îß§ÌÑ∞ ÏÉùÏÑ±\n            const frontmatter = `---\ntitle: ${conversation.title}\ndate: ${new Date().toISOString()}\nsource: ${url}\ntags: [${tags.map((tag)=>`\"${tag}\"`).join(\", \")}]\nmodel: ${summaryResult.modelUsed || conversation.metadata?.model || \"ChatGPT\"}\n---\n\n`;\n            // ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ ÎßàÌÅ¨Îã§Ïö¥ÏúºÎ°ú Î≥ÄÌôò\n            let markdownContent = frontmatter;\n            // ÎåÄÌôî ÎÇ¥Ïö© Ï∂îÍ∞Ä\n            markdownContent += `# ${conversation.title}\\n\\n`;\n            // URLÍ≥º ÎÇ†Ïßú Ï†ïÎ≥¥ Ï∂îÍ∞Ä\n            markdownContent += `> [ÏõêÎ≥∏ URL](${url})\\n\\n`;\n            markdownContent += `> Ï†ÄÏû• ÏãúÍ∞Ñ: ${new Date().toLocaleString(\"ko-KR\")}\\n\\n`;\n            if (tags.length > 0) {\n                markdownContent += `> ÌÉúÍ∑∏: ${tags.join(\", \")}\\n\\n`;\n            }\n            markdownContent += `---\\n\\n`;\n            // ÏÇ¨Ïö©Ïûê-Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏ ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ ÎßàÌÅ¨Îã§Ïö¥ÏúºÎ°ú Ìè¨Îß∑ÌåÖ (JSON Ïä§ÌÉÄÏùºÎ°ú Î≥ÄÍ≤Ω)\n            conversation.messages.forEach((message, index)=>{\n                const isUser = message.role === \"user\";\n                const messageHeader = isUser ? \"## \\uD83D\\uDC64 ÏÇ¨Ïö©Ïûê\" : \"## \\uD83E\\uDD16 assistant\";\n                // JSON ÌòïÏãùÏ≤òÎüº Ïó≠Ìï†Í≥º ÎÇ¥Ïö©ÏùÑ Íµ¨Î∂ÑÌïòÏó¨ ÌëúÏãú\n                markdownContent += `${messageHeader}\\n\\n${message.content}\\n\\n`;\n                // ÎßàÏßÄÎßâ Î©îÏãúÏßÄÍ∞Ä ÏïÑÎãàÎ©¥ Íµ¨Î∂ÑÏÑ† Ï∂îÍ∞Ä\n                if (index < conversation.messages.length - 1) {\n                    markdownContent += `---\\n\\n`;\n                }\n            });\n            // ÏöîÏïΩ ÏÑπÏÖò Ï∂îÍ∞Ä\n            markdownContent += `\\n\\n---\\n\\n## üí° ÏöîÏïΩ\\n\\n${summaryResult.summary}\\n`;\n            // ÌÇ§ÏõåÎìú ÏÑπÏÖò Ï∂îÍ∞Ä\n            if (summaryResult.keywords && summaryResult.keywords.length > 0) {\n                markdownContent += `\\n## üîë ÌÇ§ÏõåÎìú\\n\\n${summaryResult.keywords.map((k)=>`\\`${k}\\``).join(\" \")}\\n`;\n            }\n            // ÏòµÏãúÎîîÏñ∏Ïóê ÎßàÌÅ¨Îã§Ïö¥ ÌååÏùº Ï†ÄÏû•\n            const obsidianFilePath = path__WEBPACK_IMPORTED_MODULE_4__.join(obsidianFolder, fileName);\n            await fs_promises__WEBPACK_IMPORTED_MODULE_3__.writeFile(obsidianFilePath, markdownContent, \"utf-8\");\n            console.log(`Saved markdown content to: ${obsidianFilePath}`);\n            // ÏõêÎ≥∏ ÌÖçÏä§Ìä∏ ÎÇ¥Ïö© Ï†ÄÏû• (HTML ÎåÄÏã†)\n            const textFileName = fileName.replace(\".md\", \"-original.txt\");\n            const textFilePath = path__WEBPACK_IMPORTED_MODULE_4__.join(obsidianFolder, textFileName);\n            await fs_promises__WEBPACK_IMPORTED_MODULE_3__.writeFile(textFilePath, rawText, \"utf-8\");\n            console.log(`Saved original text content to: ${textFilePath}`);\n            // ÎåÄÌôî Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±\n            const conversationData = {\n                id,\n                title: conversation.title,\n                content: conversation.messages,\n                metadata: {\n                    date: new Date().toISOString(),\n                    model: summaryResult.modelUsed || conversation.metadata?.model || \"gpt-4\",\n                    tags: summaryResult.keywords || []\n                },\n                createdAt: new Date().toISOString(),\n                url,\n                summary: summaryResult.summary\n            };\n            // ÎßàÏßÄÎßâÏúºÎ°ú ÌïúÎ≤à Îçî Ï§ëÎ≥µ URL Ï≤¥ÌÅ¨ (ÏúÑÏóêÏÑú ÏßÑÌñâÌñàÏßÄÎßå Îã§Î•∏ ÌîÑÎ°úÏÑ∏Ïä§ÏóêÏÑú Í∞ôÏùÄ URLÏù¥ Ï†ÄÏû•Îê† ÏàòÎèÑ ÏûàÏùå)\n            let isDuplicate = false;\n            try {\n                const files = await fs_promises__WEBPACK_IMPORTED_MODULE_3__.readdir(conversationsDir);\n                const jsonFiles = files.filter((file)=>file.endsWith(\".json\"));\n                for (const file of jsonFiles){\n                    try {\n                        const filePath = path__WEBPACK_IMPORTED_MODULE_4__.join(conversationsDir, file);\n                        const content = await fs_promises__WEBPACK_IMPORTED_MODULE_3__.readFile(filePath, \"utf-8\");\n                        const data = JSON.parse(content);\n                        if (data.url === url) {\n                            console.log(`Skipping JSON save - duplicate URL found in local file: ${file}`);\n                            isDuplicate = true;\n                            break;\n                        }\n                    } catch (e) {\n                    // ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•òÎäî Î¨¥Ïãú\n                    }\n                }\n            } catch (e) {\n            // Ìè¥Îçî Ï†ëÍ∑º Ïò§Î•òÎäî Î¨¥Ïãú\n            }\n            // Ï§ëÎ≥µÏù¥ ÏïÑÎãå Í≤ΩÏö∞ÏóêÎßå JSON ÌååÏùº Ï†ÄÏû•\n            let jsonFilePath = \"\";\n            if (!isDuplicate) {\n                // ÌååÏùºÎ™Ö ÏÉùÏÑ± - ÎåÄÌôî Ï†úÎ™©Í≥º IDÎ•º Ìè¨Ìï®ÌïòÏó¨ ÏãùÎ≥Ñ Í∞ÄÎä•ÌïòÍ≤å Ìï®\n                const sanitizedTitle = conversation.title.toLowerCase().replace(/[^a-z0-9Í∞Ä-Ìû£]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100);\n                jsonFilePath = path__WEBPACK_IMPORTED_MODULE_4__.join(conversationsDir, `${sanitizedTitle}-${id}.json`);\n                await fs_promises__WEBPACK_IMPORTED_MODULE_3__.writeFile(jsonFilePath, JSON.stringify(conversationData, null, 2), \"utf-8\");\n                console.log(`Saved conversation data to: ${jsonFilePath}`);\n            } else {\n                console.log(\"Skipped saving JSON file due to duplicate URL\");\n            }\n            // ÏÑ±Í≥µ ÏùëÎãµ\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                data: {\n                    conversation: conversationData,\n                    obsidian: {\n                        path: vaultPath,\n                        fileName,\n                        filePath: obsidianFilePath,\n                        textPath: textFilePath,\n                        contentType: \"markdown-formatted\"\n                    },\n                    jsonBackup: jsonFilePath || \"skipped (duplicate URL)\",\n                    summary: summaryResult.summary,\n                    keywords: summaryResult.keywords\n                }\n            });\n        } catch (saveError) {\n            console.error(\"Error saving data:\", saveError);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: saveError instanceof Error ? saveError.message : \"Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Error processing conversation:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: error instanceof Error ? error.message : \"ÎåÄÌôî Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * ChatGPT URL Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨\n */ function isValidChatGPTUrl(url) {\n    try {\n        const parsed = new URL(url);\n        // ÎèÑÎ©îÏù∏ Ï≤¥ÌÅ¨\n        const validDomains = [\n            \"chat.openai.com\",\n            \"chatgpt.com\"\n        ];\n        if (!validDomains.some((domain)=>parsed.hostname.includes(domain))) {\n            return false;\n        }\n        // Í≤ΩÎ°ú Ï≤¥ÌÅ¨\n        return parsed.pathname.includes(\"/share/\") || parsed.pathname.includes(\"/c/\");\n    } catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBMEM7QUFDWTtBQUMrQjtBQUNwRDtBQUNMO0FBQ087QUFDcUI7QUFFakQsZUFBZVMsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFFWixNQUFNQyxPQUFPLE1BQU1ILFFBQVFJLElBQUksR0FBR0MsS0FBSyxDQUFDQyxDQUFBQTtZQUN0Q0wsUUFBUU0sS0FBSyxDQUFDLGlDQUFpQ0Q7WUFDL0MsT0FBTztRQUNUO1FBRUEsSUFBSSxDQUFDSCxRQUFRLENBQUNBLEtBQUtLLEdBQUcsRUFBRTtZQUN0QlAsUUFBUU0sS0FBSyxDQUFDO1lBQ2QsT0FBT2pCLGtGQUFZQSxDQUFDYyxJQUFJLENBQ3RCO2dCQUFFSyxTQUFTO2dCQUFPRixPQUFPO1lBQXlCLEdBQ2xEO2dCQUFFRyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNLEVBQUVGLEdBQUcsRUFBRSxHQUFHTDtRQUNoQkYsUUFBUUMsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUVNLElBQUksQ0FBQyxDQUFDO1FBRXRDLGFBQWE7UUFDYixJQUFJLENBQUNHLGtCQUFrQkgsTUFBTTtZQUMzQlAsUUFBUU0sS0FBSyxDQUFDO1lBQ2QsT0FBT2pCLGtGQUFZQSxDQUFDYyxJQUFJLENBQ3RCO2dCQUFFSyxTQUFTO2dCQUFPRixPQUFPO1lBQTRCLEdBQ3JEO2dCQUFFRyxRQUFRO1lBQUk7UUFFbEI7UUFFQSx1QkFBdUI7UUFDdkJULFFBQVFDLEdBQUcsQ0FBQztRQUNaLE1BQU0sRUFBRVUsUUFBUUMsU0FBUyxFQUFFQyxTQUFTQyxlQUFlLEVBQUUsR0FBRyxNQUFNakIsc0VBQWNBLENBQUNVO1FBRTdFLElBQUlLLFdBQVc7WUFDYlosUUFBUUMsR0FBRyxDQUFDLENBQUMsd0JBQXdCLEVBQUVNLElBQUksQ0FBQztZQUM1QyxPQUFPbEIsa0ZBQVlBLENBQUNjLElB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QixXQUFXO1lBQ2xCN0YsUUFBUU0sS0FBSyxDQUFDLHNCQUFzQnVGO1lBQ3BDLE9BQU94RyxrRkFBWUEsQ0FBQ2MsSUFBSSxDQUN0QjtnQkFDRUssU0FBUztnQkFDVEYsT0FBT3VGLHFCQUFxQmxELFFBQ3hCa0QsVUFBVTdFLE9BQU8sR0FDakI7WUFDTixHQUNBO2dCQUFFUCxRQUFRO1lBQUk7UUFFbEI7SUFDRixFQUFFLE9BQU9ILE9BQU87UUFDZE4sUUFBUU0sS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsT0FBT2pCLGtGQUFZQSxDQUFDYyxJQUFJLENBQ3RCO1lBQ0VLLFNBQVM7WUFDVEYsT0FBT0EsaUJBQWlCcUMsUUFBUXJDLE1BQU1VLE9BQU8sR0FBRztRQUNsRCxHQUNBO1lBQUVQLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRUE7O0NBRUMsR0FDRCxTQUFTQyxrQkFBa0JILEdBQVc7SUFDcEMsSUFBSTtRQUNGLE1BQU11RixTQUFTLElBQUlDLElBQUl4RjtRQUV2QixTQUFTO1FBQ1QsTUFBTXlGLGVBQWU7WUFBQztZQUFtQjtTQUFjO1FBQ3ZELElBQUksQ0FBQ0EsYUFBYUMsSUFBSSxDQUFDQyxDQUFBQSxTQUFVSixPQUFPSyxRQUFRLENBQUNDLFFBQVEsQ0FBQ0YsVUFBVTtZQUNsRSxPQUFPO1FBQ1Q7UUFFQSxRQUFRO1FBQ1IsT0FBT0osT0FBT08sUUFBUSxDQUFDRCxRQUFRLENBQUMsY0FBY04sT0FBT08sUUFBUSxDQUFDRCxRQUFRLENBQUM7SUFDekUsRUFBRSxPQUFPOUYsT0FBTztRQUNkLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvYXBwL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlLnRzP2ZmNTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwYXJzZUNoYXRHUFRMaW5rIH0gZnJvbSAnQC9saWIvdXRpbHMvY2hhdGdwdCdcbmltcG9ydCB7IHN1bW1hcml6ZUNvbnZlcnNhdGlvbiwgc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbiB9IGZyb20gJ0AvbGliL3V0aWxzL29wZW5haSdcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzL3Byb21pc2VzJ1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCdcbmltcG9ydCB7IGNoZWNrVXJsRXhpc3RzIH0gZnJvbSAnQC91dGlscy9zdXBhYmFzZUhhbmRsZXInXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJz09PSBQcm9jZXNzaW5nIGNvbnZlcnNhdGlvbiByZXF1ZXN0ID09PScpO1xuICAgIFxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKS5jYXRjaChlID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSByZXF1ZXN0IGJvZHk6JywgZSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KTtcbiAgICBcbiAgICBpZiAoIWJvZHkgfHwgIWJvZHkudXJsKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNaXNzaW5nIFVSTCBpbiByZXF1ZXN0IGJvZHknKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDaGF0R1BUIOqzteycoCBVUkzsnbQg7ZWE7JqU7ZWp64uI64ukLicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB7IHVybCB9ID0gYm9keTtcbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBVUkw6IFwiJHt1cmx9XCJgKTtcblxuICAgIC8vIFVSTCDsnKDtmqjshLEg6rKA7IKsXG4gICAgaWYgKCFpc1ZhbGlkQ2hhdEdQVFVybCh1cmwpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIFVSTCBmb3JtYXQgb3IgZG9tYWluJyk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn7Jyg7Zqo7ZWcIENoYXRHUFQg6rO17JygIFVSTOydtCDslYTri5nri4jri6QuJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gVVJMIOykkeuztSDssrTtgawgKFN1cGFiYXNlKVxuICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBmb3IgVVJMIGR1cGxpY2F0ZXMuLi4nKTtcbiAgICBjb25zdCB7IGV4aXN0czogdXJsRXhpc3RzLCBzZXNzaW9uOiBleGlzdGluZ1Nlc3Npb24gfSA9IGF3YWl0IGNoZWNrVXJsRXhpc3RzKHVybCk7XG4gICAgXG4gICAgaWYgKHVybEV4aXN0cykge1xuICAgICAgY29uc29sZS5sb2coYER1cGxpY2F0ZSBVUkwgZGV0ZWN0ZWQ6ICR7dXJsfWApO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZHVwbGljYXRlOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAn7J2066+4IOyggOyepeuQnCDrjIDtmZTsnoXri4jri6QuJyxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGlkOiBleGlzdGluZ1Nlc3Npb24/LmlkLFxuICAgICAgICAgIHRpdGxlOiBleGlzdGluZ1Nlc3Npb24/LnRpdGxlLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGV4aXN0aW5nU2Vzc2lvbj8uY3JlYXRlZF9hdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8g66Gc7LusIGNvbnZlcnNhdGlvbnMg7Y+0642U7JeQ7ISc64+EIFVSTCDspJHrs7Ug7LK07YGsXG4gICAgY29uc3QgY29udmVyc2F0aW9uc0RpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnY29udmVyc2F0aW9ucycpO1xuICAgIHRyeSB7XG4gICAgICAvLyDtj7TrjZTqsIAg7KG07J6s7ZWY64qU7KeAIO2ZleyduFxuICAgICAgYXdhaXQgZnMuYWNjZXNzKGNvbnZlcnNhdGlvbnNEaXIpO1xuICAgICAgXG4gICAgICAvLyDrqqjrk6AgSlNPTiDtjIzsnbwg7J296riwXG4gICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IGZzLnJlYWRkaXIoY29udmVyc2F0aW9uc0Rpcik7XG4gICAgICBjb25zdCBqc29uRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLmVuZHNXaXRoKCcuanNvbicpKTtcbiAgICAgIFxuICAgICAgLy8g6rCBIO2MjOydvOyXkOyEnCBVUkwg7ZmV7J24XG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YganNvbkZpbGVzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oY29udmVyc2F0aW9uc0RpciwgZmlsZSk7XG4gICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVQYXRoLCAndXRmLTgnKTtcbiAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoZGF0YS51cmwgPT09IHVybCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYER1cGxpY2F0ZSBVUkwgZm91bmQgaW4gbG9jYWwgZmlsZTogJHtmaWxlfWApO1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZHVwbGljYXRlOiB0cnVlLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAn7J2066+4IOyggOyepeuQnCDrjIDtmZTsnoXri4jri6QuJyxcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuY3JlYXRlZEF0XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIO2MjOydvCDsnb3quLAg7Jik66WY64qUIOustOyLnO2VmOqzoCDqs4Tsho0g7KeE7ZaJXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgY2hlY2tpbmcgZmlsZSAke2ZpbGV9OmAsIGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8g7Y+0642U6rCAIOyXhuqxsOuCmCDsoJHqt7ztlaAg7IiYIOyXhuycvOuptCDspJHrs7Ug7LK07YGs66W8IOqxtOuEiOubsOqzoCDqs4Tsho0g7KeE7ZaJXG4gICAgICBjb25zb2xlLmxvZygnTm8gY29udmVyc2F0aW9ucyBkaXJlY3RvcnkgeWV0LCBza2lwcGluZyBsb2NhbCBkdXBsaWNhdGUgY2hlY2snKTtcbiAgICB9XG5cbiAgICAvLyBDaGF0R1BUIOunge2BrCDtjIzsi7EgKFBsYXl3cmlnaHQg6riw67CYKSAtPiBQdXBwZXRlZXLroZwg67OA6rK965CoXG4gICAgY29uc29sZS5sb2coJz09PSBTdGFydGluZyBQdXBwZXRlZXItYmFzZWQgcGFyc2luZyA9PT0nKTtcbiAgICBsZXQgcmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICByZXN1bHQgPSBhd2FpdCBwYXJzZUNoYXRHUFRMaW5rKHVybCk7XG4gICAgICBjb25zb2xlLmxvZyhgUGFyc2VkIGNvbnZlcnNhdGlvbjogXCIke3Jlc3VsdC5jb252ZXJzYXRpb24udGl0bGV9XCIgd2l0aCAke3Jlc3VsdC5jb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlc2ApO1xuICAgICAgY29uc29sZS5sb2coYFJhdyBIVE1MIGxlbmd0aDogJHtyZXN1bHQucmF3SHRtbC5sZW5ndGh9IGNoYXJhY3RlcnNgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4nIFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDIyIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBjb252ZXJzYXRpb24sIHJhd1RleHQgfSA9IHJlc3VsdDtcblxuICAgIC8vIOuplOyLnOyngCDsnKDtmqjshLEg6rKA7IKsXG4gICAgaWYgKCFjb252ZXJzYXRpb24ubWVzc2FnZXMgfHwgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5lcnJvcignTm8gbWVzc2FnZXMgZm91bmQgaW4gY29udmVyc2F0aW9uJyk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn64yA7ZmUIOuCtOyaqeydhCDssL7snYQg7IiYIOyXhuyKteuLiOuLpC4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8g6rCBIOuplOyLnOyngCDrgrTsmqkg6rCE65617Z6IIOuhnOq5hVxuICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5mb3JFYWNoKChtc2csIGlkeCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYE1lc3NhZ2UgIyR7aWR4KzF9ICgke21zZy5yb2xlfSk6ICR7bXNnLmNvbnRlbnQuc3Vic3RyaW5nKDAsIDMwKX0uLi4gKCR7bXNnLmNvbnRlbnQubGVuZ3RofSBjaGFycylgKTtcbiAgICB9KTtcblxuICAgIC8vIE9ic2lkaWFuIFZhdWx0IOqyveuhnCDtmZXsnbhcbiAgICBjb25zdCB2YXVsdFBhdGggPSBwcm9jZXNzLmVudi5PQlNJRElBTl9WQVVMVF9QQVRIO1xuICAgIGNvbnNvbGUubG9nKGBVc2luZyBPYnNpZGlhbiB2YXVsdCBwYXRoOiAke3ZhdWx0UGF0aH1gKTtcbiAgICBcbiAgICBpZiAoIXZhdWx0UGF0aCkge1xuICAgICAgY29uc29sZS5lcnJvcignT2JzaWRpYW4gVmF1bHQgcGF0aCBpcyBub3QgY29uZmlndXJlZCcpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09ic2lkaWFuIFZhdWx0IOqyveuhnOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukLicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8g6rOg7JygIElEIOyDneyEsVxuICAgICAgY29uc3QgaWQgPSBjb252ZXJzYXRpb24uaWQgfHwgYCR7RGF0ZS5ub3coKX0tJHt1dWlkdjQoKS5zdWJzdHJpbmcoMCwgOCl9YDtcbiAgICAgIFxuICAgICAgLy8g7YyM7J2866qFIOyDneyEsSAo7KCc66qp7J2EIO2MjOydvOuqheycvOuhnCDrs4DtmZgpXG4gICAgICBjb25zdCBmaWxlTmFtZSA9IGNvbnZlcnNhdGlvbi50aXRsZVxuICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAucmVwbGFjZSgvW15hLXowLTnqsIAt7Z6jXS9nLCAnLScpXG4gICAgICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpXG4gICAgICAgIC5yZXBsYWNlKC9eLXwtJC9nLCAnJylcbiAgICAgICAgLnN1YnN0cmluZygwLCAxMDApIC8vIOq4uOydtCDsoJztlZxcbiAgICAgICAgKyAnLm1kJztcbiAgICAgIFxuICAgICAgLy8g7Ji17Iuc65SU7Ja4IENoYXRHUFQg7Y+0642UIOqyveuhnFxuICAgICAgY29uc3Qgb2JzaWRpYW5Gb2xkZXIgPSBwYXRoLmpvaW4odmF1bHRQYXRoLCAnQ2hhdEdQVCcpO1xuICAgICAgXG4gICAgICAvLyDtj7TrjZQg7IOd7ISxICjsl4bripQg6rK97JqwKVxuICAgICAgYXdhaXQgZnMubWtkaXIob2JzaWRpYW5Gb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgXG4gICAgICAvLyBPcGVuQUkgQVBJ66W8IOyCrOyaqe2VmOyXrCDrjIDtmZQg64K07JqpIOyalOyVvSDsg53shLFcbiAgICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0aW5nIGNvbnZlcnNhdGlvbiBzdW1tYXJ5Li4uJyk7XG4gICAgICBjb25zb2xlLmxvZyhg7LKY66as7ZWgIOuMgO2ZlCDrqZTsi5zsp4Ag7IiYOiAke2NvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGh9YCk7XG4gICAgICBcbiAgICAgIC8vIOuMgO2ZlCDsmpTslb0g7IOd7ISxICjrqZTsi5zsp4DqsIAgMjDqsJwg7LSI6rO87ZWY66m0IOq4tCDrjIDtmZQg7JqU7JW9IO2VqOyImCDsgqzsmqkpXG4gICAgICBjb25zdCBzdW1tYXJ5UmVzdWx0ID0gY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDIwXG4gICAgICAgID8gYXdhaXQgc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbihcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi50aXRsZSxcbiAgICAgICAgICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlc1xuICAgICAgICAgIClcbiAgICAgICAgOiBhd2FpdCBzdW1tYXJpemVDb252ZXJzYXRpb24oXG4gICAgICAgICAgICBjb252ZXJzYXRpb24udGl0bGUsXG4gICAgICAgICAgICBjb252ZXJzYXRpb24ubWVzc2FnZXNcbiAgICAgICAgICApO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhg7IOd7ISx65CcIOyalOyVvSAoJHtzdW1tYXJ5UmVzdWx0LnN1bW1hcnkubGVuZ3RofSDsnpApIC0g7YKk7JuM65OcOiAke3N1bW1hcnlSZXN1bHQua2V5d29yZHMubGVuZ3RofeqwnGApO1xuICAgICAgY29uc29sZS5sb2coJ+2CpOybjOuTnDonLCBzdW1tYXJ5UmVzdWx0LmtleXdvcmRzLmpvaW4oJywgJykpO1xuICAgICAgXG4gICAgICAvLyDtg5zqt7gg66qp66GdIOykgOu5hCAo7JqU7JW97JeQ7IScIOy2lOy2nO2VnCDtgqTsm4zrk5wgKyBDaGF0R1BUIOuqqOuNuClcbiAgICAgIGNvbnN0IHRhZ3MgPSBbXG4gICAgICAgIC4uLihzdW1tYXJ5UmVzdWx0LmtleXdvcmRzIHx8IFtdKSxcbiAgICAgICAgY29udmVyc2F0aW9uLm1ldGFkYXRhPy5tb2RlbCB8fCAnQ2hhdEdQVCdcbiAgICAgIF0uZmlsdGVyKEJvb2xlYW4pOyAvLyDruYgg6rCSIOygnOqxsFxuICAgICAgXG4gICAgICAvLyBZQU1MIO2UhOuhoO2KuOunpO2EsCDsg53shLFcbiAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gYC0tLVxudGl0bGU6ICR7Y29udmVyc2F0aW9uLnRpdGxlfVxuZGF0ZTogJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9XG5zb3VyY2U6ICR7dXJsfVxudGFnczogWyR7dGFncy5tYXAodGFnID0+IGBcIiR7dGFnfVwiYCkuam9pbignLCAnKX1dXG5tb2RlbDogJHtzdW1tYXJ5UmVzdWx0Lm1vZGVsVXNlZCB8fCBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8ICdDaGF0R1BUJ31cbi0tLVxuXG5gO1xuICAgICAgXG4gICAgICAvLyDrjIDtmZQg64K07Jqp7J2EIOuniO2BrOuLpOyatOycvOuhnCDrs4DtmZhcbiAgICAgIGxldCBtYXJrZG93bkNvbnRlbnQgPSBmcm9udG1hdHRlcjtcbiAgICAgIFxuICAgICAgLy8g64yA7ZmUIOuCtOyaqSDstpTqsIBcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgIyAke2NvbnZlcnNhdGlvbi50aXRsZX1cXG5cXG5gO1xuICAgICAgXG4gICAgICAvLyBVUkzqs7wg64Kg7KecIOygleuztCDstpTqsIBcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgPiBb7JuQ67O4IFVSTF0oJHt1cmx9KVxcblxcbmA7XG4gICAgICBtYXJrZG93bkNvbnRlbnQgKz0gYD4g7KCA7J6lIOyLnOqwhDogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdrby1LUicpfVxcblxcbmA7XG4gICAgICBcbiAgICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbWFya2Rvd25Db250ZW50ICs9IGA+IO2DnOq3uDogJHt0YWdzLmpvaW4oJywgJyl9XFxuXFxuYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xuICAgICAgXG4gICAgICAvLyDsgqzsmqnsnpAt7Ja07Iuc7Iqk7YS07Yq4IOuMgO2ZlCDrgrTsmqnsnYQg66eI7YGs64uk7Jq07Jy866GcIO2PrOunt+2MhSAoSlNPTiDsiqTtg4DsnbzroZwg67OA6rK9KVxuICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGlzVXNlciA9IG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInO1xuICAgICAgICBjb25zdCBtZXNzYWdlSGVhZGVyID0gaXNVc2VyID8gJyMjIPCfkaQg7IKs7Jqp7J6QJyA6ICcjIyDwn6SWIGFzc2lzdGFudCc7XG4gICAgICBcbiAgICAgICAgLy8gSlNPTiDtmJXsi53sspjrn7wg7Jet7ZWg6rO8IOuCtOyaqeydhCDqtazrtoTtlZjsl6wg7ZGc7IucXG4gICAgICAgIG1hcmtkb3duQ29udGVudCArPSBgJHttZXNzYWdlSGVhZGVyfVxcblxcbiR7bWVzc2FnZS5jb250ZW50fVxcblxcbmA7XG4gICAgICAgIFxuICAgICAgICAvLyDrp4jsp4Drp4kg66mU7Iuc7KeA6rCAIOyVhOuLiOuptCDqtazrtoTshKAg7LaU6rCAXG4gICAgICAgIGlmIChpbmRleCA8IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g7JqU7JW9IOyEueyFmCDstpTqsIBcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgXFxuXFxuLS0tXFxuXFxuIyMg8J+SoSDsmpTslb1cXG5cXG4ke3N1bW1hcnlSZXN1bHQuc3VtbWFyeX1cXG5gO1xuICAgICAgXG4gICAgICAvLyDtgqTsm4zrk5wg7IS57IWYIOy2lOqwgFxuICAgICAgaWYgKHN1bW1hcnlSZXN1bHQua2V5d29yZHMgJiYgc3VtbWFyeVJlc3VsdC5rZXl3b3Jkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIG1hcmtkb3duQ29udGVudCArPSBgXFxuIyMg8J+UkSDtgqTsm4zrk5xcXG5cXG4ke3N1bW1hcnlSZXN1bHQua2V5d29yZHMubWFwKGsgPT4gYFxcYCR7a31cXGBgKS5qb2luKCcgJyl9XFxuYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g7Ji17Iuc65SU7Ja47JeQIOuniO2BrOuLpOyatCDtjIzsnbwg7KCA7J6lXG4gICAgICBjb25zdCBvYnNpZGlhbkZpbGVQYXRoID0gcGF0aC5qb2luKG9ic2lkaWFuRm9sZGVyLCBmaWxlTmFtZSk7XG4gICAgICBhd2FpdCBmcy53cml0ZUZpbGUob2JzaWRpYW5GaWxlUGF0aCwgbWFya2Rvd25Db250ZW50LCAndXRmLTgnKTtcbiAgICAgIGNvbnNvbGUubG9nKGBTYXZlZCBtYXJrZG93biBjb250ZW50IHRvOiAke29ic2lkaWFuRmlsZVBhdGh9YCk7XG4gICAgICBcbiAgICAgIC8vIOybkOuzuCDthY3siqTtirgg64K07JqpIOyggOyepSAoSFRNTCDrjIDsi6ApXG4gICAgICBjb25zdCB0ZXh0RmlsZU5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKCcubWQnLCAnLW9yaWdpbmFsLnR4dCcpO1xuICAgICAgY29uc3QgdGV4dEZpbGVQYXRoID0gcGF0aC5qb2luKG9ic2lkaWFuRm9sZGVyLCB0ZXh0RmlsZU5hbWUpO1xuICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKHRleHRGaWxlUGF0aCwgcmF3VGV4dCwgJ3V0Zi04Jyk7XG4gICAgICBjb25zb2xlLmxvZyhgU2F2ZWQgb3JpZ2luYWwgdGV4dCBjb250ZW50IHRvOiAke3RleHRGaWxlUGF0aH1gKTtcbiAgICAgIFxuICAgICAgLy8g64yA7ZmUIOuNsOydtO2EsCDsg53shLFcbiAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkRhdGEgPSB7XG4gICAgICAgIGlkLFxuICAgICAgICB0aXRsZTogY29udmVyc2F0aW9uLnRpdGxlLFxuICAgICAgICBjb250ZW50OiBjb252ZXJzYXRpb24ubWVzc2FnZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIG1vZGVsOiBzdW1tYXJ5UmVzdWx0Lm1vZGVsVXNlZCB8fCBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8ICdncHQtNCcsXG4gICAgICAgICAgdGFnczogc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyB8fCBbXVxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXJsLFxuICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5UmVzdWx0LnN1bW1hcnlcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIOuniOyngOunieycvOuhnCDtlZzrsogg642UIOykkeuztSBVUkwg7LK07YGsICjsnITsl5DshJwg7KeE7ZaJ7ZaI7KeA66eMIOuLpOuluCDtlITroZzshLjsiqTsl5DshJwg6rCZ7J2AIFVSTOydtCDsoIDsnqXrkKAg7IiY64+EIOyeiOydjClcbiAgICAgIGxldCBpc0R1cGxpY2F0ZSA9IGZhbHNlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCBmcy5yZWFkZGlyKGNvbnZlcnNhdGlvbnNEaXIpO1xuICAgICAgICBjb25zdCBqc29uRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLmVuZHNXaXRoKCcuanNvbicpKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBqc29uRmlsZXMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oY29udmVyc2F0aW9uc0RpciwgZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGYtOCcpO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChkYXRhLnVybCA9PT0gdXJsKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTa2lwcGluZyBKU09OIHNhdmUgLSBkdXBsaWNhdGUgVVJMIGZvdW5kIGluIGxvY2FsIGZpbGU6ICR7ZmlsZX1gKTtcbiAgICAgICAgICAgICAgaXNEdXBsaWNhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyDtjIzsnbwg7J296riwIOyYpOulmOuKlCDrrLTsi5xcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8g7Y+0642UIOygkeq3vCDsmKTrpZjripQg66y07IucXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOykkeuzteydtCDslYTri4wg6rK97Jqw7JeQ66eMIEpTT04g7YyM7J28IOyggOyepVxuICAgICAgbGV0IGpzb25GaWxlUGF0aCA9ICcnO1xuICAgICAgaWYgKCFpc0R1cGxpY2F0ZSkge1xuICAgICAgICAvLyDtjIzsnbzrqoUg7IOd7ISxIC0g64yA7ZmUIOygnOuqqeqzvCBJROulvCDtj6ztlajtlZjsl6wg7Iud67OEIOqwgOuKpe2VmOqyjCDtlahcbiAgICAgICAgY29uc3Qgc2FuaXRpemVkVGl0bGUgPSBjb252ZXJzYXRpb24udGl0bGVcbiAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgIC5yZXBsYWNlKC9bXmEtejAtOeqwgC3tnqNdL2csICctJylcbiAgICAgICAgICAucmVwbGFjZSgvLSsvZywgJy0nKVxuICAgICAgICAgIC5yZXBsYWNlKC9eLXwtJC9nLCAnJylcbiAgICAgICAgICAuc3Vic3RyaW5nKDAsIDEwMCk7XG4gICAgICAgIFxuICAgICAgICBqc29uRmlsZVBhdGggPSBwYXRoLmpvaW4oY29udmVyc2F0aW9uc0RpciwgYCR7c2FuaXRpemVkVGl0bGV9LSR7aWR9Lmpzb25gKTtcbiAgICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKGpzb25GaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkoY29udmVyc2F0aW9uRGF0YSwgbnVsbCwgMiksICd1dGYtOCcpO1xuICAgICAgY29uc29sZS5sb2coYFNhdmVkIGNvbnZlcnNhdGlvbiBkYXRhIHRvOiAke2pzb25GaWxlUGF0aH1gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGVkIHNhdmluZyBKU09OIGZpbGUgZHVlIHRvIGR1cGxpY2F0ZSBVUkwnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8g7ISx6rO1IOydkeuLtVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGNvbnZlcnNhdGlvbjogY29udmVyc2F0aW9uRGF0YSxcbiAgICAgICAgICBvYnNpZGlhbjoge1xuICAgICAgICAgICAgcGF0aDogdmF1bHRQYXRoLFxuICAgICAgICAgICAgZmlsZU5hbWUsXG4gICAgICAgICAgICBmaWxlUGF0aDogb2JzaWRpYW5GaWxlUGF0aCxcbiAgICAgICAgICAgIHRleHRQYXRoOiB0ZXh0RmlsZVBhdGgsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogXCJtYXJrZG93bi1mb3JtYXR0ZWRcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAganNvbkJhY2t1cDoganNvbkZpbGVQYXRoIHx8ICdza2lwcGVkIChkdXBsaWNhdGUgVVJMKScsXG4gICAgICAgICAgc3VtbWFyeTogc3VtbWFyeVJlc3VsdC5zdW1tYXJ5LFxuICAgICAgICAgIGtleXdvcmRzOiBzdW1tYXJ5UmVzdWx0LmtleXdvcmRzXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChzYXZlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBkYXRhOicsIHNhdmVFcnJvcik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgIGVycm9yOiBzYXZlRXJyb3IgaW5zdGFuY2VvZiBFcnJvciBcbiAgICAgICAgICAgID8gc2F2ZUVycm9yLm1lc3NhZ2UgXG4gICAgICAgICAgICA6ICfrjbDsnbTthLAg7KCA7J6lIOykkSDsmKTrpZjqsIAg67Cc7IOd7ZaI7Iq164uI64ukLicgXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBjb252ZXJzYXRpb246JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+uMgO2ZlCDsspjrpqwg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuJyBcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8qKlxuICogQ2hhdEdQVCBVUkwg7Jyg7Zqo7ISxIOqygOyCrFxuICovXG5mdW5jdGlvbiBpc1ZhbGlkQ2hhdEdQVFVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZCA9IG5ldyBVUkwodXJsKTtcbiAgICBcbiAgICAvLyDrj4TrqZTsnbgg7LK07YGsXG4gICAgY29uc3QgdmFsaWREb21haW5zID0gWydjaGF0Lm9wZW5haS5jb20nLCAnY2hhdGdwdC5jb20nXTtcbiAgICBpZiAoIXZhbGlkRG9tYWlucy5zb21lKGRvbWFpbiA9PiBwYXJzZWQuaG9zdG5hbWUuaW5jbHVkZXMoZG9tYWluKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgLy8g6rK966GcIOyytO2BrFxuICAgIHJldHVybiBwYXJzZWQucGF0aG5hbWUuaW5jbHVkZXMoJy9zaGFyZS8nKSB8fCBwYXJzZWQucGF0aG5hbWUuaW5jbHVkZXMoJy9jLycpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwYXJzZUNoYXRHUFRMaW5rIiwic3VtbWFyaXplQ29udmVyc2F0aW9uIiwic3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbiIsImZzIiwicGF0aCIsInY0IiwidXVpZHY0IiwiY2hlY2tVcmxFeGlzdHMiLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwianNvbiIsImNhdGNoIiwiZSIsImVycm9yIiwidXJsIiwic3VjY2VzcyIsInN0YXR1cyIsImlzVmFsaWRDaGF0R1BUVXJsIiwiZXhpc3RzIiwidXJsRXhpc3RzIiwic2Vzc2lvbiIsImV4aXN0aW5nU2Vzc2lvbiIsImR1cGxpY2F0ZSIsIm1lc3NhZ2UiLCJkYXRhIiwiaWQiLCJ0aXRsZSIsImNyZWF0ZWRBdCIsImNyZWF0ZWRfYXQiLCJjb252ZXJzYXRpb25zRGlyIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJhY2Nlc3MiLCJmaWxlcyIsInJlYWRkaXIiLCJqc29uRmlsZXMiLCJmaWx0ZXIiLCJmaWxlIiwiZW5kc1dpdGgiLCJmaWxlUGF0aCIsImNvbnRlbnQiLCJyZWFkRmlsZSIsIkpTT04iLCJwYXJzZSIsInJlc3VsdCIsImNvbnZlcnNhdGlvbiIsIm1lc3NhZ2VzIiwibGVuZ3RoIiwicmF3SHRtbCIsIkVycm9yIiwicmF3VGV4dCIsImZvckVhY2giLCJtc2ciLCJpZHgiLCJyb2xlIiwic3Vic3RyaW5nIiwidmF1bHRQYXRoIiwiZW52IiwiT0JTSURJQU5fVkFVTFRfUEFUSCIsIkRhdGUiLCJub3ciLCJmaWxlTmFtZSIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsIm9ic2lkaWFuRm9sZGVyIiwibWtkaXIiLCJyZWN1cnNpdmUiLCJzdW1tYXJ5UmVzdWx0Iiwic3VtbWFyeSIsImtleXdvcmRzIiwidGFncyIsIm1ldGFkYXRhIiwibW9kZWwiLCJCb29sZWFuIiwiZnJvbnRtYXR0ZXIiLCJ0b0lTT1N0cmluZyIsIm1hcCIsInRhZyIsIm1vZGVsVXNlZCIsIm1hcmtkb3duQ29udGVudCIsInRvTG9jYWxlU3RyaW5nIiwiaW5kZXgiLCJpc1VzZXIiLCJtZXNzYWdlSGVhZGVyIiwiayIsIm9ic2lkaWFuRmlsZVBhdGgiLCJ3cml0ZUZpbGUiLCJ0ZXh0RmlsZU5hbWUiLCJ0ZXh0RmlsZVBhdGgiLCJjb252ZXJzYXRpb25EYXRhIiwiZGF0ZSIsImlzRHVwbGljYXRlIiwianNvbkZpbGVQYXRoIiwic2FuaXRpemVkVGl0bGUiLCJzdHJpbmdpZnkiLCJvYnNpZGlhbiIsInRleHRQYXRoIiwiY29udGVudFR5cGUiLCJqc29uQmFja3VwIiwic2F2ZUVycm9yIiwicGFyc2VkIiwiVVJMIiwidmFsaWREb21haW5zIiwic29tZSIsImRvbWFpbiIsImhvc3RuYW1lIiwiaW5jbHVkZXMiLCJwYXRobmFtZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/conversations/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getClientSupabase: () => (/* binding */ getClientSupabase),\n/* harmony export */   getServerSupabase: () => (/* binding */ getServerSupabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   supabaseClient: () => (/* binding */ supabaseClient),\n/* harmony export */   testSupabaseConnection: () => (/* binding */ testSupabaseConnection)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Supabase Client\nconst supabaseUrl = \"https://ghtqqcoyakjozzhegktl.supabase.co\" || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY || \"\";\n// ÏÑúÎπÑÏä§ ÌÇ§Î•º ÏÇ¨Ïö©Ìïú ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ (Î∞±ÏóîÎìú Ï†ÑÏö©) - RLS Ïö∞Ìöå\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey);\n// ÏùµÎ™Ö ÌÇ§Î•º ÏÇ¨Ïö©Ìïú ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ (ÌîÑÎ°†Ìä∏ÏóîÎìú ÏïàÏ†Ñ)\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdodHFxY295YWtqb=\\\"\\\"3p6aGVna3RsIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjA4NjkwMywiZXhwIjoyMDYxNjYyOTAzfQ.3Ygn7Ql9okDXtYnTblDXKLg2wXge1tHhm5Zok_N283k\" || 0;\nconst supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n/**\r\n * Î∞±ÏóîÎìú APIÏóêÏÑú ÏÇ¨Ïö©Ìï† Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§Î•º Î∞òÌôòÌï©ÎãàÎã§.\r\n * RLS Ï†ïÏ±ÖÏùÑ Ïö∞ÌöåÌï† Ïàò ÏûàÎäî ÏÑúÎπÑÏä§ ÌÇ§Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.\r\n */ function getServerSupabase() {\n    return supabaseAdmin;\n}\n/**\r\n * Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú ÏÇ¨Ïö©Ìï† Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ïù∏Ïä§ÌÑ¥Ïä§Î•º Î∞òÌôòÌï©ÎãàÎã§.\r\n * RLS Ï†ïÏ±ÖÏù¥ Ï†ÅÏö©Îêú ÏùµÎ™Ö ÌÇ§Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.\r\n */ function getClientSupabase() {\n    return supabaseClient;\n}\n// Supabase Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ìï®Ïàò\nasync function testSupabaseConnection() {\n    try {\n        // ÌôòÍ≤Ω Î≥ÄÏàòÎßå ÌôïÏù∏\n        if (!supabaseUrl) {\n            throw new Error(\"Supabase URLÏù¥ ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§\");\n        }\n        if (!supabaseServiceKey) {\n            throw new Error(\"Supabase ÏÑúÎπÑÏä§ ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§\");\n        }\n        if (!supabaseAnonKey) {\n            throw new Error(\"Supabase ÏùµÎ™Ö ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§\");\n        }\n        return {\n            success: true,\n            message: \"Supabase ÌôòÍ≤Ω Î≥ÄÏàò ÌôïÏù∏ ÏôÑÎ£å, ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖòÏùÑ ÏßÑÌñâÌï©ÎãàÎã§.\"\n        };\n    } catch (error) {\n        console.error(\"Supabase Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ïò§Î•ò:\", error);\n        return {\n            success: false,\n            message: error instanceof Error ? error.message : \"Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFxRDtBQUVyRCxrQkFBa0I7QUFDbEIsTUFBTUMsY0FBY0MsMENBQW9DLElBQUk7QUFDNUQsTUFBTUcscUJBQXFCSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQixJQUFJO0FBRS9ELHFDQUFxQztBQUM5QixNQUFNQyxnQkFBZ0JQLG1FQUFZQSxDQUFDQyxhQUFhSSxvQkFBb0I7QUFFM0UsNkJBQTZCO0FBQzdCLE1BQU1HLGtCQUFrQk4sa09BQXlDLElBQUk7QUFDOUQsTUFBTVEsaUJBQWlCVixtRUFBWUEsQ0FBQ0MsYUFBYU8saUJBQWlCO0FBRXpFOzs7Q0FHQyxHQUNNLFNBQVNHO0lBQ2QsT0FBT0o7QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNLO0lBQ2QsT0FBT0Y7QUFDVDtBQUVBLHFCQUFxQjtBQUNkLGVBQWVHO0lBQ3BCLElBQUk7UUFDRixZQUFZO1FBQ1osSUFBSSxDQUFDWixhQUFhO1lBQ2hCLE1BQU0sSUFBSWEsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ1Qsb0JBQW9CO1lBQ3ZCLE1BQU0sSUFBSVMsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ04saUJBQWlCO1lBQ3BCLE1BQU0sSUFBSU0sTUFBTTtRQUNsQjtRQUVBLE9BQU87WUFDTEMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBTztZQUNMRixTQUFTO1lBQ1RDLFNBQVNDLGlCQUFpQkgsUUFBUUcsTUFBTUQsT0FBTyxHQUFHO1FBQ3BEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL2xpYi9zdXBhYmFzZS50cz8wNmUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcblxyXG4vLyBTdXBhYmFzZSBDbGllbnRcclxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJyc7XHJcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfS0VZIHx8ICcnO1xyXG5cclxuLy8g7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlZwg7YG065287J207Ja47Yq4ICjrsLHsl5Trk5wg7KCE7JqpKSAtIFJMUyDsmrDtmoxcclxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlQWRtaW4gPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSk7XHJcblxyXG4vLyDsnbXrqoUg7YKk66W8IOyCrOyaqe2VnCDtgbTrnbzsnbTslrjtirggKO2UhOuhoO2KuOyXlOuTnCDslYjsoIQpXHJcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICcnO1xyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VDbGllbnQgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcblxyXG4vKipcclxuICog67Cx7JeU65OcIEFQSeyXkOyEnCDsgqzsmqntlaAgU3VwYWJhc2Ug7YG065287J207Ja47Yq4IOyduOyKpO2EtOyKpOulvCDrsJjtmZjtlanri4jri6QuXHJcbiAqIFJMUyDsoJXssYXsnYQg7Jqw7ZqM7ZWgIOyImCDsnojripQg7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmVyU3VwYWJhc2UoKSB7XHJcbiAgcmV0dXJuIHN1cGFiYXNlQWRtaW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDruIzrnbzsmrDsoIDsl5DshJwg7IKs7Jqp7ZWgIFN1cGFiYXNlIO2BtOudvOydtOyWuO2KuCDsnbjsiqTthLTsiqTrpbwg67CY7ZmY7ZWp64uI64ukLlxyXG4gKiBSTFMg7KCV7LGF7J20IOyggeyaqeuQnCDsnbXrqoUg7YKk66W8IOyCrOyaqe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRTdXBhYmFzZSgpIHtcclxuICByZXR1cm4gc3VwYWJhc2VDbGllbnQ7XHJcbn1cclxuXHJcbi8vIFN1cGFiYXNlIOyXsOqysCDthYzsiqTtirgg7ZWo7IiYXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0U3VwYWJhc2VDb25uZWN0aW9uKCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDtmZjqsr0g67OA7IiY66eMIO2ZleyduFxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIFVSTOydtCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VTZXJ2aWNlS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7ISc67mE7IqkIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7J2166qFIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IFxyXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgbWVzc2FnZTogJ1N1cGFiYXNlIO2ZmOqyvSDrs4DsiJgg7ZmV7J24IOyZhOujjCwg66eI7J206re466CI7J207IWY7J2EIOynhO2Wie2VqeuLiOuLpC4nIFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU3VwYWJhc2Ug7Jew6rKwIO2FjOyKpO2KuCDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WYJyBcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX0tFWSIsInN1cGFiYXNlQWRtaW4iLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQ2xpZW50IiwiZ2V0U2VydmVyU3VwYWJhc2UiLCJnZXRDbGllbnRTdXBhYmFzZSIsInRlc3RTdXBhYmFzZUNvbm5lY3Rpb24iLCJFcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/chatgpt.ts":
/*!**********************************!*\
  !*** ./src/lib/utils/chatgpt.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseChatGPTLink: () => (/* binding */ parseChatGPTLink)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-action-proxy */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-proxy.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/next/dist/server/app-render/action-encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/types */ \"(rsc)/./src/types.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n// ÏÑúÎ≤Ñ Ï†ÑÏö© Ïª¥Ìè¨ÎÑåÌä∏/Ïú†Ìã∏ ÌëúÏãú\n/* __next_internal_action_entry_do_not_use__ {\"491c471e7f9b8d25a45396e01470b054e19a90ee\":\"parseChatGPTLink\"} */ \n\n// Playwright Í¥ÄÎ†® import Ï£ºÏÑù Ï≤òÎ¶¨\n// import { chromium, Browser, Page } from 'playwright';\n\n\n\n// PuppeteerÏôÄ Chromium Ï∂îÍ∞Ä - ÏÑúÎ≤Ñ ÏÇ¨Ïù¥ÎìúÏóêÏÑúÎßå Ïã§Ìñâ\n// @ts-ignore - @sparticuz/chromium Î™®Îìà ÌÉÄÏûÖ ÏÑ†Ïñ∏ Î¨∏Ï†ú Ìï¥Í≤∞\nconst puppeteer = __webpack_require__(/*! puppeteer-core */ \"puppeteer-core\");\n// @ts-ignore - ÌÉÄÏûÖ Ïò§Î•ò Î¨¥Ïãú\nconst chromium = __webpack_require__(/*! @sparticuz/chromium */ \"@sparticuz/chromium\");\n// ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï∏°ÏóêÏÑúÎäî Ïã§ÌñâÎêòÏßÄ ÏïäÎèÑÎ°ù Ìï®\nif (false) {}\n// Ïö¥ÏòÅÏ≤¥Ï†ú Í∞êÏßÄ\nconst isWindows = process.platform === \"win32\";\nconst isVercel = process.env.VERCEL === \"1\";\n/**\n * ÌôòÍ≤ΩÏóê ÎßûÎäî Chromium Ïã§Ìñâ Í≤ΩÎ°ú Í∞ÄÏ†∏Ïò§Í∏∞\n */ async function getChromiumPath() {\n    try {\n        // Windows ÌôòÍ≤ΩÏù∏ Í≤ΩÏö∞ Î°úÏª¨ÏóêÏÑú Chrome Ïã§Ìñâ ÏãúÎèÑ\n        if (isWindows) {\n            // Windows ÌôòÍ≤ΩÏóêÏÑúÎäî ÏÑ§ÏπòÎêú Chrome ÏÇ¨Ïö© ÏãúÎèÑ\n            const localChromePaths = [\n                \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                \"C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                process.env.LOCALAPPDATA + \"\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\"\n            ];\n            // Ï°¥Ïû¨ÌïòÎäî Chrome Í≤ΩÎ°ú Ï∞æÍ∏∞\n            for (const chromePath of localChromePaths){\n                if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(chromePath)) {\n                    console.log(`Using local Chrome at: ${chromePath}`);\n                    return chromePath;\n                }\n            }\n            console.log(\"No local Chrome installation found, using @sparticuz/chromium fallback\");\n        }\n        // @sparticuz/chromiumÏùò executablePath Ìï®ÏàòÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Î∞îÏù¥ÎÑàÎ¶¨ Í≤ΩÎ°ú Í∞ÄÏ†∏Ïò§Í∏∞\n        const execPath = await chromium.executablePath();\n        console.log(`Chromium executable path: ${execPath}`);\n        // WindowsÏóêÏÑú Î°úÏª¨ Ìè¥Îçî ÏÉùÏÑ±\n        if (isWindows) {\n            const localChromiumPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \".chromium\");\n            if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(localChromiumPath)) {\n                console.log(`Creating local Chromium directory: ${localChromiumPath}`);\n                fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(localChromiumPath, {\n                    recursive: true\n                });\n            }\n        }\n        // ÌååÏùºÏù¥ Ïã§Ï†úÎ°ú Ï°¥Ïû¨ÌïòÎäîÏßÄ ÌôïÏù∏\n        if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(execPath)) {\n            throw new Error(`Chromium executable not found at path: ${execPath}`);\n        }\n        return execPath;\n    } catch (error) {\n        console.error(\"Error getting Chromium path:\", error);\n        // Ïò§Î•ò Î∞úÏÉù Ïãú Î°úÏª¨ Chrome ÏãúÎèÑ\n        if (isWindows) {\n            const defaultChromePath = \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\";\n            if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(defaultChromePath)) {\n                console.log(`Fallback to local Chrome: ${defaultChromePath}`);\n                return defaultChromePath;\n            }\n        }\n        throw error;\n    }\n}\n/**\n * Ï£ºÏñ¥ÏßÑ ChatGPT ÎåÄÌôî URLÏóêÏÑú ÎåÄÌôî ÎÇ¥Ïö©Í≥º Ï†ÑÏ≤¥ ÌéòÏù¥ÏßÄ ÎÇ¥Ïö©ÏùÑ Ïä§ÌÅ¨ÎûòÌïëÌïòÎäî Ìï®Ïàò\n */ async function parseChatGPTLink(url) {\n    console.log(`Scraping ChatGPT conversation from URL: ${url}`);\n    // let browser: Browser | null = null;\n    let browser = null;\n    try {\n        // Î∏åÎùºÏö∞Ï†Ä Í≤ΩÎ°ú ÎîîÎ≤ÑÍπÖ Î°úÍ∑∏\n        console.log(\"=== Browser Path Debug Info ===\");\n        console.log(\"CHROMIUM_PATH:\", \"C:\\\\pmkProject\\\\.chromium\");\n        // Playwright ÏΩîÎìú Ï£ºÏÑù Ï≤òÎ¶¨\n        /*\n    // Í∞ÄÎä•Ìïú Ïã§Ìñâ ÌååÏùº Í≤ΩÎ°úÎì§\n    const possiblePaths = [\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/chrome-linux/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-win/chrome.exe`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium/chrome-linux/chrome`,\n      // Ubuntu 20.04 fallback Í≤ΩÎ°ú Ï∂îÍ∞Ä\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `/tmp/playwright/chromium-1169/chrome-linux/chrome`,\n      // Playwright Í≤ΩÎ°ú ÏûêÎèô Í∞êÏßÄ ÏãúÎèÑ\n      process.env.PLAYWRIGHT_BROWSERS_PATH ? undefined : 'chromium'\n    ].filter(Boolean);\n    \n    console.log('Checking possible executable paths:');\n    for (const path of possiblePaths) {\n      try {\n        const fs = require('fs');\n        const exists = fs.existsSync(path);\n        console.log(`- ${path}: ${exists ? 'EXISTS' : 'NOT FOUND'}`);\n      } catch (e) {\n        console.log(`- ${path}: ERROR checking path`);\n      }\n    }\n    \n    // Ï≤´ Î≤àÏß∏ Í≤ΩÎ°úÎ°ú ÏãúÎèÑ\n    let browserLaunchError = null;\n  \n    // Chromium Î∏åÎùºÏö∞Ï†Ä ÏãúÏûë (headless Î™®Îìú)\n    try {\n      console.log('Trying to launch browser with primary path...');\n      browser = await chromium.launch({\n        headless: true,  // Î∞±Í∑∏ÎùºÏö¥ÎìúÏóêÏÑú Ïã§Ìñâ\n        args: [\n          '--disable-web-security',\n          '--disable-features=IsolateOrigins,site-per-process',\n          '--no-sandbox',\n          '--disable-setuid-sandbox',\n          '--disable-dev-shm-usage'\n        ],\n        timeout: 60000, // 60Ï¥à ÌÉÄÏûÑÏïÑÏõÉ\n        // Ïã§Ìñâ ÌååÏùº Í≤ΩÎ°úÎäî Ïö∞ÏÑ† ÏßÄÏ†ïÌïòÏßÄ ÏïäÍ≥† PlaywrightÍ∞Ä ÏûêÎèô Í∞êÏßÄÌïòÎèÑÎ°ù Ìï®\n        executablePath: undefined\n      });\n      console.log('Browser launched successfully with primary path');\n    } catch (e) {\n      console.error('Failed to launch with default path:', e);\n      browserLaunchError = e;\n      \n      // ÏûêÎèô Í∞êÏßÄ Ïã§Ìå® Ïãú Îã§Î•∏ Í≤ΩÎ°ú ÏãúÎèÑ\n      for (let i = 0; i < possiblePaths.length; i++) {\n        try {\n          if (!possiblePaths[i]) continue; // undefined Í≤ΩÎ°ú Í±¥ÎÑàÎõ∞Í∏∞\n          \n          console.log(`Trying alternate path: ${possiblePaths[i]}`);\n          browser = await chromium.launch({\n            headless: true,\n            args: [\n              '--no-sandbox', \n              '--disable-setuid-sandbox',\n              '--disable-dev-shm-usage'\n            ],\n            timeout: 60000,\n            executablePath: possiblePaths[i]\n          });\n          console.log(`Browser launched successfully with alternate path: ${possiblePaths[i]}`);\n          browserLaunchError = null;\n          break;\n        } catch (err) {\n          console.error(`Failed with alternate path ${possiblePaths[i]}:`, err);\n        }\n      }\n      \n      // Î™®Îì† Í≤ΩÎ°ú Ïã§Ìå® Ïãú Î∏åÎùºÏö∞Ï†Ä Ïû¨ÏÑ§Ïπò ÏãúÎèÑ\n      if (browserLaunchError) {\n        console.log('Î™®Îì† Í≤ΩÎ°ú ÏãúÎèÑ Ïã§Ìå®, Î∏åÎùºÏö∞Ï†Ä Ïû¨ÏÑ§Ïπò ÏãúÎèÑ Ï§ë...');\n        try {\n          // Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ïπò ÏãúÎèÑ\n          const { execSync } = require('child_process');\n          execSync('npx playwright install chromium', { stdio: 'inherit' });\n          console.log('Chromium Ïû¨ÏÑ§Ïπò ÏôÑÎ£å, Îã§Ïãú ÏãúÎèÑÌï©ÎãàÎã§.');\n          \n          // ÏÑ§Ïπò ÌõÑ Î∏åÎùºÏö∞Ï†Ä Ïã§Ìñâ Ïû¨ÏãúÎèÑ\n          browser = await chromium.launch({\n            headless: true,\n            args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-dev-shm-usage'],\n            timeout: 60000\n          });\n          console.log('Î∏åÎùºÏö∞Ï†Ä ÏãúÏûë ÏÑ±Í≥µ (Ïû¨ÏÑ§Ïπò ÌõÑ)');\n          browserLaunchError = null;\n        } catch (installError) {\n          console.error('Î∏åÎùºÏö∞Ï†Ä Ïû¨ÏÑ§Ïπò Ïã§Ìå®:', installError);\n          throw new Error(`Î™®Îì† Î∏åÎùºÏö∞Ï†Ä Ïã§Ìñâ Í≤ΩÎ°ú ÏãúÎèÑ Ïã§Ìå® Î∞è Ïû¨ÏÑ§Ïπò Ïã§Ìå®: ${browserLaunchError instanceof Error ? browserLaunchError.message : String(browserLaunchError)}`);\n        }\n      }\n    }\n\n    // browserÍ∞Ä nullÏù∏ Í≤ΩÏö∞ Ï≤òÎ¶¨ (Î™®Îì† Ïã§Ìñâ Í≤ΩÎ°ú ÏãúÎèÑ ÌõÑÏóêÎèÑ Ïã§Ìå®Ìïú Í≤ΩÏö∞)\n    if (!browser) {\n      throw new Error('Î∏åÎùºÏö∞Ï†ÄÎ•º ÏãúÏûëÌï† Ïàò ÏóÜÏäµÎãàÎã§. Ïã§Ìñâ ÌååÏùº Í≤ΩÎ°úÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî.');\n    }\n    */ // puppeteer-core + @sparticuz/chromium ÏÇ¨Ïö©ÌïòÏó¨ Î∏åÎùºÏö∞Ï†Ä ÏãúÏûë\n        console.log(\"Launching browser with @sparticuz/chromium...\");\n        // ÌôòÍ≤ΩÏóê ÎßûÎäî Chromium Í≤ΩÎ°ú Í∞ÄÏ†∏Ïò§Í∏∞\n        const executablePath = await getChromiumPath();\n        console.log(`Using Chromium at: ${executablePath}`);\n        // Î∏åÎùºÏö∞Ï†Ä Ïã§Ìñâ ÏòµÏÖò\n        const options = {\n            args: chromium.args,\n            defaultViewport: chromium.defaultViewport,\n            executablePath,\n            headless: true,\n            ignoreHTTPSErrors: true\n        };\n        browser = await puppeteer.launch(options);\n        console.log(\"Browser launched successfully with @sparticuz/chromium\");\n        // ÌéòÏù¥ÏßÄ ÏÉùÏÑ±\n        const page = await browser.newPage();\n        // ÏÇ¨Ïö©Ïûê ÏóêÏù¥Ï†ÑÌä∏ ÏÑ§Ï†ï\n        await page.setUserAgent(\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\");\n        // ÌéòÏù¥ÏßÄ Î°úÎìú ÏãúÎèÑ (Ïó¨Îü¨ Î≤à ÏãúÎèÑ)\n        let maxRetries = 3;\n        let loaded = false;\n        for(let attempt = 1; attempt <= maxRetries; attempt++){\n            try {\n                console.log(`Loading page attempt ${attempt}/${maxRetries}...`);\n                // Î™®Îì† Î¶¨ÏÜåÏä§Î•º Î°úÎìúÌïòÎèÑÎ°ù ÏÑ§Ï†ï\n                await page.goto(url, {\n                    timeout: 30000,\n                    waitUntil: \"networkidle0\" // Î™®Îì† Î¶¨ÏÜåÏä§Í∞Ä Î°úÎìúÎê† ÎïåÍπåÏßÄ ÎåÄÍ∏∞\n                });\n                loaded = true;\n                break;\n            } catch (navigationError) {\n                console.error(`Navigation error on attempt ${attempt}:`, navigationError);\n                // ÎßàÏßÄÎßâ ÏãúÎèÑÍ∞Ä ÏïÑÎãàÎ©¥ Ïû†Ïãú ÎåÄÍ∏∞ ÌõÑ Ïû¨ÏãúÎèÑ\n                if (attempt < maxRetries) {\n                    await new Promise((resolve)=>setTimeout(resolve, 2000));\n                } else {\n                    throw new Error(`ÌéòÏù¥ÏßÄ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ${navigationError instanceof Error ? navigationError.message : String(navigationError)}`);\n                }\n            }\n        }\n        if (!loaded) {\n            throw new Error(\"ÌéòÏù¥ÏßÄ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\");\n        }\n        console.log(\"Page loaded successfully.\");\n        // Î°úÍ∑∏Ïù∏ ÌïÑÏöî Ïó¨Î∂Ä Í≤ÄÏÇ¨\n        if (url.includes(\"/share/\")) {\n            console.log(\"Shared URL detected, skipping login check\");\n        } else {\n            const isActualLoginPage = await page.evaluate(()=>{\n                return window.location.href.includes(\"/login\") || window.location.href.includes(\"auth0.openai.com\") || window.location.pathname === \"/auth/login\";\n            });\n            if (isActualLoginPage) {\n                console.log(\"Login page detected.\");\n                throw new Error(\"Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌïú ÌéòÏù¥ÏßÄÏûÖÎãàÎã§. ChatGPTÏóê Î°úÍ∑∏Ïù∏ ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.\");\n            }\n        }\n        // ÌéòÏù¥ÏßÄ ÎÇ¥Ïö©Ïù¥ Ï∂©Î∂ÑÌûà Î°úÎìúÎê† ÎïåÍπåÏßÄ Ï∂îÍ∞Ä ÎåÄÍ∏∞\n        await page.waitForTimeout(3000);\n        // Ïä§ÌÅ¨Î¶∞ÏÉ∑ Ï∫°Ï≤ò (ÎîîÎ≤ÑÍπÖÏö©)\n        await page.screenshot({\n            path: \"chatgpt-capture.png\"\n        });\n        console.log(\"Screenshot saved to chatgpt-capture.png\");\n        // Ï†ÑÏ≤¥ ÌéòÏù¥ÏßÄ HTML Í∞ÄÏ†∏Ïò§Í∏∞ - Î™®Îì† Íµ¨Ï°∞ Í∑∏ÎåÄÎ°ú Ïú†ÏßÄ\n        const rawHtml = await page.content();\n        // ÌéòÏù¥ÏßÄ ÌÖçÏä§Ìä∏ ÏΩòÌÖêÏ∏† Í∞ÄÏ†∏Ïò§Í∏∞\n        const rawText = await page.evaluate(()=>document.body.innerText);\n        // ÎåÄÌôî ÎÇ¥Ïö© Ï∂îÏ∂ú (Î©îÏãúÏßÄ Íµ¨Ï°∞Ìôî)\n        console.log(\"Extracting conversation data...\");\n        const conversationData = await extractConversationData(page);\n        // ÎåÄÌôî Í∞ùÏ≤¥ ÏÉùÏÑ±\n        const conversation = {\n            id: extractConversationId(url),\n            title: conversationData.title,\n            messages: conversationData.messages,\n            createdAt: new Date().toISOString(),\n            source: _types__WEBPACK_IMPORTED_MODULE_2__.ChatSource.CHATGPT,\n            metadata: conversationData.metadata\n        };\n        // Îπà ÎåÄÌôîÏù∏ÏßÄ ÌôïÏù∏\n        if (conversation.messages.length === 0) {\n            throw new Error(\"ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ Ï∂îÏ∂úÌï† Ïàò ÏóÜÏäµÎãàÎã§.\");\n        }\n        console.log(`Extracted conversation: \"${conversation.title}\" with ${conversation.messages.length} messages`);\n        return {\n            conversation,\n            rawHtml,\n            rawText\n        };\n    } catch (error) {\n        console.error(\"Error during conversation extraction:\", error);\n        throw error instanceof Error ? error : new Error(`ÎåÄÌôî Ï∂îÏ∂ú Ï§ë Ïò§Î•ò Î∞úÏÉù: ${String(error)}`);\n    } finally{\n        // Î∏åÎùºÏö∞Ï†Ä Ï¢ÖÎ£å - Î¶¨ÏÜåÏä§ Ï†ïÎ¶¨\n        if (browser) {\n            await browser.close();\n            console.log(\"Browser closed.\");\n        }\n    }\n}\n/**\n * URLÏóêÏÑú ÎåÄÌôî IDÎ•º Ï∂îÏ∂úÌïòÎäî Ìó¨Ìçº Ìï®Ïàò\n */ function extractConversationId(url) {\n    const urlSegments = url.split(\"/\");\n    const potentialId = urlSegments.pop() || \"\";\n    // IDÍ∞Ä Ïú†Ìö®ÌïúÏßÄ ÌôïÏù∏ (Í≥µÏú† URLÏùò ID ÌòïÏãùÏùÄ Îã§Î•º Ïàò ÏûàÏùå)\n    if (potentialId && potentialId.length > 5) {\n        return potentialId;\n    }\n    // ÎåÄÏ≤¥ ID ÏÉùÏÑ±\n    return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n// Playwright Page ÌÉÄÏûÖÏùÑ anyÎ°ú Î≥ÄÍ≤Ω\n// async function extractConversationData(page: Page): Promise<{\nasync function extractConversationData(page) {\n    return await page.evaluate(()=>{\n        console.log(\"Starting conversation extraction...\");\n        // Ï†úÎ™© Ï∂îÏ∂ú (Ïó¨Îü¨ Î∞©Î≤ï ÏãúÎèÑ)\n        let title = \"\";\n        // 1. h1 ÌÉúÍ∑∏ÏóêÏÑú Ï†úÎ™© Ï∞æÍ∏∞\n        const h1Element = document.querySelector(\"h1\");\n        if (h1Element && h1Element.textContent) {\n            title = h1Element.textContent.trim();\n        }\n        // 2. ÌéòÏù¥ÏßÄ ÌÉÄÏù¥ÌãÄÏóêÏÑú Ï†úÎ™© Ï∞æÍ∏∞\n        if (!title) {\n            const titleElement = document.querySelector(\"title\");\n            if (titleElement && titleElement.textContent) {\n                title = titleElement.textContent.replace(\" - ChatGPT\", \"\").replace(\" - OpenAI\", \"\").trim();\n            }\n        }\n        // 3. Î©îÌÉÄ Îç∞Ïù¥ÌÑ∞ÏóêÏÑú Ï†úÎ™© Ï∞æÍ∏∞\n        if (!title) {\n            const metaTitle = document.querySelector('meta[property=\"og:title\"]');\n            if (metaTitle) {\n                const content = metaTitle.getAttribute(\"content\");\n                if (content) {\n                    title = content.trim();\n                }\n            }\n        }\n        // Ï†úÎ™©ÏùÑ Ï∞æÏßÄ Î™ªÌïú Í≤ΩÏö∞ Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©\n        if (!title) {\n            title = \"ChatGPT Conversation \" + new Date().toLocaleString();\n        }\n        console.log(`Title extracted: ${title}`);\n        // ÌéòÏù¥ÏßÄ Ï†ÑÏ≤¥ÏóêÏÑú Î™®Îì† ÎåÄÌôî ÏöîÏÜå ÏßÅÏ†ë Ï∂îÏ∂ú ÏãúÎèÑ\n        // 1. assistant Î©îÏãúÏßÄ Ï∞æÍ∏∞\n        const assistantElements = document.querySelectorAll('[data-message-author-role=\"assistant\"]');\n        console.log(`[DEBUG] Found ${assistantElements.length} assistant elements by attribute`);\n        // 2. user Î©îÏãúÏßÄ Ï∞æÍ∏∞ (Ïó¨Îü¨ Î∞©Î≤ï ÏãúÎèÑ)\n        // Î™ÖÏãúÏ†ÅÏù∏ user Ïó≠Ìï† ÏÜçÏÑ± Ï∞æÍ∏∞\n        const userByAttrElements = document.querySelectorAll('[data-message-author-role=\"user\"]');\n        console.log(`[DEBUG] Found ${userByAttrElements.length} user elements by attribute`);\n        // ÎåÄÏïà: ÌäπÏ†ï ÌÅ¥ÎûòÏä§ÏôÄ ÏúÑÏπòÎ°ú user Î©îÏãúÏßÄ Ï∂îÎ°†\n        let userElements = [];\n        // ÎåÄÌôî Î©îÏãúÏßÄÎ•º Ï†ÄÏû•Ìï† Î∞∞Ïó¥\n        let messages = [];\n        if (userByAttrElements.length === 0) {\n            // Ïó¨Îü¨ Í∞ÄÎä•Ìïú ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄ Ïª®ÌÖåÏù¥ÎÑà ÏÑ†ÌÉùÏûê ÏãúÎèÑ\n            for (const selector of [\n                \".whitespace-pre-wrap:not([data-message-author-role])\",\n                \".text-message:not([data-message-author-role])\",\n                '.chat-message[role=\"user\"]',\n                \".chat-message-user\",\n                \".message-user\",\n                \".human-message\"\n            ]){\n                const candidates = document.querySelectorAll(selector);\n                console.log(`[DEBUG] Found ${candidates.length} potential user elements with selector: ${selector}`);\n                if (candidates.length > 0) {\n                    userElements = Array.from(candidates);\n                    break;\n                }\n            }\n        } else {\n            userElements = Array.from(userByAttrElements);\n        }\n        console.log(`[DEBUG] Total user elements: ${userElements.length}`);\n        // ÎåÄÌôî ÏàòÏßë\n        if (assistantElements.length > 0 && userElements.length > 0) {\n            // HTML Íµ¨Ï°∞ÏóêÏÑú Î™®Îì† ÎåÄÌôî ÏöîÏÜå ÏàòÏßë Î∞è ÏàúÏÑú Í≤∞Ï†ï\n            const conversationElements = [];\n            // Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏ Î©îÏãúÏßÄ Ï∂îÍ∞Ä\n            Array.from(assistantElements).forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"assistant\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄ Ï∂îÍ∞Ä\n            userElements.forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"user\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // DOM ÏàúÏÑúÎåÄÎ°ú Ï†ïÎ†¨\n            conversationElements.sort((a, b)=>a.position - b.position);\n            console.log(`[DEBUG] Sorted conversation elements: ${conversationElements.length}`);\n            console.log(`[DEBUG] First few roles: ${conversationElements.slice(0, 3).map((e)=>e.role).join(\", \")}`);\n            // Ï†ïÎ†¨Îêú ÏöîÏÜåÏóêÏÑú ÎåÄÌôî ÎÇ¥Ïö© Ï∂îÏ∂ú\n            const extractedMessages = [];\n            for (const item of conversationElements){\n                const content = item.element.textContent?.trim() || \"\";\n                if (content && content.length > 0) {\n                    // ÏùºÎ∂Ä UI ÏöîÏÜå Ï†úÏô∏\n                    if (!content.includes(\"Skip to content\") && !content.includes(\"Log in\") && !content.includes(\"Sign up\")) {\n                        extractedMessages.push({\n                            role: item.role,\n                            content\n                        });\n                    }\n                }\n            }\n            console.log(`[DEBUG] Extracted ${extractedMessages.length} messages`);\n            if (extractedMessages.length > 0) {\n                console.log(`[DEBUG] First message role: ${extractedMessages[0].role}`);\n                console.log(`[DEBUG] First message preview: ${extractedMessages[0].content.substring(0, 30)}...`);\n            }\n            // ÏµúÏÜåÌïú ÌïòÎÇòÏùò ÏÇ¨Ïö©ÏûêÏôÄ Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏ Î©îÏãúÏßÄÍ∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏\n            const hasUser = extractedMessages.some((m)=>m.role === \"user\");\n            const hasAssistant = extractedMessages.some((m)=>m.role === \"assistant\");\n            if (hasUser && hasAssistant && extractedMessages.length >= 2) {\n                console.log(`[DEBUG] Found valid conversation with ${extractedMessages.length} messages`);\n                messages = extractedMessages;\n            } else {\n                console.log(`[DEBUG] Extracted messages don't form a valid conversation (user: ${hasUser}, assistant: ${hasAssistant})`);\n            }\n        }\n        // ÌéòÏù¥ÏßÄÏóêÏÑú ÏöîÏÜåÏùò ÏúÑÏπòÎ•º Í≤∞Ï†ïÌïòÎäî Ìï®Ïàò\n        function getPositionInDocument(element) {\n            // ÏöîÏÜåÏùò Î∂ÄÎ™®Îì§ÏùÑ Î™®Îëê Ï∞æÏïÑÏÑú ÍπäÏù¥ Í≥ÑÏÇ∞\n            let depth = 0;\n            let parent = element.parentElement;\n            while(parent){\n                depth++;\n                parent = parent.parentElement;\n            }\n            // DOMÏóêÏÑúÏùò ÏàúÏÑúÎ•º Í≥ÑÏÇ∞ (ÌòïÏ†ú ÏöîÏÜå Ï§ë ÏúÑÏπò)\n            let siblingPosition = 0;\n            let sibling = element.previousElementSibling;\n            while(sibling){\n                siblingPosition++;\n                sibling = sibling.previousElementSibling;\n            }\n            // ÏöîÏÜåÏùò ÎåÄÎûµÏ†ÅÏù∏ Y ÏúÑÏπòÎ•º Î∞òÌôò (if available)\n            const rect = element.getBoundingClientRect();\n            const yPosition = rect ? rect.top : 0;\n            // ÍπäÏù¥, ÌòïÏ†ú ÏúÑÏπò, YÏúÑÏπòÎ•º Ï°∞Ìï©ÌïòÏó¨ ÏµúÏ¢Ö ÏúÑÏπò Î∞òÌôò\n            return yPosition + siblingPosition * 10000 + depth * 1000000;\n        }\n        // Î©îÏãúÏßÄÍ∞Ä ÏóÜÏúºÎ©¥ Í∏∞Î≥∏ Ïò§Î•ò Î©îÏãúÏßÄ Ï∂îÍ∞Ä\n        if (messages.length === 0) {\n            // ÏµúÌõÑÏùò Î∞©Î≤ï: ÌéòÏù¥ÏßÄÏóêÏÑú Ïù¥Ï†Ñ/Îã§Ïùå Î©îÏãúÏßÄ Ìå®ÌÑ¥ Ï∞æÍ∏∞\n            try {\n                // ÏùºÎ∞òÏ†ÅÏù∏ ÏÇ¨Ïö©Ïûê ÏûÖÎ†• Ìå®ÌÑ¥ (ÏµúÏÜå 3Í∞ú Ïù¥ÏÉÅÏùò Îã®Ïñ¥Î•º Í∞ÄÏßÑ Î¨∏Îã®)\n                const potentialUserMessages = Array.from(document.querySelectorAll(\"p, div, span\")).map((el)=>el.textContent?.trim() || \"\").filter((text)=>text && text.split(\" \").length >= 3 && text.length > 20).filter((text)=>!text.includes(\"ChatGPT\") && !text.includes(\"Log in\") && !text.includes(\"Sign up\"));\n                if (potentialUserMessages.length > 0) {\n                    // Ï≤´ Î≤àÏß∏ Î©îÏãúÏßÄÎ•º ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄÎ°ú Ï∂îÍ∞Ä\n                    const userMessage = potentialUserMessages[0];\n                    messages.push({\n                        role: \"user\",\n                        content: userMessage\n                    });\n                    // ÎÇòÎ®∏ÏßÄ ÌÖçÏä§Ìä∏Î•º Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏ ÏùëÎãµÏúºÎ°ú Ï∂îÍ∞Ä\n                    const remainingText = document.body.innerText.replace(title, \"\").replace(userMessage, \"\").replace(/Log in|Sign up|Attach|Search|Reason|Voice|By messaging ChatGPT|Skip to content|ChatGPT/g, \"\").replace(/window\\.__oai_.*?;/g, \"\").trim();\n                    if (remainingText.length > 0) {\n                        messages.push({\n                            role: \"assistant\",\n                            content: remainingText\n                        });\n                    }\n                } else {\n                    messages.push({\n                        role: \"assistant\",\n                        content: \"ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ Ï∂îÏ∂úÌï† Ïàò ÏóÜÏäµÎãàÎã§. ChatGPT Í≥µÏú† ÎßÅÌÅ¨Í∞Ä Ïú†Ìö®ÌïúÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.\"\n                    });\n                }\n            } catch (error) {\n                messages.push({\n                    role: \"assistant\",\n                    content: \"ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ Ï∂îÏ∂úÌï† Ïàò ÏóÜÏäµÎãàÎã§. ChatGPT Í≥µÏú† ÎßÅÌÅ¨Í∞Ä Ïú†Ìö®ÌïúÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.\"\n                });\n            }\n        }\n        // ÎåÄÌôîÌòï Íµ¨Ï°∞ ÌôïÏù∏ - Î®ºÏ†Ä Ïú†Ï†Ä Î©îÏãúÏßÄÎ°ú ÏãúÏûëÌïòÎäîÏßÄ ÌôïÏù∏\n        if (messages.length > 0 && messages[0].role !== \"user\") {\n            // ChatGPT ÎåÄÌôîÎäî Ìï≠ÏÉÅ ÏÇ¨Ïö©Ïûê ÏßàÎ¨∏ÏúºÎ°ú ÏãúÏûëÌï¥Ïïº Ìï®\n            // ÎåÄÌôîÍ∞Ä Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏Î°ú ÏãúÏûëÌïòÎ©¥ Ï≤´ Î©îÏãúÏßÄÎ•º ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄÎ°ú Î≥ÄÍ≤Ω\n            console.log(\"Ï≤´ Î©îÏãúÏßÄÍ∞Ä ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄÍ∞Ä ÏïÑÎãôÎãàÎã§. ÎåÄÌôî Íµ¨Ï°∞Î•º ÏàòÏ†ïÌï©ÎãàÎã§.\");\n            // ÏÉà ÎåÄÌôî Íµ¨Ï°∞ ÏÉùÏÑ±\n            const alternatingMessages = [];\n            // Ï≤´ Î≤àÏß∏ Î©îÏãúÏßÄÍ∞Ä assistantÏù∏ Í≤ΩÏö∞, Í∞ÄÏßú user Î©îÏãúÏßÄÎ•º Ï∂îÍ∞ÄÌïòÍ≥† ÏãúÏûë\n            alternatingMessages.push({\n                role: \"user\",\n                content: \"ÎåÄÌôîÎ•º ÏãúÏûëÌï©ÎãàÎã§.\"\n            });\n            // Í∏∞Ï°¥ Î©îÏãúÏßÄ Î≥µÏÇ¨\n            messages.forEach((msg)=>{\n                alternatingMessages.push(msg);\n            });\n            // ÏàòÏ†ïÎêú Î©îÏãúÏßÄÎ°ú ÍµêÏ≤¥\n            messages = alternatingMessages;\n        }\n        // Ïò¨Î∞îÎ•∏ ÎåÄÌôî Íµ¨Ï°∞ ÌôïÏù∏ (userÏôÄ assistantÍ∞Ä Î≤àÍ∞àÏïÑ ÎÇòÌÉÄÎÇòÏïº Ìï®)\n        const correctedMessages = [];\n        let expectedRole = \"user\"; // ÎåÄÌôîÎäî userÎ°ú ÏãúÏûëÌï¥Ïïº Ìï®\n        messages.forEach((msg, index)=>{\n            if (index === 0 && msg.role !== \"user\") {\n                // Ï≤´ Î©îÏãúÏßÄÎäî Ìï≠ÏÉÅ ÏÇ¨Ïö©ÏûêÏó¨Ïïº Ìï®\n                correctedMessages.push({\n                    role: \"user\",\n                    content: \"ÎåÄÌôîÎ•º ÏãúÏûëÌï©ÎãàÎã§.\"\n                });\n                expectedRole = \"assistant\";\n            }\n            if (msg.role === expectedRole) {\n                // Ïó≠Ìï†Ïù¥ ÏòàÏÉÅÎåÄÎ°úÏù∏ Í≤ΩÏö∞ Í∑∏ÎåÄÎ°ú Ï∂îÍ∞Ä\n                correctedMessages.push(msg);\n                // Îã§Ïùå ÏòàÏÉÅ Ïó≠Ìï† Ï†ÑÌôò\n                expectedRole = expectedRole === \"user\" ? \"assistant\" : \"user\";\n            } else {\n                // Í∞ôÏùÄ Ïó≠Ìï†Ïù¥ Ïó∞ÏÜçÏúºÎ°ú ÎÇòÌÉÄÎÇòÎäî Í≤ΩÏö∞, Îπà Î©îÏãúÏßÄÎ•º Ï§ëÍ∞ÑÏóê ÏÇΩÏûÖ\n                if (expectedRole === \"user\") {\n                    correctedMessages.push({\n                        role: \"user\",\n                        content: \"(Í≥ÑÏÜç)\"\n                    });\n                } else {\n                    correctedMessages.push({\n                        role: \"assistant\",\n                        content: \"(Í≥ÑÏÜç)\"\n                    });\n                }\n                // ÌòÑÏû¨ Î©îÏãúÏßÄ Ï∂îÍ∞Ä\n                correctedMessages.push(msg);\n                // Îã§Ïùå ÏòàÏÉÅ Ïó≠Ìï† ÏÑ§Ï†ï\n                expectedRole = msg.role === \"user\" ? \"assistant\" : \"user\";\n            }\n        });\n        // ÏàòÏ†ïÎêú Î©îÏãúÏßÄÎ°ú ÍµêÏ≤¥\n        messages = correctedMessages;\n        // GPT-4 Î™®Îç∏Ïù∏ÏßÄ ÌôïÏù∏\n        const isGPT4 = document.body.innerText.includes(\"GPT-4\") || document.body.innerText.includes(\"gpt-4\") || document.querySelector('img[alt*=\"GPT-4\"]') !== null;\n        return {\n            title,\n            messages,\n            metadata: {\n                date: new Date().toISOString(),\n                model: isGPT4 ? \"gpt-4\" : \"gpt-3.5-turbo\",\n                tags: []\n            }\n        };\n    });\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    parseChatGPTLink\n]);\n(0,private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__.createActionProxy)(\"491c471e7f9b8d25a45396e01470b054e19a90ee\", parseChatGPTLink);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxJQUFJLENBQUNpQztnQkFDdkIsY0FBYztnQkFDZEUsZUFBZUYsSUFBSS9CLElBQUksS0FBSyxTQUFTLGNBQWM7WUFDckQ7UUFDRjtRQUVBLGNBQWM7UUFDZHhDLFdBQVd3RTtRQUVULGdCQUFnQjtRQUNoQixNQUFNRyxTQUFTcEYsU0FBU0MsSUFBSSxDQUFDQyxTQUFTLENBQUNkLFFBQVEsQ0FBQyxZQUNsQ1ksU0FBU0MsSUFBSSxDQUFDQyxTQUFTLENBQUNkLFFBQVEsQ0FBQyxZQUNqQ1ksU0FBUzRCLGFBQWEsQ0FBQyx5QkFBeUI7UUFFOUQsT0FBTztZQUNMcEI7WUFDQUM7WUFDQU0sVUFBVTtnQkFDUnNFLE1BQU0sSUFBSTFFLE9BQU9DLFdBQVc7Z0JBQzVCMEUsT0FBT0YsU0FBUyxVQUFVO2dCQUMxQkcsTUFBTSxFQUFFO1lBQ1Y7UUFDRjtJQUNKO0FBU0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8uL3NyYy9saWIvdXRpbHMvY2hhdGdwdC50cz9kZmUxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOyEnOuyhCDsoITsmqkg7Lu07Y+s64SM7Yq4L+ycoO2LuCDtkZzsi5xcbid1c2Ugc2VydmVyJztcblxuLy8gUGxheXdyaWdodCDqtIDroKggaW1wb3J0IOyjvOyEnSDsspjrpqxcbi8vIGltcG9ydCB7IGNocm9taXVtLCBCcm93c2VyLCBQYWdlIH0gZnJvbSAncGxheXdyaWdodCc7XG5pbXBvcnQgeyBDb252ZXJzYXRpb24sIENoYXRNZXNzYWdlLCBDaGF0U291cmNlIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5cbi8vIFB1cHBldGVlcuyZgCBDaHJvbWl1bSDstpTqsIAgLSDshJzrsoQg7IKs7J2065Oc7JeQ7ISc66eMIOyLpO2WiVxuLy8gQHRzLWlnbm9yZSAtIEBzcGFydGljdXovY2hyb21pdW0g66qo65OIIO2DgOyehSDshKDslrgg66y47KCcIO2VtOqysFxuY29uc3QgcHVwcGV0ZWVyID0gcmVxdWlyZSgncHVwcGV0ZWVyLWNvcmUnKTtcbi8vIEB0cy1pZ25vcmUgLSDtg4DsnoUg7Jik66WYIOustOyLnFxuY29uc3QgY2hyb21pdW0gPSByZXF1aXJlKCdAc3BhcnRpY3V6L2Nocm9taXVtJyk7XG5cbi8vIO2BtOudvOydtOyWuO2KuCDsuKHsl5DshJzripQg7Iuk7ZaJ65CY7KeAIOyViuuPhOuhnSDtlahcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbW9kdWxlIGlzIHNlcnZlci1zaWRlIG9ubHknKTtcbn1cblxuLy8g7Jq07JiB7LK07KCcIOqwkOyngFxuY29uc3QgaXNXaW5kb3dzID0gcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJztcbmNvbnN0IGlzVmVyY2VsID0gcHJvY2Vzcy5lbnYuVkVSQ0VMID09PSAnMSc7XG5cbi8qKlxuICog7ZmY6rK97JeQIOunnuuKlCBDaHJvbWl1bSDsi6Ttlokg6rK966GcIOqwgOyguOyYpOq4sFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRDaHJvbWl1bVBhdGgoKSB7XG4gIHRyeSB7XG4gICAgLy8gV2luZG93cyDtmZjqsr3snbgg6rK97JqwIOuhnOy7rOyXkOyEnCBDaHJvbWUg7Iuk7ZaJIOyLnOuPhFxuICAgIGlmIChpc1dpbmRvd3MpIHtcbiAgICAgIC8vIFdpbmRvd3Mg7ZmY6rK97JeQ7ISc64qUIOyEpOy5mOuQnCBDaHJvbWUg7IKs7JqpIOyLnOuPhFxuICAgICAgY29uc3QgbG9jYWxDaHJvbWVQYXRocyA9IFtcbiAgICAgICAgJ0M6XFxcXFByb2dyYW0gRmlsZXNcXFxcR29vZ2xlXFxcXENocm9tZVxcXFxBcHBsaWNhdGlvblxcXFxjaHJvbWUuZXhlJyxcbiAgICAgICAgJ0M6XFxcXFByb2dyYW0gRmlsZXMgKHg4NilcXFxcR29vZ2xlXFxcXENocm9tZVxcXFxBcHBsaWNhdGlvblxcXFxjaHJvbWUuZXhlJyxcbiAgICAgICAgcHJvY2Vzcy5lbnYuTE9DQUxBUFBEQVRBICsgJ1xcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnLFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgLy8g7KG07J6s7ZWY64qUIENocm9tZSDqsr3roZwg7LC+6riwXG4gICAgICBmb3IgKGNvbnN0IGNocm9tZVBhdGggb2YgbG9jYWxDaHJvbWVQYXRocykge1xuICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhjaHJvbWVQYXRoKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBsb2NhbCBDaHJvbWUgYXQ6ICR7Y2hyb21lUGF0aH1gKTtcbiAgICAgICAgICByZXR1cm4gY2hyb21lUGF0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnTm8gbG9jYWwgQ2hyb21lIGluc3RhbGxhdGlvbiBmb3VuZCwgdXNpbmcgQHNwYXJ0aWN1ei9jaHJvbWl1bSBmYWxsYmFjaycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBAc3BhcnRpY3V6L2Nocm9taXVt7J2YIGV4ZWN1dGFibGVQYXRoIO2VqOyImOulvCDsgqzsmqntlZjsl6wg67CU7J2064SI66asIOqyveuhnCDqsIDsoLjsmKTquLBcbiAgICBjb25zdCBleGVjUGF0aCA9IGF3YWl0IGNocm9taXVtLmV4ZWN1dGFibGVQYXRoKCk7XG4gICAgY29uc29sZS5sb2coYENocm9taXVtIGV4ZWN1dGFibGUgcGF0aDogJHtleGVjUGF0aH1gKTtcbiAgICBcbiAgICAvLyBXaW5kb3dz7JeQ7IScIOuhnOy7rCDtj7TrjZQg7IOd7ISxXG4gICAgaWYgKGlzV2luZG93cykge1xuICAgICAgY29uc3QgbG9jYWxDaHJvbWl1bVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJy5jaHJvbWl1bScpO1xuICAgICAgaWYgKCFmcy5leGlzdHNTeW5jKGxvY2FsQ2hyb21pdW1QYXRoKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgQ3JlYXRpbmcgbG9jYWwgQ2hyb21pdW0gZGlyZWN0b3J5OiAke2xvY2FsQ2hyb21pdW1QYXRofWApO1xuICAgICAgICBmcy5ta2RpclN5bmMobG9jYWxDaHJvbWl1bVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDtjIzsnbzsnbQg7Iuk7KCc66GcIOyhtOyerO2VmOuKlOyngCDtmZXsnbhcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZXhlY1BhdGgpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENocm9taXVtIGV4ZWN1dGFibGUgbm90IGZvdW5kIGF0IHBhdGg6ICR7ZXhlY1BhdGh9YCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBleGVjUGF0aDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIENocm9taXVtIHBhdGg6JywgZXJyb3IpO1xuICAgIFxuICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOuhnOy7rCBDaHJvbWUg7Iuc64+EXG4gICAgaWYgKGlzV2luZG93cykge1xuICAgICAgY29uc3QgZGVmYXVsdENocm9tZVBhdGggPSAnQzpcXFxcUHJvZ3JhbSBGaWxlc1xcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnO1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZGVmYXVsdENocm9tZVBhdGgpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBGYWxsYmFjayB0byBsb2NhbCBDaHJvbWU6ICR7ZGVmYXVsdENocm9tZVBhdGh9YCk7XG4gICAgICAgIHJldHVybiBkZWZhdWx0Q2hyb21lUGF0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiDso7zslrTsp4QgQ2hhdEdQVCDrjIDtmZQgVVJM7JeQ7IScIOuMgO2ZlCDrgrTsmqnqs7wg7KCE7LK0IO2OmOydtOyngCDrgrTsmqnsnYQg7Iqk7YGs656Y7ZWR7ZWY64qUIO2VqOyImFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGFyc2VDaGF0R1BUTGluayh1cmw6IHN0cmluZyk6IFByb21pc2U8eyBcbiAgY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb247IFxuICByYXdIdG1sOiBzdHJpbmc7IFxuICByYXdUZXh0OiBzdHJpbmc7XG59PiB7XG4gIGNvbnNvbGUubG9nKGBTY3JhcGluZyBDaGF0R1BUIGNvbnZlcnNhdGlvbiBmcm9tIFVSTDogJHt1cmx9YCk7XG4gIFxuICAvLyBsZXQgYnJvd3NlcjogQnJvd3NlciB8IG51bGwgPSBudWxsO1xuICBsZXQgYnJvd3NlcjogYW55ID0gbnVsbDtcbiAgXG4gIHRyeSB7XG4gICAgLy8g67iM65287Jqw7KCAIOqyveuhnCDrlJTrsoTquYUg66Gc6re4XG4gICAgY29uc29sZS5sb2coJz09PSBCcm93c2VyIFBhdGggRGVidWcgSW5mbyA9PT0nKTtcbiAgICBjb25zb2xlLmxvZygnQ0hST01JVU1fUEFUSDonLCBwcm9jZXNzLmVudi5DSFJPTUlVTV9QQVRIKTtcbiAgICBcbiAgICAvLyBQbGF5d3JpZ2h0IOy9lOuTnCDso7zshJ0g7LKY66asXG4gICAgLypcbiAgICAvLyDqsIDriqXtlZwg7Iuk7ZaJIO2MjOydvCDqsr3roZzrk6RcbiAgICBjb25zdCBwb3NzaWJsZVBhdGhzID0gW1xuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bV9oZWFkbGVzc19zaGVsbC0xMTY5L2hlYWRsZXNzX3NoZWxsYCxcbiAgICAgIGAke3Byb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSH0vY2hyb21pdW1faGVhZGxlc3Nfc2hlbGwtMTE2OS9jaHJvbWUtbGludXgvaGVhZGxlc3Nfc2hlbGxgLFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bS0xMTY5L2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bS0xMTY5L2Nocm9tZS13aW4vY2hyb21lLmV4ZWAsXG4gICAgICBgJHtwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEh9L2Nocm9taXVtL2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgLy8gVWJ1bnR1IDIwLjA0IGZhbGxiYWNrIOqyveuhnCDstpTqsIBcbiAgICAgIGAke3Byb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSH0vY2hyb21pdW0tMTE2OS9jaHJvbWUtbGludXgvY2hyb21lYCxcbiAgICAgIGAvdG1wL3BsYXl3cmlnaHQvY2hyb21pdW0tMTE2OS9jaHJvbWUtbGludXgvY2hyb21lYCxcbiAgICAgIC8vIFBsYXl3cmlnaHQg6rK966GcIOyekOuPmSDqsJDsp4Ag7Iuc64+EXG4gICAgICBwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEggPyB1bmRlZmluZWQgOiAnY2hyb21pdW0nXG4gICAgXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NoZWNraW5nIHBvc3NpYmxlIGV4ZWN1dGFibGUgcGF0aHM6Jyk7XG4gICAgZm9yIChjb25zdCBwYXRoIG9mIHBvc3NpYmxlUGF0aHMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgICAgICAgY29uc3QgZXhpc3RzID0gZnMuZXhpc3RzU3luYyhwYXRoKTtcbiAgICAgICAgY29uc29sZS5sb2coYC0gJHtwYXRofTogJHtleGlzdHMgPyAnRVhJU1RTJyA6ICdOT1QgRk9VTkQnfWApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgLSAke3BhdGh9OiBFUlJPUiBjaGVja2luZyBwYXRoYCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOyyqyDrsojsp7gg6rK966Gc66GcIOyLnOuPhFxuICAgIGxldCBicm93c2VyTGF1bmNoRXJyb3IgPSBudWxsO1xuICBcbiAgICAvLyBDaHJvbWl1bSDruIzrnbzsmrDsoIAg7Iuc7J6RIChoZWFkbGVzcyDrqqjrk5wpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdUcnlpbmcgdG8gbGF1bmNoIGJyb3dzZXIgd2l0aCBwcmltYXJ5IHBhdGguLi4nKTtcbiAgICAgIGJyb3dzZXIgPSBhd2FpdCBjaHJvbWl1bS5sYXVuY2goe1xuICAgICAgICBoZWFkbGVzczogdHJ1ZSwgIC8vIOuwseq3uOudvOyatOuTnOyXkOyEnCDsi6TtlolcbiAgICAgICAgYXJnczogW1xuICAgICAgICAgICctLWRpc2FibGUtd2ViLXNlY3VyaXR5JyxcbiAgICAgICAgICAnLS1kaXNhYmxlLWZlYXR1cmVzPUlzb2xhdGVPcmlnaW5zLHNpdGUtcGVyLXByb2Nlc3MnLFxuICAgICAgICAgICctLW5vLXNhbmRib3gnLFxuICAgICAgICAgICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLFxuICAgICAgICAgICctLWRpc2FibGUtZGV2LXNobS11c2FnZSdcbiAgICAgICAgXSxcbiAgICAgICAgdGltZW91dDogNjAwMDAsIC8vIDYw7LSIIO2DgOyehOyVhOybg1xuICAgICAgICAvLyDsi6Ttlokg7YyM7J28IOqyveuhnOuKlCDsmrDshKAg7KeA7KCV7ZWY7KeAIOyViuqzoCBQbGF5d3JpZ2h06rCAIOyekOuPmSDqsJDsp4DtlZjrj4TroZ0g7ZWoXG4gICAgICAgIGV4ZWN1dGFibGVQYXRoOiB1bmRlZmluZWRcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coJ0Jyb3dzZXIgbGF1bmNoZWQgc3VjY2Vzc2Z1bGx5IHdpdGggcHJpbWFyeSBwYXRoJyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxhdW5jaCB3aXRoIGRlZmF1bHQgcGF0aDonLCBlKTtcbiAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IGU7XG4gICAgICBcbiAgICAgIC8vIOyekOuPmSDqsJDsp4Ag7Iuk7YyoIOyLnCDri6Trpbgg6rK966GcIOyLnOuPhFxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKCFwb3NzaWJsZVBhdGhzW2ldKSBjb250aW51ZTsgLy8gdW5kZWZpbmVkIOqyveuhnCDqsbTrhIjrm7DquLBcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zb2xlLmxvZyhgVHJ5aW5nIGFsdGVybmF0ZSBwYXRoOiAke3Bvc3NpYmxlUGF0aHNbaV19YCk7XG4gICAgICAgICAgYnJvd3NlciA9IGF3YWl0IGNocm9taXVtLmxhdW5jaCh7XG4gICAgICAgICAgICBoZWFkbGVzczogdHJ1ZSxcbiAgICAgICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICAgICAgJy0tbm8tc2FuZGJveCcsIFxuICAgICAgICAgICAgICAnLS1kaXNhYmxlLXNldHVpZC1zYW5kYm94JyxcbiAgICAgICAgICAgICAgJy0tZGlzYWJsZS1kZXYtc2htLXVzYWdlJ1xuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwLFxuICAgICAgICAgICAgZXhlY3V0YWJsZVBhdGg6IHBvc3NpYmxlUGF0aHNbaV1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQnJvd3NlciBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBhbHRlcm5hdGUgcGF0aDogJHtwb3NzaWJsZVBhdGhzW2ldfWApO1xuICAgICAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IG51bGw7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB3aXRoIGFsdGVybmF0ZSBwYXRoICR7cG9zc2libGVQYXRoc1tpXX06YCwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDrqqjrk6Ag6rK966GcIOyLpO2MqCDsi5wg67iM65287Jqw7KCAIOyerOyEpOy5mCDsi5zrj4RcbiAgICAgIGlmIChicm93c2VyTGF1bmNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+uqqOuToCDqsr3roZwg7Iuc64+EIOyLpO2MqCwg67iM65287Jqw7KCAIOyerOyEpOy5mCDsi5zrj4Qg7KSRLi4uJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g67iM65287Jqw7KCAIOyEpOy5mCDsi5zrj4RcbiAgICAgICAgICBjb25zdCB7IGV4ZWNTeW5jIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG4gICAgICAgICAgZXhlY1N5bmMoJ25weCBwbGF5d3JpZ2h0IGluc3RhbGwgY2hyb21pdW0nLCB7IHN0ZGlvOiAnaW5oZXJpdCcgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Nocm9taXVtIOyerOyEpOy5mCDsmYTro4wsIOuLpOyLnCDsi5zrj4Ttlanri4jri6QuJyk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8g7ISk7LmYIO2bhCDruIzrnbzsmrDsoIAg7Iuk7ZaJIOyerOyLnOuPhFxuICAgICAgICAgIGJyb3dzZXIgPSBhd2FpdCBjaHJvbWl1bS5sYXVuY2goe1xuICAgICAgICAgICAgaGVhZGxlc3M6IHRydWUsXG4gICAgICAgICAgICBhcmdzOiBbJy0tbm8tc2FuZGJveCcsICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLCAnLS1kaXNhYmxlLWRldi1zaG0tdXNhZ2UnXSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+u4jOudvOyasOyggCDsi5zsnpEg7ISx6rO1ICjsnqzshKTsuZgg7ZuEKScpO1xuICAgICAgICAgIGJyb3dzZXJMYXVuY2hFcnJvciA9IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGluc3RhbGxFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+u4jOudvOyasOyggCDsnqzshKTsuZgg7Iuk7YyoOicsIGluc3RhbGxFcnJvcik7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDrqqjrk6Ag67iM65287Jqw7KCAIOyLpO2WiSDqsr3roZwg7Iuc64+EIOyLpO2MqCDrsI8g7J6s7ISk7LmYIOyLpO2MqDogJHticm93c2VyTGF1bmNoRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGJyb3dzZXJMYXVuY2hFcnJvci5tZXNzYWdlIDogU3RyaW5nKGJyb3dzZXJMYXVuY2hFcnJvcil9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBicm93c2Vy6rCAIG51bGzsnbgg6rK97JqwIOyymOumrCAo66qo65OgIOyLpO2WiSDqsr3roZwg7Iuc64+EIO2bhOyXkOuPhCDsi6TtjKjtlZwg6rK97JqwKVxuICAgIGlmICghYnJvd3Nlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfruIzrnbzsmrDsoIDrpbwg7Iuc7J6R7ZWgIOyImCDsl4bsirXri4jri6QuIOyLpO2WiSDtjIzsnbwg6rK966Gc66W8IO2ZleyduO2VmOyEuOyalC4nKTtcbiAgICB9XG4gICAgKi9cblxuICAgIC8vIHB1cHBldGVlci1jb3JlICsgQHNwYXJ0aWN1ei9jaHJvbWl1bSDsgqzsmqntlZjsl6wg67iM65287Jqw7KCAIOyLnOyekVxuICAgIGNvbnNvbGUubG9nKCdMYXVuY2hpbmcgYnJvd3NlciB3aXRoIEBzcGFydGljdXovY2hyb21pdW0uLi4nKTtcbiAgICBcbiAgICAvLyDtmZjqsr3sl5Ag66ee64qUIENocm9taXVtIOqyveuhnCDqsIDsoLjsmKTquLBcbiAgICBjb25zdCBleGVjdXRhYmxlUGF0aCA9IGF3YWl0IGdldENocm9taXVtUGF0aCgpO1xuICAgIGNvbnNvbGUubG9nKGBVc2luZyBDaHJvbWl1bSBhdDogJHtleGVjdXRhYmxlUGF0aH1gKTtcbiAgICBcbiAgICAvLyDruIzrnbzsmrDsoIAg7Iuk7ZaJIOyYteyFmFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBhcmdzOiBjaHJvbWl1bS5hcmdzLFxuICAgICAgZGVmYXVsdFZpZXdwb3J0OiBjaHJvbWl1bS5kZWZhdWx0Vmlld3BvcnQsXG4gICAgICBleGVjdXRhYmxlUGF0aCxcbiAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgaWdub3JlSFRUUFNFcnJvcnM6IHRydWUsXG4gICAgfTtcbiAgICBcbiAgICBicm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyLmxhdW5jaChvcHRpb25zKTtcbiAgICBjb25zb2xlLmxvZygnQnJvd3NlciBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBAc3BhcnRpY3V6L2Nocm9taXVtJyk7XG5cbiAgICAvLyDtjpjsnbTsp4Ag7IOd7ISxXG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuICAgIFxuICAgIC8vIOyCrOyaqeyekCDsl5DsnbTsoITtirgg7ISk7KCVXG4gICAgYXdhaXQgcGFnZS5zZXRVc2VyQWdlbnQoJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMjAuMC4wLjAgU2FmYXJpLzUzNy4zNicpO1xuICAgIFxuICAgIC8vIO2OmOydtOyngCDroZzrk5wg7Iuc64+EICjsl6zrn6wg67KIIOyLnOuPhClcbiAgICBsZXQgbWF4UmV0cmllcyA9IDM7XG4gICAgbGV0IGxvYWRlZCA9IGZhbHNlO1xuICAgIFxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgcGFnZSBhdHRlbXB0ICR7YXR0ZW1wdH0vJHttYXhSZXRyaWVzfS4uLmApO1xuICAgICAgICAvLyDrqqjrk6Ag66as7IaM7Iqk66W8IOuhnOuTnO2VmOuPhOuhnSDshKTsoJVcbiAgICAgICAgYXdhaXQgcGFnZS5nb3RvKHVybCwgeyBcbiAgICAgICAgICB0aW1lb3V0OiAzMDAwMCwgXG4gICAgICAgICAgd2FpdFVudGlsOiAnbmV0d29ya2lkbGUwJyAvLyDrqqjrk6Ag66as7IaM7Iqk6rCAIOuhnOuTnOuQoCDrlYzquYzsp4Ag64yA6riwXG4gICAgICAgIH0pO1xuICAgICAgICBsb2FkZWQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gY2F0Y2ggKG5hdmlnYXRpb25FcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBOYXZpZ2F0aW9uIGVycm9yIG9uIGF0dGVtcHQgJHthdHRlbXB0fTpgLCBuYXZpZ2F0aW9uRXJyb3IpO1xuICAgICAgICBcbiAgICAgICAgLy8g66eI7KeA66eJIOyLnOuPhOqwgCDslYTri4jrqbQg7J6g7IucIOuMgOq4sCDtm4Qg7J6s7Iuc64+EXG4gICAgICAgIGlmIChhdHRlbXB0IDwgbWF4UmV0cmllcykge1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDtjpjsnbTsp4Ag66Gc65Oc7JeQIOyLpO2MqO2WiOyKteuLiOuLpDogJHtuYXZpZ2F0aW9uRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IG5hdmlnYXRpb25FcnJvci5tZXNzYWdlIDogU3RyaW5nKG5hdmlnYXRpb25FcnJvcil9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWxvYWRlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCftjpjsnbTsp4Ag66Gc65Oc7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnUGFnZSBsb2FkZWQgc3VjY2Vzc2Z1bGx5LicpO1xuICAgIFxuICAgIC8vIOuhnOq3uOyduCDtlYTsmpQg7Jes67aAIOqygOyCrFxuICAgIGlmICh1cmwuaW5jbHVkZXMoJy9zaGFyZS8nKSkge1xuICAgICAgY29uc29sZS5sb2coJ1NoYXJlZCBVUkwgZGV0ZWN0ZWQsIHNraXBwaW5nIGxvZ2luIGNoZWNrJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGlzQWN0dWFsTG9naW5QYWdlID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnL2xvZ2luJykgfHwgXG4gICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygnYXV0aDAub3BlbmFpLmNvbScpIHx8XG4gICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvYXV0aC9sb2dpbic7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKGlzQWN0dWFsTG9naW5QYWdlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdMb2dpbiBwYWdlIGRldGVjdGVkLicpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+uhnOq3uOyduOydtCDtlYTsmpTtlZwg7Y6Y7J207KeA7J6F64uI64ukLiBDaGF0R1BU7JeQIOuhnOq3uOyduCDtm4Qg64uk7IucIOyLnOuPhO2VtOyjvOyEuOyalC4nKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7Y6Y7J207KeAIOuCtOyaqeydtCDstqnrtoTtnogg66Gc65Oc65CgIOuVjOq5jOyngCDstpTqsIAg64yA6riwXG4gICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCgzMDAwKTtcbiAgICBcbiAgICAvLyDsiqTtgazrprDsg7cg7Lqh7LKYICjrlJTrsoTquYXsmqkpXG4gICAgYXdhaXQgcGFnZS5zY3JlZW5zaG90KHsgcGF0aDogJ2NoYXRncHQtY2FwdHVyZS5wbmcnIH0pO1xuICAgIGNvbnNvbGUubG9nKCdTY3JlZW5zaG90IHNhdmVkIHRvIGNoYXRncHQtY2FwdHVyZS5wbmcnKTtcbiAgICBcbiAgICAvLyDsoITssrQg7Y6Y7J207KeAIEhUTUwg6rCA7KC47Jik6riwIC0g66qo65OgIOq1rOyhsCDqt7jrjIDroZwg7Jyg7KeAXG4gICAgY29uc3QgcmF3SHRtbCA9IGF3YWl0IHBhZ2UuY29udGVudCgpO1xuICAgIFxuICAgIC8vIO2OmOydtOyngCDthY3siqTtirgg7L2Y7YWQ7LigIOqwgOyguOyYpOq4sFxuICAgIGNvbnN0IHJhd1RleHQgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0KTtcblxuICAgIC8vIOuMgO2ZlCDrgrTsmqkg7LaU7LacICjrqZTsi5zsp4Ag6rWs7KGw7ZmUKVxuICAgIGNvbnNvbGUubG9nKCdFeHRyYWN0aW5nIGNvbnZlcnNhdGlvbiBkYXRhLi4uJyk7XG4gICAgY29uc3QgY29udmVyc2F0aW9uRGF0YSA9IGF3YWl0IGV4dHJhY3RDb252ZXJzYXRpb25EYXRhKHBhZ2UpO1xuXG4gICAgLy8g64yA7ZmUIOqwneyytCDsg53shLFcbiAgICBjb25zdCBjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbiA9IHtcbiAgICAgIGlkOiBleHRyYWN0Q29udmVyc2F0aW9uSWQodXJsKSxcbiAgICAgIHRpdGxlOiBjb252ZXJzYXRpb25EYXRhLnRpdGxlLFxuICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbkRhdGEubWVzc2FnZXMgYXMgQ2hhdE1lc3NhZ2VbXSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgc291cmNlOiBDaGF0U291cmNlLkNIQVRHUFQsXG4gICAgICBtZXRhZGF0YTogY29udmVyc2F0aW9uRGF0YS5tZXRhZGF0YVxuICAgIH07XG5cbiAgICAvLyDruYgg64yA7ZmU7J247KeAIO2ZleyduFxuICAgIGlmIChjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+uMgO2ZlCDrgrTsmqnsnYQg7LaU7Lac7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYEV4dHJhY3RlZCBjb252ZXJzYXRpb246IFwiJHtjb252ZXJzYXRpb24udGl0bGV9XCIgd2l0aCAke2NvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGh9IG1lc3NhZ2VzYCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udmVyc2F0aW9uLFxuICAgICAgcmF3SHRtbCxcbiAgICAgIHJhd1RleHRcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBjb252ZXJzYXRpb24gZXh0cmFjdGlvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciBcbiAgICAgID8gZXJyb3IgXG4gICAgICA6IG5ldyBFcnJvcihg64yA7ZmUIOy2lOy2nCDspJEg7Jik66WYIOuwnOyDnTogJHtTdHJpbmcoZXJyb3IpfWApO1xuICB9IGZpbmFsbHkge1xuICAgIC8vIOu4jOudvOyasOyggCDsooXro4wgLSDrpqzshozsiqQg7KCV66asXG4gICAgaWYgKGJyb3dzZXIpIHtcbiAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcbiAgICAgIGNvbnNvbGUubG9nKCdCcm93c2VyIGNsb3NlZC4nKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBVUkzsl5DshJwg64yA7ZmUIElE66W8IOy2lOy2nO2VmOuKlCDtl6ztjbwg7ZWo7IiYXG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RDb252ZXJzYXRpb25JZCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHVybFNlZ21lbnRzID0gdXJsLnNwbGl0KCcvJyk7XG4gIGNvbnN0IHBvdGVudGlhbElkID0gdXJsU2VnbWVudHMucG9wKCkgfHwgJyc7XG4gIFxuICAvLyBJROqwgCDsnKDtmqjtlZzsp4Ag7ZmV7J24ICjqs7XsnKAgVVJM7J2YIElEIO2YleyLneydgCDri6Trpbwg7IiYIOyeiOydjClcbiAgaWYgKHBvdGVudGlhbElkICYmIHBvdGVudGlhbElkLmxlbmd0aCA+IDUpIHtcbiAgICByZXR1cm4gcG90ZW50aWFsSWQ7XG4gIH1cbiAgXG4gIC8vIOuMgOyytCBJRCDsg53shLFcbiAgcmV0dXJuIGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpfWA7XG59XG5cbi8vIFBsYXl3cmlnaHQgUGFnZSDtg4DsnoXsnYQgYW5566GcIOuzgOqyvVxuLy8gYXN5bmMgZnVuY3Rpb24gZXh0cmFjdENvbnZlcnNhdGlvbkRhdGEocGFnZTogUGFnZSk6IFByb21pc2U8e1xuYXN5bmMgZnVuY3Rpb24gZXh0cmFjdENvbnZlcnNhdGlvbkRhdGEocGFnZTogYW55KTogUHJvbWlzZTx7XG4gIHRpdGxlOiBzdHJpbmc7IFxuICBtZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT47IFxuICBtZXRhZGF0YTogeyBcbiAgICBkYXRlOiBzdHJpbmc7IFxuICAgIG1vZGVsOiBzdHJpbmc7IFxuICAgIHRhZ3M6IHN0cmluZ1tdOyBcbiAgfTsgXG59PiB7XG4gIHJldHVybiBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnU3RhcnRpbmcgY29udmVyc2F0aW9uIGV4dHJhY3Rpb24uLi4nKTtcbiAgICAgIFxuICAgICAgLy8g7KCc66qpIOy2lOy2nCAo7Jes65+sIOuwqeuylSDsi5zrj4QpXG4gICAgICBsZXQgdGl0bGUgPSAnJztcbiAgICAgIFxuICAgICAgLy8gMS4gaDEg7YOc6re47JeQ7IScIOygnOuqqSDssL7quLBcbiAgICAgIGNvbnN0IGgxRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gxJyk7XG4gICAgICBpZiAoaDFFbGVtZW50ICYmIGgxRWxlbWVudC50ZXh0Q29udGVudCkge1xuICAgICAgICB0aXRsZSA9IGgxRWxlbWVudC50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIDIuIO2OmOydtOyngCDtg4DsnbTti4Dsl5DshJwg7KCc66qpIOywvuq4sFxuICAgICAgaWYgKCF0aXRsZSkge1xuICAgICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0aXRsZScpO1xuICAgICAgICBpZiAodGl0bGVFbGVtZW50ICYmIHRpdGxlRWxlbWVudC50ZXh0Q29udGVudCkge1xuICAgICAgICAgIHRpdGxlID0gdGl0bGVFbGVtZW50LnRleHRDb250ZW50XG4gICAgICAgICAgICAucmVwbGFjZSgnIC0gQ2hhdEdQVCcsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoJyAtIE9wZW5BSScsICcnKVxuICAgICAgICAgICAgLnRyaW0oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyAzLiDrqZTtg4Ag642w7J207YSw7JeQ7IScIOygnOuqqSDssL7quLBcbiAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgY29uc3QgbWV0YVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtwcm9wZXJ0eT1cIm9nOnRpdGxlXCJdJyk7XG4gICAgICAgIGlmIChtZXRhVGl0bGUpIHtcbiAgICAgICAgICBjb25zdCBjb250ZW50ID0gbWV0YVRpdGxlLmdldEF0dHJpYnV0ZSgnY29udGVudCcpO1xuICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICB0aXRsZSA9IGNvbnRlbnQudHJpbSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDsoJzrqqnsnYQg7LC+7KeAIOuqu+2VnCDqsr3smrAg6riw67O46rCSIOyCrOyaqVxuICAgICAgaWYgKCF0aXRsZSkge1xuICAgICAgdGl0bGUgPSAnQ2hhdEdQVCBDb252ZXJzYXRpb24gJyArIG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFRpdGxlIGV4dHJhY3RlZDogJHt0aXRsZX1gKTtcbiAgICAgIFxuICAgIC8vIO2OmOydtOyngCDsoITssrTsl5DshJwg66qo65OgIOuMgO2ZlCDsmpTshowg7KeB7KCRIOy2lOy2nCDsi5zrj4RcbiAgICAvLyAxLiBhc3Npc3RhbnQg66mU7Iuc7KeAIOywvuq4sFxuICAgIGNvbnN0IGFzc2lzdGFudEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbWVzc2FnZS1hdXRob3Itcm9sZT1cImFzc2lzdGFudFwiXScpO1xuICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZvdW5kICR7YXNzaXN0YW50RWxlbWVudHMubGVuZ3RofSBhc3Npc3RhbnQgZWxlbWVudHMgYnkgYXR0cmlidXRlYCk7XG4gICAgXG4gICAgLy8gMi4gdXNlciDrqZTsi5zsp4Ag7LC+6riwICjsl6zrn6wg67Cp67KVIOyLnOuPhClcbiAgICAvLyDrqoXsi5zsoIHsnbggdXNlciDsl63tlaAg7IaN7ISxIOywvuq4sFxuICAgIGNvbnN0IHVzZXJCeUF0dHJFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lc3NhZ2UtYXV0aG9yLXJvbGU9XCJ1c2VyXCJdJyk7XG4gICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHt1c2VyQnlBdHRyRWxlbWVudHMubGVuZ3RofSB1c2VyIGVsZW1lbnRzIGJ5IGF0dHJpYnV0ZWApO1xuICAgIFxuICAgIC8vIOuMgOyViDog7Yq57KCVIO2BtOuemOyKpOyZgCDsnITsuZjroZwgdXNlciDrqZTsi5zsp4Ag7LaU66GgXG4gICAgbGV0IHVzZXJFbGVtZW50czogRWxlbWVudFtdID0gW107XG4gICAgXG4gICAgLy8g64yA7ZmUIOuplOyLnOyngOulvCDsoIDsnqXtlaAg67Cw7Je0XG4gICAgbGV0IG1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgIFxuICAgIGlmICh1c2VyQnlBdHRyRWxlbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyDsl6zrn6wg6rCA64ql7ZWcIOyCrOyaqeyekCDrqZTsi5zsp4Ag7Luo7YWM7J2064SIIOyEoO2DneyekCDsi5zrj4RcbiAgICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgW1xuICAgICAgICAnLndoaXRlc3BhY2UtcHJlLXdyYXA6bm90KFtkYXRhLW1lc3NhZ2UtYXV0aG9yLXJvbGVdKScsIFxuICAgICAgICAnLnRleHQtbWVzc2FnZTpub3QoW2RhdGEtbWVzc2FnZS1hdXRob3Itcm9sZV0pJyxcbiAgICAgICAgJy5jaGF0LW1lc3NhZ2Vbcm9sZT1cInVzZXJcIl0nLFxuICAgICAgICAnLmNoYXQtbWVzc2FnZS11c2VyJyxcbiAgICAgICAgJy5tZXNzYWdlLXVzZXInLFxuICAgICAgICAnLmh1bWFuLW1lc3NhZ2UnXG4gICAgICBdKSB7XG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHtjYW5kaWRhdGVzLmxlbmd0aH0gcG90ZW50aWFsIHVzZXIgZWxlbWVudHMgd2l0aCBzZWxlY3RvcjogJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB1c2VyRWxlbWVudHMgPSBBcnJheS5mcm9tKGNhbmRpZGF0ZXMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHVzZXJFbGVtZW50cyA9IEFycmF5LmZyb20odXNlckJ5QXR0ckVsZW1lbnRzKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYFtERUJVR10gVG90YWwgdXNlciBlbGVtZW50czogJHt1c2VyRWxlbWVudHMubGVuZ3RofWApO1xuICAgIFxuICAgIC8vIOuMgO2ZlCDsiJjsp5FcbiAgICBpZiAoYXNzaXN0YW50RWxlbWVudHMubGVuZ3RoID4gMCAmJiB1c2VyRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gSFRNTCDqtazsobDsl5DshJwg66qo65OgIOuMgO2ZlCDsmpTshowg7IiY7KeRIOuwjyDsiJzshJwg6rKw7KCVXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25FbGVtZW50czogQXJyYXk8e1xuICAgICAgICBlbGVtZW50OiBFbGVtZW50O1xuICAgICAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgICAgICAgcG9zaXRpb246IG51bWJlcjtcbiAgICAgIH0+ID0gW107XG4gICAgICBcbiAgICAgIC8vIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICBBcnJheS5mcm9tKGFzc2lzdGFudEVsZW1lbnRzKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgcG9zaXRpb246IGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbClcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g7IKs7Jqp7J6QIOuplOyLnOyngCDstpTqsIBcbiAgICAgIHVzZXJFbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIHBvc2l0aW9uOiBnZXRQb3NpdGlvbkluRG9jdW1lbnQoZWwpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIERPTSDsiJzshJzrjIDroZwg7KCV66CsXG4gICAgICBjb252ZXJzYXRpb25FbGVtZW50cy5zb3J0KChhLCBiKSA9PiBhLnBvc2l0aW9uIC0gYi5wb3NpdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIFNvcnRlZCBjb252ZXJzYXRpb24gZWxlbWVudHM6ICR7Y29udmVyc2F0aW9uRWxlbWVudHMubGVuZ3RofWApO1xuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgZmV3IHJvbGVzOiAke2NvbnZlcnNhdGlvbkVsZW1lbnRzLnNsaWNlKDAsIDMpLm1hcChlID0+IGUucm9sZSkuam9pbignLCAnKX1gKTtcbiAgICAgIFxuICAgICAgLy8g7KCV66Cs65CcIOyalOyGjOyXkOyEnCDrjIDtmZQg64K07JqpIOy2lOy2nFxuICAgICAgY29uc3QgZXh0cmFjdGVkTWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY29udmVyc2F0aW9uRWxlbWVudHMpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGl0ZW0uZWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xuICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyDsnbzrtoAgVUkg7JqU7IaMIOygnOyZuFxuICAgICAgICAgIGlmICghY29udGVudC5pbmNsdWRlcygnU2tpcCB0byBjb250ZW50JykgJiYgXG4gICAgICAgICAgICAgICFjb250ZW50LmluY2x1ZGVzKCdMb2cgaW4nKSAmJiBcbiAgICAgICAgICAgICAgIWNvbnRlbnQuaW5jbHVkZXMoJ1NpZ24gdXAnKSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHRyYWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgcm9sZTogaXRlbS5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRXh0cmFjdGVkICR7ZXh0cmFjdGVkTWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlc2ApO1xuICAgICAgaWYgKGV4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgbWVzc2FnZSByb2xlOiAke2V4dHJhY3RlZE1lc3NhZ2VzWzBdLnJvbGV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZpcnN0IG1lc3NhZ2UgcHJldmlldzogJHtleHRyYWN0ZWRNZXNzYWdlc1swXS5jb250ZW50LnN1YnN0cmluZygwLCAzMCl9Li4uYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOy1nOyGjO2VnCDtlZjrgpjsnZgg7IKs7Jqp7J6Q7JmAIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4DqsIAg7J6I64qU7KeAIO2ZleyduFxuICAgICAgY29uc3QgaGFzVXNlciA9IGV4dHJhY3RlZE1lc3NhZ2VzLnNvbWUobSA9PiBtLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgICBjb25zdCBoYXNBc3Npc3RhbnQgPSBleHRyYWN0ZWRNZXNzYWdlcy5zb21lKG0gPT4gbS5yb2xlID09PSAnYXNzaXN0YW50Jyk7XG4gICAgICBcbiAgICAgIGlmIChoYXNVc2VyICYmIGhhc0Fzc2lzdGFudCAmJiBleHRyYWN0ZWRNZXNzYWdlcy5sZW5ndGggPj0gMikge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGb3VuZCB2YWxpZCBjb252ZXJzYXRpb24gd2l0aCAke2V4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXNgKTtcbiAgICAgICAgbWVzc2FnZXMgPSBleHRyYWN0ZWRNZXNzYWdlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEV4dHJhY3RlZCBtZXNzYWdlcyBkb24ndCBmb3JtIGEgdmFsaWQgY29udmVyc2F0aW9uICh1c2VyOiAke2hhc1VzZXJ9LCBhc3Npc3RhbnQ6ICR7aGFzQXNzaXN0YW50fSlgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7Y6Y7J207KeA7JeQ7IScIOyalOyGjOydmCDsnITsuZjrpbwg6rKw7KCV7ZWY64qUIO2VqOyImFxuICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbGVtZW50OiBFbGVtZW50KTogbnVtYmVyIHtcbiAgICAgIC8vIOyalOyGjOydmCDrtoDrqqjrk6TsnYQg66qo65GQIOywvuyVhOyEnCDquYrsnbQg6rOE7IKwXG4gICAgICBsZXQgZGVwdGggPSAwO1xuICAgICAgbGV0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgZGVwdGgrKztcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIERPTeyXkOyEnOydmCDsiJzshJzrpbwg6rOE7IKwICjtmJXsoJwg7JqU7IaMIOykkSDsnITsuZgpXG4gICAgICBsZXQgc2libGluZ1Bvc2l0aW9uID0gMDtcbiAgICAgIGxldCBzaWJsaW5nID0gZWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgd2hpbGUgKHNpYmxpbmcpIHtcbiAgICAgICAgc2libGluZ1Bvc2l0aW9uKys7XG4gICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOyalOyGjOydmCDrjIDrnrXsoIHsnbggWSDsnITsuZjrpbwg67CY7ZmYIChpZiBhdmFpbGFibGUpXG4gICAgICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHlQb3NpdGlvbiA9IHJlY3QgPyByZWN0LnRvcCA6IDA7XG4gICAgICBcbiAgICAgIC8vIOq5iuydtCwg7ZiV7KCcIOychOy5mCwgWeychOy5mOulvCDsobDtlantlZjsl6wg7LWc7KKFIOychOy5mCDrsJjtmZhcbiAgICAgIHJldHVybiB5UG9zaXRpb24gKyAoc2libGluZ1Bvc2l0aW9uICogMTAwMDApICsgKGRlcHRoICogMTAwMDAwMCk7XG4gICAgfVxuICAgIFxuICAgIC8vIOuplOyLnOyngOqwgCDsl4bsnLzrqbQg6riw67O4IOyYpOulmCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyDstZztm4TsnZgg67Cp67KVOiDtjpjsnbTsp4Dsl5DshJwg7J207KCEL+uLpOydjCDrqZTsi5zsp4Ag7Yyo7YS0IOywvuq4sFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8g7J2867CY7KCB7J24IOyCrOyaqeyekCDsnoXroKUg7Yyo7YS0ICjstZzshowgM+qwnCDsnbTsg4HsnZgg64uo7Ja066W8IOqwgOynhCDrrLjri6gpXG4gICAgICAgIGNvbnN0IHBvdGVudGlhbFVzZXJNZXNzYWdlcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgncCwgZGl2LCBzcGFuJykpXG4gICAgICAgICAgLm1hcChlbCA9PiBlbC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnKVxuICAgICAgICAgIC5maWx0ZXIodGV4dCA9PiB0ZXh0ICYmIHRleHQuc3BsaXQoJyAnKS5sZW5ndGggPj0gMyAmJiB0ZXh0Lmxlbmd0aCA+IDIwKVxuICAgICAgICAgIC5maWx0ZXIodGV4dCA9PiAhdGV4dC5pbmNsdWRlcygnQ2hhdEdQVCcpICYmICF0ZXh0LmluY2x1ZGVzKCdMb2cgaW4nKSAmJiAhdGV4dC5pbmNsdWRlcygnU2lnbiB1cCcpKTtcbiAgICAgICAgICBcbiAgICAgICAgaWYgKHBvdGVudGlhbFVzZXJNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8g7LKrIOuyiOynuCDrqZTsi5zsp4Drpbwg7IKs7Jqp7J6QIOuplOyLnOyngOuhnCDstpTqsIBcbiAgICAgICAgICBjb25zdCB1c2VyTWVzc2FnZSA9IHBvdGVudGlhbFVzZXJNZXNzYWdlc1swXTtcbiAgICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHVzZXJNZXNzYWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8g64KY66i47KeAIO2FjeyKpO2KuOulvCDslrTsi5zsiqTthLTtirgg7J2R64u17Jy866GcIOy2lOqwgFxuICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1RleHQgPSBkb2N1bWVudC5ib2R5LmlubmVyVGV4dFxuICAgICAgICAgICAgLnJlcGxhY2UodGl0bGUsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UodXNlck1lc3NhZ2UsICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL0xvZyBpbnxTaWduIHVwfEF0dGFjaHxTZWFyY2h8UmVhc29ufFZvaWNlfEJ5IG1lc3NhZ2luZyBDaGF0R1BUfFNraXAgdG8gY29udGVudHxDaGF0R1BUL2csICcnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL3dpbmRvd1xcLl9fb2FpXy4qPzsvZywgJycpXG4gICAgICAgICAgLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgICAgaWYgKHJlbWFpbmluZ1RleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgICBjb250ZW50OiByZW1haW5pbmdUZXh0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWVzc2FnZXMucHVzaCh7IFxuICAgICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICBjb250ZW50OiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4gQ2hhdEdQVCDqs7XsnKAg66eB7YGs6rCAIOycoO2aqO2VnOyngCDtmZXsnbjtlbTso7zshLjsmpQuJyBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbWVzc2FnZXMucHVzaCh7IFxuICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLCBcbiAgICAgICAgICBjb250ZW50OiAn64yA7ZmUIOuCtOyaqeydhCDstpTstpztlaAg7IiYIOyXhuyKteuLiOuLpC4gQ2hhdEdQVCDqs7XsnKAg66eB7YGs6rCAIOycoO2aqO2VnOyngCDtmZXsnbjtlbTso7zshLjsmpQuJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOuMgO2ZlO2YlSDqtazsobAg7ZmV7J24IC0g66i87KCAIOycoOyggCDrqZTsi5zsp4DroZwg7Iuc7J6R7ZWY64qU7KeAIO2ZleyduFxuICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPiAwICYmIG1lc3NhZ2VzWzBdLnJvbGUgIT09ICd1c2VyJykge1xuICAgICAgLy8gQ2hhdEdQVCDrjIDtmZTripQg7ZWt7IOBIOyCrOyaqeyekCDsp4jrrLjsnLzroZwg7Iuc7J6R7ZW07JW8IO2VqFxuICAgICAgLy8g64yA7ZmU6rCAIOyWtOyLnOyKpO2EtO2KuOuhnCDsi5zsnpHtlZjrqbQg7LKrIOuplOyLnOyngOulvCDsgqzsmqnsnpAg66mU7Iuc7KeA66GcIOuzgOqyvVxuICAgICAgY29uc29sZS5sb2coJ+yyqyDrqZTsi5zsp4DqsIAg7IKs7Jqp7J6QIOuplOyLnOyngOqwgCDslYTri5nri4jri6QuIOuMgO2ZlCDqtazsobDrpbwg7IiY7KCV7ZWp64uI64ukLicpO1xuICAgICAgXG4gICAgICAvLyDsg4gg64yA7ZmUIOq1rOyhsCDsg53shLFcbiAgICAgIGNvbnN0IGFsdGVybmF0aW5nTWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJzsgY29udGVudDogc3RyaW5nIH0+ID0gW107XG4gICAgICBcbiAgICAgIC8vIOyyqyDrsojsp7gg66mU7Iuc7KeA6rCAIGFzc2lzdGFudOyduCDqsr3smrAsIOqwgOynnCB1c2VyIOuplOyLnOyngOulvCDstpTqsIDtlZjqs6Ag7Iuc7J6RXG4gICAgICBhbHRlcm5hdGluZ01lc3NhZ2VzLnB1c2goe1xuICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgIGNvbnRlbnQ6ICfrjIDtmZTrpbwg7Iuc7J6R7ZWp64uI64ukLidcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyDquLDsobQg66mU7Iuc7KeAIOuzteyCrFxuICAgICAgbWVzc2FnZXMuZm9yRWFjaChtc2cgPT4ge1xuICAgICAgICBhbHRlcm5hdGluZ01lc3NhZ2VzLnB1c2gobXNnKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyDsiJjsoJXrkJwg66mU7Iuc7KeA66GcIOq1kOyytFxuICAgICAgbWVzc2FnZXMgPSBhbHRlcm5hdGluZ01lc3NhZ2VzO1xuICAgIH1cbiAgICBcbiAgICAvLyDsmKzrsJTrpbgg64yA7ZmUIOq1rOyhsCDtmZXsnbggKHVzZXLsmYAgYXNzaXN0YW506rCAIOuyiOqwiOyVhCDrgpjtg4Drgpjslbwg7ZWoKVxuICAgIGNvbnN0IGNvcnJlY3RlZE1lc3NhZ2VzOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgIGxldCBleHBlY3RlZFJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnID0gJ3VzZXInOyAvLyDrjIDtmZTripQgdXNlcuuhnCDsi5zsnpHtlbTslbwg7ZWoXG4gICAgXG4gICAgbWVzc2FnZXMuZm9yRWFjaCgobXNnLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGluZGV4ID09PSAwICYmIG1zZy5yb2xlICE9PSAndXNlcicpIHtcbiAgICAgICAgLy8g7LKrIOuplOyLnOyngOuKlCDtla3sg4Eg7IKs7Jqp7J6Q7Jes7JW8IO2VqFxuICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY29udGVudDogJ+uMgO2ZlOulvCDsi5zsnpHtlanri4jri6QuJ1xuICAgICAgICB9KTtcbiAgICAgICAgZXhwZWN0ZWRSb2xlID0gJ2Fzc2lzdGFudCc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChtc2cucm9sZSA9PT0gZXhwZWN0ZWRSb2xlKSB7XG4gICAgICAgIC8vIOyXre2VoOydtCDsmIjsg4HrjIDroZzsnbgg6rK97JqwIOq3uOuMgOuhnCDstpTqsIBcbiAgICAgICAgY29ycmVjdGVkTWVzc2FnZXMucHVzaChtc2cpO1xuICAgICAgICAvLyDri6TsnYwg7JiI7IOBIOyXre2VoCDsoITtmZhcbiAgICAgICAgZXhwZWN0ZWRSb2xlID0gZXhwZWN0ZWRSb2xlID09PSAndXNlcicgPyAnYXNzaXN0YW50JyA6ICd1c2VyJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOqwmeydgCDsl63tlaDsnbQg7Jew7IaN7Jy866GcIOuCmO2DgOuCmOuKlCDqsr3smrAsIOu5iCDrqZTsi5zsp4Drpbwg7KSR6rCE7JeQIOyCveyehVxuICAgICAgICBpZiAoZXhwZWN0ZWRSb2xlID09PSAndXNlcicpIHtcbiAgICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICco6rOE7IaNKSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgY29udGVudDogJyjqs4Tsho0pJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIO2YhOyerCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICAgIGNvcnJlY3RlZE1lc3NhZ2VzLnB1c2gobXNnKTtcbiAgICAgICAgLy8g64uk7J2MIOyYiOyDgSDsl63tlaAg7ISk7KCVXG4gICAgICAgIGV4cGVjdGVkUm9sZSA9IG1zZy5yb2xlID09PSAndXNlcicgPyAnYXNzaXN0YW50JyA6ICd1c2VyJztcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICAvLyDsiJjsoJXrkJwg66mU7Iuc7KeA66GcIOq1kOyytFxuICAgIG1lc3NhZ2VzID0gY29ycmVjdGVkTWVzc2FnZXM7XG4gICAgICBcbiAgICAgIC8vIEdQVC00IOuqqOuNuOyduOyngCDtmZXsnbhcbiAgICAgIGNvbnN0IGlzR1BUNCA9IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0LmluY2x1ZGVzKCdHUFQtNCcpIHx8IFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmlubmVyVGV4dC5pbmNsdWRlcygnZ3B0LTQnKSB8fFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbWdbYWx0Kj1cIkdQVC00XCJdJykgIT09IG51bGw7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlLFxuICAgICAgICBtZXNzYWdlcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgbW9kZWw6IGlzR1BUNCA/ICdncHQtNCcgOiAnZ3B0LTMuNS10dXJibycsXG4gICAgICAgICAgdGFnczogW11cbiAgICAgICAgfVxuICAgICAgfTtcbiAgfSkgYXMgeyBcbiAgICB0aXRsZTogc3RyaW5nOyBcbiAgICBtZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT47IFxuICAgIG1ldGFkYXRhOiB7IFxuICAgICAgZGF0ZTogc3RyaW5nOyBcbiAgICAgIG1vZGVsOiBzdHJpbmc7IFxuICAgICAgdGFnczogc3RyaW5nW107IFxuICAgIH07IFxuICB9O1xufSJdLCJuYW1lcyI6WyJDaGF0U291cmNlIiwicGF0aCIsImZzIiwicHVwcGV0ZWVyIiwicmVxdWlyZSIsImNocm9taXVtIiwiRXJyb3IiLCJpc1dpbmRvd3MiLCJwcm9jZXNzIiwicGxhdGZvcm0iLCJpc1ZlcmNlbCIsImVudiIsIlZFUkNFTCIsImdldENocm9taXVtUGF0aCIsImxvY2FsQ2hyb21lUGF0aHMiLCJMT0NBTEFQUERBVEEiLCJjaHJvbWVQYXRoIiwiZXhpc3RzU3luYyIsImNvbnNvbGUiLCJsb2ciLCJleGVjUGF0aCIsImV4ZWN1dGFibGVQYXRoIiwibG9jYWxDaHJvbWl1bVBhdGgiLCJqb2luIiwiY3dkIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiZXJyb3IiLCJkZWZhdWx0Q2hyb21lUGF0aCIsInBhcnNlQ2hhdEdQVExpbmsiLCJ1cmwiLCJicm93c2VyIiwiQ0hST01JVU1fUEFUSCIsIm9wdGlvbnMiLCJhcmdzIiwiZGVmYXVsdFZpZXdwb3J0IiwiaGVhZGxlc3MiLCJpZ25vcmVIVFRQU0Vycm9ycyIsImxhdW5jaCIsInBhZ2UiLCJuZXdQYWdlIiwic2V0VXNlckFnZW50IiwibWF4UmV0cmllcyIsImxvYWRlZCIsImF0dGVtcHQiLCJnb3RvIiwidGltZW91dCIsIndhaXRVbnRpbCIsIm5hdmlnYXRpb25FcnJvciIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm1lc3NhZ2UiLCJTdHJpbmciLCJpbmNsdWRlcyIsImlzQWN0dWFsTG9naW5QYWdlIiwiZXZhbHVhdGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJwYXRobmFtZSIsIndhaXRGb3JUaW1lb3V0Iiwic2NyZWVuc2hvdCIsInJhd0h0bWwiLCJjb250ZW50IiwicmF3VGV4dCIsImRvY3VtZW50IiwiYm9keSIsImlubmVyVGV4dCIsImNvbnZlcnNhdGlvbkRhdGEiLCJleHRyYWN0Q29udmVyc2F0aW9uRGF0YSIsImNvbnZlcnNhdGlvbiIsImlkIiwiZXh0cmFjdENvbnZlcnNhdGlvbklkIiwidGl0bGUiLCJtZXNzYWdlcyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNvdXJjZSIsIkNIQVRHUFQiLCJtZXRhZGF0YSIsImxlbmd0aCIsImNsb3NlIiwidXJsU2VnbWVudHMiLCJzcGxpdCIsInBvdGVudGlhbElkIiwicG9wIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwiaDFFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwidHJpbSIsInRpdGxlRWxlbWVudCIsInJlcGxhY2UiLCJtZXRhVGl0bGUiLCJnZXRBdHRyaWJ1dGUiLCJ0b0xvY2FsZVN0cmluZyIsImFzc2lzdGFudEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsInVzZXJCeUF0dHJFbGVtZW50cyIsInVzZXJFbGVtZW50cyIsInNlbGVjdG9yIiwiY2FuZGlkYXRlcyIsIkFycmF5IiwiZnJvbSIsImNvbnZlcnNhdGlvbkVsZW1lbnRzIiwiZm9yRWFjaCIsImVsIiwicHVzaCIsImVsZW1lbnQiLCJyb2xlIiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbkluRG9jdW1lbnQiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsIm1hcCIsImUiLCJleHRyYWN0ZWRNZXNzYWdlcyIsIml0ZW0iLCJoYXNVc2VyIiwic29tZSIsIm0iLCJoYXNBc3Npc3RhbnQiLCJkZXB0aCIsInBhcmVudCIsInBhcmVudEVsZW1lbnQiLCJzaWJsaW5nUG9zaXRpb24iLCJzaWJsaW5nIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ5UG9zaXRpb24iLCJ0b3AiLCJwb3RlbnRpYWxVc2VyTWVzc2FnZXMiLCJmaWx0ZXIiLCJ0ZXh0IiwidXNlck1lc3NhZ2UiLCJyZW1haW5pbmdUZXh0IiwiYWx0ZXJuYXRpbmdNZXNzYWdlcyIsIm1zZyIsImNvcnJlY3RlZE1lc3NhZ2VzIiwiZXhwZWN0ZWRSb2xlIiwiaW5kZXgiLCJpc0dQVDQiLCJkYXRlIiwibW9kZWwiLCJ0YWdzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/chatgpt.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/openai.ts":
/*!*********************************!*\
  !*** ./src/lib/utils/openai.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   summarizeConversation: () => (/* binding */ summarizeConversation),\n/* harmony export */   summarizeLongConversation: () => (/* binding */ summarizeLongConversation)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n// OpenAI API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// ÏÇ¨Ïö©Ìï† Î™®Îç∏ Ï†ïÏùò\nconst MODEL = \"gpt-4.1-nano\";\n/**\r\n * ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ ÏöîÏïΩÌïòÍ≥† ÌÇ§ÏõåÎìúÎ•º Ï∂îÏ∂úÌïòÎäî Ìï®Ïàò\r\n * @param title ÎåÄÌôî Ï†úÎ™©\r\n * @param messages ÎåÄÌôî Î©îÏãúÏßÄ Î∞∞Ïó¥\r\n * @returns ÏöîÏïΩÎêú ÎÇ¥Ïö©Í≥º ÌÇ§ÏõåÎìú, ÏÇ¨Ïö©Îêú Î™®Îç∏ Ï†ïÎ≥¥\r\n */ async function summarizeConversation(title, messages) {\n    try {\n        const conversationText = messages.map((msg)=>`${msg.role === \"user\" ? \"\\uD83D\\uDC64 ÏÇ¨Ïö©Ïûê\" : \"\\uD83E\\uDD16 AI\"}: ${msg.content}`).join(\"\\n\\n\");\n        // API ÏöîÏ≤≠ - ÏöîÏïΩ Î∞è ÌÇ§ÏõåÎìú Ï∂îÏ∂ú\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"ÎãπÏã†ÏùÄ ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ ÏöîÏïΩÌïòÍ≥† Ï£ºÏöî ÌÇ§ÏõåÎìúÎ•º Ï∂îÏ∂úÌïòÎäî assistantÏûÖÎãàÎã§. ÏöîÏïΩÏùÄ 3-5Î¨∏Ïû•ÏúºÎ°ú, ÌÇ§ÏõåÎìúÎäî ÏµúÎåÄ 5Í∞úÍπåÏßÄ Ï∂îÏ∂úÌï¥Ï£ºÏÑ∏Ïöî. JSON ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌï¥Ï£ºÏÑ∏Ïöî.\"\n                },\n                {\n                    role: \"user\",\n                    content: `Ï†úÎ™©: \"${title}\"\\n\\nÎã§Ïùå ÎåÄÌôî ÎÇ¥Ïö©ÏùÑ ÏöîÏïΩÌïòÍ≥†, Í¥ÄÎ†® ÌÇ§ÏõåÎìúÎ•º Ï∂îÏ∂úÌï¥Ï£ºÏÑ∏Ïöî. JSON ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌï¥Ïïº Ìï©ÎãàÎã§. Îã§Ïùå ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌïòÏÑ∏Ïöî: {\"summary\": \"ÏöîÏïΩ ÎÇ¥Ïö©...\", \"keywords\": [\"ÌÇ§ÏõåÎìú1\", \"ÌÇ§ÏõåÎìú2\", ...]}:\\n\\n${conversationText}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        // ÏùëÎãµ Ï≤òÎ¶¨\n        try {\n            const content = response.choices[0]?.message?.content || \"\";\n            console.log(\"API ÏùëÎãµ ÎÇ¥Ïö©:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : [],\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"JSON ÌååÏã± Ïò§Î•ò:\", parseError);\n            console.log(\"ÌååÏã± Ïã§Ìå®Ìïú ÎÇ¥Ïö©:\", response.choices[0]?.message?.content);\n            return {\n                summary: \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n                keywords: [],\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"ÎåÄÌôî ÏöîÏïΩ Ï§ë Ïò§Î•ò Î∞úÏÉù:\", error);\n        return {\n            summary: \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n/**\r\n * Í∏¥ ÎåÄÌôîÎ•º ÏöîÏïΩÌïòÎäî Ìï®Ïàò (ÌÜ†ÌÅ∞ Ï†úÌïúÏóê Í±∏Î¶¨Îäî Í≤ΩÏö∞ ÏÇ¨Ïö©)\r\n * @param title ÎåÄÌôî Ï†úÎ™©\r\n * @param messages ÎåÄÌôî Î©îÏãúÏßÄ Î∞∞Ïó¥\r\n * @returns ÏöîÏïΩÎêú ÎÇ¥Ïö©Í≥º ÌÇ§ÏõåÎìú, ÏÇ¨Ïö©Îêú Î™®Îç∏ Ï†ïÎ≥¥\r\n */ async function summarizeLongConversation(title, messages) {\n    try {\n        // ÎåÄÌôîÎ•º Ïó¨Îü¨ ÌååÌä∏Î°ú ÎÇòÎàÑÍ∏∞ (10Í∞ú Î©îÏãúÏßÄÏî©)\n        const messageParts = [];\n        const partSize = 10;\n        for(let i = 0; i < messages.length; i += partSize){\n            messageParts.push(messages.slice(i, i + partSize));\n        }\n        // Í∞Å ÌååÌä∏Î≥ÑÎ°ú ÏöîÏïΩ ÏÉùÏÑ±\n        const partSummaries = [];\n        let allKeywords = [];\n        for(let i = 0; i < messageParts.length; i++){\n            try {\n                const result = await summarizeConversation(`${title} (ÌååÌä∏ ${i + 1}/${messageParts.length})`, messageParts[i]);\n                partSummaries.push(`ÌååÌä∏ ${i + 1}: ${result.summary}`);\n                // ÌÇ§ÏõåÎìú ÏàòÏßë\n                if (Array.isArray(result.keywords)) {\n                    allKeywords = [\n                        ...allKeywords,\n                        ...result.keywords\n                    ];\n                }\n            } catch (error) {\n                console.error(`ÌååÌä∏ ${i + 1} ÏöîÏïΩ Ï§ë Ïò§Î•ò:`, error);\n                partSummaries.push(`ÌååÌä∏ ${i + 1}: ÏöîÏïΩ Ïã§Ìå®`);\n            }\n        }\n        // Î∂ÄÎ∂Ñ ÏöîÏïΩÎì§ÏùÑ Ï°∞Ìï©ÌïòÏó¨ ÏµúÏ¢Ö ÏöîÏïΩ ÏÉùÏÑ±\n        const finalResponse = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"Ïó¨Îü¨ ÎåÄÌôî ÏöîÏïΩÏùÑ ÌïòÎÇòÏùò ÌÜµÌï©Îêú ÏöîÏïΩÏúºÎ°ú ÎßåÎì§Í≥†, Í∞ÄÏû• Ï§ëÏöîÌïú ÌÇ§ÏõåÎìúÎ•º 5Í∞ú Ïù¥ÎÇ¥Î°ú Ï∂îÏ∂úÌï¥Ï£ºÏÑ∏Ïöî. JSON ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌï¥Ï£ºÏÑ∏Ïöî.\"\n                },\n                {\n                    role: \"user\",\n                    content: `Îã§ÏùåÏùÄ Í∏¥ ÎåÄÌôîÎ•º ÎÇòÎàà Î∂ÄÎ∂ÑÎ≥Ñ ÏöîÏïΩÏûÖÎãàÎã§. Ïù¥Îì§ÏùÑ Í≤∞Ìï©ÌïòÏó¨ Ï†ÑÏ≤¥ ÎåÄÌôîÏùò ÌïµÏã¨ÏùÑ Îã¥ÏùÄ ÌÜµÌï© ÏöîÏïΩÏùÑ 5Î¨∏Ïû• Ïù¥ÎÇ¥Î°ú ÏûëÏÑ±ÌïòÍ≥†, Í∞ÄÏû• Ï§ëÏöîÌïú ÌÇ§ÏõåÎìú 5Í∞úÎ•º Ï∂îÏ∂úÌï¥Ï£ºÏÑ∏Ïöî. JSON ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌï¥Ïïº Ìï©ÎãàÎã§. {\"summary\": \"ÏöîÏïΩ ÎÇ¥Ïö©...\", \"keywords\": [\"ÌÇ§ÏõåÎìú1\", \"ÌÇ§ÏõåÎìú2\", ...]} ÌòïÏãùÏúºÎ°ú ÏùëÎãµÌïòÏÑ∏Ïöî:\\n\\n${partSummaries.join(\"\\n\\n\")}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        try {\n            const content = finalResponse.choices[0]?.message?.content || \"\";\n            console.log(\"ÏµúÏ¢Ö API ÏùëÎãµ ÎÇ¥Ïö©:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : allKeywords,\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"ÏµúÏ¢Ö ÏöîÏïΩ JSON ÌååÏã± Ïò§Î•ò:\", parseError);\n            console.log(\"ÌååÏã± Ïã§Ìå®Ìïú ÎÇ¥Ïö©:\", finalResponse.choices[0]?.message?.content);\n            // ÌÇ§ÏõåÎìú Ï§ëÎ≥µ Ï†úÍ±∞ Î∞è ÏµúÎåÄ 5Í∞úÎ°ú Ï†úÌïú\n            const uniqueKeywords = Array.from(new Set(allKeywords)).slice(0, 5);\n            return {\n                summary: \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n                keywords: uniqueKeywords,\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"Í∏¥ ÎåÄÌôî ÏöîÏïΩ Ï§ë Ïò§Î•ò Î∞úÏÉù:\", error);\n        return {\n            summary: \"ÏöîÏïΩÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏóÜÏäµÎãàÎã§.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxDQUFDLGNBQWNxQixjQUFjeEIsT0FBTyxDQUFDLEVBQUUsRUFBRUMsU0FBU1o7WUFFN0Qsd0JBQXdCO1lBQ3hCLE1BQU1vQyxpQkFBaUJoQixNQUFNaUIsSUFBSSxDQUFDLElBQUlDLElBQUlMLGNBQWNGLEtBQUssQ0FBQyxHQUFHO1lBRWpFLE9BQU87Z0JBQ0xiLFNBQVM7Z0JBQ1RDLFVBQVVpQjtnQkFDVmQsV0FBVzlCO1lBQ2I7UUFDRjtJQUNGLEVBQUUsT0FBT2dDLE9BQVk7UUFDbkJYLFFBQVFXLEtBQUssQ0FBQyxvQkFBb0JBO1FBQ2xDLE9BQU87WUFDTE4sU0FBUztZQUNUQyxVQUFVLEVBQUU7WUFDWkcsV0FBVzlCO1FBQ2I7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvbGliL3V0aWxzL29wZW5haS50cz9iNjgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuXHJcbi8vIE9wZW5BSSBBUEkg7YG065287J207Ja47Yq4IOy0iOq4sO2ZlFxyXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcclxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxyXG59KTtcclxuXHJcbi8vIOyCrOyaqe2VoCDrqqjrjbgg7KCV7J2YXHJcbmNvbnN0IE1PREVMID0gJ2dwdC00LjEtbmFubyc7XHJcblxyXG4vLyDsmpTslb0g6rKw6rO8IO2DgOyehSDsoJXsnZhcclxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJ5UmVzdWx0IHtcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIG1vZGVsVXNlZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7YKk7JuM65Oc66W8IOy2lOy2nO2VmOuKlCDtlajsiJhcclxuICogQHBhcmFtIHRpdGxlIOuMgO2ZlCDsoJzrqqlcclxuICogQHBhcmFtIG1lc3NhZ2VzIOuMgO2ZlCDrqZTsi5zsp4Ag67Cw7Je0XHJcbiAqIEByZXR1cm5zIOyalOyVveuQnCDrgrTsmqnqs7wg7YKk7JuM65OcLCDsgqzsmqnrkJwg66qo6424IOygleuztFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjb252ZXJzYXRpb25UZXh0ID0gbWVzc2FnZXNcclxuICAgICAgLm1hcChtc2cgPT4gYCR7bXNnLnJvbGUgPT09ICd1c2VyJyA/ICfwn5GkIOyCrOyaqeyekCcgOiAn8J+kliBBSSd9OiAke21zZy5jb250ZW50fWApXHJcbiAgICAgIC5qb2luKCdcXG5cXG4nKTtcclxuXHJcbiAgICAvLyBBUEkg7JqU7LKtIC0g7JqU7JW9IOuwjyDtgqTsm4zrk5wg7LaU7LacXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsOiBNT0RFTCxcclxuICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcclxuICAgICAgICAgIGNvbnRlbnQ6ICfri7nsi6DsnYAg64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7KO87JqUIO2CpOybjOuTnOulvCDstpTstpztlZjripQgYXNzaXN0YW507J6F64uI64ukLiDsmpTslb3snYAgMy0166y47J6l7Jy866GcLCDtgqTsm4zrk5zripQg7LWc64yAIDXqsJzquYzsp4Ag7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOygnOuqqTogXCIke3RpdGxlfVwiXFxuXFxu64uk7J2MIOuMgO2ZlCDrgrTsmqnsnYQg7JqU7JW97ZWY6rOgLCDqtIDroKgg7YKk7JuM65Oc66W8IOy2lOy2nO2VtOyjvOyEuOyalC4gSlNPTiDtmJXsi53snLzroZwg7J2R64u17ZW07JW8IO2VqeuLiOuLpC4g64uk7J2MIO2YleyLneycvOuhnCDsnZHri7XtlZjshLjsmpQ6IHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX06XFxuXFxuJHtjb252ZXJzYXRpb25UZXh0fWBcclxuICAgICAgICB9XHJcbiAgICAgIF0sXHJcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjUsXHJcbiAgICAgIG1heF90b2tlbnM6IDQwMCxcclxuICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDsnZHri7Ug7LKY66asXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcclxuICAgICAgY29uc29sZS5sb2coJ0FQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBbXSxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7IuxIOyYpOulmDonLCBwYXJzZUVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ+2MjOyLsSDsi6TtjKjtlZwg64K07JqpOicsIHJlc3BvbnNlLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1bW1hcnk6ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgICAgbW9kZWxVc2VkOiBNT0RFTFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+uMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog6ri0IOuMgO2ZlOulvCDsmpTslb3tlZjripQg7ZWo7IiYICjthqDtgbAg7KCc7ZWc7JeQIOqxuOumrOuKlCDqsr3smrAg7IKs7JqpKVxyXG4gKiBAcGFyYW0gdGl0bGUg64yA7ZmUIOygnOuqqVxyXG4gKiBAcGFyYW0gbWVzc2FnZXMg64yA7ZmUIOuplOyLnOyngCDrsLDsl7RcclxuICogQHJldHVybnMg7JqU7JW965CcIOuCtOyaqeqzvCDtgqTsm4zrk5wsIOyCrOyaqeuQnCDrqqjrjbgg7KCV67O0XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrjIDtmZTrpbwg7Jes65+sIO2MjO2KuOuhnCDrgpjriITquLAgKDEw6rCcIOuplOyLnOyngOyUqSlcclxuICAgIGNvbnN0IG1lc3NhZ2VQYXJ0czogQ2hhdE1lc3NhZ2VbXVtdID0gW107XHJcbiAgICBjb25zdCBwYXJ0U2l6ZSA9IDEwO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VzLmxlbmd0aDsgaSArPSBwYXJ0U2l6ZSkge1xyXG4gICAgICBtZXNzYWdlUGFydHMucHVzaChtZXNzYWdlcy5zbGljZShpLCBpICsgcGFydFNpemUpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g6rCBIO2MjO2KuOuzhOuhnCDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBwYXJ0U3VtbWFyaWVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgbGV0IGFsbEtleXdvcmRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VQYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICAgICAgICAgIGAke3RpdGxlfSAo7YyM7Yq4ICR7aSsxfS8ke21lc3NhZ2VQYXJ0cy5sZW5ndGh9KWAsXHJcbiAgICAgICAgICBtZXNzYWdlUGFydHNbaV1cclxuICAgICAgICApO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTogJHtyZXN1bHQuc3VtbWFyeX1gKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDtgqTsm4zrk5wg7IiY7KeRXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0LmtleXdvcmRzKSkge1xyXG4gICAgICAgICAgYWxsS2V5d29yZHMgPSBbLi4uYWxsS2V5d29yZHMsIC4uLnJlc3VsdC5rZXl3b3Jkc107XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYO2MjO2KuCAke2krMX0g7JqU7JW9IOykkSDsmKTrpZg6YCwgZXJyb3IpO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTog7JqU7JW9IOyLpO2MqGApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOu2gOu2hCDsmpTslb3rk6TsnYQg7KGw7ZWp7ZWY7JesIOy1nOyihSDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBmaW5hbFJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgbW9kZWw6IE1PREVMLFxyXG4gICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxyXG4gICAgICAgICAgY29udGVudDogJ+yXrOufrCDrjIDtmZQg7JqU7JW97J2EIO2VmOuCmOydmCDthrXtlanrkJwg7JqU7JW97Jy866GcIOunjOuTpOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5zrpbwgNeqwnCDsnbTrgrTroZwg7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOuLpOydjOydgCDquLQg64yA7ZmU66W8IOuCmOuIiCDrtoDrtoTrs4Qg7JqU7JW97J6F64uI64ukLiDsnbTrk6TsnYQg6rKw7ZWp7ZWY7JesIOyghOyytCDrjIDtmZTsnZgg7ZW17Ius7J2EIOuLtOydgCDthrXtlakg7JqU7JW97J2EIDXrrLjsnqUg7J2064K066GcIOyekeyEse2VmOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5wgNeqwnOulvCDstpTstpztlbTso7zshLjsmpQuIEpTT04g7ZiV7Iud7Jy866GcIOydkeuLte2VtOyVvCDtlanri4jri6QuIHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX0g7ZiV7Iud7Jy866GcIOydkeuLte2VmOyEuOyalDpcXG5cXG4ke3BhcnRTdW1tYXJpZXMuam9pbignXFxuXFxuJyl9YFxyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgdGVtcGVyYXR1cmU6IDAuNSxcclxuICAgICAgbWF4X3Rva2VuczogNDAwLFxyXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IHsgdHlwZTogXCJqc29uX29iamVjdFwiIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnO1xyXG4gICAgICBjb25zb2xlLmxvZygn7LWc7KKFIEFQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBhbGxLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyihSDsmpTslb0gSlNPTiDtjIzsi7Eg7Jik66WYOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICBjb25zb2xlLmxvZygn7YyM7IuxIOyLpO2MqO2VnCDrgrTsmqk6JywgZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50KTtcclxuICAgICAgXHJcbiAgICAgIC8vIO2CpOybjOuTnCDspJHrs7Ug7KCc6rGwIOuwjyDstZzrjIAgNeqwnOuhnCDsoJztlZxcclxuICAgICAgY29uc3QgdW5pcXVlS2V5d29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoYWxsS2V5d29yZHMpKS5zbGljZSgwLCA1KTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICAgIGtleXdvcmRzOiB1bmlxdWVLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcign6ri0IOuMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJPcGVuQUkiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJNT0RFTCIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsInRpdGxlIiwibWVzc2FnZXMiLCJjb252ZXJzYXRpb25UZXh0IiwibWFwIiwibXNnIiwicm9sZSIsImNvbnRlbnQiLCJqb2luIiwicmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInJlc3BvbnNlX2Zvcm1hdCIsInR5cGUiLCJjaG9pY2VzIiwibWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZWRDb250ZW50IiwiSlNPTiIsInBhcnNlIiwic3VtbWFyeSIsImtleXdvcmRzIiwiQXJyYXkiLCJpc0FycmF5IiwibW9kZWxVc2VkIiwicGFyc2VFcnJvciIsImVycm9yIiwic3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbiIsIm1lc3NhZ2VQYXJ0cyIsInBhcnRTaXplIiwiaSIsImxlbmd0aCIsInB1c2giLCJzbGljZSIsInBhcnRTdW1tYXJpZXMiLCJhbGxLZXl3b3JkcyIsInJlc3VsdCIsImZpbmFsUmVzcG9uc2UiLCJ1bmlxdWVLZXl3b3JkcyIsImZyb20iLCJTZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/openai.ts\n");

/***/ }),

/***/ "(rsc)/./src/types.ts":
/*!**********************!*\
  !*** ./src/types.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatSource: () => (/* binding */ ChatSource)\n/* harmony export */ });\nvar ChatSource;\n(function(ChatSource) {\n    ChatSource[\"CHATGPT\"] = \"chatgpt\";\n    ChatSource[\"USER_INPUT\"] = \"user_input\";\n    ChatSource[\"API\"] = \"api\";\n})(ChatSource || (ChatSource = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdHlwZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7VUFBWUE7Ozs7R0FBQUEsZUFBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8uL3NyYy90eXBlcy50cz8yNjljIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBlbnVtIENoYXRTb3VyY2Uge1xyXG4gIENIQVRHUFQgPSAnY2hhdGdwdCcsXHJcbiAgVVNFUl9JTlBVVCA9ICd1c2VyX2lucHV0JyxcclxuICBBUEkgPSAnYXBpJyxcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZSB7XHJcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udmVyc2F0aW9uIHtcclxuICBpZD86IHN0cmluZztcclxuICB0aXRsZTogc3RyaW5nO1xyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZSB8IHN0cmluZztcclxuICBzb3VyY2U6IENoYXRTb3VyY2U7XHJcbiAgdGFncz86IHN0cmluZ1tdO1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb25TdW1tYXJ5IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xyXG4gIHNvdXJjZTogQ2hhdFNvdXJjZTtcclxuICB0YWdzPzogc3RyaW5nW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2V0dGluZ3Mge1xyXG4gIG9ic2lkaWFuVmF1bHRQYXRoOiBzdHJpbmc7XHJcbiAgb3BlbmFpQXBpS2V5OiBzdHJpbmc7XHJcbiAgZGVmYXVsdFRhZ3M6IHN0cmluZ1tdO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBBcGlSZXNwb25zZTxUPiA9IHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIGRhdGE/OiBUO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJ5UmVzdWx0IHtcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIG1vZGVsVXNlZDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENoYXRDaHVuayB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBjaGF0X3Nlc3Npb25faWQ6IHN0cmluZztcclxuICBjaHVua19pbmRleDogbnVtYmVyO1xyXG4gIGNvbnRlbnQ6IHN0cmluZztcclxuICBlbWJlZGRpbmc/OiBudW1iZXJbXTtcclxuICBzaW1pbGFyaXR5PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENoYXRTZXNzaW9uIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICBjcmVhdGVkX2F0Pzogc3RyaW5nO1xyXG4gIGVtYmVkZGluZz86IG51bWJlcltdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhZ1NvdXJjZSB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHNpbWlsYXJpdHk/OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmFnUmVzcG9uc2Uge1xyXG4gIGFuc3dlcjogc3RyaW5nO1xyXG4gIHNvdXJjZXM6IFJhZ1NvdXJjZVtdO1xyXG59ICJdLCJuYW1lcyI6WyJDaGF0U291cmNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/types.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/embeddings.ts":
/*!*********************************!*\
  !*** ./src/utils/embeddings.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chunkMessages: () => (/* binding */ chunkMessages),\n/* harmony export */   getEmbedding: () => (/* binding */ getEmbedding),\n/* harmony export */   truncateText: () => (/* binding */ truncateText)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gpt-tokenizer */ \"(rsc)/./node_modules/gpt-tokenizer/esm/main.js\");\n\n\n// OpenAI API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n/**\r\n * ÌÖçÏä§Ìä∏ÏóêÏÑú Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Î¨∏ÏûêÎ•º Ï†úÍ±∞Ìï©ÎãàÎã§.\r\n * ÌäπÌûà \\u0000(NULL) Î¨∏ÏûêÏôÄ Í∏∞ÌÉÄ PostgreSQLÏóêÏÑú Î¨∏Ï†úÎ•º ÏùºÏúºÌÇ¨ Ïàò ÏûàÎäî Î¨∏ÏûêÎ•º Ï†úÍ±∞Ìï©ÎãàÎã§.\r\n */ function sanitizeText(text) {\n    if (!text) return \"\";\n    // null Î¨∏Ïûê Î∞è Ï†úÏñ¥ Î¨∏Ïûê Ï†úÍ±∞\n    let sanitized = text.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \");\n    // PostgreSQLÏóêÏÑú Î¨∏Ï†úÍ∞Ä Îê† Ïàò ÏûàÎäî ÌäπÏàò Ïù¥Ïä§ÏºÄÏù¥ÌîÑ ÏãúÌÄÄÏä§ Ï≤òÎ¶¨\n    sanitized = sanitized.replace(/\\\\u0000/g, \"\");\n    // Ïó∞ÏÜçÎêú Í≥µÎ∞± Ï†úÍ±∞\n    sanitized = sanitized.replace(/\\s+/g, \" \");\n    return sanitized.trim();\n}\n/**\r\n * ÌÖçÏä§Ìä∏Ïóê ÎåÄÌïú ÏûÑÎ≤†Îî© Î≤°ÌÑ∞Î•º ÏÉùÏÑ±Ìï©ÎãàÎã§.\r\n * @param text ÏûÑÎ≤†Îî©Ìï† ÌÖçÏä§Ìä∏\r\n * @returns ÏûÑÎ≤†Îî© Î≤°ÌÑ∞\r\n */ async function getEmbedding(text) {\n    try {\n        // ÌÖçÏä§Ìä∏ Ï†ïÏ†ú\n        const sanitizedText = sanitizeText(text);\n        if (!sanitizedText) {\n            console.warn(\"ÏûÑÎ≤†Îî© ÏÉùÏÑ±ÏùÑ ÏúÑÌïú ÌÖçÏä§Ìä∏Í∞Ä ÎπÑÏñ¥ÏûàÏäµÎãàÎã§.\");\n            // Îπà ÌÖçÏä§Ìä∏Ïùò Í≤ΩÏö∞ Í∏∞Î≥∏ ÏûÑÎ≤†Îî© Í∞í Î∞òÌôò (Î™®Îëê 0)\n            return Array(1536).fill(0);\n        }\n        // ÌÖçÏä§Ìä∏Í∞Ä ÎÑàÎ¨¥ ÏßßÏùÄ Í≤ΩÏö∞ (1-2Í∏ÄÏûê) Ï≤òÎ¶¨\n        if (sanitizedText.length < 3) {\n            console.warn(`ÏûÑÎ≤†Îî© ÏÉùÏÑ±ÏùÑ ÏúÑÌïú ÌÖçÏä§Ìä∏Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§: \"${sanitizedText}\"`);\n            // ÏßßÏùÄ ÌÖçÏä§Ìä∏ ÌôïÏû• (ÏùòÎØ∏Î•º Ïú†ÏßÄÌïòÎ©¥ÏÑú Ïª®ÌÖçÏä§Ìä∏ Ï∂îÍ∞Ä)\n            const expandedText = `ÏßàÎ¨∏: ${sanitizedText} Ïóê ÎåÄÌïú Ï†ïÎ≥¥Î•º Ï∞æÏäµÎãàÎã§.`;\n            console.log(`ÌôïÏû•Îêú ÌÖçÏä§Ìä∏Î°ú ÏûÑÎ≤†Îî© ÏÉùÏÑ±: \"${expandedText}\"`);\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-3-small\",\n                input: expandedText\n            });\n            return response.data[0].embedding;\n        }\n        // ÏùºÎ∞òÏ†ÅÏù∏ Í≤ΩÏö∞ ÏûÑÎ≤†Îî© ÏÉùÏÑ±\n        const response = await openai.embeddings.create({\n            model: \"text-embedding-3-small\",\n            input: sanitizedText\n        });\n        return response.data[0].embedding;\n    } catch (error) {\n        console.error(\"ÏûÑÎ≤†Îî© ÏÉùÏÑ± Ï§ë Ïò§Î•ò:\", error);\n        // Ïò§Î•ò Î∞úÏÉù Ïãú Ïû¨ÏãúÎèÑ (Îã§Î•∏ Î™®Îç∏ ÏÇ¨Ïö©)\n        try {\n            console.log(\"ÎåÄÏ≤¥ ÏûÑÎ≤†Îî© Î™®Îç∏Î°ú Ïû¨ÏãúÎèÑÌï©ÎãàÎã§.\");\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-ada-002\",\n                input: sanitizeText(text) || \"Îπà ÏøºÎ¶¨\"\n            });\n            return response.data[0].embedding;\n        } catch (retryError) {\n            console.error(\"ÎåÄÏ≤¥ ÏûÑÎ≤†Îî© ÏÉùÏÑ± Ï§ë Ïò§Î•ò:\", retryError);\n            // Î™®Îì† ÏãúÎèÑ Ïã§Ìå® Ïãú Í∏∞Î≥∏ ÏûÑÎ≤†Îî© Î∞òÌôò\n            return Array(1536).fill(0);\n        }\n    }\n}\n/**\r\n * ÌÜ†ÌÅ∞ Ï†úÌïúÏóê ÎßûÍ≤å ÌÖçÏä§Ìä∏Î•º ÏûêÎ¶ÖÎãàÎã§.\r\n * @param text ÏõêÎ≥∏ ÌÖçÏä§Ìä∏\r\n * @param maxTokens ÏµúÎåÄ ÌÜ†ÌÅ∞ Ïàò (Í∏∞Î≥∏Í∞í 8000)\r\n * @returns ÏûòÎ¶∞ ÌÖçÏä§Ìä∏\r\n */ function truncateText(text, maxTokens = 8000) {\n    const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(text);\n    if (tokens.length <= maxTokens) {\n        return text;\n    }\n    // ÏàòÏ†ïÎêú Î∂ÄÎ∂Ñ\n    const truncatedTokens = tokens.slice(0, maxTokens);\n    return (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(truncatedTokens); // ÏûòÎ™ªÎêú ÏßÅÏ†ë Íµ¨ÌòÑ Ìï®ÏàòÍ∞Ä ÏïÑÎãàÎùº Í≥µÏãù Ìï®Ïàò ÏÇ¨Ïö©\n}\n/**\r\n * ÎåÄÌôî Î©îÏãúÏßÄÎ•º Ï≤≠ÌÅ¨Î°ú Î∂ÑÌï†Ìï©ÎãàÎã§.\r\n * @param messages Î©îÏãúÏßÄ Î∞∞Ïó¥\r\n * @param maxTokensPerChunk Ï≤≠ÌÅ¨Îãπ ÏµúÎåÄ ÌÜ†ÌÅ∞ Ïàò (Í∏∞Î≥∏Í∞í 500)\r\n * @returns Ï≤≠ÌÅ¨ Î∞∞Ïó¥\r\n */ function chunkMessages(messages, maxTokensPerChunk = 500) {\n    const chunks = [];\n    let currentChunk = \"\";\n    let currentTokens = 0;\n    let chunkIndex = 0;\n    for(let i = 0; i < messages.length; i++){\n        const message = messages[i];\n        const messageText = `[${message.role}]: ${message.content}`;\n        const messageTokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText).length;\n        // Îã®Ïùº Î©îÏãúÏßÄÍ∞Ä Ï≤≠ÌÅ¨ Ï†úÌïúÏùÑ Ï¥àÍ≥ºÌïòÎäî Í≤ΩÏö∞ (Î∂ÑÌï† ÌïÑÏöî)\n        if (messageTokens > maxTokensPerChunk) {\n            // ÌòÑÏû¨ Ï∂ïÏ†ÅÎêú Ï≤≠ÌÅ¨Í∞Ä ÏûàÎã§Î©¥ Î®ºÏ†Ä Ï†ÄÏû•\n            if (currentTokens > 0) {\n                chunks.push({\n                    content: currentChunk.trim(),\n                    chunk_index: chunkIndex++\n                });\n                currentChunk = \"\";\n                currentTokens = 0;\n            }\n            // Í∏¥ Î©îÏãúÏßÄÎ•º Ïó¨Îü¨ Ï≤≠ÌÅ¨Î°ú Î∂ÑÌï†\n            const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText);\n            for(let j = 0; j < tokens.length; j += maxTokensPerChunk){\n                const chunkTokens = tokens.slice(j, j + maxTokensPerChunk);\n                chunks.push({\n                    content: (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(chunkTokens).trim(),\n                    chunk_index: chunkIndex++\n                });\n            }\n        } else if (currentTokens + messageTokens <= maxTokensPerChunk) {\n            currentChunk += (currentChunk ? \"\\n\\n\" : \"\") + messageText;\n            currentTokens += messageTokens;\n        } else {\n            chunks.push({\n                content: currentChunk.trim(),\n                chunk_index: chunkIndex++\n            });\n            currentChunk = messageText;\n            currentTokens = messageTokens;\n        }\n    }\n    // ÎßàÏßÄÎßâ Ï≤≠ÌÅ¨ Ï∂îÍ∞Ä\n    if (currentTokens > 0) {\n        chunks.push({\n            content: currentChunk.trim(),\n            chunk_index: chunkIndex\n        });\n    }\n    return chunks;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxJQUFJLENBQUM7WUFDVkYsU0FBU1AsYUFBYTVCLElBQUk7WUFDMUJzQyxhQUFhUjtRQUNmO0lBQ0Y7SUFFQSxPQUFPSDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvdXRpbHMvZW1iZWRkaW5ncy50cz8zNmIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgZW5jb2RlLCBkZWNvZGUgfSBmcm9tICdncHQtdG9rZW5pemVyJztcclxuXHJcbi8vIE9wZW5BSSBBUEkg7YG065287J207Ja47Yq4IOy0iOq4sO2ZlFxyXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcclxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiDthY3siqTtirjsl5DshJwg7Jyg7Zqo7ZWY7KeAIOyViuydgCDrrLjsnpDrpbwg7KCc6rGw7ZWp64uI64ukLlxyXG4gKiDtirntnoggXFx1MDAwMChOVUxMKSDrrLjsnpDsmYAg6riw7YOAIFBvc3RncmVTUUzsl5DshJwg66y47KCc66W8IOydvOycvO2CrCDsiJgg7J6I64qUIOusuOyekOulvCDsoJzqsbDtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZVRleHQodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBpZiAoIXRleHQpIHJldHVybiAnJztcclxuICBcclxuICAvLyBudWxsIOusuOyekCDrsI8g7KCc7Ja0IOusuOyekCDsoJzqsbBcclxuICBsZXQgc2FuaXRpemVkID0gdGV4dC5yZXBsYWNlKC9bXFx1MDAwMC1cXHUwMDFGXFx1MDA3Ri1cXHUwMDlGXS9nLCAnICcpO1xyXG4gIFxyXG4gIC8vIFBvc3RncmVTUUzsl5DshJwg66y47KCc6rCAIOuQoCDsiJgg7J6I64qUIO2KueyImCDsnbTsiqTsvIDsnbTtlIQg7Iuc7YCA7IqkIOyymOumrFxyXG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC9cXFxcdTAwMDAvZywgJycpO1xyXG4gIFxyXG4gIC8vIOyXsOyGjeuQnCDqs7XrsLEg7KCc6rGwXHJcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL1xccysvZywgJyAnKTtcclxuICBcclxuICByZXR1cm4gc2FuaXRpemVkLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIO2FjeyKpO2KuOyXkCDrjIDtlZwg7J6E67Kg65SpIOuyoe2EsOulvCDsg53shLHtlanri4jri6QuXHJcbiAqIEBwYXJhbSB0ZXh0IOyehOuyoOuUqe2VoCDthY3siqTtirhcclxuICogQHJldHVybnMg7J6E67Kg65SpIOuyoe2EsFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVtYmVkZGluZyh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcltdPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIO2FjeyKpO2KuCDsoJXsoJxcclxuICAgIGNvbnN0IHNhbml0aXplZFRleHQgPSBzYW5pdGl6ZVRleHQodGV4dCk7XHJcbiAgICBcclxuICAgIGlmICghc2FuaXRpemVkVGV4dCkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+yehOuyoOuUqSDsg53shLHsnYQg7JyE7ZWcIO2FjeyKpO2KuOqwgCDruYTslrTsnojsirXri4jri6QuJyk7XHJcbiAgICAgIC8vIOu5iCDthY3siqTtirjsnZgg6rK97JqwIOq4sOuzuCDsnoTrsqDrlKkg6rCSIOuwmO2ZmCAo66qo65GQIDApXHJcbiAgICAgIHJldHVybiBBcnJheSgxNTM2KS5maWxsKDApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDthY3siqTtirjqsIAg64SI66y0IOynp+ydgCDqsr3smrAgKDEtMuq4gOyekCkg7LKY66asXHJcbiAgICBpZiAoc2FuaXRpemVkVGV4dC5sZW5ndGggPCAzKSB7XHJcbiAgICAgIGNvbnNvbGUud2Fybihg7J6E67Kg65SpIOyDneyEseydhCDsnITtlZwg7YWN7Iqk7Yq46rCAIOuEiOustCDsp6fsirXri4jri6Q6IFwiJHtzYW5pdGl6ZWRUZXh0fVwiYCk7XHJcbiAgICAgIC8vIOynp+ydgCDthY3siqTtirgg7ZmV7J6lICjsnZjrr7jrpbwg7Jyg7KeA7ZWY66m07IScIOy7qO2FjeyKpO2KuCDstpTqsIApXHJcbiAgICAgIGNvbnN0IGV4cGFuZGVkVGV4dCA9IGDsp4jrrLg6ICR7c2FuaXRpemVkVGV4dH0g7JeQIOuMgO2VnCDsoJXrs7Trpbwg7LC+7Iq164uI64ukLmA7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDtmZXsnqXrkJwg7YWN7Iqk7Yq466GcIOyehOuyoOuUqSDsg53shLE6IFwiJHtleHBhbmRlZFRleHR9XCJgKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcclxuICAgICAgICBtb2RlbDogJ3RleHQtZW1iZWRkaW5nLTMtc21hbGwnLFxyXG4gICAgICAgIGlucHV0OiBleHBhbmRlZFRleHQsXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFbMF0uZW1iZWRkaW5nO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDsnbzrsJjsoIHsnbgg6rK97JqwIOyehOuyoOuUqSDsg53shLFcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcclxuICAgICAgbW9kZWw6ICd0ZXh0LWVtYmVkZGluZy0zLXNtYWxsJyxcclxuICAgICAgaW5wdXQ6IHNhbml0aXplZFRleHQsXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFbMF0uZW1iZWRkaW5nO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfsnoTrsqDrlKkg7IOd7ISxIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyDsmKTrpZgg67Cc7IOdIOyLnCDsnqzsi5zrj4QgKOuLpOuluCDrqqjrjbgg7IKs7JqpKVxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ+uMgOyytCDsnoTrsqDrlKkg66qo642466GcIOyerOyLnOuPhO2VqeuLiOuLpC4nKTtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuZW1iZWRkaW5ncy5jcmVhdGUoe1xyXG4gICAgICAgIG1vZGVsOiAndGV4dC1lbWJlZGRpbmctYWRhLTAwMicsIC8vIOuMgOyytCDrqqjrjbhcclxuICAgICAgICBpbnB1dDogc2FuaXRpemVUZXh0KHRleHQpIHx8ICfruYgg7L+866asJyxcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVswXS5lbWJlZGRpbmc7XHJcbiAgICB9IGNhdGNoIChyZXRyeUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+uMgOyytCDsnoTrsqDrlKkg7IOd7ISxIOykkSDsmKTrpZg6JywgcmV0cnlFcnJvcik7XHJcbiAgICAgIC8vIOuqqOuToCDsi5zrj4Qg7Iuk7YyoIOyLnCDquLDrs7gg7J6E67Kg65SpIOuwmO2ZmFxyXG4gICAgICByZXR1cm4gQXJyYXkoMTUzNikuZmlsbCgwKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDthqDtgbAg7KCc7ZWc7JeQIOunnuqyjCDthY3siqTtirjrpbwg7J6Q66aF64uI64ukLlxyXG4gKiBAcGFyYW0gdGV4dCDsm5Drs7gg7YWN7Iqk7Yq4XHJcbiAqIEBwYXJhbSBtYXhUb2tlbnMg7LWc64yAIO2GoO2BsCDsiJggKOq4sOuzuOqwkiA4MDAwKVxyXG4gKiBAcmV0dXJucyDsnpjrprAg7YWN7Iqk7Yq4XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdHJ1bmNhdGVUZXh0KHRleHQ6IHN0cmluZywgbWF4VG9rZW5zOiBudW1iZXIgPSA4MDAwKTogc3RyaW5nIHtcclxuICBjb25zdCB0b2tlbnMgPSBlbmNvZGUodGV4dCk7XHJcbiAgXHJcbiAgaWYgKHRva2Vucy5sZW5ndGggPD0gbWF4VG9rZW5zKSB7XHJcbiAgICByZXR1cm4gdGV4dDtcclxuICB9XHJcbiAgXHJcbiAgLy8g7IiY7KCV65CcIOu2gOu2hFxyXG5jb25zdCB0cnVuY2F0ZWRUb2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbWF4VG9rZW5zKTtcclxucmV0dXJuIGRlY29kZSh0cnVuY2F0ZWRUb2tlbnMpOyAvLyDsnpjrqrvrkJwg7KeB7KCRIOq1rO2YhCDtlajsiJjqsIAg7JWE64uI6528IOqzteyLnSDtlajsiJgg7IKs7JqpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrjIDtmZQg66mU7Iuc7KeA66W8IOyyre2BrOuhnCDrtoTtlaDtlanri4jri6QuXHJcbiAqIEBwYXJhbSBtZXNzYWdlcyDrqZTsi5zsp4Ag67Cw7Je0XHJcbiAqIEBwYXJhbSBtYXhUb2tlbnNQZXJDaHVuayDssq3tgazri7kg7LWc64yAIO2GoO2BsCDsiJggKOq4sOuzuOqwkiA1MDApXHJcbiAqIEByZXR1cm5zIOyyre2BrCDrsLDsl7RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjaHVua01lc3NhZ2VzKFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdLCBcclxuICBtYXhUb2tlbnNQZXJDaHVuazogbnVtYmVyID0gNTAwXHJcbik6IHtjb250ZW50OiBzdHJpbmc7IGNodW5rX2luZGV4OiBudW1iZXJ9W10ge1xyXG4gIGNvbnN0IGNodW5rczoge2NvbnRlbnQ6IHN0cmluZzsgY2h1bmtfaW5kZXg6IG51bWJlcn1bXSA9IFtdO1xyXG4gIGxldCBjdXJyZW50Q2h1bmsgPSAnJztcclxuICBsZXQgY3VycmVudFRva2VucyA9IDA7XHJcbiAgbGV0IGNodW5rSW5kZXggPSAwO1xyXG4gIFxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1tpXTtcclxuICAgIGNvbnN0IG1lc3NhZ2VUZXh0ID0gYFske21lc3NhZ2Uucm9sZX1dOiAke21lc3NhZ2UuY29udGVudH1gO1xyXG4gICAgY29uc3QgbWVzc2FnZVRva2VucyA9IGVuY29kZShtZXNzYWdlVGV4dCkubGVuZ3RoO1xyXG4gICAgXHJcbiAgICAvLyDri6jsnbwg66mU7Iuc7KeA6rCAIOyyre2BrCDsoJztlZzsnYQg7LSI6rO87ZWY64qUIOqyveyasCAo67aE7ZWgIO2VhOyalClcclxuICAgIGlmIChtZXNzYWdlVG9rZW5zID4gbWF4VG9rZW5zUGVyQ2h1bmspIHtcclxuICAgICAgLy8g7ZiE7J6sIOy2leyggeuQnCDssq3tgazqsIAg7J6I64uk66m0IOuovOyggCDsoIDsnqVcclxuICAgICAgaWYgKGN1cnJlbnRUb2tlbnMgPiAwKSB7XHJcbiAgICAgICAgY2h1bmtzLnB1c2goe1xyXG4gICAgICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcclxuICAgICAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4KytcclxuICAgICAgICB9KTtcclxuICAgICAgICBjdXJyZW50Q2h1bmsgPSAnJztcclxuICAgICAgICBjdXJyZW50VG9rZW5zID0gMDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8g6ri0IOuplOyLnOyngOulvCDsl6zrn6wg7LKt7YGs66GcIOu2hO2VoFxyXG4gICAgICBjb25zdCB0b2tlbnMgPSBlbmNvZGUobWVzc2FnZVRleHQpO1xyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRva2Vucy5sZW5ndGg7IGogKz0gbWF4VG9rZW5zUGVyQ2h1bmspIHtcclxuICAgICAgICBjb25zdCBjaHVua1Rva2VucyA9IHRva2Vucy5zbGljZShqLCBqICsgbWF4VG9rZW5zUGVyQ2h1bmspO1xyXG4gICAgICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgICAgIGNvbnRlbnQ6IGRlY29kZShjaHVua1Rva2VucykudHJpbSgpLCAvLyDqs7Xsi50gZGVjb2RlIOyCrOyaqVxyXG4gICAgICAgICAgY2h1bmtfaW5kZXg6IGNodW5rSW5kZXgrK1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgLy8g7ZiE7J6sIOyyre2BrOyXkCDrqZTsi5zsp4Drpbwg7LaU6rCA7ZWgIOyImCDsnojripTsp4Ag7ZmV7J24XHJcbiAgICBlbHNlIGlmIChjdXJyZW50VG9rZW5zICsgbWVzc2FnZVRva2VucyA8PSBtYXhUb2tlbnNQZXJDaHVuaykge1xyXG4gICAgICBjdXJyZW50Q2h1bmsgKz0gKGN1cnJlbnRDaHVuayA/ICdcXG5cXG4nIDogJycpICsgbWVzc2FnZVRleHQ7XHJcbiAgICAgIGN1cnJlbnRUb2tlbnMgKz0gbWVzc2FnZVRva2VucztcclxuICAgIH0gXHJcbiAgICAvLyDsg4gg7LKt7YGsIOyLnOyekVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgICBjb250ZW50OiBjdXJyZW50Q2h1bmsudHJpbSgpLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4KytcclxuICAgICAgfSk7XHJcbiAgICAgIGN1cnJlbnRDaHVuayA9IG1lc3NhZ2VUZXh0O1xyXG4gICAgICBjdXJyZW50VG9rZW5zID0gbWVzc2FnZVRva2VucztcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgLy8g66eI7KeA66eJIOyyre2BrCDstpTqsIBcclxuICBpZiAoY3VycmVudFRva2VucyA+IDApIHtcclxuICAgIGNodW5rcy5wdXNoKHtcclxuICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcclxuICAgICAgY2h1bmtfaW5kZXg6IGNodW5rSW5kZXhcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gY2h1bmtzO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJPcGVuQUkiLCJlbmNvZGUiLCJkZWNvZGUiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJzYW5pdGl6ZVRleHQiLCJ0ZXh0Iiwic2FuaXRpemVkIiwicmVwbGFjZSIsInRyaW0iLCJnZXRFbWJlZGRpbmciLCJzYW5pdGl6ZWRUZXh0IiwiY29uc29sZSIsIndhcm4iLCJBcnJheSIsImZpbGwiLCJsZW5ndGgiLCJleHBhbmRlZFRleHQiLCJsb2ciLCJyZXNwb25zZSIsImVtYmVkZGluZ3MiLCJjcmVhdGUiLCJtb2RlbCIsImlucHV0IiwiZGF0YSIsImVtYmVkZGluZyIsImVycm9yIiwicmV0cnlFcnJvciIsInRydW5jYXRlVGV4dCIsIm1heFRva2VucyIsInRva2VucyIsInRydW5jYXRlZFRva2VucyIsInNsaWNlIiwiY2h1bmtNZXNzYWdlcyIsIm1lc3NhZ2VzIiwibWF4VG9rZW5zUGVyQ2h1bmsiLCJjaHVua3MiLCJjdXJyZW50Q2h1bmsiLCJjdXJyZW50VG9rZW5zIiwiY2h1bmtJbmRleCIsImkiLCJtZXNzYWdlIiwibWVzc2FnZVRleHQiLCJyb2xlIiwiY29udGVudCIsIm1lc3NhZ2VUb2tlbnMiLCJwdXNoIiwiY2h1bmtfaW5kZXgiLCJqIiwiY2h1bmtUb2tlbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/embeddings.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/supabaseHandler.ts":
/*!**************************************!*\
  !*** ./src/utils/supabaseHandler.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkUrlExists: () => (/* binding */ checkUrlExists),\n/* harmony export */   getAllChatSessions: () => (/* binding */ getAllChatSessions),\n/* harmony export */   getChatSessionById: () => (/* binding */ getChatSessionById),\n/* harmony export */   getChunksBySessionId: () => (/* binding */ getChunksBySessionId),\n/* harmony export */   insertChatSession: () => (/* binding */ insertChatSession),\n/* harmony export */   processAndInsertChunks: () => (/* binding */ processAndInsertChunks),\n/* harmony export */   searchChatSessions: () => (/* binding */ searchChatSessions),\n/* harmony export */   searchSimilarChunks: () => (/* binding */ searchSimilarChunks),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _embeddings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./embeddings */ \"(rsc)/./src/utils/embeddings.ts\");\n\n\n// Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ïû¨ÏÇ¨Ïö©\nconst supabase = _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin;\n/**\r\n * JSON Îç∞Ïù¥ÌÑ∞Î•º ÏïàÏ†ÑÌïòÍ≤å Ï≤òÎ¶¨Ìï©ÎãàÎã§.\r\n * PostgreSQLÏóê Ï†ÄÏû•ÌïòÍ∏∞ Ï†Ñ Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Î¨∏ÏûêÎÇò Íµ¨Ï°∞Î•º Ï†úÍ±∞Ìï©ÎãàÎã§.\r\n */ function sanitizeJsonData(data) {\n    if (!data) return null;\n    if (typeof data === \"string\") {\n        // Î¨∏ÏûêÏó¥ÏóêÏÑú Ï†úÏñ¥ Î¨∏Ïûê Ï†úÍ±∞ Î∞è Ïú†ÎãàÏΩîÎìú Î¨∏Ïûê Ï≤òÎ¶¨ Í∞úÏÑ†\n        return data.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \") // Ï†úÏñ¥ Î¨∏Ïûê Ï†úÍ±∞\n        .replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, (match)=>match) // Ïò¨Î∞îÎ•∏ Ïú†ÎãàÏΩîÎìú Ïù¥Î™®ÏßÄ Ïú†ÏßÄ\n        .replace(/\\uFFFD/g, \"\") // ÎåÄÏ≤¥ Î¨∏Ïûê Ï†úÍ±∞\n        .replace(/\\s+/g, \" \") // Ïó∞ÏÜçÎêú Í≥µÎ∞± Ï†úÍ±∞\n        .trim();\n    }\n    if (Array.isArray(data)) {\n        // Î∞∞Ïó¥Ïùò Í∞Å Ìï≠Î™© Ï†ïÏ†ú\n        return data.map((item)=>sanitizeJsonData(item));\n    }\n    if (typeof data === \"object\" && data !== null) {\n        // Í∞ùÏ≤¥Ïùò Í∞Å ÌïÑÎìú Ï†ïÏ†ú\n        const sanitized = {};\n        for(const key in data){\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                sanitized[key] = sanitizeJsonData(data[key]);\n            }\n        }\n        return sanitized;\n    }\n    // Í∏∞Î≥∏ ÏûêÎ£åÌòïÏùÄ Í∑∏ÎåÄÎ°ú Î∞òÌôò\n    return data;\n}\n/**\r\n * URLÏù¥ Ïù¥ÎØ∏ Ï†ÄÏû•ÎêòÏñ¥ ÏûàÎäîÏßÄ ÌôïÏù∏Ìï©ÎãàÎã§.\r\n * @param url ÌôïÏù∏Ìï† URL\r\n * @returns Ï§ëÎ≥µ Ïó¨Î∂ÄÏôÄ Í∏∞Ï°¥ ÏÑ∏ÏÖò Ï†ïÎ≥¥\r\n */ async function checkUrlExists(url) {\n    try {\n        // URL Ï†ïÍ∑úÌôî (ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞ Îì± Ï†úÍ±∞)\n        const normalizedUrl = new URL(url).origin + new URL(url).pathname;\n        // Ï†ïÍ∑úÌôîÎêú URLÎ°ú ÏãúÏûëÌïòÎäî ÏÑ∏ÏÖò Í≤ÄÏÉâ\n        const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at\").ilike(\"url\", `${normalizedUrl}%`).limit(1);\n        if (error) {\n            console.error(\"URL Ï§ëÎ≥µ ÌôïÏù∏ Ï§ë Ïò§Î•ò:\", error);\n            throw error;\n        }\n        if (data && data.length > 0) {\n            return {\n                exists: true,\n                session: data[0]\n            };\n        }\n        return {\n            exists: false\n        };\n    } catch (error) {\n        console.error(\"URL Ï§ëÎ≥µ ÌôïÏù∏ Ï§ë Ïò§Î•ò:\", error);\n        // Ïò§Î•ò Î∞úÏÉù Ïãú ÏïàÏ†ÑÌïòÍ≤å Ï§ëÎ≥µÏù¥ ÏïÑÎãå Í≤ÉÏúºÎ°ú Ï≤òÎ¶¨\n        return {\n            exists: false\n        };\n    }\n}\n/**\r\n * ÎåÄÌôî ÏÑ∏ÏÖòÏùÑ SupabaseÏóê Ï†ÄÏû•Ìï©ÎãàÎã§.\r\n */ async function insertChatSession({ title, url, summary, messages, metadata = {}, skipDuplicateCheck = false }) {\n    try {\n        // URL Ï§ëÎ≥µ ÌôïÏù∏ (skipDuplicateCheckÍ∞Ä falseÏùº ÎïåÎßå)\n        if (!skipDuplicateCheck && url) {\n            const { exists, session } = await checkUrlExists(url);\n            if (exists) {\n                console.log(`URLÏù¥ Ïù¥ÎØ∏ Ï°¥Ïû¨Ìï©ÎãàÎã§: ${url}`);\n                console.log(`Í∏∞Ï°¥ ÏÑ∏ÏÖò Ï†ïÎ≥¥: ${session?.title} (${session?.id})`);\n                return {\n                    id: session?.id,\n                    duplicate: true,\n                    message: \"Ïù¥ÎØ∏ Ï†ÄÏû•Îêú ÎåÄÌôîÏûÖÎãàÎã§.\"\n                };\n            }\n        }\n        // Îç∞Ïù¥ÌÑ∞ Ï†ïÏ†ú\n        const sanitizedTitle = sanitizeJsonData(title);\n        const sanitizedSummary = sanitizeJsonData(summary);\n        const sanitizedMessages = sanitizeJsonData(messages);\n        const sanitizedMetadata = sanitizeJsonData(metadata);\n        // ÏöîÏïΩ ÌÖçÏä§Ìä∏ ÏûÑÎ≤†Îî© ÏÉùÏÑ±\n        const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedSummary);\n        // ÏÑ∏ÏÖò Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ\n        const { data, error } = await supabase.from(\"chat_sessions\").insert({\n            title: sanitizedTitle,\n            url,\n            summary: sanitizedSummary,\n            messages: sanitizedMessages,\n            metadata: sanitizedMetadata,\n            embedding\n        }).select(\"id\").single();\n        if (error) throw error;\n        return {\n            ...data,\n            duplicate: false\n        };\n    } catch (error) {\n        console.error(\"ÎåÄÌôî ÏÑ∏ÏÖò Ï†ÄÏû• Ï§ë Ïò§Î•ò:\", error);\n        throw error;\n    }\n}\n/**\r\n * ÎåÄÌôî Ï≤≠ÌÅ¨Î•º ÏÉùÏÑ±ÌïòÍ≥† SupabaseÏóê Ï†ÄÏû•Ìï©ÎãàÎã§.\r\n */ async function processAndInsertChunks(sessionId, messages) {\n    try {\n        // Î©îÏãúÏßÄ Ï†ïÏ†ú\n        const sanitizedMessages = sanitizeJsonData(messages);\n        // Î©îÏãúÏßÄÎ•º Ï≤≠ÌÅ¨Î°ú Î∂ÑÌï†\n        const chunks = (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.chunkMessages)(sanitizedMessages);\n        console.log(\"\\uD83E\\uDDF1 Î∂ÑÌï†Îêú Ï≤≠ÌÅ¨:\", chunks);\n        // Í∞Å Ï≤≠ÌÅ¨Ïóê ÎåÄÌï¥ ÏûÑÎ≤†Îî© ÏÉùÏÑ± Î∞è Ï†ÄÏû•\n        const chunkPromises = chunks.map(async (chunk)=>{\n            // Ï≤≠ÌÅ¨ ÎÇ¥Ïö© Ï†ïÏ†ú\n            const sanitizedContent = sanitizeJsonData(chunk.content);\n            const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedContent);\n            return {\n                chat_session_id: sessionId,\n                chunk_index: chunk.chunk_index,\n                content: sanitizedContent,\n                embedding\n            };\n        });\n        // Î™®Îì† Ï≤≠ÌÅ¨ ÏûÑÎ≤†Îî© Ï≤òÎ¶¨ ÏôÑÎ£å ÎåÄÍ∏∞\n        const chunksWithEmbeddings = await Promise.all(chunkPromises);\n        // Ï≤≠ÌÅ¨ Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ (ÏµúÎåÄ 1MB Ï†úÌïúÏúºÎ°ú Ï≤≠ÌÅ¨ 10Í∞úÏî© Î∞∞Ïπò Ï≤òÎ¶¨)\n        const batchSize = 10;\n        const results = [];\n        for(let i = 0; i < chunksWithEmbeddings.length; i += batchSize){\n            const batch = chunksWithEmbeddings.slice(i, i + batchSize);\n            try {\n                const { data, error } = await supabase.from(\"chat_chunks\").insert(batch);\n                if (error) throw error;\n                results.push(data);\n            } catch (error) {\n                console.error(`Ï≤≠ÌÅ¨ Î∞∞Ïπò ${i}/${chunksWithEmbeddings.length} Ï†ÄÏû• Ï§ë Ïò§Î•ò:`, error);\n            // Í∞úÎ≥Ñ Ï≤≠ÌÅ¨ ÏóêÎü¨Î•º Í∏∞Î°ùÌïòÎêò Ï†ÑÏ≤¥ ÌîÑÎ°úÏÑ∏Ïä§Îäî Í≥ÑÏÜç ÏßÑÌñâ\n            }\n        }\n        return {\n            success: true,\n            count: chunksWithEmbeddings.length\n        };\n    } catch (error) {\n        console.error(\"Ï≤≠ÌÅ¨ Ï≤òÎ¶¨ Î∞è Ï†ÄÏû• Ï§ë Ïò§Î•ò:\", error);\n        throw error;\n    }\n}\n/**\r\n * Ïú†ÏÇ¨Ìïú Ï≤≠ÌÅ¨Î•º Í≤ÄÏÉâÌï©ÎãàÎã§.\r\n */ async function searchSimilarChunks(query, similarity = 0.3, limit = 10) {\n    try {\n        // Î©îÌÉÄ ÏßàÎ¨∏ Í∞êÏßÄ (Ïòà: \"Ïù¥ ÎåÄÌôîÏùò ÌïµÏã¨Ïù¥ Î≠êÏïº?\", \"ÏöîÏïΩÌï¥Ï§ò\" Îì±)\n        const metaQuestionPatterns = [\n            /Ïù¥\\s*ÎåÄÌôîÏùò?\\s*(ÌïµÏã¨|ÏöîÏïΩ|ÎÇ¥Ïö©|Ï£ºÏ†ú)/i,\n            /ÎåÄÌôîÎ•º?\\s*(ÏöîÏïΩ|Ï†ïÎ¶¨)/i,\n            /ÏöîÏïΩÌï¥\\s*Ï§ò/i,\n            /ÌïµÏã¨\\s*(ÎÇ¥Ïö©|Ìè¨Ïù∏Ìä∏)/i,\n            /Ï£ºÏöî\\s*(ÎÇ¥Ïö©|Ìè¨Ïù∏Ìä∏)/i\n        ];\n        const isMetaQuestion = metaQuestionPatterns.some((pattern)=>pattern.test(query));\n        if (isMetaQuestion) {\n            console.log(\"Î©îÌÉÄ ÏßàÎ¨∏ Í∞êÏßÄÎê®, Î™®Îì† ÏÑ∏ÏÖòÏùò ÏöîÏïΩ Ï†ïÎ≥¥Î•º Í≤ÄÏÉâÌï©ÎãàÎã§.\");\n            // Î©îÌÉÄ ÏßàÎ¨∏Ïù∏ Í≤ΩÏö∞ Í∞ÄÏû• ÏµúÍ∑º ÏÑ∏ÏÖòÏùò ÏöîÏïΩ Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§Í∏∞\n            const { data: sessionData, error: sessionError } = await supabase.from(\"chat_sessions\").select(\"id, title, summary\").order(\"created_at\", {\n                ascending: false\n            }).limit(1);\n            if (sessionError || !sessionData || sessionData.length === 0) {\n                console.warn(\"ÏÑ∏ÏÖò Îç∞Ïù¥ÌÑ∞Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\");\n                return [];\n            }\n            // ÏÑ∏ÏÖòÏùò ÏöîÏïΩ Ï†ïÎ≥¥Î•º Ï≤≠ÌÅ¨Î°ú Î≥ÄÌôòÌïòÏó¨ Î∞òÌôò\n            const session = sessionData[0];\n            const fakeChunk = {\n                id: \"meta-question-chunk\",\n                chat_session_id: session.id,\n                chunk_index: 0,\n                content: `[ÏöîÏïΩ]: ${session.summary}`,\n                similarity: 1.0\n            };\n            return [\n                fakeChunk\n            ];\n        }\n        console.log(`Í≤ÄÏÉâ ÏøºÎ¶¨: \"${query}\", Ïú†ÏÇ¨ÎèÑ ÏûÑÍ≥ÑÍ∞í: ${similarity}, Ï†úÌïú: ${limit}`);\n        // ÏøºÎ¶¨ ÌÖçÏä§Ìä∏ Ï†ïÏ†ú\n        const sanitizedQuery = sanitizeJsonData(query);\n        console.log(`Ï†ïÏ†úÎêú ÏøºÎ¶¨: \"${sanitizedQuery}\"`);\n        if (!sanitizedQuery || sanitizedQuery.trim().length < 2) {\n            console.warn(\"ÏøºÎ¶¨Í∞Ä ÎÑàÎ¨¥ ÏßßÍ±∞ÎÇò ÎπÑÏñ¥ ÏûàÏäµÎãàÎã§\");\n            return [];\n        }\n        // ÏøºÎ¶¨ ÌÖçÏä§Ìä∏ ÏûÑÎ≤†Îî© ÏÉùÏÑ±\n        const queryEmbedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedQuery);\n        console.log(`ÏûÑÎ≤†Îî© ÏÉùÏÑ± ÏôÑÎ£å: ${queryEmbedding.length} Ï∞®Ïõê`);\n        // Ïú†ÏÇ¨Ìïú Ï≤≠ÌÅ¨ Í≤ÄÏÉâ\n        const { data, error } = await supabase.rpc(\"match_chunks\", {\n            query_embedding: queryEmbedding,\n            match_threshold: similarity,\n            match_count: limit\n        });\n        if (error) {\n            console.error(\"Ïú†ÏÇ¨ Ï≤≠ÌÅ¨ Í≤ÄÏÉâ Ïò§Î•ò:\", error);\n            throw error;\n        }\n        console.log(`Í≤ÄÏÉâÎêú Ï≤≠ÌÅ¨ Ïàò: ${data?.length || 0}`);\n        // Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÎäî Í≤ΩÏö∞ Ïú†ÏÇ¨ÎèÑ ÏûÑÍ≥ÑÍ∞íÏùÑ ÎÇÆÏ∂∞ÏÑú Îã§Ïãú ÏãúÎèÑ (2Îã®Í≥ÑÎ°ú ÎÇÆÏ∂§)\n        if (!data || data.length === 0) {\n            // Ï≤´ Î≤àÏß∏ Ïû¨ÏãúÎèÑ: ÏûÑÍ≥ÑÍ∞íÏùÑ 50% ÎÇÆÏ∂§\n            const lowerThreshold = similarity * 0.5;\n            console.log(`Í≤∞Í≥ºÍ∞Ä ÏóÜÏñ¥ Ïú†ÏÇ¨ÎèÑ ÏûÑÍ≥ÑÍ∞íÏùÑ ${lowerThreshold.toFixed(2)}Î°ú ÎÇÆÏ∂∞ Ïû¨ÏãúÎèÑ`);\n            const { data: retryData, error: retryError } = await supabase.rpc(\"match_chunks\", {\n                query_embedding: queryEmbedding,\n                match_threshold: lowerThreshold,\n                match_count: limit\n            });\n            if (retryError) {\n                console.error(\"ÎÇÆÏùÄ ÏûÑÍ≥ÑÍ∞íÏúºÎ°ú Ïû¨ÏãúÎèÑ Ï§ë Ïò§Î•ò:\", retryError);\n            } else if (retryData && retryData.length > 0) {\n                console.log(`ÎÇÆÏùÄ ÏûÑÍ≥ÑÍ∞íÏúºÎ°ú ${retryData.length}Í∞ú Ï≤≠ÌÅ¨ Í≤ÄÏÉâÎê®`);\n                return retryData;\n            } else {\n                // Îëê Î≤àÏß∏ Ïû¨ÏãúÎèÑ: Îß§Ïö∞ ÎÇÆÏùÄ ÏûÑÍ≥ÑÍ∞í (0.1)ÏúºÎ°ú ÏãúÎèÑ\n                const lowestThreshold = 0.1;\n                console.log(`Í≤∞Í≥ºÍ∞Ä Ïó¨Ï†ÑÌûà ÏóÜÏñ¥ ÏµúÏ†Ä ÏûÑÍ≥ÑÍ∞í ${lowestThreshold.toFixed(2)}Î°ú Ïû¨ÏãúÎèÑ`);\n                const { data: lastRetryData, error: lastRetryError } = await supabase.rpc(\"match_chunks\", {\n                    query_embedding: queryEmbedding,\n                    match_threshold: lowestThreshold,\n                    match_count: limit\n                });\n                if (lastRetryError) {\n                    console.error(\"ÏµúÏ†Ä ÏûÑÍ≥ÑÍ∞íÏúºÎ°ú Ïû¨ÏãúÎèÑ Ï§ë Ïò§Î•ò:\", lastRetryError);\n                } else if (lastRetryData && lastRetryData.length > 0) {\n                    console.log(`ÏµúÏ†Ä ÏûÑÍ≥ÑÍ∞íÏúºÎ°ú ${lastRetryData.length}Í∞ú Ï≤≠ÌÅ¨ Í≤ÄÏÉâÎê®`);\n                    return lastRetryData;\n                }\n            }\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Ïú†ÏÇ¨ Ï≤≠ÌÅ¨ Í≤ÄÏÉâ Ï§ë Ïò§Î•ò:\", error);\n        throw error;\n    }\n}\n/**\r\n * ÏÑ∏ÏÖò IDÎ°ú ÎåÄÌôî ÏÑ∏ÏÖòÏùÑ Ï°∞ÌöåÌï©ÎãàÎã§.\r\n */ async function getChatSessionById(id) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"*\").eq(\"id\", id).single();\n    if (error) throw error;\n    return data;\n}\n/**\r\n * Î™®Îì† ÎåÄÌôî ÏÑ∏ÏÖòÏùÑ Ï°∞ÌöåÌï©ÎãàÎã§.\r\n * ÏöîÏïΩ Ï†ïÎ≥¥Îßå Î∞òÌôòÌï©ÎãàÎã§ (Ï†ÑÏ≤¥ Î©îÏãúÏßÄÎäî Ï†úÏô∏).\r\n */ async function getAllChatSessions() {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * ÎåÄÌôî ÏÑ∏ÏÖòÏùò Î™®Îì† Ï≤≠ÌÅ¨Î•º Í∞ÄÏ†∏ÏòµÎãàÎã§.\r\n */ async function getChunksBySessionId(sessionId) {\n    const { data, error } = await supabase.from(\"chat_chunks\").select(\"*\").eq(\"chat_session_id\", sessionId).order(\"chunk_index\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * ÌÇ§ÏõåÎìúÎ°ú ÎåÄÌôî ÏÑ∏ÏÖòÏùÑ Í≤ÄÏÉâÌï©ÎãàÎã§.\r\n */ async function searchChatSessions(keyword) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").or(`title.ilike.%${keyword}%,summary.ilike.%${keyword}%`).order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxFQUFFLEdBQUcsTUFBTXRCLFNBQzNCdUIsSUFBSSxDQUFDLGVBQ0xDLE1BQU0sQ0FBQyxLQUNQd0UsRUFBRSxDQUFDLG1CQUFtQi9DLFdBQ3RCNkIsS0FBSyxDQUFDLGVBQWU7UUFBRUMsV0FBVztJQUFLO0lBRTFDLElBQUl6RCxPQUFPLE1BQU1BO0lBRWpCLE9BQU9wQjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlaUcsbUJBQW1CQyxPQUFlO0lBQ3RELE1BQU0sRUFBRWxHLElBQUksRUFBRW9CLEtBQUssRUFBRSxHQUFHLE1BQU10QixTQUMzQnVCLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLGlEQUNQNkUsRUFBRSxDQUFDLENBQUMsYUFBYSxFQUFFRCxRQUFRLGlCQUFpQixFQUFFQSxRQUFRLENBQUMsQ0FBQyxFQUN4RHRCLEtBQUssQ0FBQyxjQUFjO1FBQUVDLFdBQVc7SUFBTTtJQUUxQyxJQUFJekQsT0FBTyxNQUFNQTtJQUVqQixPQUFPcEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL3V0aWxzL3N1cGFiYXNlSGFuZGxlci50cz85YmZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XHJcbmltcG9ydCB7IENoYXRNZXNzYWdlLCBDaGF0Q2h1bmssIENoYXRTZXNzaW9uIH0gZnJvbSAnQC90eXBlcyc7XHJcbmltcG9ydCB7IGdldEVtYmVkZGluZywgY2h1bmtNZXNzYWdlcyB9IGZyb20gJy4vZW1iZWRkaW5ncyc7XHJcblxyXG4vLyBTdXBhYmFzZSDtgbTrnbzsnbTslrjtirgg7J6s7IKs7JqpXHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IHN1cGFiYXNlQWRtaW47XHJcblxyXG4vKipcclxuICogSlNPTiDrjbDsnbTthLDrpbwg7JWI7KCE7ZWY6rKMIOyymOumrO2VqeuLiOuLpC5cclxuICogUG9zdGdyZVNRTOyXkCDsoIDsnqXtlZjquLAg7KCEIOycoO2aqO2VmOyngCDslYrsnYAg66y47J6Q64KYIOq1rOyhsOulvCDsoJzqsbDtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZUpzb25EYXRhKGRhdGE6IGFueSk6IGFueSB7XHJcbiAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcclxuICBcclxuICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAvLyDrrLjsnpDsl7Tsl5DshJwg7KCc7Ja0IOusuOyekCDsoJzqsbAg67CPIOycoOuLiOy9lOuTnCDrrLjsnpAg7LKY66asIOqwnOyEoFxyXG4gICAgcmV0dXJuIGRhdGFcclxuICAgICAgLnJlcGxhY2UoL1tcXHUwMDAwLVxcdTAwMUZcXHUwMDdGLVxcdTAwOUZdL2csICcgJykgIC8vIOygnOyWtCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9bXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdL2csIG1hdGNoID0+IG1hdGNoKSAvLyDsmKzrsJTrpbgg7Jyg64uI7L2U65OcIOydtOuqqOyngCDsnKDsp4BcclxuICAgICAgLnJlcGxhY2UoL1xcdUZGRkQvZywgJycpIC8vIOuMgOyytCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8g7Jew7IaN65CcIOqzteuwsSDsoJzqsbBcclxuICAgICAgLnRyaW0oKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcclxuICAgIC8vIOuwsOyXtOydmCDqsIEg7ZWt66qpIOygleygnFxyXG4gICAgcmV0dXJuIGRhdGEubWFwKGl0ZW0gPT4gc2FuaXRpemVKc29uRGF0YShpdGVtKSk7XHJcbiAgfVxyXG4gIFxyXG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkge1xyXG4gICAgLy8g6rCd7LK07J2YIOqwgSDtlYTrk5wg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWQ6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XHJcbiAgICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUpzb25EYXRhKGRhdGFba2V5XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzYW5pdGl6ZWQ7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIOq4sOuzuCDsnpDro4ztmJXsnYAg6re464yA66GcIOuwmO2ZmFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICogVVJM7J20IOydtOuvuCDsoIDsnqXrkJjslrQg7J6I64qU7KeAIO2ZleyduO2VqeuLiOuLpC5cclxuICogQHBhcmFtIHVybCDtmZXsnbjtlaAgVVJMXHJcbiAqIEByZXR1cm5zIOykkeuztSDsl6zrtoDsmYAg6riw7KG0IOyEuOyFmCDsoJXrs7RcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1VybEV4aXN0cyh1cmw6IHN0cmluZyk6IFByb21pc2U8eyBleGlzdHM6IGJvb2xlYW47IHNlc3Npb24/OiBQYXJ0aWFsPENoYXRTZXNzaW9uPiB9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFVSTCDsoJXqt5ztmZQgKOy/vOumrCDtjIzrnbzrr7jthLAg65OxIOygnOqxsClcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBuZXcgVVJMKHVybCkub3JpZ2luICsgbmV3IFVSTCh1cmwpLnBhdGhuYW1lO1xyXG4gICAgXHJcbiAgICAvLyDsoJXqt5ztmZTrkJwgVVJM66GcIOyLnOyeke2VmOuKlCDshLjshZgg6rKA7IOJXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0JylcclxuICAgICAgLmlsaWtlKCd1cmwnLCBgJHtub3JtYWxpemVkVXJsfSVgKVxyXG4gICAgICAubGltaXQoMSk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4geyBleGlzdHM6IHRydWUsIHNlc3Npb246IGRhdGFbMF0gfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgZXhpc3RzOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOyViOyghO2VmOqyjCDspJHrs7XsnbQg7JWE64uMIOqyg+ycvOuhnCDsspjrpqxcclxuICAgIHJldHVybiB7IGV4aXN0czogZmFsc2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrjIDtmZQg7IS47IWY7J2EIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRDaGF0U2Vzc2lvbih7XHJcbiAgdGl0bGUsXHJcbiAgdXJsLFxyXG4gIHN1bW1hcnksXHJcbiAgbWVzc2FnZXMsXHJcbiAgbWV0YWRhdGEgPSB7fSxcclxuICBza2lwRHVwbGljYXRlQ2hlY2sgPSBmYWxzZVxyXG59OiB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIHNraXBEdXBsaWNhdGVDaGVjaz86IGJvb2xlYW47XHJcbn0pIHtcclxuICB0cnkge1xyXG4gICAgLy8gVVJMIOykkeuztSDtmZXsnbggKHNraXBEdXBsaWNhdGVDaGVja+qwgCBmYWxzZeydvCDrlYzrp4wpXHJcbiAgICBpZiAoIXNraXBEdXBsaWNhdGVDaGVjayAmJiB1cmwpIHtcclxuICAgICAgY29uc3QgeyBleGlzdHMsIHNlc3Npb24gfSA9IGF3YWl0IGNoZWNrVXJsRXhpc3RzKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFVSTOydtCDsnbTrr7gg7KG07J6s7ZWp64uI64ukOiAke3VybH1gKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhg6riw7KG0IOyEuOyFmCDsoJXrs7Q6ICR7c2Vzc2lvbj8udGl0bGV9ICgke3Nlc3Npb24/LmlkfSlgKTtcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgIGlkOiBzZXNzaW9uPy5pZCwgXHJcbiAgICAgICAgICBkdXBsaWNhdGU6IHRydWUsIFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLicgXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDrjbDsnbTthLAg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRUaXRsZSA9IHNhbml0aXplSnNvbkRhdGEodGl0bGUpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkU3VtbWFyeSA9IHNhbml0aXplSnNvbkRhdGEoc3VtbWFyeSk7XHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkTWV0YWRhdGEgPSBzYW5pdGl6ZUpzb25EYXRhKG1ldGFkYXRhKTtcclxuICAgIFxyXG4gICAgLy8g7JqU7JW9IO2FjeyKpO2KuCDsnoTrsqDrlKkg7IOd7ISxXHJcbiAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkU3VtbWFyeSk7XHJcbiAgICBcclxuICAgIC8vIOyEuOyFmCDrjbDsnbTthLAg7IK97J6FXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgIHRpdGxlOiBzYW5pdGl6ZWRUaXRsZSxcclxuICAgICAgICB1cmwsXHJcbiAgICAgICAgc3VtbWFyeTogc2FuaXRpemVkU3VtbWFyeSxcclxuICAgICAgICBtZXNzYWdlczogc2FuaXRpemVkTWVzc2FnZXMsXHJcbiAgICAgICAgbWV0YWRhdGE6IHNhbml0aXplZE1ldGFkYXRhLFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9KVxyXG4gICAgICAuc2VsZWN0KCdpZCcpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgLi4uZGF0YSwgZHVwbGljYXRlOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfrjIDtmZQg7IS47IWYIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlCDssq3tgazrpbwg7IOd7ISx7ZWY6rOgIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzQW5kSW5zZXJ0Q2h1bmtzKFxyXG4gIHNlc3Npb25JZDogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTsi5zsp4Ag7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgXHJcbiAgICAvLyDrqZTsi5zsp4Drpbwg7LKt7YGs66GcIOu2hO2VoFxyXG4gICAgY29uc3QgY2h1bmtzID0gY2h1bmtNZXNzYWdlcyhzYW5pdGl6ZWRNZXNzYWdlcyk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+nsSDrtoTtlaDrkJwg7LKt7YGsOicsIGNodW5rcyk7XHJcbiAgICBcclxuICAgIC8vIOqwgSDssq3tgazsl5Ag64yA7ZW0IOyehOuyoOuUqSDsg53shLEg67CPIOyggOyepVxyXG4gICAgY29uc3QgY2h1bmtQcm9taXNlcyA9IGNodW5rcy5tYXAoYXN5bmMgKGNodW5rKSA9PiB7XHJcbiAgICAgIC8vIOyyre2BrCDrgrTsmqkg7KCV7KCcXHJcbiAgICAgIGNvbnN0IHNhbml0aXplZENvbnRlbnQgPSBzYW5pdGl6ZUpzb25EYXRhKGNodW5rLmNvbnRlbnQpO1xyXG4gICAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkQ29udGVudCk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGNoYXRfc2Vzc2lvbl9pZDogc2Vzc2lvbklkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiBjaHVuay5jaHVua19pbmRleCxcclxuICAgICAgICBjb250ZW50OiBzYW5pdGl6ZWRDb250ZW50LFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIOuqqOuToCDssq3tgawg7J6E67Kg65SpIOyymOumrCDsmYTro4wg64yA6riwXHJcbiAgICBjb25zdCBjaHVua3NXaXRoRW1iZWRkaW5ncyA9IGF3YWl0IFByb21pc2UuYWxsKGNodW5rUHJvbWlzZXMpO1xyXG4gICAgXHJcbiAgICAvLyDssq3tgawg642w7J207YSwIOyCveyehSAo7LWc64yAIDFNQiDsoJztlZzsnLzroZwg7LKt7YGsIDEw6rCc7JSpIOuwsOy5mCDsspjrpqwpXHJcbiAgICBjb25zdCBiYXRjaFNpemUgPSAxMDtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XHJcbiAgICAgIGNvbnN0IGJhdGNoID0gY2h1bmtzV2l0aEVtYmVkZGluZ3Muc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2hhdF9jaHVua3MnKVxyXG4gICAgICAgICAgLmluc2VydChiYXRjaCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICByZXN1bHRzLnB1c2goZGF0YSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg7LKt7YGsIOuwsOy5mCAke2l9LyR7Y2h1bmtzV2l0aEVtYmVkZGluZ3MubGVuZ3RofSDsoIDsnqUg7KSRIOyYpOulmDpgLCBlcnJvcik7XHJcbiAgICAgICAgLy8g6rCc67OEIOyyre2BrCDsl5Drn6zrpbwg6riw66Gd7ZWY65CYIOyghOyytCDtlITroZzshLjsiqTripQg6rOE7IaNIOynhO2WiVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGNvdW50OiBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGggfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7LKt7YGsIOyymOumrCDrsI8g7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog7Jyg7IKs7ZWcIOyyre2BrOulvCDqsoDsg4ntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoU2ltaWxhckNodW5rcyhcclxuICBxdWVyeTogc3RyaW5nLFxyXG4gIHNpbWlsYXJpdHk6IG51bWJlciA9IDAuMywgIC8vIOq4sOuzuOqwkiAwLjXsl5DshJwgMC4z7Jy866GcIOuNlCDrgq7stqRcclxuICBsaW1pdDogbnVtYmVyID0gMTBcclxuKTogUHJvbWlzZTxDaGF0Q2h1bmtbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTtg4Ag7KeI66y4IOqwkOyngCAo7JiIOiBcIuydtCDrjIDtmZTsnZgg7ZW17Ius7J20IOutkOyVvD9cIiwgXCLsmpTslb3tlbTspJhcIiDrk7EpXHJcbiAgICBjb25zdCBtZXRhUXVlc3Rpb25QYXR0ZXJucyA9IFtcclxuICAgICAgL+ydtFxccyrrjIDtmZTsnZg/XFxzKijtlbXsi6x87JqU7JW9fOuCtOyaqXzso7zsoJwpL2ksXHJcbiAgICAgIC/rjIDtmZTrpbw/XFxzKijsmpTslb187KCV66asKS9pLFxyXG4gICAgICAv7JqU7JW97ZW0XFxzKuykmC9pLFxyXG4gICAgICAv7ZW17IusXFxzKijrgrTsmql87Y+s7J247Yq4KS9pLFxyXG4gICAgICAv7KO87JqUXFxzKijrgrTsmql87Y+s7J247Yq4KS9pXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBjb25zdCBpc01ldGFRdWVzdGlvbiA9IG1ldGFRdWVzdGlvblBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QocXVlcnkpKTtcclxuICAgIFxyXG4gICAgaWYgKGlzTWV0YVF1ZXN0aW9uKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfrqZTtg4Ag7KeI66y4IOqwkOyngOuQqCwg66qo65OgIOyEuOyFmOydmCDsmpTslb0g7KCV67O066W8IOqygOyDie2VqeuLiOuLpC4nKTtcclxuICAgICAgLy8g66mU7YOAIOyniOusuOyduCDqsr3smrAg6rCA7J6lIOy1nOq3vCDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDqsIDsoLjsmKTquLBcclxuICAgICAgY29uc3QgeyBkYXRhOiBzZXNzaW9uRGF0YSwgZXJyb3I6IHNlc3Npb25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQsIHRpdGxlLCBzdW1tYXJ5JylcclxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgICAubGltaXQoMSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uRGF0YSB8fCBzZXNzaW9uRGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ+yEuOyFmCDrjbDsnbTthLDrpbwg7LC+7J2EIOyImCDsl4bsirXri4jri6QuJyk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDssq3tgazroZwg67OA7ZmY7ZWY7JesIOuwmO2ZmFxyXG4gICAgICBjb25zdCBzZXNzaW9uID0gc2Vzc2lvbkRhdGFbMF07XHJcbiAgICAgIGNvbnN0IGZha2VDaHVuazogQ2hhdENodW5rID0ge1xyXG4gICAgICAgIGlkOiAnbWV0YS1xdWVzdGlvbi1jaHVuaycsXHJcbiAgICAgICAgY2hhdF9zZXNzaW9uX2lkOiBzZXNzaW9uLmlkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiAwLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBb7JqU7JW9XTogJHtzZXNzaW9uLnN1bW1hcnl9YCxcclxuICAgICAgICBzaW1pbGFyaXR5OiAxLjBcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBbZmFrZUNodW5rXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOqygOyDiSDsv7zrpqw6IFwiJHtxdWVyeX1cIiwg7Jyg7IKs64+EIOyehOqzhOqwkjogJHtzaW1pbGFyaXR5fSwg7KCc7ZWcOiAke2xpbWl0fWApO1xyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOygleygnFxyXG4gICAgY29uc3Qgc2FuaXRpemVkUXVlcnkgPSBzYW5pdGl6ZUpzb25EYXRhKHF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsoJXsoJzrkJwg7L+866asOiBcIiR7c2FuaXRpemVkUXVlcnl9XCJgKTtcclxuICAgIFxyXG4gICAgaWYgKCFzYW5pdGl6ZWRRdWVyeSB8fCBzYW5pdGl6ZWRRdWVyeS50cmltKCkubGVuZ3RoIDwgMikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+y/vOumrOqwgCDrhIjrrLQg7Ken6rGw64KYIOu5hOyWtCDsnojsirXri4jri6QnKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOyehOuyoOuUqSDsg53shLFcclxuICAgIGNvbnN0IHF1ZXJ5RW1iZWRkaW5nID0gYXdhaXQgZ2V0RW1iZWRkaW5nKHNhbml0aXplZFF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsnoTrsqDrlKkg7IOd7ISxIOyZhOujjDogJHtxdWVyeUVtYmVkZGluZy5sZW5ndGh9IOywqOybkGApO1xyXG4gICAgXHJcbiAgICAvLyDsnKDsgqztlZwg7LKt7YGsIOqygOyDiVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFxyXG4gICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAge1xyXG4gICAgICAgIHF1ZXJ5X2VtYmVkZGluZzogcXVlcnlFbWJlZGRpbmcsXHJcbiAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBzaW1pbGFyaXR5LFxyXG4gICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGDqsoDsg4nrkJwg7LKt7YGsIOyImDogJHtkYXRhPy5sZW5ndGggfHwgMH1gKTtcclxuICAgIFxyXG4gICAgLy8g6rKA7IOJIOqysOqzvOqwgCDsl4bripQg6rK97JqwIOycoOyCrOuPhCDsnoTqs4TqsJLsnYQg64Ku7Law7IScIOuLpOyLnCDsi5zrj4QgKDLri6jqs4TroZwg64Ku7LakKVxyXG4gICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIC8vIOyyqyDrsojsp7gg7J6s7Iuc64+EOiDsnoTqs4TqsJLsnYQgNTAlIOuCruy2pFxyXG4gICAgICBjb25zdCBsb3dlclRocmVzaG9sZCA9IHNpbWlsYXJpdHkgKiAwLjU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDqsrDqs7zqsIAg7JeG7Ja0IOycoOyCrOuPhCDsnoTqs4TqsJLsnYQgJHtsb3dlclRocmVzaG9sZC50b0ZpeGVkKDIpfeuhnCDrgq7strAg7J6s7Iuc64+EYCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB7IGRhdGE6IHJldHJ5RGF0YSwgZXJyb3I6IHJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBsb3dlclRocmVzaG9sZCxcclxuICAgICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign64Ku7J2AIOyehOqzhOqwkuycvOuhnCDsnqzsi5zrj4Qg7KSRIOyYpOulmDonLCByZXRyeUVycm9yKTtcclxuICAgICAgfSBlbHNlIGlmIChyZXRyeURhdGEgJiYgcmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg64Ku7J2AIOyehOqzhOqwkuycvOuhnCAke3JldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICByZXR1cm4gcmV0cnlEYXRhO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOuRkCDrsojsp7gg7J6s7Iuc64+EOiDrp6TsmrAg64Ku7J2AIOyehOqzhOqwkiAoMC4xKeycvOuhnCDsi5zrj4RcclxuICAgICAgICBjb25zdCBsb3dlc3RUaHJlc2hvbGQgPSAwLjE7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOqysOqzvOqwgCDsl6zsoITtnogg7JeG7Ja0IOy1nOyggCDsnoTqs4TqsJIgJHtsb3dlc3RUaHJlc2hvbGQudG9GaXhlZCgyKX3roZwg7J6s7Iuc64+EYCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBsYXN0UmV0cnlEYXRhLCBlcnJvcjogbGFzdFJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAgICdtYXRjaF9jaHVua3MnLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgICBtYXRjaF90aHJlc2hvbGQ6IGxvd2VzdFRocmVzaG9sZCxcclxuICAgICAgICAgICAgbWF0Y2hfY291bnQ6IGxpbWl0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGFzdFJldHJ5RXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyggCDsnoTqs4TqsJLsnLzroZwg7J6s7Iuc64+EIOykkSDsmKTrpZg6JywgbGFzdFJldHJ5RXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGFzdFJldHJ5RGF0YSAmJiBsYXN0UmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDstZzsoIAg7J6E6rOE6rCS7Jy866GcICR7bGFzdFJldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICAgIHJldHVybiBsYXN0UmV0cnlEYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDshLjshZggSUTroZwg64yA7ZmUIOyEuOyFmOydhCDsobDtmoztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdFNlc3Npb25CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPENoYXRTZXNzaW9uPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgLnNpbmdsZSgpO1xyXG4gICAgXHJcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICBcclxuICByZXR1cm4gZGF0YTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOuqqOuToCDrjIDtmZQg7IS47IWY7J2EIOyhsO2ajO2VqeuLiOuLpC5cclxuICog7JqU7JW9IOygleuztOunjCDrsJjtmZjtlanri4jri6QgKOyghOyytCDrqZTsi5zsp4DripQg7KCc7Jm4KS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxDaGF0U2Vzc2lvbnMoKTogUHJvbWlzZTxQYXJ0aWFsPENoYXRTZXNzaW9uPltdPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0LCBtZXRhZGF0YScpXHJcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOyEuOyFmOydmCDrqqjrk6Ag7LKt7YGs66W8IOqwgOyguOyYteuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaHVua3NCeVNlc3Npb25JZChzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Q2hhdENodW5rW10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfY2h1bmtzJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdjaGF0X3Nlc3Npb25faWQnLCBzZXNzaW9uSWQpXHJcbiAgICAub3JkZXIoJ2NodW5rX2luZGV4JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog7YKk7JuM65Oc66GcIOuMgO2ZlCDshLjshZjsnYQg6rKA7IOJ7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaENoYXRTZXNzaW9ucyhrZXl3b3JkOiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8Q2hhdFNlc3Npb24+W10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfc2Vzc2lvbnMnKVxyXG4gICAgLnNlbGVjdCgnaWQsIHRpdGxlLCB1cmwsIHN1bW1hcnksIGNyZWF0ZWRfYXQsIG1ldGFkYXRhJylcclxuICAgIC5vcihgdGl0bGUuaWxpa2UuJSR7a2V5d29yZH0lLHN1bW1hcnkuaWxpa2UuJSR7a2V5d29yZH0lYClcclxuICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuICAgIFxyXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGE7XHJcbn0gIl0sIm5hbWVzIjpbInN1cGFiYXNlQWRtaW4iLCJnZXRFbWJlZGRpbmciLCJjaHVua01lc3NhZ2VzIiwic3VwYWJhc2UiLCJzYW5pdGl6ZUpzb25EYXRhIiwiZGF0YSIsInJlcGxhY2UiLCJtYXRjaCIsInRyaW0iLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJpdGVtIiwic2FuaXRpemVkIiwia2V5IiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY2hlY2tVcmxFeGlzdHMiLCJ1cmwiLCJub3JtYWxpemVkVXJsIiwiVVJMIiwib3JpZ2luIiwicGF0aG5hbWUiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJpbGlrZSIsImxpbWl0IiwiY29uc29sZSIsImxlbmd0aCIsImV4aXN0cyIsInNlc3Npb24iLCJpbnNlcnRDaGF0U2Vzc2lvbiIsInRpdGxlIiwic3VtbWFyeSIsIm1lc3NhZ2VzIiwibWV0YWRhdGEiLCJza2lwRHVwbGljYXRlQ2hlY2siLCJsb2ciLCJpZCIsImR1cGxpY2F0ZSIsIm1lc3NhZ2UiLCJzYW5pdGl6ZWRUaXRsZSIsInNhbml0aXplZFN1bW1hcnkiLCJzYW5pdGl6ZWRNZXNzYWdlcyIsInNhbml0aXplZE1ldGFkYXRhIiwiZW1iZWRkaW5nIiwiaW5zZXJ0Iiwic2luZ2xlIiwicHJvY2Vzc0FuZEluc2VydENodW5rcyIsInNlc3Npb25JZCIsImNodW5rcyIsImNodW5rUHJvbWlzZXMiLCJjaHVuayIsInNhbml0aXplZENvbnRlbnQiLCJjb250ZW50IiwiY2hhdF9zZXNzaW9uX2lkIiwiY2h1bmtfaW5kZXgiLCJjaHVua3NXaXRoRW1iZWRkaW5ncyIsIlByb21pc2UiLCJhbGwiLCJiYXRjaFNpemUiLCJyZXN1bHRzIiwiaSIsImJhdGNoIiwic2xpY2UiLCJwdXNoIiwic3VjY2VzcyIsImNvdW50Iiwic2VhcmNoU2ltaWxhckNodW5rcyIsInF1ZXJ5Iiwic2ltaWxhcml0eSIsIm1ldGFRdWVzdGlvblBhdHRlcm5zIiwiaXNNZXRhUXVlc3Rpb24iLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJzZXNzaW9uRGF0YSIsInNlc3Npb25FcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwid2FybiIsImZha2VDaHVuayIsInNhbml0aXplZFF1ZXJ5IiwicXVlcnlFbWJlZGRpbmciLCJycGMiLCJxdWVyeV9lbWJlZGRpbmciLCJtYXRjaF90aHJlc2hvbGQiLCJtYXRjaF9jb3VudCIsImxvd2VyVGhyZXNob2xkIiwidG9GaXhlZCIsInJldHJ5RGF0YSIsInJldHJ5RXJyb3IiLCJsb3dlc3RUaHJlc2hvbGQiLCJsYXN0UmV0cnlEYXRhIiwibGFzdFJldHJ5RXJyb3IiLCJnZXRDaGF0U2Vzc2lvbkJ5SWQiLCJlcSIsImdldEFsbENoYXRTZXNzaW9ucyIsImdldENodW5rc0J5U2Vzc2lvbklkIiwic2VhcmNoQ2hhdFNlc3Npb25zIiwia2V5d29yZCIsIm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/supabaseHandler.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/@supabase","vendor-chunks/gpt-tokenizer","vendor-chunks/form-data-encoder","vendor-chunks/uuid","vendor-chunks/whatwg-url","vendor-chunks/agentkeepalive","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/ms","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();