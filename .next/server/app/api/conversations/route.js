"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/conversations/route";
exports.ids = ["app/api/conversations/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "@sparticuz/chromium":
/*!**************************************!*\
  !*** external "@sparticuz/chromium" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@sparticuz/chromium");

/***/ }),

/***/ "puppeteer-core":
/*!*********************************!*\
  !*** external "puppeteer-core" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("puppeteer-core");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_pmkProject_src_app_api_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/conversations/route.ts */ \"(rsc)/./src/app/api/conversations/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/conversations/route\",\n        pathname: \"/api/conversations\",\n        filename: \"route\",\n        bundlePath: \"app/api/conversations/route\"\n    },\n    resolvedPagePath: \"C:\\\\pmkProject\\\\src\\\\app\\\\api\\\\conversations\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_pmkProject_src_app_api_conversations_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/conversations/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjb252ZXJzYXRpb25zJTJGcm91dGUmcGFnZT0lMkZhcGklMkZjb252ZXJzYXRpb25zJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY29udmVyc2F0aW9ucyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDcG1rUHJvamVjdCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3Bta1Byb2plY3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ007QUFDbkY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8/OTMyOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxwbWtQcm9qZWN0XFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNvbnZlcnNhdGlvbnNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY29udmVyc2F0aW9uc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY29udmVyc2F0aW9ucy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXHBta1Byb2plY3RcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY29udmVyc2F0aW9uc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/conversations/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/conversations/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _utils_conversationHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/conversationHandler */ \"(rsc)/./src/utils/conversationHandler.ts\");\n\n\nasync function POST(request) {\n    try {\n        console.log(\"=== Processing conversation request ===\");\n        const body = await request.json().catch((e)=>{\n            console.error(\"Failed to parse request body:\", e);\n            return null;\n        });\n        if (!body || !body.url) {\n            console.error(\"Missing URL in request body\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"ChatGPT 공유 URL이 필요합니다.\"\n            }, {\n                status: 400\n            });\n        }\n        const { url, options = {\n            saveToSupabase: true,\n            saveToObsidian: true,\n            saveAsJson: true\n        } } = body;\n        console.log(`Processing URL: \"${url}\"`);\n        console.log(`Save options:`, options);\n        // 통합 저장 핸들러 호출\n        const result = await (0,_utils_conversationHandler__WEBPACK_IMPORTED_MODULE_1__.saveConversation)(url, options);\n        if (!result.success) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: result.error || \"대화 처리 중 오류가 발생했습니다.\"\n            }, {\n                status: 500\n            });\n        }\n        // 중복 URL 처리\n        if (result.duplicate) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                duplicate: true,\n                message: \"이미 저장된 대화입니다.\",\n                data: {\n                    id: result.id,\n                    title: result.title,\n                    url\n                }\n            });\n        }\n        // 성공 응답\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            data: {\n                conversation: {\n                    id: result.id,\n                    title: result.title\n                },\n                summary: result.summary,\n                keywords: result.keywords,\n                obsidian: result.obsidian,\n                jsonBackup: result.jsonBackup\n            }\n        });\n    } catch (error) {\n        console.error(\"Error processing conversation:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: error instanceof Error ? error.message : \"대화 처리 중 오류가 발생했습니다.\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jb252ZXJzYXRpb25zL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEwQztBQUNvQjtBQUV2RCxlQUFlRSxLQUFLQyxPQUFnQjtJQUN6QyxJQUFJO1FBQ0ZDLFFBQVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1DLE9BQU8sTUFBTUgsUUFBUUksSUFBSSxHQUFHQyxLQUFLLENBQUNDLENBQUFBO1lBQ3RDTCxRQUFRTSxLQUFLLENBQUMsaUNBQWlDRDtZQUMvQyxPQUFPO1FBQ1Q7UUFFQSxJQUFJLENBQUNILFFBQVEsQ0FBQ0EsS0FBS0ssR0FBRyxFQUFFO1lBQ3RCUCxRQUFRTSxLQUFLLENBQUM7WUFDZCxPQUFPVixrRkFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtnQkFBRUssU0FBUztnQkFBT0YsT0FBTztZQUF5QixHQUNsRDtnQkFBRUcsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTSxFQUFFRixHQUFHLEVBQUVHLFVBQVU7WUFDckJDLGdCQUFnQjtZQUNoQkMsZ0JBQWdCO1lBQ2hCQyxZQUFZO1FBQ2QsQ0FBQyxFQUFFLEdBQUdYO1FBRU5GLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFTSxJQUFJLENBQUMsQ0FBQztRQUN0Q1AsUUFBUUMsR0FBRyxDQUFDLENBQUMsYUFBYSxDQUFDLEVBQUVTO1FBRTdCLGVBQWU7UUFDZixNQUFNSSxTQUFTLE1BQU1qQiw0RUFBZ0JBLENBQUNVLEtBQUtHO1FBRTNDLElBQUksQ0FBQ0ksT0FBT04sT0FBTyxFQUFFO1lBQ25CLE9BQU9aLGtGQUFZQSxDQUFDTyxJQUFJLENBQ3RCO2dCQUFFSyxTQUFTO2dCQUFPRixPQUFPUSxPQUFPUixLQUFLLElBQUk7WUFBc0IsR0FDL0Q7Z0JBQUVHLFFBQVE7WUFBSTtRQUVsQjtRQUVBLFlBQVk7UUFDWixJQUFJSyxPQUFPQyxTQUFTLEVBQUU7WUFDcEIsT0FBT25CLGtGQUFZQSxDQUFDTyxJQUFJLENBQUM7Z0JBQ3ZCSyxTQUFTO2dCQUNUTyxXQUFXO2dCQUNYQyxTQUFTO2dCQUNUQyxNQUFNO29CQUNKQyxJQUFJSixPQUFPSSxFQUFFO29CQUNiQyxPQUFPTCxPQUFPSyxLQUFLO29CQUNuQlo7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUEsUUFBUTtRQUNSLE9BQU9YLGtGQUFZQSxDQUFDTyxJQUFJLENBQUM7WUFDdkJLLFNBQVM7WUFDVFMsTUFBTTtnQkFDSkcsY0FBYztvQkFDWkYsSUFBSUosT0FBT0ksRUFBRTtvQkFDYkMsT0FBT0wsT0FBT0ssS0FBSztnQkFDckI7Z0JBQ0FFLFNBQVNQLE9BQU9PLE9BQU87Z0JBQ3ZCQyxVQUFVUixPQUFPUSxRQUFRO2dCQUN6QkMsVUFBVVQsT0FBT1MsUUFBUTtnQkFDekJDLFlBQVlWLE9BQU9VLFVBQVU7WUFDL0I7UUFDRjtJQUNGLEVBQUUsT0FBT2xCLE9BQU87UUFDZE4sUUFBUU0sS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsT0FBT1Ysa0ZBQVlBLENBQUNPLElBQUksQ0FDdEI7WUFDRUssU0FBUztZQUNURixPQUFPQSxpQkFBaUJtQixRQUFRbkIsTUFBTVUsT0FBTyxHQUFHO1FBQ2xELEdBQ0E7WUFBRVAsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wa20tcHJvamVjdC8uL3NyYy9hcHAvYXBpL2NvbnZlcnNhdGlvbnMvcm91dGUudHM/ZmY1MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgc2F2ZUNvbnZlcnNhdGlvbiB9IGZyb20gJ0AvdXRpbHMvY29udmVyc2F0aW9uSGFuZGxlcidcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpOiBQcm9taXNlPFJlc3BvbnNlPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCc9PT0gUHJvY2Vzc2luZyBjb252ZXJzYXRpb24gcmVxdWVzdCA9PT0nKTtcclxuICAgIFxyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpLmNhdGNoKGUgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgcmVxdWVzdCBib2R5OicsIGUpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoIWJvZHkgfHwgIWJvZHkudXJsKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ01pc3NpbmcgVVJMIGluIHJlcXVlc3QgYm9keScpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDaGF0R1BUIOqzteycoCBVUkzsnbQg7ZWE7JqU7ZWp64uI64ukLicgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgeyB1cmwsIG9wdGlvbnMgPSB7IFxyXG4gICAgICBzYXZlVG9TdXBhYmFzZTogdHJ1ZSwgXHJcbiAgICAgIHNhdmVUb09ic2lkaWFuOiB0cnVlLCBcclxuICAgICAgc2F2ZUFzSnNvbjogdHJ1ZSBcclxuICAgIH0gfSA9IGJvZHk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIFVSTDogXCIke3VybH1cImApO1xyXG4gICAgY29uc29sZS5sb2coYFNhdmUgb3B0aW9uczpgLCBvcHRpb25zKTtcclxuXHJcbiAgICAvLyDthrXtlakg7KCA7J6lIO2VuOuTpOufrCDtmLjstpxcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNhdmVDb252ZXJzYXRpb24odXJsLCBvcHRpb25zKTtcclxuICAgIFxyXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHJlc3VsdC5lcnJvciB8fCAn64yA7ZmUIOyymOumrCDspJEg7Jik66WY6rCAIOuwnOyDne2WiOyKteuLiOuLpC4nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOykkeuztSBVUkwg7LKY66asXHJcbiAgICBpZiAocmVzdWx0LmR1cGxpY2F0ZSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZHVwbGljYXRlOiB0cnVlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICfsnbTrr7gg7KCA7J6l65CcIOuMgO2ZlOyeheuLiOuLpC4nLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGlkOiByZXN1bHQuaWQsXHJcbiAgICAgICAgICB0aXRsZTogcmVzdWx0LnRpdGxlLFxyXG4gICAgICAgICAgdXJsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g7ISx6rO1IOydkeuLtVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGNvbnZlcnNhdGlvbjoge1xyXG4gICAgICAgICAgaWQ6IHJlc3VsdC5pZCxcclxuICAgICAgICAgIHRpdGxlOiByZXN1bHQudGl0bGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN1bW1hcnk6IHJlc3VsdC5zdW1tYXJ5LFxyXG4gICAgICAgIGtleXdvcmRzOiByZXN1bHQua2V5d29yZHMsXHJcbiAgICAgICAgb2JzaWRpYW46IHJlc3VsdC5vYnNpZGlhbixcclxuICAgICAgICBqc29uQmFja3VwOiByZXN1bHQuanNvbkJhY2t1cFxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBjb252ZXJzYXRpb246JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64yA7ZmUIOyymOumrCDspJEg7Jik66WY6rCAIOuwnOyDne2WiOyKteuLiOuLpC4nIFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInNhdmVDb252ZXJzYXRpb24iLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwianNvbiIsImNhdGNoIiwiZSIsImVycm9yIiwidXJsIiwic3VjY2VzcyIsInN0YXR1cyIsIm9wdGlvbnMiLCJzYXZlVG9TdXBhYmFzZSIsInNhdmVUb09ic2lkaWFuIiwic2F2ZUFzSnNvbiIsInJlc3VsdCIsImR1cGxpY2F0ZSIsIm1lc3NhZ2UiLCJkYXRhIiwiaWQiLCJ0aXRsZSIsImNvbnZlcnNhdGlvbiIsInN1bW1hcnkiLCJrZXl3b3JkcyIsIm9ic2lkaWFuIiwianNvbkJhY2t1cCIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/conversations/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getClientSupabase: () => (/* binding */ getClientSupabase),\n/* harmony export */   getServerSupabase: () => (/* binding */ getServerSupabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   supabaseClient: () => (/* binding */ supabaseClient),\n/* harmony export */   testSupabaseConnection: () => (/* binding */ testSupabaseConnection)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Supabase Client\nconst supabaseUrl = \"https://ghtqqcoyakjozzhegktl.supabase.co\" || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY || \"\";\n// 서비스 키를 사용한 클라이언트 (백엔드 전용) - RLS 우회\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey);\n// 익명 키를 사용한 클라이언트 (프론트엔드 안전)\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdodHFxY295YWtqb=\\\"\\\"3p6aGVna3RsIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjA4NjkwMywiZXhwIjoyMDYxNjYyOTAzfQ.3Ygn7Ql9okDXtYnTblDXKLg2wXge1tHhm5Zok_N283k\" || 0;\nconst supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n/**\r\n * 백엔드 API에서 사용할 Supabase 클라이언트 인스턴스를 반환합니다.\r\n * RLS 정책을 우회할 수 있는 서비스 키를 사용합니다.\r\n */ function getServerSupabase() {\n    return supabaseAdmin;\n}\n/**\r\n * 브라우저에서 사용할 Supabase 클라이언트 인스턴스를 반환합니다.\r\n * RLS 정책이 적용된 익명 키를 사용합니다.\r\n */ function getClientSupabase() {\n    return supabaseClient;\n}\n// Supabase 연결 테스트 함수\nasync function testSupabaseConnection() {\n    try {\n        // 환경 변수만 확인\n        if (!supabaseUrl) {\n            throw new Error(\"Supabase URL이 설정되지 않았습니다\");\n        }\n        if (!supabaseServiceKey) {\n            throw new Error(\"Supabase 서비스 키가 설정되지 않았습니다\");\n        }\n        if (!supabaseAnonKey) {\n            throw new Error(\"Supabase 익명 키가 설정되지 않았습니다\");\n        }\n        return {\n            success: true,\n            message: \"Supabase 환경 변수 확인 완료, 마이그레이션을 진행합니다.\"\n        };\n    } catch (error) {\n        console.error(\"Supabase 연결 테스트 오류:\", error);\n        return {\n            success: false,\n            message: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFxRDtBQUVyRCxrQkFBa0I7QUFDbEIsTUFBTUMsY0FBY0MsMENBQW9DLElBQUk7QUFDNUQsTUFBTUcscUJBQXFCSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQixJQUFJO0FBRS9ELHFDQUFxQztBQUM5QixNQUFNQyxnQkFBZ0JQLG1FQUFZQSxDQUFDQyxhQUFhSSxvQkFBb0I7QUFFM0UsNkJBQTZCO0FBQzdCLE1BQU1HLGtCQUFrQk4sa09BQXlDLElBQUk7QUFDOUQsTUFBTVEsaUJBQWlCVixtRUFBWUEsQ0FBQ0MsYUFBYU8saUJBQWlCO0FBRXpFOzs7Q0FHQyxHQUNNLFNBQVNHO0lBQ2QsT0FBT0o7QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNLO0lBQ2QsT0FBT0Y7QUFDVDtBQUVBLHFCQUFxQjtBQUNkLGVBQWVHO0lBQ3BCLElBQUk7UUFDRixZQUFZO1FBQ1osSUFBSSxDQUFDWixhQUFhO1lBQ2hCLE1BQU0sSUFBSWEsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ1Qsb0JBQW9CO1lBQ3ZCLE1BQU0sSUFBSVMsTUFBTTtRQUNsQjtRQUVBLElBQUksQ0FBQ04saUJBQWlCO1lBQ3BCLE1BQU0sSUFBSU0sTUFBTTtRQUNsQjtRQUVBLE9BQU87WUFDTEMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBTztZQUNMRixTQUFTO1lBQ1RDLFNBQVNDLGlCQUFpQkgsUUFBUUcsTUFBTUQsT0FBTyxHQUFHO1FBQ3BEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL2xpYi9zdXBhYmFzZS50cz8wNmUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcblxyXG4vLyBTdXBhYmFzZSBDbGllbnRcclxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJyc7XHJcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfS0VZIHx8ICcnO1xyXG5cclxuLy8g7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlZwg7YG065287J207Ja47Yq4ICjrsLHsl5Trk5wg7KCE7JqpKSAtIFJMUyDsmrDtmoxcclxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlQWRtaW4gPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSk7XHJcblxyXG4vLyDsnbXrqoUg7YKk66W8IOyCrOyaqe2VnCDtgbTrnbzsnbTslrjtirggKO2UhOuhoO2KuOyXlOuTnCDslYjsoIQpXHJcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICcnO1xyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VDbGllbnQgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XHJcblxyXG4vKipcclxuICog67Cx7JeU65OcIEFQSeyXkOyEnCDsgqzsmqntlaAgU3VwYWJhc2Ug7YG065287J207Ja47Yq4IOyduOyKpO2EtOyKpOulvCDrsJjtmZjtlanri4jri6QuXHJcbiAqIFJMUyDsoJXssYXsnYQg7Jqw7ZqM7ZWgIOyImCDsnojripQg7ISc67mE7IqkIO2CpOulvCDsgqzsmqntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VydmVyU3VwYWJhc2UoKSB7XHJcbiAgcmV0dXJuIHN1cGFiYXNlQWRtaW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDruIzrnbzsmrDsoIDsl5DshJwg7IKs7Jqp7ZWgIFN1cGFiYXNlIO2BtOudvOydtOyWuO2KuCDsnbjsiqTthLTsiqTrpbwg67CY7ZmY7ZWp64uI64ukLlxyXG4gKiBSTFMg7KCV7LGF7J20IOyggeyaqeuQnCDsnbXrqoUg7YKk66W8IOyCrOyaqe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRTdXBhYmFzZSgpIHtcclxuICByZXR1cm4gc3VwYWJhc2VDbGllbnQ7XHJcbn1cclxuXHJcbi8vIFN1cGFiYXNlIOyXsOqysCDthYzsiqTtirgg7ZWo7IiYXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0U3VwYWJhc2VDb25uZWN0aW9uKCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDtmZjqsr0g67OA7IiY66eMIO2ZleyduFxyXG4gICAgaWYgKCFzdXBhYmFzZVVybCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIFVSTOydtCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VTZXJ2aWNlS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7ISc67mE7IqkIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICghc3VwYWJhc2VBbm9uS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignU3VwYWJhc2Ug7J2166qFIO2CpOqwgCDshKTsoJXrkJjsp4Ag7JWK7JWY7Iq164uI64ukJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IFxyXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgbWVzc2FnZTogJ1N1cGFiYXNlIO2ZmOqyvSDrs4DsiJgg7ZmV7J24IOyZhOujjCwg66eI7J206re466CI7J207IWY7J2EIOynhO2Wie2VqeuLiOuLpC4nIFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU3VwYWJhc2Ug7Jew6rKwIO2FjOyKpO2KuCDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WYJyBcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZVNlcnZpY2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX0tFWSIsInN1cGFiYXNlQWRtaW4iLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQ2xpZW50IiwiZ2V0U2VydmVyU3VwYWJhc2UiLCJnZXRDbGllbnRTdXBhYmFzZSIsInRlc3RTdXBhYmFzZUNvbm5lY3Rpb24iLCJFcnJvciIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/chatgpt.ts":
/*!**********************************!*\
  !*** ./src/lib/utils/chatgpt.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseChatGPTLink: () => (/* binding */ parseChatGPTLink)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-action-proxy */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-proxy.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/next/dist/server/app-render/action-encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/types */ \"(rsc)/./src/types.ts\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n// 서버 전용 컴포넌트/유틸 표시\n/* __next_internal_action_entry_do_not_use__ {\"491c471e7f9b8d25a45396e01470b054e19a90ee\":\"parseChatGPTLink\"} */ \n\n// Playwright 관련 import 주석 처리\n// import { chromium, Browser, Page } from 'playwright';\n\n\n\n// Puppeteer와 Chromium 추가 - 서버 사이드에서만 실행\n// @ts-ignore - @sparticuz/chromium 모듈 타입 선언 문제 해결\nconst puppeteer = __webpack_require__(/*! puppeteer-core */ \"puppeteer-core\");\n// @ts-ignore - 타입 오류 무시\nconst chromium = __webpack_require__(/*! @sparticuz/chromium */ \"@sparticuz/chromium\");\n// 클라이언트 측에서는 실행되지 않도록 함\nif (false) {}\n// 운영체제 감지\nconst isWindows = process.platform === \"win32\";\nconst isVercel = process.env.VERCEL === \"1\";\n/**\n * 환경에 맞는 Chromium 실행 경로 가져오기\n */ async function getChromiumPath() {\n    try {\n        // Windows 환경인 경우 로컬에서 Chrome 실행 시도\n        if (isWindows) {\n            // Windows 환경에서는 설치된 Chrome 사용 시도\n            const localChromePaths = [\n                \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                \"C:\\\\Program Files (x86)\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\",\n                process.env.LOCALAPPDATA + \"\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\"\n            ];\n            // 존재하는 Chrome 경로 찾기\n            for (const chromePath of localChromePaths){\n                if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(chromePath)) {\n                    console.log(`Using local Chrome at: ${chromePath}`);\n                    return chromePath;\n                }\n            }\n            console.log(\"No local Chrome installation found, using @sparticuz/chromium fallback\");\n        }\n        // @sparticuz/chromium의 executablePath 함수를 사용하여 바이너리 경로 가져오기\n        const execPath = await chromium.executablePath();\n        console.log(`Chromium executable path: ${execPath}`);\n        // Windows에서 로컬 폴더 생성\n        if (isWindows) {\n            const localChromiumPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \".chromium\");\n            if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(localChromiumPath)) {\n                console.log(`Creating local Chromium directory: ${localChromiumPath}`);\n                fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(localChromiumPath, {\n                    recursive: true\n                });\n            }\n        }\n        // 파일이 실제로 존재하는지 확인\n        if (!fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(execPath)) {\n            throw new Error(`Chromium executable not found at path: ${execPath}`);\n        }\n        return execPath;\n    } catch (error) {\n        console.error(\"Error getting Chromium path:\", error);\n        // 오류 발생 시 로컬 Chrome 시도\n        if (isWindows) {\n            const defaultChromePath = \"C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\";\n            if (fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(defaultChromePath)) {\n                console.log(`Fallback to local Chrome: ${defaultChromePath}`);\n                return defaultChromePath;\n            }\n        }\n        throw error;\n    }\n}\n/**\n * 주어진 ChatGPT 대화 URL에서 대화 내용과 전체 페이지 내용을 스크래핑하는 함수\n */ async function parseChatGPTLink(url) {\n    console.log(`Scraping ChatGPT conversation from URL: ${url}`);\n    // let browser: Browser | null = null;\n    let browser = null;\n    try {\n        // 브라우저 경로 디버깅 로그\n        console.log(\"=== Browser Path Debug Info ===\");\n        console.log(\"CHROMIUM_PATH:\", \"C:\\\\pmkProject\\\\.chromium\");\n        // Playwright 코드 주석 처리\n        /*\n    // 가능한 실행 파일 경로들\n    const possiblePaths = [\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium_headless_shell-1169/chrome-linux/headless_shell`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-win/chrome.exe`,\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium/chrome-linux/chrome`,\n      // Ubuntu 20.04 fallback 경로 추가\n      `${process.env.PLAYWRIGHT_BROWSERS_PATH}/chromium-1169/chrome-linux/chrome`,\n      `/tmp/playwright/chromium-1169/chrome-linux/chrome`,\n      // Playwright 경로 자동 감지 시도\n      process.env.PLAYWRIGHT_BROWSERS_PATH ? undefined : 'chromium'\n    ].filter(Boolean);\n    \n    console.log('Checking possible executable paths:');\n    for (const path of possiblePaths) {\n      try {\n        const fs = require('fs');\n        const exists = fs.existsSync(path);\n        console.log(`- ${path}: ${exists ? 'EXISTS' : 'NOT FOUND'}`);\n      } catch (e) {\n        console.log(`- ${path}: ERROR checking path`);\n      }\n    }\n    \n    // 첫 번째 경로로 시도\n    let browserLaunchError = null;\n  \n    // Chromium 브라우저 시작 (headless 모드)\n    try {\n      console.log('Trying to launch browser with primary path...');\n      browser = await chromium.launch({\n        headless: true,  // 백그라운드에서 실행\n        args: [\n          '--disable-web-security',\n          '--disable-features=IsolateOrigins,site-per-process',\n          '--no-sandbox',\n          '--disable-setuid-sandbox',\n          '--disable-dev-shm-usage'\n        ],\n        timeout: 60000, // 60초 타임아웃\n        // 실행 파일 경로는 우선 지정하지 않고 Playwright가 자동 감지하도록 함\n        executablePath: undefined\n      });\n      console.log('Browser launched successfully with primary path');\n    } catch (e) {\n      console.error('Failed to launch with default path:', e);\n      browserLaunchError = e;\n      \n      // 자동 감지 실패 시 다른 경로 시도\n      for (let i = 0; i < possiblePaths.length; i++) {\n        try {\n          if (!possiblePaths[i]) continue; // undefined 경로 건너뛰기\n          \n          console.log(`Trying alternate path: ${possiblePaths[i]}`);\n          browser = await chromium.launch({\n            headless: true,\n            args: [\n              '--no-sandbox', \n              '--disable-setuid-sandbox',\n              '--disable-dev-shm-usage'\n            ],\n            timeout: 60000,\n            executablePath: possiblePaths[i]\n          });\n          console.log(`Browser launched successfully with alternate path: ${possiblePaths[i]}`);\n          browserLaunchError = null;\n          break;\n        } catch (err) {\n          console.error(`Failed with alternate path ${possiblePaths[i]}:`, err);\n        }\n      }\n      \n      // 모든 경로 실패 시 브라우저 재설치 시도\n      if (browserLaunchError) {\n        console.log('모든 경로 시도 실패, 브라우저 재설치 시도 중...');\n        try {\n          // 브라우저 설치 시도\n          const { execSync } = require('child_process');\n          execSync('npx playwright install chromium', { stdio: 'inherit' });\n          console.log('Chromium 재설치 완료, 다시 시도합니다.');\n          \n          // 설치 후 브라우저 실행 재시도\n          browser = await chromium.launch({\n            headless: true,\n            args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-dev-shm-usage'],\n            timeout: 60000\n          });\n          console.log('브라우저 시작 성공 (재설치 후)');\n          browserLaunchError = null;\n        } catch (installError) {\n          console.error('브라우저 재설치 실패:', installError);\n          throw new Error(`모든 브라우저 실행 경로 시도 실패 및 재설치 실패: ${browserLaunchError instanceof Error ? browserLaunchError.message : String(browserLaunchError)}`);\n        }\n      }\n    }\n\n    // browser가 null인 경우 처리 (모든 실행 경로 시도 후에도 실패한 경우)\n    if (!browser) {\n      throw new Error('브라우저를 시작할 수 없습니다. 실행 파일 경로를 확인하세요.');\n    }\n    */ // puppeteer-core + @sparticuz/chromium 사용하여 브라우저 시작\n        console.log(\"Launching browser with @sparticuz/chromium...\");\n        // 환경에 맞는 Chromium 경로 가져오기\n        const executablePath = await getChromiumPath();\n        console.log(`Using Chromium at: ${executablePath}`);\n        // 브라우저 실행 옵션을 더 단순화\n        const options = {\n            args: [\n                \"--no-sandbox\",\n                \"--disable-setuid-sandbox\",\n                \"--disable-dev-shm-usage\",\n                \"--disable-gpu\"\n            ],\n            defaultViewport: {\n                width: 1280,\n                height: 800\n            },\n            executablePath,\n            headless: true,\n            ignoreHTTPSErrors: true,\n            timeout: 30000\n        };\n        // 브라우저 인스턴스\n        try {\n            // 브라우저 실행\n            console.log(\"Attempting to launch browser...\");\n            browser = await puppeteer.launch(options);\n            console.log(\"Browser launched successfully\");\n            // 페이지 생성 전에 잠시 대기하여 브라우저가 완전히 초기화되도록 함\n            await new Promise((resolve)=>setTimeout(resolve, 1000));\n            // 페이지 생성\n            console.log(\"Creating page...\");\n            const page = await browser.newPage();\n            console.log(\"Page created successfully\");\n            // 페이지 설정\n            await page.setDefaultNavigationTimeout(60000); // 60초\n            await page.setDefaultTimeout(60000);\n            // 사용자 에이전트 설정\n            await page.setUserAgent(\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\");\n            // 페이지 로드 전에 약간 대기\n            await new Promise((resolve)=>setTimeout(resolve, 500));\n            // 페이지 로드\n            console.log(`Loading URL: ${url}`);\n            await page.goto(url, {\n                waitUntil: \"networkidle0\",\n                timeout: 60000\n            });\n            console.log(\"Page loaded successfully\");\n            // 페이지 컨텐츠가 렌더링될 시간을 확보\n            console.log(\"Waiting for content to render...\");\n            await page.waitForTimeout(5000);\n            // 전체 페이지 HTML 가져오기\n            const rawHtml = await page.content();\n            console.log(`Raw HTML length: ${rawHtml.length} characters`);\n            // 페이지 텍스트 콘텐츠 가져오기\n            const rawText = await page.evaluate(()=>document.body.innerText);\n            console.log(`Raw text length: ${rawText.length} characters`);\n            // 대화 내용 추출 (메시지 구조화)\n            console.log(\"Extracting conversation data...\");\n            const conversationData = await extractConversationData(page);\n            // 대화 객체 생성\n            const conversation = {\n                id: extractConversationId(url),\n                title: conversationData.title,\n                messages: conversationData.messages,\n                createdAt: new Date().toISOString(),\n                source: _types__WEBPACK_IMPORTED_MODULE_2__.ChatSource.CHATGPT,\n                metadata: conversationData.metadata\n            };\n            // 빈 대화인지 확인\n            if (conversation.messages.length === 0) {\n                throw new Error(\"대화 내용을 추출할 수 없습니다.\");\n            }\n            console.log(`Extracted conversation: \"${conversation.title}\" with ${conversation.messages.length} messages`);\n            // 모든 작업이 완료된 후 브라우저 종료\n            console.log(\"Closing browser...\");\n            await browser.close();\n            console.log(\"Browser closed successfully\");\n            return {\n                conversation,\n                rawHtml,\n                rawText\n            };\n        } catch (error) {\n            console.error(\"Error during conversation extraction:\", error);\n            // 오류 발생 시 브라우저 자원 정리 시도\n            if (browser) {\n                try {\n                    await browser.close();\n                } catch (closeError) {\n                    console.warn(\"Failed to close browser after error:\", closeError);\n                }\n            }\n            throw error instanceof Error ? error : new Error(`대화 추출 중 오류 발생: ${String(error)}`);\n        }\n    } catch (error) {\n        console.error(\"Error during conversation extraction:\", error);\n        throw error instanceof Error ? error : new Error(`대화 추출 중 오류 발생: ${String(error)}`);\n    }\n}\n/**\n * URL에서 대화 ID를 추출하는 헬퍼 함수\n */ function extractConversationId(url) {\n    const urlSegments = url.split(\"/\");\n    const potentialId = urlSegments.pop() || \"\";\n    // ID가 유효한지 확인 (공유 URL의 ID 형식은 다를 수 있음)\n    if (potentialId && potentialId.length > 5) {\n        return potentialId;\n    }\n    // 대체 ID 생성\n    return `${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n// Playwright Page 타입을 any로 변경\n// async function extractConversationData(page: Page): Promise<{\nasync function extractConversationData(page) {\n    return await page.evaluate(()=>{\n        console.log(\"Starting conversation extraction...\");\n        // 디버깅 정보\n        const pageInfo = {\n            url: window.location.href,\n            title: document.title,\n            bodyText: document.body.innerText.length\n        };\n        console.log(\"Page info:\", JSON.stringify(pageInfo));\n        // 제목 추출 (여러 방법 시도)\n        let title = \"\";\n        // 1. h1 태그에서 제목 찾기\n        const h1Element = document.querySelector(\"h1\");\n        if (h1Element && h1Element.textContent) {\n            title = h1Element.textContent.trim();\n        }\n        // 2. 페이지 타이틀에서 제목 찾기\n        if (!title) {\n            const titleElement = document.querySelector(\"title\");\n            if (titleElement && titleElement.textContent) {\n                title = titleElement.textContent.replace(\" - ChatGPT\", \"\").replace(\" - OpenAI\", \"\").trim();\n            }\n        }\n        // 3. 메타 데이터에서 제목 찾기\n        if (!title) {\n            const metaTitle = document.querySelector('meta[property=\"og:title\"]');\n            if (metaTitle) {\n                const content = metaTitle.getAttribute(\"content\");\n                if (content) {\n                    title = content.trim();\n                }\n            }\n        }\n        // 제목을 찾지 못한 경우 기본값 사용\n        if (!title) {\n            title = \"ChatGPT Conversation \" + new Date().toLocaleString();\n        }\n        console.log(`Title extracted: ${title}`);\n        // 페이지 전체에서 모든 대화 요소 직접 추출 시도\n        // 1. assistant 메시지 찾기 (여러 선택자 시도)\n        let assistantElements = document.querySelectorAll('[data-message-author-role=\"assistant\"]');\n        console.log(`[DEBUG] Found ${assistantElements.length} assistant elements by attribute`);\n        // 보조 선택자 시도\n        if (assistantElements.length === 0) {\n            const potentialSelectors = [\n                \".markdown.prose\",\n                '.chat-message[data-role=\"assistant\"]',\n                \".chat-message-assistant\",\n                \".assistant-message\",\n                '[data-role=\"assistant\"]',\n                'div[role=\"region\"] > div > div:nth-child(even)'\n            ];\n            for (const selector of potentialSelectors){\n                const elements = document.querySelectorAll(selector);\n                if (elements.length > 0) {\n                    console.log(`[DEBUG] Found ${elements.length} assistant elements with selector: ${selector}`);\n                    assistantElements = elements;\n                    break;\n                }\n            }\n        }\n        // 2. user 메시지 찾기 (여러 방법 시도)\n        // 명시적인 user 역할 속성 찾기\n        let userElements = Array.from(document.querySelectorAll('[data-message-author-role=\"user\"]'));\n        console.log(`[DEBUG] Found ${userElements.length} user elements by attribute`);\n        // 대안 선택자 시도\n        if (userElements.length === 0) {\n            const potentialUserSelectors = [\n                '.chat-message[data-role=\"user\"]',\n                \".chat-message-user\",\n                \".user-message\",\n                '[data-role=\"user\"]',\n                'div[role=\"region\"] > div > div:nth-child(odd)'\n            ];\n            for (const selector of potentialUserSelectors){\n                const elements = document.querySelectorAll(selector);\n                if (elements.length > 0) {\n                    console.log(`[DEBUG] Found ${elements.length} user elements with selector: ${selector}`);\n                    userElements = Array.from(elements);\n                    break;\n                }\n            }\n        }\n        console.log(`[DEBUG] Final count - Assistant: ${assistantElements.length}, User: ${userElements.length}`);\n        // 대화 수집\n        let messages = [];\n        if (assistantElements.length > 0 && userElements.length > 0) {\n            // HTML 구조에서 모든 대화 요소 수집 및 순서 결정\n            const conversationElements = [];\n            // 어시스턴트 메시지 추가\n            Array.from(assistantElements).forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"assistant\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // 사용자 메시지 추가\n            userElements.forEach((el)=>{\n                conversationElements.push({\n                    element: el,\n                    role: \"user\",\n                    position: getPositionInDocument(el)\n                });\n            });\n            // DOM 순서대로 정렬\n            conversationElements.sort((a, b)=>a.position - b.position);\n            console.log(`[DEBUG] Sorted conversation elements: ${conversationElements.length}`);\n            console.log(`[DEBUG] First few roles: ${conversationElements.slice(0, 3).map((e)=>e.role).join(\", \")}`);\n            // 정렬된 요소에서 대화 내용 추출\n            const extractedMessages = [];\n            for (const item of conversationElements){\n                const content = item.element.textContent?.trim() || \"\";\n                if (content && content.length > 0) {\n                    // 일부 UI 요소 제외\n                    if (!content.includes(\"Skip to content\") && !content.includes(\"Log in\") && !content.includes(\"Sign up\")) {\n                        extractedMessages.push({\n                            role: item.role,\n                            content\n                        });\n                    }\n                }\n            }\n            console.log(`[DEBUG] Extracted ${extractedMessages.length} messages`);\n            if (extractedMessages.length > 0) {\n                console.log(`[DEBUG] First message role: ${extractedMessages[0].role}`);\n                console.log(`[DEBUG] First message preview: ${extractedMessages[0].content.substring(0, 30)}...`);\n            }\n            // 최소한 하나의 사용자와 어시스턴트 메시지가 있는지 확인\n            const hasUser = extractedMessages.some((m)=>m.role === \"user\");\n            const hasAssistant = extractedMessages.some((m)=>m.role === \"assistant\");\n            if (hasUser && hasAssistant && extractedMessages.length >= 2) {\n                console.log(`[DEBUG] Found valid conversation with ${extractedMessages.length} messages`);\n                messages = extractedMessages;\n            } else {\n                console.log(`[DEBUG] Extracted messages don't form a valid conversation (user: ${hasUser}, assistant: ${hasAssistant})`);\n            }\n        }\n        // 페이지에서 요소의 위치를 결정하는 함수\n        function getPositionInDocument(element) {\n            // 요소의 부모들을 모두 찾아서 깊이 계산\n            let depth = 0;\n            let parent = element.parentElement;\n            while(parent){\n                depth++;\n                parent = parent.parentElement;\n            }\n            // DOM에서의 순서를 계산 (형제 요소 중 위치)\n            let siblingPosition = 0;\n            let sibling = element.previousElementSibling;\n            while(sibling){\n                siblingPosition++;\n                sibling = sibling.previousElementSibling;\n            }\n            // 요소의 대략적인 Y 위치를 반환 (if available)\n            const rect = element.getBoundingClientRect();\n            const yPosition = rect ? rect.top : 0;\n            // 깊이, 형제 위치, Y위치를 조합하여 최종 위치 반환\n            return yPosition + siblingPosition * 10000 + depth * 1000000;\n        }\n        // 메시지가 없으면 기본 오류 메시지 추가\n        if (messages.length === 0) {\n            // 최후의 방법: 페이지에서 이전/다음 메시지 패턴 찾기\n            try {\n                // 일반적인 사용자 입력 패턴 (최소 3개 이상의 단어를 가진 문단)\n                const potentialUserMessages = Array.from(document.querySelectorAll(\"p, div, span\")).map((el)=>el.textContent?.trim() || \"\").filter((text)=>text && text.split(\" \").length >= 3 && text.length > 20).filter((text)=>!text.includes(\"ChatGPT\") && !text.includes(\"Log in\") && !text.includes(\"Sign up\"));\n                if (potentialUserMessages.length > 0) {\n                    // 첫 번째 메시지를 사용자 메시지로 추가\n                    const userMessage = potentialUserMessages[0];\n                    messages.push({\n                        role: \"user\",\n                        content: userMessage\n                    });\n                    // 나머지 텍스트를 어시스턴트 응답으로 추가\n                    const remainingText = document.body.innerText.replace(title, \"\").replace(userMessage, \"\").replace(/Log in|Sign up|Attach|Search|Reason|Voice|By messaging ChatGPT|Skip to content|ChatGPT/g, \"\").replace(/window\\.__oai_.*?;/g, \"\").trim();\n                    if (remainingText.length > 0) {\n                        messages.push({\n                            role: \"assistant\",\n                            content: remainingText\n                        });\n                    }\n                } else {\n                    messages.push({\n                        role: \"assistant\",\n                        content: \"대화 내용을 추출할 수 없습니다. ChatGPT 공유 링크가 유효한지 확인해주세요.\"\n                    });\n                }\n            } catch (error) {\n                messages.push({\n                    role: \"assistant\",\n                    content: \"대화 내용을 추출할 수 없습니다. ChatGPT 공유 링크가 유효한지 확인해주세요.\"\n                });\n            }\n        }\n        // 대화형 구조 확인 - 먼저 유저 메시지로 시작하는지 확인\n        if (messages.length > 0 && messages[0].role !== \"user\") {\n            // ChatGPT 대화는 항상 사용자 질문으로 시작해야 함\n            // 대화가 어시스턴트로 시작하면 첫 메시지를 사용자 메시지로 변경\n            console.log(\"첫 메시지가 사용자 메시지가 아닙니다. 대화 구조를 수정합니다.\");\n            // 새 대화 구조 생성\n            const alternatingMessages = [];\n            // 첫 번째 메시지가 assistant인 경우, 가짜 user 메시지를 추가하고 시작\n            alternatingMessages.push({\n                role: \"user\",\n                content: \"대화를 시작합니다.\"\n            });\n            // 기존 메시지 복사\n            messages.forEach((msg)=>{\n                alternatingMessages.push(msg);\n            });\n            // 수정된 메시지로 교체\n            messages = alternatingMessages;\n        }\n        // 올바른 대화 구조 확인 (user와 assistant가 번갈아 나타나야 함)\n        const correctedMessages = [];\n        let expectedRole = \"user\"; // 대화는 user로 시작해야 함\n        messages.forEach((msg, index)=>{\n            if (index === 0 && msg.role !== \"user\") {\n                // 첫 메시지는 항상 사용자여야 함\n                correctedMessages.push({\n                    role: \"user\",\n                    content: \"대화를 시작합니다.\"\n                });\n                expectedRole = \"assistant\";\n            }\n            if (msg.role === expectedRole) {\n                // 역할이 예상대로인 경우 그대로 추가\n                correctedMessages.push(msg);\n                // 다음 예상 역할 전환\n                expectedRole = expectedRole === \"user\" ? \"assistant\" : \"user\";\n            } else {\n                // 같은 역할이 연속으로 나타나는 경우, 빈 메시지를 중간에 삽입\n                if (expectedRole === \"user\") {\n                    correctedMessages.push({\n                        role: \"user\",\n                        content: \"(계속)\"\n                    });\n                } else {\n                    correctedMessages.push({\n                        role: \"assistant\",\n                        content: \"(계속)\"\n                    });\n                }\n                // 현재 메시지 추가\n                correctedMessages.push(msg);\n                // 다음 예상 역할 설정\n                expectedRole = msg.role === \"user\" ? \"assistant\" : \"user\";\n            }\n        });\n        // 수정된 메시지로 교체\n        messages = correctedMessages;\n        // GPT-4 모델인지 확인\n        const isGPT4 = document.body.innerText.includes(\"GPT-4\") || document.body.innerText.includes(\"gpt-4\") || document.querySelector('img[alt*=\"GPT-4\"]') !== null;\n        return {\n            title,\n            messages,\n            metadata: {\n                date: new Date().toISOString(),\n                model: isGPT4 ? \"gpt-4\" : \"gpt-3.5-turbo\",\n                tags: []\n            }\n        };\n    });\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    parseChatGPTLink\n]);\n(0,private_next_rsc_action_proxy__WEBPACK_IMPORTED_MODULE_0__.createActionProxy)(\"491c471e7f9b8d25a45396e01470b054e19a90ee\", parseChatGPTLink);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQ2pCO1lBRUEsSUFBSUYsSUFBSWhDLElBQUksS0FBS2tDLGNBQWM7Z0JBQzdCLHNCQUFzQjtnQkFDdEJELGtCQUFrQm5DLElBQUksQ0FBQ2tDO2dCQUN2QixjQUFjO2dCQUNkRSxlQUFlQSxpQkFBaUIsU0FBUyxjQUFjO1lBQ3pELE9BQU87Z0JBQ0wscUNBQXFDO2dCQUNyQyxJQUFJQSxpQkFBaUIsUUFBUTtvQkFDM0JELGtCQUFrQm5DLElBQUksQ0FBQzt3QkFDckJFLE1BQU07d0JBQ04vRCxTQUFTO29CQUNYO2dCQUNGLE9BQU87b0JBQ0xnRyxrQkFBa0JuQyxJQUFJLENBQUM7d0JBQ3JCRSxNQUFNO3dCQUNOL0QsU0FBUztvQkFDWDtnQkFDRjtnQkFDQSxZQUFZO2dCQUNaZ0csa0JBQWtCbkMsSUFBSSxDQUFDa0M7Z0JBQ3ZCLGNBQWM7Z0JBQ2RFLGVBQWVGLElBQUloQyxJQUFJLEtBQUssU0FBUyxjQUFjO1lBQ3JEO1FBQ0Y7UUFFQSxjQUFjO1FBQ2RsRCxXQUFXbUY7UUFFVCxnQkFBZ0I7UUFDaEIsTUFBTUcsU0FBUy9GLFNBQVNDLElBQUksQ0FBQ0MsU0FBUyxDQUFDb0UsUUFBUSxDQUFDLFlBQ2xDdEUsU0FBU0MsSUFBSSxDQUFDQyxTQUFTLENBQUNvRSxRQUFRLENBQUMsWUFDakN0RSxTQUFTcUMsYUFBYSxDQUFDLHlCQUF5QjtRQUU5RCxPQUFPO1lBQ0w3QjtZQUNBQztZQUNBTSxVQUFVO2dCQUNSaUYsTUFBTSxJQUFJckYsT0FBT0MsV0FBVztnQkFDNUJxRixPQUFPRixTQUFTLFVBQVU7Z0JBQzFCRyxNQUFNLEVBQUU7WUFDVjtRQUNGO0lBQ0o7QUFTRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL2xpYi91dGlscy9jaGF0Z3B0LnRzP2RmZTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8g7ISc67KEIOyghOyaqSDsu7Ttj6zrhIztirgv7Jyg7Yu4IO2RnOyLnFxuJ3VzZSBzZXJ2ZXInO1xuXG4vLyBQbGF5d3JpZ2h0IOq0gOugqCBpbXBvcnQg7KO87ISdIOyymOumrFxuLy8gaW1wb3J0IHsgY2hyb21pdW0sIEJyb3dzZXIsIFBhZ2UgfSBmcm9tICdwbGF5d3JpZ2h0JztcbmltcG9ydCB7IENvbnZlcnNhdGlvbiwgQ2hhdE1lc3NhZ2UsIENoYXRTb3VyY2UgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcblxuLy8gUHVwcGV0ZWVy7JmAIENocm9taXVtIOy2lOqwgCAtIOyEnOuyhCDsgqzsnbTrk5zsl5DshJzrp4wg7Iuk7ZaJXG4vLyBAdHMtaWdub3JlIC0gQHNwYXJ0aWN1ei9jaHJvbWl1bSDrqqjrk4gg7YOA7J6FIOyEoOyWuCDrrLjsoJwg7ZW06rKwXG5jb25zdCBwdXBwZXRlZXIgPSByZXF1aXJlKCdwdXBwZXRlZXItY29yZScpO1xuLy8gQHRzLWlnbm9yZSAtIO2DgOyehSDsmKTrpZgg66y07IucXG5jb25zdCBjaHJvbWl1bSA9IHJlcXVpcmUoJ0BzcGFydGljdXovY2hyb21pdW0nKTtcblxuLy8g7YG065287J207Ja47Yq4IOy4oeyXkOyEnOuKlCDsi6TtlonrkJjsp4Ag7JWK64+E66GdIO2VqFxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignVGhpcyBtb2R1bGUgaXMgc2VydmVyLXNpZGUgb25seScpO1xufVxuXG4vLyDsmrTsmIHssrTsoJwg6rCQ7KeAXG5jb25zdCBpc1dpbmRvd3MgPSBwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInO1xuY29uc3QgaXNWZXJjZWwgPSBwcm9jZXNzLmVudi5WRVJDRUwgPT09ICcxJztcblxuLyoqXG4gKiDtmZjqsr3sl5Ag66ee64qUIENocm9taXVtIOyLpO2WiSDqsr3roZwg6rCA7KC47Jik6riwXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldENocm9taXVtUGF0aCgpIHtcbiAgdHJ5IHtcbiAgICAvLyBXaW5kb3dzIO2ZmOqyveyduCDqsr3smrAg66Gc7Lus7JeQ7IScIENocm9tZSDsi6Ttlokg7Iuc64+EXG4gICAgaWYgKGlzV2luZG93cykge1xuICAgICAgLy8gV2luZG93cyDtmZjqsr3sl5DshJzripQg7ISk7LmY65CcIENocm9tZSDsgqzsmqkg7Iuc64+EXG4gICAgICBjb25zdCBsb2NhbENocm9tZVBhdGhzID0gW1xuICAgICAgICAnQzpcXFxcUHJvZ3JhbSBGaWxlc1xcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnLFxuICAgICAgICAnQzpcXFxcUHJvZ3JhbSBGaWxlcyAoeDg2KVxcXFxHb29nbGVcXFxcQ2hyb21lXFxcXEFwcGxpY2F0aW9uXFxcXGNocm9tZS5leGUnLFxuICAgICAgICBwcm9jZXNzLmVudi5MT0NBTEFQUERBVEEgKyAnXFxcXEdvb2dsZVxcXFxDaHJvbWVcXFxcQXBwbGljYXRpb25cXFxcY2hyb21lLmV4ZScsXG4gICAgICBdO1xuICAgICAgXG4gICAgICAvLyDsobTsnqztlZjripQgQ2hyb21lIOqyveuhnCDssL7quLBcbiAgICAgIGZvciAoY29uc3QgY2hyb21lUGF0aCBvZiBsb2NhbENocm9tZVBhdGhzKSB7XG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGNocm9tZVBhdGgpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFVzaW5nIGxvY2FsIENocm9tZSBhdDogJHtjaHJvbWVQYXRofWApO1xuICAgICAgICAgIHJldHVybiBjaHJvbWVQYXRoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdObyBsb2NhbCBDaHJvbWUgaW5zdGFsbGF0aW9uIGZvdW5kLCB1c2luZyBAc3BhcnRpY3V6L2Nocm9taXVtIGZhbGxiYWNrJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEBzcGFydGljdXovY2hyb21pdW3snZggZXhlY3V0YWJsZVBhdGgg7ZWo7IiY66W8IOyCrOyaqe2VmOyXrCDrsJTsnbTrhIjrpqwg6rK966GcIOqwgOyguOyYpOq4sFxuICAgIGNvbnN0IGV4ZWNQYXRoID0gYXdhaXQgY2hyb21pdW0uZXhlY3V0YWJsZVBhdGgoKTtcbiAgICBjb25zb2xlLmxvZyhgQ2hyb21pdW0gZXhlY3V0YWJsZSBwYXRoOiAke2V4ZWNQYXRofWApO1xuICAgIFxuICAgIC8vIFdpbmRvd3Psl5DshJwg66Gc7LusIO2PtOuNlCDsg53shLFcbiAgICBpZiAoaXNXaW5kb3dzKSB7XG4gICAgICBjb25zdCBsb2NhbENocm9taXVtUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnLmNocm9taXVtJyk7XG4gICAgICBpZiAoIWZzLmV4aXN0c1N5bmMobG9jYWxDaHJvbWl1bVBhdGgpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDcmVhdGluZyBsb2NhbCBDaHJvbWl1bSBkaXJlY3Rvcnk6ICR7bG9jYWxDaHJvbWl1bVBhdGh9YCk7XG4gICAgICAgIGZzLm1rZGlyU3luYyhsb2NhbENocm9taXVtUGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIO2MjOydvOydtCDsi6TsoJzroZwg7KG07J6s7ZWY64qU7KeAIO2ZleyduFxuICAgIGlmICghZnMuZXhpc3RzU3luYyhleGVjUGF0aCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2hyb21pdW0gZXhlY3V0YWJsZSBub3QgZm91bmQgYXQgcGF0aDogJHtleGVjUGF0aH1gKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGV4ZWNQYXRoO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgQ2hyb21pdW0gcGF0aDonLCBlcnJvcik7XG4gICAgXG4gICAgLy8g7Jik66WYIOuwnOyDnSDsi5wg66Gc7LusIENocm9tZSDsi5zrj4RcbiAgICBpZiAoaXNXaW5kb3dzKSB7XG4gICAgICBjb25zdCBkZWZhdWx0Q2hyb21lUGF0aCA9ICdDOlxcXFxQcm9ncmFtIEZpbGVzXFxcXEdvb2dsZVxcXFxDaHJvbWVcXFxcQXBwbGljYXRpb25cXFxcY2hyb21lLmV4ZSc7XG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhkZWZhdWx0Q2hyb21lUGF0aCkpIHtcbiAgICAgICAgY29uc29sZS5sb2coYEZhbGxiYWNrIHRvIGxvY2FsIENocm9tZTogJHtkZWZhdWx0Q2hyb21lUGF0aH1gKTtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRDaHJvbWVQYXRoO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIOyjvOyWtOynhCBDaGF0R1BUIOuMgO2ZlCBVUkzsl5DshJwg64yA7ZmUIOuCtOyaqeqzvCDsoITssrQg7Y6Y7J207KeAIOuCtOyaqeydhCDsiqTtgazrnpjtlZHtlZjripQg7ZWo7IiYXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJzZUNoYXRHUFRMaW5rKHVybDogc3RyaW5nKTogUHJvbWlzZTx7IFxuICBjb252ZXJzYXRpb246IENvbnZlcnNhdGlvbjsgXG4gIHJhd0h0bWw6IHN0cmluZzsgXG4gIHJhd1RleHQ6IHN0cmluZztcbn0+IHtcbiAgY29uc29sZS5sb2coYFNjcmFwaW5nIENoYXRHUFQgY29udmVyc2F0aW9uIGZyb20gVVJMOiAke3VybH1gKTtcbiAgXG4gIC8vIGxldCBicm93c2VyOiBCcm93c2VyIHwgbnVsbCA9IG51bGw7XG4gIGxldCBicm93c2VyOiBhbnkgPSBudWxsO1xuICBcbiAgdHJ5IHtcbiAgICAvLyDruIzrnbzsmrDsoIAg6rK966GcIOuUlOuyhOq5hSDroZzqt7hcbiAgICBjb25zb2xlLmxvZygnPT09IEJyb3dzZXIgUGF0aCBEZWJ1ZyBJbmZvID09PScpO1xuICAgIGNvbnNvbGUubG9nKCdDSFJPTUlVTV9QQVRIOicsIHByb2Nlc3MuZW52LkNIUk9NSVVNX1BBVEgpO1xuICAgIFxuICAgIC8vIFBsYXl3cmlnaHQg7L2U65OcIOyjvOyEnSDsspjrpqxcbiAgICAvKlxuICAgIC8vIOqwgOuKpe2VnCDsi6Ttlokg7YyM7J28IOqyveuhnOuTpFxuICAgIGNvbnN0IHBvc3NpYmxlUGF0aHMgPSBbXG4gICAgICBgJHtwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEh9L2Nocm9taXVtX2hlYWRsZXNzX3NoZWxsLTExNjkvaGVhZGxlc3Nfc2hlbGxgLFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bV9oZWFkbGVzc19zaGVsbC0xMTY5L2Nocm9tZS1saW51eC9oZWFkbGVzc19zaGVsbGAsXG4gICAgICBgJHtwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEh9L2Nocm9taXVtLTExNjkvY2hyb21lLWxpbnV4L2Nocm9tZWAsXG4gICAgICBgJHtwcm9jZXNzLmVudi5QTEFZV1JJR0hUX0JST1dTRVJTX1BBVEh9L2Nocm9taXVtLTExNjkvY2hyb21lLXdpbi9jaHJvbWUuZXhlYCxcbiAgICAgIGAke3Byb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSH0vY2hyb21pdW0vY2hyb21lLWxpbnV4L2Nocm9tZWAsXG4gICAgICAvLyBVYnVudHUgMjAuMDQgZmFsbGJhY2sg6rK966GcIOy2lOqwgFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuUExBWVdSSUdIVF9CUk9XU0VSU19QQVRIfS9jaHJvbWl1bS0xMTY5L2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgYC90bXAvcGxheXdyaWdodC9jaHJvbWl1bS0xMTY5L2Nocm9tZS1saW51eC9jaHJvbWVgLFxuICAgICAgLy8gUGxheXdyaWdodCDqsr3roZwg7J6Q64+ZIOqwkOyngCDsi5zrj4RcbiAgICAgIHByb2Nlc3MuZW52LlBMQVlXUklHSFRfQlJPV1NFUlNfUEFUSCA/IHVuZGVmaW5lZCA6ICdjaHJvbWl1bSdcbiAgICBdLmZpbHRlcihCb29sZWFuKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQ2hlY2tpbmcgcG9zc2libGUgZXhlY3V0YWJsZSBwYXRoczonKTtcbiAgICBmb3IgKGNvbnN0IHBhdGggb2YgcG9zc2libGVQYXRocykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuICAgICAgICBjb25zdCBleGlzdHMgPSBmcy5leGlzdHNTeW5jKHBhdGgpO1xuICAgICAgICBjb25zb2xlLmxvZyhgLSAke3BhdGh9OiAke2V4aXN0cyA/ICdFWElTVFMnIDogJ05PVCBGT1VORCd9YCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGAtICR7cGF0aH06IEVSUk9SIGNoZWNraW5nIHBhdGhgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7LKrIOuyiOynuCDqsr3roZzroZwg7Iuc64+EXG4gICAgbGV0IGJyb3dzZXJMYXVuY2hFcnJvciA9IG51bGw7XG4gIFxuICAgIC8vIENocm9taXVtIOu4jOudvOyasOyggCDsi5zsnpEgKGhlYWRsZXNzIOuqqOuTnClcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ1RyeWluZyB0byBsYXVuY2ggYnJvd3NlciB3aXRoIHByaW1hcnkgcGF0aC4uLicpO1xuICAgICAgYnJvd3NlciA9IGF3YWl0IGNocm9taXVtLmxhdW5jaCh7XG4gICAgICAgIGhlYWRsZXNzOiB0cnVlLCAgLy8g67Cx6re465287Jq065Oc7JeQ7IScIOyLpO2WiVxuICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgJy0tZGlzYWJsZS13ZWItc2VjdXJpdHknLFxuICAgICAgICAgICctLWRpc2FibGUtZmVhdHVyZXM9SXNvbGF0ZU9yaWdpbnMsc2l0ZS1wZXItcHJvY2VzcycsXG4gICAgICAgICAgJy0tbm8tc2FuZGJveCcsXG4gICAgICAgICAgJy0tZGlzYWJsZS1zZXR1aWQtc2FuZGJveCcsXG4gICAgICAgICAgJy0tZGlzYWJsZS1kZXYtc2htLXVzYWdlJ1xuICAgICAgICBdLFxuICAgICAgICB0aW1lb3V0OiA2MDAwMCwgLy8gNjDstIgg7YOA7J6E7JWE7JuDXG4gICAgICAgIC8vIOyLpO2WiSDtjIzsnbwg6rK966Gc64qUIOyasOyEoCDsp4DsoJXtlZjsp4Ag7JWK6rOgIFBsYXl3cmlnaHTqsIAg7J6Q64+ZIOqwkOyngO2VmOuPhOuhnSDtlahcbiAgICAgICAgZXhlY3V0YWJsZVBhdGg6IHVuZGVmaW5lZFxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnQnJvd3NlciBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgd2l0aCBwcmltYXJ5IHBhdGgnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbGF1bmNoIHdpdGggZGVmYXVsdCBwYXRoOicsIGUpO1xuICAgICAgYnJvd3NlckxhdW5jaEVycm9yID0gZTtcbiAgICAgIFxuICAgICAgLy8g7J6Q64+ZIOqwkOyngCDsi6TtjKgg7IucIOuLpOuluCDqsr3roZwg7Iuc64+EXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlUGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoIXBvc3NpYmxlUGF0aHNbaV0pIGNvbnRpbnVlOyAvLyB1bmRlZmluZWQg6rK966GcIOqxtOuEiOubsOq4sFxuICAgICAgICAgIFxuICAgICAgICAgIGNvbnNvbGUubG9nKGBUcnlpbmcgYWx0ZXJuYXRlIHBhdGg6ICR7cG9zc2libGVQYXRoc1tpXX1gKTtcbiAgICAgICAgICBicm93c2VyID0gYXdhaXQgY2hyb21pdW0ubGF1bmNoKHtcbiAgICAgICAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAnLS1uby1zYW5kYm94JywgXG4gICAgICAgICAgICAgICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLFxuICAgICAgICAgICAgICAnLS1kaXNhYmxlLWRldi1zaG0tdXNhZ2UnXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgdGltZW91dDogNjAwMDAsXG4gICAgICAgICAgICBleGVjdXRhYmxlUGF0aDogcG9zc2libGVQYXRoc1tpXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBCcm93c2VyIGxhdW5jaGVkIHN1Y2Nlc3NmdWxseSB3aXRoIGFsdGVybmF0ZSBwYXRoOiAke3Bvc3NpYmxlUGF0aHNbaV19YCk7XG4gICAgICAgICAgYnJvd3NlckxhdW5jaEVycm9yID0gbnVsbDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHdpdGggYWx0ZXJuYXRlIHBhdGggJHtwb3NzaWJsZVBhdGhzW2ldfTpgLCBlcnIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOuqqOuToCDqsr3roZwg7Iuk7YyoIOyLnCDruIzrnbzsmrDsoIAg7J6s7ISk7LmYIOyLnOuPhFxuICAgICAgaWYgKGJyb3dzZXJMYXVuY2hFcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZygn66qo65OgIOqyveuhnCDsi5zrj4Qg7Iuk7YyoLCDruIzrnbzsmrDsoIAg7J6s7ISk7LmYIOyLnOuPhCDspJEuLi4nKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyDruIzrnbzsmrDsoIAg7ISk7LmYIOyLnOuPhFxuICAgICAgICAgIGNvbnN0IHsgZXhlY1N5bmMgfSA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKTtcbiAgICAgICAgICBleGVjU3luYygnbnB4IHBsYXl3cmlnaHQgaW5zdGFsbCBjaHJvbWl1bScsIHsgc3RkaW86ICdpbmhlcml0JyB9KTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnQ2hyb21pdW0g7J6s7ISk7LmYIOyZhOujjCwg64uk7IucIOyLnOuPhO2VqeuLiOuLpC4nKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDshKTsuZgg7ZuEIOu4jOudvOyasOyggCDsi6Ttlokg7J6s7Iuc64+EXG4gICAgICAgICAgYnJvd3NlciA9IGF3YWl0IGNocm9taXVtLmxhdW5jaCh7XG4gICAgICAgICAgICBoZWFkbGVzczogdHJ1ZSxcbiAgICAgICAgICAgIGFyZ3M6IFsnLS1uby1zYW5kYm94JywgJy0tZGlzYWJsZS1zZXR1aWQtc2FuZGJveCcsICctLWRpc2FibGUtZGV2LXNobS11c2FnZSddLFxuICAgICAgICAgICAgdGltZW91dDogNjAwMDBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn67iM65287Jqw7KCAIOyLnOyekSDshLHqs7UgKOyerOyEpOy5mCDtm4QpJyk7XG4gICAgICAgICAgYnJvd3NlckxhdW5jaEVycm9yID0gbnVsbDtcbiAgICAgICAgfSBjYXRjaCAoaW5zdGFsbEVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign67iM65287Jqw7KCAIOyerOyEpOy5mCDsi6TtjKg6JywgaW5zdGFsbEVycm9yKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOuqqOuToCDruIzrnbzsmrDsoIAg7Iuk7ZaJIOqyveuhnCDsi5zrj4Qg7Iuk7YyoIOuwjyDsnqzshKTsuZgg7Iuk7YyoOiAke2Jyb3dzZXJMYXVuY2hFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gYnJvd3NlckxhdW5jaEVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoYnJvd3NlckxhdW5jaEVycm9yKX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGJyb3dzZXLqsIAgbnVsbOyduCDqsr3smrAg7LKY66asICjrqqjrk6Ag7Iuk7ZaJIOqyveuhnCDsi5zrj4Qg7ZuE7JeQ64+EIOyLpO2MqO2VnCDqsr3smrApXG4gICAgaWYgKCFicm93c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+u4jOudvOyasOyggOulvCDsi5zsnpHtlaAg7IiYIOyXhuyKteuLiOuLpC4g7Iuk7ZaJIO2MjOydvCDqsr3roZzrpbwg7ZmV7J247ZWY7IS47JqULicpO1xuICAgIH1cbiAgICAqL1xuXG4gICAgLy8gcHVwcGV0ZWVyLWNvcmUgKyBAc3BhcnRpY3V6L2Nocm9taXVtIOyCrOyaqe2VmOyXrCDruIzrnbzsmrDsoIAg7Iuc7J6RXG4gICAgY29uc29sZS5sb2coJ0xhdW5jaGluZyBicm93c2VyIHdpdGggQHNwYXJ0aWN1ei9jaHJvbWl1bS4uLicpO1xuXG4gICAgLy8g7ZmY6rK97JeQIOunnuuKlCBDaHJvbWl1bSDqsr3roZwg6rCA7KC47Jik6riwXG4gICAgY29uc3QgZXhlY3V0YWJsZVBhdGggPSBhd2FpdCBnZXRDaHJvbWl1bVBhdGgoKTtcbiAgICBjb25zb2xlLmxvZyhgVXNpbmcgQ2hyb21pdW0gYXQ6ICR7ZXhlY3V0YWJsZVBhdGh9YCk7XG5cbiAgICAvLyDruIzrnbzsmrDsoIAg7Iuk7ZaJIOyYteyFmOydhCDrjZQg64uo7Iic7ZmUXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGFyZ3M6IFtcbiAgICAgICAgJy0tbm8tc2FuZGJveCcsIFxuICAgICAgICAnLS1kaXNhYmxlLXNldHVpZC1zYW5kYm94JyxcbiAgICAgICAgJy0tZGlzYWJsZS1kZXYtc2htLXVzYWdlJyxcbiAgICAgICAgJy0tZGlzYWJsZS1ncHUnXG4gICAgICBdLFxuICAgICAgZGVmYXVsdFZpZXdwb3J0OiB7XG4gICAgICAgIHdpZHRoOiAxMjgwLFxuICAgICAgICBoZWlnaHQ6IDgwMFxuICAgICAgfSxcbiAgICAgIGV4ZWN1dGFibGVQYXRoLFxuICAgICAgaGVhZGxlc3M6IHRydWUsXG4gICAgICBpZ25vcmVIVFRQU0Vycm9yczogdHJ1ZSxcbiAgICAgIHRpbWVvdXQ6IDMwMDAwXG4gICAgfTtcblxuICAgIC8vIOu4jOudvOyasOyggCDsnbjsiqTthLTsiqRcbiAgICB0cnkge1xuICAgICAgLy8g67iM65287Jqw7KCAIOyLpO2WiVxuICAgICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgdG8gbGF1bmNoIGJyb3dzZXIuLi4nKTtcbiAgICAgIGJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXIubGF1bmNoKG9wdGlvbnMpO1xuICAgICAgY29uc29sZS5sb2coJ0Jyb3dzZXIgbGF1bmNoZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBcbiAgICAgIC8vIO2OmOydtOyngCDsg53shLEg7KCE7JeQIOyeoOyLnCDrjIDquLDtlZjsl6wg67iM65287Jqw7KCA6rCAIOyZhOyghO2eiCDstIjquLDtmZTrkJjrj4TroZ0g7ZWoXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgXG4gICAgICAvLyDtjpjsnbTsp4Ag7IOd7ISxXG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgcGFnZS4uLicpO1xuICAgICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuICAgICAgY29uc29sZS5sb2coJ1BhZ2UgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIFxuICAgICAgLy8g7Y6Y7J207KeAIOyEpOyglVxuICAgICAgYXdhaXQgcGFnZS5zZXREZWZhdWx0TmF2aWdhdGlvblRpbWVvdXQoNjAwMDApOyAvLyA2MOy0iFxuICAgICAgYXdhaXQgcGFnZS5zZXREZWZhdWx0VGltZW91dCg2MDAwMCk7XG4gICAgICBcbiAgICAgIC8vIOyCrOyaqeyekCDsl5DsnbTsoITtirgg7ISk7KCVXG4gICAgICBhd2FpdCBwYWdlLnNldFVzZXJBZ2VudCgnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyMC4wLjAuMCBTYWZhcmkvNTM3LjM2Jyk7XG4gICAgICBcbiAgICAgIC8vIO2OmOydtOyngCDroZzrk5wg7KCE7JeQIOyVveqwhCDrjIDquLBcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgIFxuICAgICAgLy8g7Y6Y7J207KeAIOuhnOuTnFxuICAgICAgY29uc29sZS5sb2coYExvYWRpbmcgVVJMOiAke3VybH1gKTtcbiAgICAgIGF3YWl0IHBhZ2UuZ290byh1cmwsIHsgd2FpdFVudGlsOiAnbmV0d29ya2lkbGUwJywgdGltZW91dDogNjAwMDAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnUGFnZSBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICBcbiAgICAgIC8vIO2OmOydtOyngCDsu6jthZDsuKDqsIAg66CM642U66eB65CgIOyLnOqwhOydhCDtmZXrs7RcbiAgICAgIGNvbnNvbGUubG9nKCdXYWl0aW5nIGZvciBjb250ZW50IHRvIHJlbmRlci4uLicpO1xuICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCg1MDAwKTtcbiAgICAgIFxuICAgICAgLy8g7KCE7LK0IO2OmOydtOyngCBIVE1MIOqwgOyguOyYpOq4sFxuICAgICAgY29uc3QgcmF3SHRtbCA9IGF3YWl0IHBhZ2UuY29udGVudCgpO1xuICAgICAgY29uc29sZS5sb2coYFJhdyBIVE1MIGxlbmd0aDogJHtyYXdIdG1sLmxlbmd0aH0gY2hhcmFjdGVyc2ApO1xuICAgICAgXG4gICAgICAvLyDtjpjsnbTsp4Ag7YWN7Iqk7Yq4IOy9mO2FkOy4oCDqsIDsoLjsmKTquLBcbiAgICAgIGNvbnN0IHJhd1RleHQgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0KTtcbiAgICAgIGNvbnNvbGUubG9nKGBSYXcgdGV4dCBsZW5ndGg6ICR7cmF3VGV4dC5sZW5ndGh9IGNoYXJhY3RlcnNgKTtcbiAgICAgIFxuICAgICAgLy8g64yA7ZmUIOuCtOyaqSDstpTstpwgKOuplOyLnOyngCDqtazsobDtmZQpXG4gICAgICBjb25zb2xlLmxvZygnRXh0cmFjdGluZyBjb252ZXJzYXRpb24gZGF0YS4uLicpO1xuICAgICAgY29uc3QgY29udmVyc2F0aW9uRGF0YSA9IGF3YWl0IGV4dHJhY3RDb252ZXJzYXRpb25EYXRhKHBhZ2UpO1xuXG4gICAgICAvLyDrjIDtmZQg6rCd7LK0IOyDneyEsVxuICAgICAgY29uc3QgY29udmVyc2F0aW9uOiBDb252ZXJzYXRpb24gPSB7XG4gICAgICAgIGlkOiBleHRyYWN0Q29udmVyc2F0aW9uSWQodXJsKSxcbiAgICAgICAgdGl0bGU6IGNvbnZlcnNhdGlvbkRhdGEudGl0bGUsXG4gICAgICAgIG1lc3NhZ2VzOiBjb252ZXJzYXRpb25EYXRhLm1lc3NhZ2VzIGFzIENoYXRNZXNzYWdlW10sXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBzb3VyY2U6IENoYXRTb3VyY2UuQ0hBVEdQVCxcbiAgICAgICAgbWV0YWRhdGE6IGNvbnZlcnNhdGlvbkRhdGEubWV0YWRhdGFcbiAgICAgIH07XG5cbiAgICAgIC8vIOu5iCDrjIDtmZTsnbjsp4Ag7ZmV7J24XG4gICAgICBpZiAoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+uMgO2ZlCDrgrTsmqnsnYQg7LaU7Lac7ZWgIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKGBFeHRyYWN0ZWQgY29udmVyc2F0aW9uOiBcIiR7Y29udmVyc2F0aW9uLnRpdGxlfVwiIHdpdGggJHtjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlc2ApO1xuICAgICAgXG4gICAgICAvLyDrqqjrk6Ag7J6R7JeF7J20IOyZhOujjOuQnCDtm4Qg67iM65287Jqw7KCAIOyiheujjFxuICAgICAgY29uc29sZS5sb2coJ0Nsb3NpbmcgYnJvd3Nlci4uLicpO1xuICAgICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgICAgY29uc29sZS5sb2coJ0Jyb3dzZXIgY2xvc2VkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb252ZXJzYXRpb24sXG4gICAgICAgIHJhd0h0bWwsXG4gICAgICAgIHJhd1RleHRcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBjb252ZXJzYXRpb24gZXh0cmFjdGlvbjonLCBlcnJvcik7XG4gICAgICBcbiAgICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOu4jOudvOyasOyggCDsnpDsm5Ag7KCV66asIOyLnOuPhFxuICAgICAgaWYgKGJyb3dzZXIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBicm93c2VyLmNsb3NlKCk7XG4gICAgICAgIH0gY2F0Y2ggKGNsb3NlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjbG9zZSBicm93c2VyIGFmdGVyIGVycm9yOicsIGNsb3NlRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRocm93IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgXG4gICAgICAgID8gZXJyb3IgXG4gICAgICAgIDogbmV3IEVycm9yKGDrjIDtmZQg7LaU7LacIOykkSDsmKTrpZgg67Cc7IOdOiAke1N0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBjb252ZXJzYXRpb24gZXh0cmFjdGlvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciBcbiAgICAgID8gZXJyb3IgXG4gICAgICA6IG5ldyBFcnJvcihg64yA7ZmUIOy2lOy2nCDspJEg7Jik66WYIOuwnOyDnTogJHtTdHJpbmcoZXJyb3IpfWApO1xuICB9XG59XG5cbi8qKlxuICogVVJM7JeQ7IScIOuMgO2ZlCBJROulvCDstpTstpztlZjripQg7Zes7Y28IO2VqOyImFxuICovXG5mdW5jdGlvbiBleHRyYWN0Q29udmVyc2F0aW9uSWQodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB1cmxTZWdtZW50cyA9IHVybC5zcGxpdCgnLycpO1xuICBjb25zdCBwb3RlbnRpYWxJZCA9IHVybFNlZ21lbnRzLnBvcCgpIHx8ICcnO1xuICBcbiAgLy8gSUTqsIAg7Jyg7Zqo7ZWc7KeAIO2ZleyduCAo6rO17JygIFVSTOydmCBJRCDtmJXsi53snYAg64uk66W8IOyImCDsnojsnYwpXG4gIGlmIChwb3RlbnRpYWxJZCAmJiBwb3RlbnRpYWxJZC5sZW5ndGggPiA1KSB7XG4gICAgcmV0dXJuIHBvdGVudGlhbElkO1xuICB9XG4gIFxuICAvLyDrjIDssrQgSUQg7IOd7ISxXG4gIHJldHVybiBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA5KX1gO1xufVxuXG4vLyBQbGF5d3JpZ2h0IFBhZ2Ug7YOA7J6F7J2EIGFueeuhnCDrs4Dqsr1cbi8vIGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RDb252ZXJzYXRpb25EYXRhKHBhZ2U6IFBhZ2UpOiBQcm9taXNlPHtcbmFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RDb252ZXJzYXRpb25EYXRhKHBhZ2U6IGFueSk6IFByb21pc2U8e1xuICB0aXRsZTogc3RyaW5nOyBcbiAgbWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJzsgY29udGVudDogc3RyaW5nIH0+OyBcbiAgbWV0YWRhdGE6IHsgXG4gICAgZGF0ZTogc3RyaW5nOyBcbiAgICBtb2RlbDogc3RyaW5nOyBcbiAgICB0YWdzOiBzdHJpbmdbXTsgXG4gIH07IFxufT4ge1xuICByZXR1cm4gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ1N0YXJ0aW5nIGNvbnZlcnNhdGlvbiBleHRyYWN0aW9uLi4uJyk7XG4gICAgICBcbiAgICAvLyDrlJTrsoTquYUg7KCV67O0XG4gICAgY29uc3QgcGFnZUluZm8gPSB7XG4gICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxuICAgICAgdGl0bGU6IGRvY3VtZW50LnRpdGxlLFxuICAgICAgYm9keVRleHQ6IGRvY3VtZW50LmJvZHkuaW5uZXJUZXh0Lmxlbmd0aCxcbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKCdQYWdlIGluZm86JywgSlNPTi5zdHJpbmdpZnkocGFnZUluZm8pKTtcbiAgICAgIFxuICAgIC8vIOygnOuqqSDstpTstpwgKOyXrOufrCDrsKnrspUg7Iuc64+EKVxuICAgIGxldCB0aXRsZSA9ICcnO1xuICAgIFxuICAgIC8vIDEuIGgxIO2DnOq3uOyXkOyEnCDsoJzrqqkg7LC+6riwXG4gICAgY29uc3QgaDFFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaDEnKTtcbiAgICBpZiAoaDFFbGVtZW50ICYmIGgxRWxlbWVudC50ZXh0Q29udGVudCkge1xuICAgICAgdGl0bGUgPSBoMUVsZW1lbnQudGV4dENvbnRlbnQudHJpbSgpO1xuICAgIH1cbiAgICBcbiAgICAvLyAyLiDtjpjsnbTsp4Ag7YOA7J207YuA7JeQ7IScIOygnOuqqSDssL7quLBcbiAgICBpZiAoIXRpdGxlKSB7XG4gICAgICBjb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0aXRsZScpO1xuICAgICAgaWYgKHRpdGxlRWxlbWVudCAmJiB0aXRsZUVsZW1lbnQudGV4dENvbnRlbnQpIHtcbiAgICAgICAgdGl0bGUgPSB0aXRsZUVsZW1lbnQudGV4dENvbnRlbnRcbiAgICAgICAgICAucmVwbGFjZSgnIC0gQ2hhdEdQVCcsICcnKVxuICAgICAgICAgIC5yZXBsYWNlKCcgLSBPcGVuQUknLCAnJylcbiAgICAgICAgICAudHJpbSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyAzLiDrqZTtg4Ag642w7J207YSw7JeQ7IScIOygnOuqqSDssL7quLBcbiAgICBpZiAoIXRpdGxlKSB7XG4gICAgICBjb25zdCBtZXRhVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW3Byb3BlcnR5PVwib2c6dGl0bGVcIl0nKTtcbiAgICAgIGlmIChtZXRhVGl0bGUpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IG1ldGFUaXRsZS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcbiAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICB0aXRsZSA9IGNvbnRlbnQudHJpbSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIOygnOuqqeydhCDssL7sp4Ag66q77ZWcIOqyveyasCDquLDrs7jqsJIg7IKs7JqpXG4gICAgaWYgKCF0aXRsZSkge1xuICAgICAgdGl0bGUgPSAnQ2hhdEdQVCBDb252ZXJzYXRpb24gJyArIG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coYFRpdGxlIGV4dHJhY3RlZDogJHt0aXRsZX1gKTtcbiAgICBcbiAgICAvLyDtjpjsnbTsp4Ag7KCE7LK07JeQ7IScIOuqqOuToCDrjIDtmZQg7JqU7IaMIOyngeygkSDstpTstpwg7Iuc64+EXG4gICAgLy8gMS4gYXNzaXN0YW50IOuplOyLnOyngCDssL7quLAgKOyXrOufrCDshKDtg53snpAg7Iuc64+EKVxuICAgIGxldCBhc3Npc3RhbnRFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1lc3NhZ2UtYXV0aG9yLXJvbGU9XCJhc3Npc3RhbnRcIl0nKTtcbiAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGb3VuZCAke2Fzc2lzdGFudEVsZW1lbnRzLmxlbmd0aH0gYXNzaXN0YW50IGVsZW1lbnRzIGJ5IGF0dHJpYnV0ZWApO1xuICAgIFxuICAgIC8vIOuztOyhsCDshKDtg53snpAg7Iuc64+EXG4gICAgaWYgKGFzc2lzdGFudEVsZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgcG90ZW50aWFsU2VsZWN0b3JzID0gW1xuICAgICAgICAnLm1hcmtkb3duLnByb3NlJywgLy8g7J2867CY7KCB7J24IENoYXRHUFQg7J2R64u1IOyKpO2DgOydvFxuICAgICAgICAnLmNoYXQtbWVzc2FnZVtkYXRhLXJvbGU9XCJhc3Npc3RhbnRcIl0nLFxuICAgICAgICAnLmNoYXQtbWVzc2FnZS1hc3Npc3RhbnQnLFxuICAgICAgICAnLmFzc2lzdGFudC1tZXNzYWdlJyxcbiAgICAgICAgJ1tkYXRhLXJvbGU9XCJhc3Npc3RhbnRcIl0nLFxuICAgICAgICAnZGl2W3JvbGU9XCJyZWdpb25cIl0gPiBkaXYgPiBkaXY6bnRoLWNoaWxkKGV2ZW4pJywgLy8g7Ked7IiYIOuyiOynuCDrqZTsi5zsp4DqsIAgYXNzaXN0YW507J24IOqyveyasFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBwb3RlbnRpYWxTZWxlY3RvcnMpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgaWYgKGVsZW1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGb3VuZCAke2VsZW1lbnRzLmxlbmd0aH0gYXNzaXN0YW50IGVsZW1lbnRzIHdpdGggc2VsZWN0b3I6ICR7c2VsZWN0b3J9YCk7XG4gICAgICAgICAgYXNzaXN0YW50RWxlbWVudHMgPSBlbGVtZW50cztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyAyLiB1c2VyIOuplOyLnOyngCDssL7quLAgKOyXrOufrCDrsKnrspUg7Iuc64+EKVxuICAgIC8vIOuqheyLnOyggeyduCB1c2VyIOyXre2VoCDsho3shLEg7LC+6riwXG4gICAgbGV0IHVzZXJFbGVtZW50cyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbWVzc2FnZS1hdXRob3Itcm9sZT1cInVzZXJcIl0nKSk7XG4gICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHt1c2VyRWxlbWVudHMubGVuZ3RofSB1c2VyIGVsZW1lbnRzIGJ5IGF0dHJpYnV0ZWApO1xuICAgIFxuICAgIC8vIOuMgOyViCDshKDtg53snpAg7Iuc64+EXG4gICAgaWYgKHVzZXJFbGVtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHBvdGVudGlhbFVzZXJTZWxlY3RvcnMgPSBbXG4gICAgICAgICcuY2hhdC1tZXNzYWdlW2RhdGEtcm9sZT1cInVzZXJcIl0nLFxuICAgICAgICAnLmNoYXQtbWVzc2FnZS11c2VyJyxcbiAgICAgICAgJy51c2VyLW1lc3NhZ2UnLFxuICAgICAgICAnW2RhdGEtcm9sZT1cInVzZXJcIl0nLFxuICAgICAgICAnZGl2W3JvbGU9XCJyZWdpb25cIl0gPiBkaXYgPiBkaXY6bnRoLWNoaWxkKG9kZCknLCAvLyDtmYDsiJgg67KI7Ke4IOuplOyLnOyngOqwgCB1c2Vy7J24IOqyveyasFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBwb3RlbnRpYWxVc2VyU2VsZWN0b3JzKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRm91bmQgJHtlbGVtZW50cy5sZW5ndGh9IHVzZXIgZWxlbWVudHMgd2l0aCBzZWxlY3RvcjogJHtzZWxlY3Rvcn1gKTtcbiAgICAgICAgICB1c2VyRWxlbWVudHMgPSBBcnJheS5mcm9tKGVsZW1lbnRzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGaW5hbCBjb3VudCAtIEFzc2lzdGFudDogJHthc3Npc3RhbnRFbGVtZW50cy5sZW5ndGh9LCBVc2VyOiAke3VzZXJFbGVtZW50cy5sZW5ndGh9YCk7XG4gICAgXG4gICAgLy8g64yA7ZmUIOyImOynkVxuICAgIGxldCBtZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT4gPSBbXTtcbiAgICBcbiAgICBpZiAoYXNzaXN0YW50RWxlbWVudHMubGVuZ3RoID4gMCAmJiB1c2VyRWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gSFRNTCDqtazsobDsl5DshJwg66qo65OgIOuMgO2ZlCDsmpTshowg7IiY7KeRIOuwjyDsiJzshJwg6rKw7KCVXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25FbGVtZW50czogQXJyYXk8e1xuICAgICAgICBlbGVtZW50OiBFbGVtZW50O1xuICAgICAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgICAgICAgcG9zaXRpb246IG51bWJlcjtcbiAgICAgIH0+ID0gW107XG4gICAgICBcbiAgICAgIC8vIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgICBBcnJheS5mcm9tKGFzc2lzdGFudEVsZW1lbnRzKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgcG9zaXRpb246IGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbClcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g7IKs7Jqp7J6QIOuplOyLnOyngCDstpTqsIBcbiAgICAgIHVzZXJFbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgY29udmVyc2F0aW9uRWxlbWVudHMucHVzaCh7XG4gICAgICAgICAgZWxlbWVudDogZWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIHBvc2l0aW9uOiBnZXRQb3NpdGlvbkluRG9jdW1lbnQoZWwpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIERPTSDsiJzshJzrjIDroZwg7KCV66CsXG4gICAgICBjb252ZXJzYXRpb25FbGVtZW50cy5zb3J0KChhLCBiKSA9PiBhLnBvc2l0aW9uIC0gYi5wb3NpdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIFNvcnRlZCBjb252ZXJzYXRpb24gZWxlbWVudHM6ICR7Y29udmVyc2F0aW9uRWxlbWVudHMubGVuZ3RofWApO1xuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgZmV3IHJvbGVzOiAke2NvbnZlcnNhdGlvbkVsZW1lbnRzLnNsaWNlKDAsIDMpLm1hcChlID0+IGUucm9sZSkuam9pbignLCAnKX1gKTtcbiAgICAgIFxuICAgICAgLy8g7KCV66Cs65CcIOyalOyGjOyXkOyEnCDrjIDtmZQg64K07JqpIOy2lOy2nFxuICAgICAgY29uc3QgZXh0cmFjdGVkTWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY29udmVyc2F0aW9uRWxlbWVudHMpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGl0ZW0uZWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xuICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyDsnbzrtoAgVUkg7JqU7IaMIOygnOyZuFxuICAgICAgICAgIGlmICghY29udGVudC5pbmNsdWRlcygnU2tpcCB0byBjb250ZW50JykgJiYgXG4gICAgICAgICAgICAgICFjb250ZW50LmluY2x1ZGVzKCdMb2cgaW4nKSAmJiBcbiAgICAgICAgICAgICAgIWNvbnRlbnQuaW5jbHVkZXMoJ1NpZ24gdXAnKSkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHRyYWN0ZWRNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgcm9sZTogaXRlbS5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRXh0cmFjdGVkICR7ZXh0cmFjdGVkTWVzc2FnZXMubGVuZ3RofSBtZXNzYWdlc2ApO1xuICAgICAgaWYgKGV4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtERUJVR10gRmlyc3QgbWVzc2FnZSByb2xlOiAke2V4dHJhY3RlZE1lc3NhZ2VzWzBdLnJvbGV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEZpcnN0IG1lc3NhZ2UgcHJldmlldzogJHtleHRyYWN0ZWRNZXNzYWdlc1swXS5jb250ZW50LnN1YnN0cmluZygwLCAzMCl9Li4uYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOy1nOyGjO2VnCDtlZjrgpjsnZgg7IKs7Jqp7J6Q7JmAIOyWtOyLnOyKpO2EtO2KuCDrqZTsi5zsp4DqsIAg7J6I64qU7KeAIO2ZleyduFxuICAgICAgY29uc3QgaGFzVXNlciA9IGV4dHJhY3RlZE1lc3NhZ2VzLnNvbWUobSA9PiBtLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgICBjb25zdCBoYXNBc3Npc3RhbnQgPSBleHRyYWN0ZWRNZXNzYWdlcy5zb21lKG0gPT4gbS5yb2xlID09PSAnYXNzaXN0YW50Jyk7XG4gICAgICBcbiAgICAgIGlmIChoYXNVc2VyICYmIGhhc0Fzc2lzdGFudCAmJiBleHRyYWN0ZWRNZXNzYWdlcy5sZW5ndGggPj0gMikge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0RFQlVHXSBGb3VuZCB2YWxpZCBjb252ZXJzYXRpb24gd2l0aCAke2V4dHJhY3RlZE1lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXNgKTtcbiAgICAgICAgbWVzc2FnZXMgPSBleHRyYWN0ZWRNZXNzYWdlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBbREVCVUddIEV4dHJhY3RlZCBtZXNzYWdlcyBkb24ndCBmb3JtIGEgdmFsaWQgY29udmVyc2F0aW9uICh1c2VyOiAke2hhc1VzZXJ9LCBhc3Npc3RhbnQ6ICR7aGFzQXNzaXN0YW50fSlgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8g7Y6Y7J207KeA7JeQ7IScIOyalOyGjOydmCDsnITsuZjrpbwg6rKw7KCV7ZWY64qUIO2VqOyImFxuICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uSW5Eb2N1bWVudChlbGVtZW50OiBFbGVtZW50KTogbnVtYmVyIHtcbiAgICAgIC8vIOyalOyGjOydmCDrtoDrqqjrk6TsnYQg66qo65GQIOywvuyVhOyEnCDquYrsnbQg6rOE7IKwXG4gICAgICBsZXQgZGVwdGggPSAwO1xuICAgICAgbGV0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgIHdoaWxlIChwYXJlbnQpIHtcbiAgICAgICAgZGVwdGgrKztcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIERPTeyXkOyEnOydmCDsiJzshJzrpbwg6rOE7IKwICjtmJXsoJwg7JqU7IaMIOykkSDsnITsuZgpXG4gICAgICBsZXQgc2libGluZ1Bvc2l0aW9uID0gMDtcbiAgICAgIGxldCBzaWJsaW5nID0gZWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgd2hpbGUgKHNpYmxpbmcpIHtcbiAgICAgICAgc2libGluZ1Bvc2l0aW9uKys7XG4gICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOyalOyGjOydmCDrjIDrnrXsoIHsnbggWSDsnITsuZjrpbwg67CY7ZmYIChpZiBhdmFpbGFibGUpXG4gICAgICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHlQb3NpdGlvbiA9IHJlY3QgPyByZWN0LnRvcCA6IDA7XG4gICAgICBcbiAgICAgIC8vIOq5iuydtCwg7ZiV7KCcIOychOy5mCwgWeychOy5mOulvCDsobDtlantlZjsl6wg7LWc7KKFIOychOy5mCDrsJjtmZhcbiAgICAgIHJldHVybiB5UG9zaXRpb24gKyAoc2libGluZ1Bvc2l0aW9uICogMTAwMDApICsgKGRlcHRoICogMTAwMDAwMCk7XG4gICAgfVxuICAgIFxuICAgIC8vIOuplOyLnOyngOqwgCDsl4bsnLzrqbQg6riw67O4IOyYpOulmCDrqZTsi5zsp4Ag7LaU6rCAXG4gICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8g7LWc7ZuE7J2YIOuwqeuylTog7Y6Y7J207KeA7JeQ7IScIOydtOyghC/ri6TsnYwg66mU7Iuc7KeAIO2MqO2EtCDssL7quLBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIOydvOuwmOyggeyduCDsgqzsmqnsnpAg7J6F66ClIO2MqO2EtCAo7LWc7IaMIDPqsJwg7J207IOB7J2YIOuLqOyWtOulvCDqsIDsp4Qg66y464uoKVxuICAgICAgICBjb25zdCBwb3RlbnRpYWxVc2VyTWVzc2FnZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3AsIGRpdiwgc3BhbicpKVxuICAgICAgICAgIC5tYXAoZWwgPT4gZWwudGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnJylcbiAgICAgICAgICAuZmlsdGVyKHRleHQgPT4gdGV4dCAmJiB0ZXh0LnNwbGl0KCcgJykubGVuZ3RoID49IDMgJiYgdGV4dC5sZW5ndGggPiAyMClcbiAgICAgICAgICAuZmlsdGVyKHRleHQgPT4gIXRleHQuaW5jbHVkZXMoJ0NoYXRHUFQnKSAmJiAhdGV4dC5pbmNsdWRlcygnTG9nIGluJykgJiYgIXRleHQuaW5jbHVkZXMoJ1NpZ24gdXAnKSk7XG4gICAgICAgICAgXG4gICAgICAgIGlmIChwb3RlbnRpYWxVc2VyTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIOyyqyDrsojsp7gg66mU7Iuc7KeA66W8IOyCrOyaqeyekCDrqZTsi5zsp4DroZwg7LaU6rCAXG4gICAgICAgICAgY29uc3QgdXNlck1lc3NhZ2UgPSBwb3RlbnRpYWxVc2VyTWVzc2FnZXNbMF07XG4gICAgICAgICAgbWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICBjb250ZW50OiB1c2VyTWVzc2FnZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIOuCmOuouOyngCDthY3siqTtirjrpbwg7Ja07Iuc7Iqk7YS07Yq4IOydkeuLteycvOuhnCDstpTqsIBcbiAgICAgICAgICBjb25zdCByZW1haW5pbmdUZXh0ID0gZG9jdW1lbnQuYm9keS5pbm5lclRleHRcbiAgICAgICAgICAgIC5yZXBsYWNlKHRpdGxlLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKHVzZXJNZXNzYWdlLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9Mb2cgaW58U2lnbiB1cHxBdHRhY2h8U2VhcmNofFJlYXNvbnxWb2ljZXxCeSBtZXNzYWdpbmcgQ2hhdEdQVHxTa2lwIHRvIGNvbnRlbnR8Q2hhdEdQVC9nLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC93aW5kb3dcXC5fX29haV8uKj87L2csICcnKVxuICAgICAgICAgIC50cmltKCk7XG4gICAgICAgIFxuICAgICAgICAgIGlmIChyZW1haW5pbmdUZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICAgICAgY29udGVudDogcmVtYWluaW5nVGV4dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1lc3NhZ2VzLnB1c2goeyBcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgY29udGVudDogJ+uMgO2ZlCDrgrTsmqnsnYQg7LaU7Lac7ZWgIOyImCDsl4bsirXri4jri6QuIENoYXRHUFQg6rO17JygIOunge2BrOqwgCDsnKDtmqjtlZzsp4Ag7ZmV7J247ZW07KO87IS47JqULicgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG1lc3NhZ2VzLnB1c2goeyBcbiAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JywgXG4gICAgICAgICAgY29udGVudDogJ+uMgO2ZlCDrgrTsmqnsnYQg7LaU7Lac7ZWgIOyImCDsl4bsirXri4jri6QuIENoYXRHUFQg6rO17JygIOunge2BrOqwgCDsnKDtmqjtlZzsp4Ag7ZmV7J247ZW07KO87IS47JqULicgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyDrjIDtmZTtmJUg6rWs7KGwIO2ZleyduCAtIOuovOyggCDsnKDsoIAg66mU7Iuc7KeA66GcIOyLnOyeke2VmOuKlOyngCDtmZXsnbhcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID4gMCAmJiBtZXNzYWdlc1swXS5yb2xlICE9PSAndXNlcicpIHtcbiAgICAgIC8vIENoYXRHUFQg64yA7ZmU64qUIO2VreyDgSDsgqzsmqnsnpAg7KeI66y47Jy866GcIOyLnOyeke2VtOyVvCDtlahcbiAgICAgIC8vIOuMgO2ZlOqwgCDslrTsi5zsiqTthLTtirjroZwg7Iuc7J6R7ZWY66m0IOyyqyDrqZTsi5zsp4Drpbwg7IKs7Jqp7J6QIOuplOyLnOyngOuhnCDrs4Dqsr1cbiAgICAgIGNvbnNvbGUubG9nKCfssqsg66mU7Iuc7KeA6rCAIOyCrOyaqeyekCDrqZTsi5zsp4DqsIAg7JWE64uZ64uI64ukLiDrjIDtmZQg6rWs7KGw66W8IOyImOygle2VqeuLiOuLpC4nKTtcbiAgICAgIFxuICAgICAgLy8g7IOIIOuMgO2ZlCDqtazsobAg7IOd7ISxXG4gICAgICBjb25zdCBhbHRlcm5hdGluZ01lc3NhZ2VzOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7IGNvbnRlbnQ6IHN0cmluZyB9PiA9IFtdO1xuICAgICAgXG4gICAgICAvLyDssqsg67KI7Ke4IOuplOyLnOyngOqwgCBhc3Npc3RhbnTsnbgg6rK97JqwLCDqsIDsp5wgdXNlciDrqZTsi5zsp4Drpbwg7LaU6rCA7ZWY6rOgIOyLnOyekVxuICAgICAgYWx0ZXJuYXRpbmdNZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICBjb250ZW50OiAn64yA7ZmU66W8IOyLnOyeke2VqeuLiOuLpC4nXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g6riw7KG0IOuplOyLnOyngCDrs7XsgqxcbiAgICAgIG1lc3NhZ2VzLmZvckVhY2gobXNnID0+IHtcbiAgICAgICAgYWx0ZXJuYXRpbmdNZXNzYWdlcy5wdXNoKG1zZyk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8g7IiY7KCV65CcIOuplOyLnOyngOuhnCDqtZDssrRcbiAgICAgIG1lc3NhZ2VzID0gYWx0ZXJuYXRpbmdNZXNzYWdlcztcbiAgICB9XG4gICAgXG4gICAgLy8g7Jis67CU66W4IOuMgO2ZlCDqtazsobAg7ZmV7J24ICh1c2Vy7JmAIGFzc2lzdGFudOqwgCDrsojqsIjslYQg64KY7YOA64KY7JW8IO2VqClcbiAgICBjb25zdCBjb3JyZWN0ZWRNZXNzYWdlczogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyBjb250ZW50OiBzdHJpbmcgfT4gPSBbXTtcbiAgICBsZXQgZXhwZWN0ZWRSb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyA9ICd1c2VyJzsgLy8g64yA7ZmU64qUIHVzZXLroZwg7Iuc7J6R7ZW07JW8IO2VqFxuICAgIFxuICAgIG1lc3NhZ2VzLmZvckVhY2goKG1zZywgaW5kZXgpID0+IHtcbiAgICAgIGlmIChpbmRleCA9PT0gMCAmJiBtc2cucm9sZSAhPT0gJ3VzZXInKSB7XG4gICAgICAgIC8vIOyyqyDrqZTsi5zsp4DripQg7ZWt7IOBIOyCrOyaqeyekOyXrOyVvCDtlahcbiAgICAgICAgY29ycmVjdGVkTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6ICfrjIDtmZTrpbwg7Iuc7J6R7ZWp64uI64ukLidcbiAgICAgICAgfSk7XG4gICAgICAgIGV4cGVjdGVkUm9sZSA9ICdhc3Npc3RhbnQnO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAobXNnLnJvbGUgPT09IGV4cGVjdGVkUm9sZSkge1xuICAgICAgICAvLyDsl63tlaDsnbQg7JiI7IOB64yA66Gc7J24IOqyveyasCDqt7jrjIDroZwg7LaU6rCAXG4gICAgICAgIGNvcnJlY3RlZE1lc3NhZ2VzLnB1c2gobXNnKTtcbiAgICAgICAgLy8g64uk7J2MIOyYiOyDgSDsl63tlaAg7KCE7ZmYXG4gICAgICAgIGV4cGVjdGVkUm9sZSA9IGV4cGVjdGVkUm9sZSA9PT0gJ3VzZXInID8gJ2Fzc2lzdGFudCcgOiAndXNlcic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDqsJnsnYAg7Jet7ZWg7J20IOyXsOyGjeycvOuhnCDrgpjtg4DrgpjripQg6rK97JqwLCDruYgg66mU7Iuc7KeA66W8IOykkeqwhOyXkCDsgr3snoVcbiAgICAgICAgaWYgKGV4cGVjdGVkUm9sZSA9PT0gJ3VzZXInKSB7XG4gICAgICAgICAgY29ycmVjdGVkTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICBjb250ZW50OiAnKOqzhOyGjSknXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29ycmVjdGVkTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICco6rOE7IaNKSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyDtmITsnqwg66mU7Iuc7KeAIOy2lOqwgFxuICAgICAgICBjb3JyZWN0ZWRNZXNzYWdlcy5wdXNoKG1zZyk7XG4gICAgICAgIC8vIOuLpOydjCDsmIjsg4Eg7Jet7ZWgIOyEpOyglVxuICAgICAgICBleHBlY3RlZFJvbGUgPSBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ2Fzc2lzdGFudCcgOiAndXNlcic7XG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgLy8g7IiY7KCV65CcIOuplOyLnOyngOuhnCDqtZDssrRcbiAgICBtZXNzYWdlcyA9IGNvcnJlY3RlZE1lc3NhZ2VzO1xuICAgICAgXG4gICAgICAvLyBHUFQtNCDrqqjrjbjsnbjsp4Ag7ZmV7J24XG4gICAgICBjb25zdCBpc0dQVDQgPSBkb2N1bWVudC5ib2R5LmlubmVyVGV4dC5pbmNsdWRlcygnR1BULTQnKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lclRleHQuaW5jbHVkZXMoJ2dwdC00JykgfHxcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW1nW2FsdCo9XCJHUFQtNFwiXScpICE9PSBudWxsO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZSxcbiAgICAgICAgbWVzc2FnZXMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIG1vZGVsOiBpc0dQVDQgPyAnZ3B0LTQnIDogJ2dwdC0zLjUtdHVyYm8nLFxuICAgICAgICAgIHRhZ3M6IFtdXG4gICAgICAgIH1cbiAgICAgIH07XG4gIH0pIGFzIHsgXG4gICAgdGl0bGU6IHN0cmluZzsgXG4gICAgbWVzc2FnZXM6IEFycmF5PHsgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJzsgY29udGVudDogc3RyaW5nIH0+OyBcbiAgICBtZXRhZGF0YTogeyBcbiAgICAgIGRhdGU6IHN0cmluZzsgXG4gICAgICBtb2RlbDogc3RyaW5nOyBcbiAgICAgIHRhZ3M6IHN0cmluZ1tdOyBcbiAgICB9OyBcbiAgfTtcbn0iXSwibmFtZXMiOlsiQ2hhdFNvdXJjZSIsInBhdGgiLCJmcyIsInB1cHBldGVlciIsInJlcXVpcmUiLCJjaHJvbWl1bSIsIkVycm9yIiwiaXNXaW5kb3dzIiwicHJvY2VzcyIsInBsYXRmb3JtIiwiaXNWZXJjZWwiLCJlbnYiLCJWRVJDRUwiLCJnZXRDaHJvbWl1bVBhdGgiLCJsb2NhbENocm9tZVBhdGhzIiwiTE9DQUxBUFBEQVRBIiwiY2hyb21lUGF0aCIsImV4aXN0c1N5bmMiLCJjb25zb2xlIiwibG9nIiwiZXhlY1BhdGgiLCJleGVjdXRhYmxlUGF0aCIsImxvY2FsQ2hyb21pdW1QYXRoIiwiam9pbiIsImN3ZCIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsImVycm9yIiwiZGVmYXVsdENocm9tZVBhdGgiLCJwYXJzZUNoYXRHUFRMaW5rIiwidXJsIiwiYnJvd3NlciIsIkNIUk9NSVVNX1BBVEgiLCJvcHRpb25zIiwiYXJncyIsImRlZmF1bHRWaWV3cG9ydCIsIndpZHRoIiwiaGVpZ2h0IiwiaGVhZGxlc3MiLCJpZ25vcmVIVFRQU0Vycm9ycyIsInRpbWVvdXQiLCJsYXVuY2giLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJwYWdlIiwibmV3UGFnZSIsInNldERlZmF1bHROYXZpZ2F0aW9uVGltZW91dCIsInNldERlZmF1bHRUaW1lb3V0Iiwic2V0VXNlckFnZW50IiwiZ290byIsIndhaXRVbnRpbCIsIndhaXRGb3JUaW1lb3V0IiwicmF3SHRtbCIsImNvbnRlbnQiLCJsZW5ndGgiLCJyYXdUZXh0IiwiZXZhbHVhdGUiLCJkb2N1bWVudCIsImJvZHkiLCJpbm5lclRleHQiLCJjb252ZXJzYXRpb25EYXRhIiwiZXh0cmFjdENvbnZlcnNhdGlvbkRhdGEiLCJjb252ZXJzYXRpb24iLCJpZCIsImV4dHJhY3RDb252ZXJzYXRpb25JZCIsInRpdGxlIiwibWVzc2FnZXMiLCJjcmVhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzb3VyY2UiLCJDSEFUR1BUIiwibWV0YWRhdGEiLCJjbG9zZSIsImNsb3NlRXJyb3IiLCJ3YXJuIiwiU3RyaW5nIiwidXJsU2VnbWVudHMiLCJzcGxpdCIsInBvdGVudGlhbElkIiwicG9wIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwicGFnZUluZm8iLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJib2R5VGV4dCIsIkpTT04iLCJzdHJpbmdpZnkiLCJoMUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJ0cmltIiwidGl0bGVFbGVtZW50IiwicmVwbGFjZSIsIm1ldGFUaXRsZSIsImdldEF0dHJpYnV0ZSIsInRvTG9jYWxlU3RyaW5nIiwiYXNzaXN0YW50RWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwicG90ZW50aWFsU2VsZWN0b3JzIiwic2VsZWN0b3IiLCJlbGVtZW50cyIsInVzZXJFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInBvdGVudGlhbFVzZXJTZWxlY3RvcnMiLCJjb252ZXJzYXRpb25FbGVtZW50cyIsImZvckVhY2giLCJlbCIsInB1c2giLCJlbGVtZW50Iiwicm9sZSIsInBvc2l0aW9uIiwiZ2V0UG9zaXRpb25JbkRvY3VtZW50Iiwic29ydCIsImEiLCJiIiwic2xpY2UiLCJtYXAiLCJlIiwiZXh0cmFjdGVkTWVzc2FnZXMiLCJpdGVtIiwiaW5jbHVkZXMiLCJoYXNVc2VyIiwic29tZSIsIm0iLCJoYXNBc3Npc3RhbnQiLCJkZXB0aCIsInBhcmVudCIsInBhcmVudEVsZW1lbnQiLCJzaWJsaW5nUG9zaXRpb24iLCJzaWJsaW5nIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ5UG9zaXRpb24iLCJ0b3AiLCJwb3RlbnRpYWxVc2VyTWVzc2FnZXMiLCJmaWx0ZXIiLCJ0ZXh0IiwidXNlck1lc3NhZ2UiLCJyZW1haW5pbmdUZXh0IiwiYWx0ZXJuYXRpbmdNZXNzYWdlcyIsIm1zZyIsImNvcnJlY3RlZE1lc3NhZ2VzIiwiZXhwZWN0ZWRSb2xlIiwiaW5kZXgiLCJpc0dQVDQiLCJkYXRlIiwibW9kZWwiLCJ0YWdzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/chatgpt.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/utils/openai.ts":
/*!*********************************!*\
  !*** ./src/lib/utils/openai.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   summarizeConversation: () => (/* binding */ summarizeConversation),\n/* harmony export */   summarizeLongConversation: () => (/* binding */ summarizeLongConversation)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n// OpenAI API 클라이언트 초기화\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// 사용할 모델 정의\nconst MODEL = \"gpt-4.1-nano\";\n/**\r\n * 대화 내용을 요약하고 키워드를 추출하는 함수\r\n * @param title 대화 제목\r\n * @param messages 대화 메시지 배열\r\n * @returns 요약된 내용과 키워드, 사용된 모델 정보\r\n */ async function summarizeConversation(title, messages) {\n    try {\n        const conversationText = messages.map((msg)=>`${msg.role === \"user\" ? \"\\uD83D\\uDC64 사용자\" : \"\\uD83E\\uDD16 AI\"}: ${msg.content}`).join(\"\\n\\n\");\n        // API 요청 - 요약 및 키워드 추출\n        const response = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"당신은 대화 내용을 요약하고 주요 키워드를 추출하는 assistant입니다. 요약은 3-5문장으로, 키워드는 최대 5개까지 추출해주세요. JSON 형식으로 응답해주세요.\"\n                },\n                {\n                    role: \"user\",\n                    content: `제목: \"${title}\"\\n\\n다음 대화 내용을 요약하고, 관련 키워드를 추출해주세요. JSON 형식으로 응답해야 합니다. 다음 형식으로 응답하세요: {\"summary\": \"요약 내용...\", \"keywords\": [\"키워드1\", \"키워드2\", ...]}:\\n\\n${conversationText}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        // 응답 처리\n        try {\n            const content = response.choices[0]?.message?.content || \"\";\n            console.log(\"API 응답 내용:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"요약을 생성할 수 없습니다.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : [],\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"JSON 파싱 오류:\", parseError);\n            console.log(\"파싱 실패한 내용:\", response.choices[0]?.message?.content);\n            return {\n                summary: \"요약을 생성할 수 없습니다.\",\n                keywords: [],\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"대화 요약 중 오류 발생:\", error);\n        return {\n            summary: \"요약을 생성할 수 없습니다.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n/**\r\n * 긴 대화를 요약하는 함수 (토큰 제한에 걸리는 경우 사용)\r\n * @param title 대화 제목\r\n * @param messages 대화 메시지 배열\r\n * @returns 요약된 내용과 키워드, 사용된 모델 정보\r\n */ async function summarizeLongConversation(title, messages) {\n    try {\n        // 대화를 여러 파트로 나누기 (10개 메시지씩)\n        const messageParts = [];\n        const partSize = 10;\n        for(let i = 0; i < messages.length; i += partSize){\n            messageParts.push(messages.slice(i, i + partSize));\n        }\n        // 각 파트별로 요약 생성\n        const partSummaries = [];\n        let allKeywords = [];\n        for(let i = 0; i < messageParts.length; i++){\n            try {\n                const result = await summarizeConversation(`${title} (파트 ${i + 1}/${messageParts.length})`, messageParts[i]);\n                partSummaries.push(`파트 ${i + 1}: ${result.summary}`);\n                // 키워드 수집\n                if (Array.isArray(result.keywords)) {\n                    allKeywords = [\n                        ...allKeywords,\n                        ...result.keywords\n                    ];\n                }\n            } catch (error) {\n                console.error(`파트 ${i + 1} 요약 중 오류:`, error);\n                partSummaries.push(`파트 ${i + 1}: 요약 실패`);\n            }\n        }\n        // 부분 요약들을 조합하여 최종 요약 생성\n        const finalResponse = await openai.chat.completions.create({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: \"여러 대화 요약을 하나의 통합된 요약으로 만들고, 가장 중요한 키워드를 5개 이내로 추출해주세요. JSON 형식으로 응답해주세요.\"\n                },\n                {\n                    role: \"user\",\n                    content: `다음은 긴 대화를 나눈 부분별 요약입니다. 이들을 결합하여 전체 대화의 핵심을 담은 통합 요약을 5문장 이내로 작성하고, 가장 중요한 키워드 5개를 추출해주세요. JSON 형식으로 응답해야 합니다. {\"summary\": \"요약 내용...\", \"keywords\": [\"키워드1\", \"키워드2\", ...]} 형식으로 응답하세요:\\n\\n${partSummaries.join(\"\\n\\n\")}`\n                }\n            ],\n            temperature: 0.5,\n            max_tokens: 400,\n            response_format: {\n                type: \"json_object\"\n            }\n        });\n        try {\n            const content = finalResponse.choices[0]?.message?.content || \"\";\n            console.log(\"최종 API 응답 내용:\", content);\n            const parsedContent = JSON.parse(content);\n            return {\n                summary: parsedContent.summary || \"요약을 생성할 수 없습니다.\",\n                keywords: Array.isArray(parsedContent.keywords) ? parsedContent.keywords : allKeywords,\n                modelUsed: MODEL\n            };\n        } catch (parseError) {\n            console.error(\"최종 요약 JSON 파싱 오류:\", parseError);\n            console.log(\"파싱 실패한 내용:\", finalResponse.choices[0]?.message?.content);\n            // 키워드 중복 제거 및 최대 5개로 제한\n            const uniqueKeywords = Array.from(new Set(allKeywords)).slice(0, 5);\n            return {\n                summary: \"요약을 생성할 수 없습니다.\",\n                keywords: uniqueKeywords,\n                modelUsed: MODEL\n            };\n        }\n    } catch (error) {\n        console.error(\"긴 대화 요약 중 오류 발생:\", error);\n        return {\n            summary: \"요약을 생성할 수 없습니다.\",\n            keywords: [],\n            modelUsed: MODEL\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3V0aWxzL29wZW5haS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEI7QUFHNUIsdUJBQXVCO0FBQ3ZCLE1BQU1DLFNBQVMsSUFBSUQsOENBQU1BLENBQUM7SUFDeEJFLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsY0FBYztBQUNwQztBQUVBLFlBQVk7QUFDWixNQUFNQyxRQUFRO0FBU2Q7Ozs7O0NBS0MsR0FDTSxlQUFlQyxzQkFDcEJDLEtBQWEsRUFDYkMsUUFBdUI7SUFFdkIsSUFBSTtRQUNGLE1BQU1DLG1CQUFtQkQsU0FDdEJFLEdBQUcsQ0FBQ0MsQ0FBQUEsTUFBTyxDQUFDLEVBQUVBLElBQUlDLElBQUksS0FBSyxTQUFTLHFCQUFXLGtCQUFRLEVBQUUsRUFBRUQsSUFBSUUsT0FBTyxDQUFDLENBQUMsRUFDeEVDLElBQUksQ0FBQztRQUVSLHVCQUF1QjtRQUN2QixNQUFNQyxXQUFXLE1BQU1mLE9BQU9nQixJQUFJLENBQUNDLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1lBQ3BEQyxPQUFPZDtZQUNQRyxVQUFVO2dCQUNSO29CQUNFSSxNQUFNO29CQUNOQyxTQUFTO2dCQUNYO2dCQUNBO29CQUNFRCxNQUFNO29CQUNOQyxTQUFTLENBQUMsS0FBSyxFQUFFTixNQUFNLHVJQUF1SSxFQUFFRSxpQkFBaUIsQ0FBQztnQkFDcEw7YUFDRDtZQUNEVyxhQUFhO1lBQ2JDLFlBQVk7WUFDWkMsaUJBQWlCO2dCQUFFQyxNQUFNO1lBQWM7UUFDekM7UUFFQSxRQUFRO1FBQ1IsSUFBSTtZQUNGLE1BQU1WLFVBQVVFLFNBQVNTLE9BQU8sQ0FBQyxFQUFFLEVBQUVDLFNBQVNaLFdBQVc7WUFDekRhLFFBQVFDLEdBQUcsQ0FBQyxjQUFjZDtZQUUxQixNQUFNZSxnQkFBZ0JDLEtBQUtDLEtBQUssQ0FBQ2pCO1lBQ2pDLE9BQU87Z0JBQ0xrQixTQUFTSCxjQUFjRyxPQUFPLElBQUk7Z0JBQ2xDQyxVQUFVQyxNQUFNQyxPQUFPLENBQUNOLGNBQWNJLFFBQVEsSUFBSUosY0FBY0ksUUFBUSxHQUFHLEVBQUU7Z0JBQzdFRyxXQUFXOUI7WUFDYjtRQUNGLEVBQUUsT0FBTytCLFlBQVk7WUFDbkJWLFFBQVFXLEtBQUssQ0FBQyxlQUFlRDtZQUM3QlYsUUFBUUMsR0FBRyxDQUFDLGNBQWNaLFNBQVNTLE9BQU8sQ0FBQyxFQUFFLEVBQUVDLFNBQVNaO1lBQ3hELE9BQU87Z0JBQ0xrQixTQUFTO2dCQUNUQyxVQUFVLEVBQUU7Z0JBQ1pHLFdBQVc5QjtZQUNiO1FBQ0Y7SUFDRixFQUFFLE9BQU9nQyxPQUFZO1FBQ25CWCxRQUFRVyxLQUFLLENBQUMsa0JBQWtCQTtRQUNoQyxPQUFPO1lBQ0xOLFNBQVM7WUFDVEMsVUFBVSxFQUFFO1lBQ1pHLFdBQVc5QjtRQUNiO0lBQ0Y7QUFDRjtBQUVBOzs7OztDQUtDLEdBQ00sZUFBZWlDLDBCQUNwQi9CLEtBQWEsRUFDYkMsUUFBdUI7SUFFdkIsSUFBSTtRQUNGLDRCQUE0QjtRQUM1QixNQUFNK0IsZUFBZ0MsRUFBRTtRQUN4QyxNQUFNQyxXQUFXO1FBRWpCLElBQUssSUFBSUMsSUFBSSxHQUFHQSxJQUFJakMsU0FBU2tDLE1BQU0sRUFBRUQsS0FBS0QsU0FBVTtZQUNsREQsYUFBYUksSUFBSSxDQUFDbkMsU0FBU29DLEtBQUssQ0FBQ0gsR0FBR0EsSUFBSUQ7UUFDMUM7UUFFQSxlQUFlO1FBQ2YsTUFBTUssZ0JBQTBCLEVBQUU7UUFDbEMsSUFBSUMsY0FBd0IsRUFBRTtRQUU5QixJQUFLLElBQUlMLElBQUksR0FBR0EsSUFBSUYsYUFBYUcsTUFBTSxFQUFFRCxJQUFLO1lBQzVDLElBQUk7Z0JBQ0YsTUFBTU0sU0FBUyxNQUFNekMsc0JBQ25CLENBQUMsRUFBRUMsTUFBTSxLQUFLLEVBQUVrQyxJQUFFLEVBQUUsQ0FBQyxFQUFFRixhQUFhRyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQzdDSCxZQUFZLENBQUNFLEVBQUU7Z0JBRWpCSSxjQUFjRixJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUVGLElBQUUsRUFBRSxFQUFFLEVBQUVNLE9BQU9oQixPQUFPLENBQUMsQ0FBQztnQkFFakQsU0FBUztnQkFDVCxJQUFJRSxNQUFNQyxPQUFPLENBQUNhLE9BQU9mLFFBQVEsR0FBRztvQkFDbENjLGNBQWM7MkJBQUlBOzJCQUFnQkMsT0FBT2YsUUFBUTtxQkFBQztnQkFDcEQ7WUFDRixFQUFFLE9BQU9LLE9BQU87Z0JBQ2RYLFFBQVFXLEtBQUssQ0FBQyxDQUFDLEdBQUcsRUFBRUksSUFBRSxFQUFFLFNBQVMsQ0FBQyxFQUFFSjtnQkFDcENRLGNBQWNGLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRUYsSUFBRSxFQUFFLE9BQU8sQ0FBQztZQUN2QztRQUNGO1FBRUEsd0JBQXdCO1FBQ3hCLE1BQU1PLGdCQUFnQixNQUFNaEQsT0FBT2dCLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxNQUFNLENBQUM7WUFDekRDLE9BQU9kO1lBQ1BHLFVBQVU7Z0JBQ1I7b0JBQ0VJLE1BQU07b0JBQ05DLFNBQVM7Z0JBQ1g7Z0JBQ0E7b0JBQ0VELE1BQU07b0JBQ05DLFNBQVMsQ0FBQyx5TEFBeUwsRUFBRWdDLGNBQWMvQixJQUFJLENBQUMsUUFBUSxDQUFDO2dCQUNuTzthQUNEO1lBQ0RNLGFBQWE7WUFDYkMsWUFBWTtZQUNaQyxpQkFBaUI7Z0JBQUVDLE1BQU07WUFBYztRQUN6QztRQUVBLElBQUk7WUFDRixNQUFNVixVQUFVbUMsY0FBY3hCLE9BQU8sQ0FBQyxFQUFFLEVBQUVDLFNBQVNaLFdBQVc7WUFDOURhLFFBQVFDLEdBQUcsQ0FBQyxpQkFBaUJkO1lBRTdCLE1BQU1lLGdCQUFnQkMsS0FBS0MsS0FBSyxDQUFDakI7WUFDakMsT0FBTztnQkFDTGtCLFNBQVNILGNBQWNHLE9BQU8sSUFBSTtnQkFDbENDLFVBQVVDLE1BQU1DLE9BQU8sQ0FBQ04sY0FBY0ksUUFBUSxJQUFJSixjQUFjSSxRQUFRLEdBQUdjO2dCQUMzRVgsV0FBVzlCO1lBQ2I7UUFDRixFQUFFLE9BQU8rQixZQUFZO1lBQ25CVixRQUFRVyxLQUFLLENBQUMscUJBQXFCRDtZQUNuQ1YsUUFBUUMsR0FBRyxDQUFDLGNBQWNxQixjQUFjeEIsT0FBTyxDQUFDLEVBQUUsRUFBRUMsU0FBU1o7WUFFN0Qsd0JBQXdCO1lBQ3hCLE1BQU1vQyxpQkFBaUJoQixNQUFNaUIsSUFBSSxDQUFDLElBQUlDLElBQUlMLGNBQWNGLEtBQUssQ0FBQyxHQUFHO1lBRWpFLE9BQU87Z0JBQ0xiLFNBQVM7Z0JBQ1RDLFVBQVVpQjtnQkFDVmQsV0FBVzlCO1lBQ2I7UUFDRjtJQUNGLEVBQUUsT0FBT2dDLE9BQVk7UUFDbkJYLFFBQVFXLEtBQUssQ0FBQyxvQkFBb0JBO1FBQ2xDLE9BQU87WUFDTE4sU0FBUztZQUNUQyxVQUFVLEVBQUU7WUFDWkcsV0FBVzlCO1FBQ2I7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvbGliL3V0aWxzL29wZW5haS50cz9iNjgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuXHJcbi8vIE9wZW5BSSBBUEkg7YG065287J207Ja47Yq4IOy0iOq4sO2ZlFxyXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcclxuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxyXG59KTtcclxuXHJcbi8vIOyCrOyaqe2VoCDrqqjrjbgg7KCV7J2YXHJcbmNvbnN0IE1PREVMID0gJ2dwdC00LjEtbmFubyc7XHJcblxyXG4vLyDsmpTslb0g6rKw6rO8IO2DgOyehSDsoJXsnZhcclxuZXhwb3J0IGludGVyZmFjZSBTdW1tYXJ5UmVzdWx0IHtcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIG1vZGVsVXNlZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7YKk7JuM65Oc66W8IOy2lOy2nO2VmOuKlCDtlajsiJhcclxuICogQHBhcmFtIHRpdGxlIOuMgO2ZlCDsoJzrqqlcclxuICogQHBhcmFtIG1lc3NhZ2VzIOuMgO2ZlCDrqZTsi5zsp4Ag67Cw7Je0XHJcbiAqIEByZXR1cm5zIOyalOyVveuQnCDrgrTsmqnqs7wg7YKk7JuM65OcLCDsgqzsmqnrkJwg66qo6424IOygleuztFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjb252ZXJzYXRpb25UZXh0ID0gbWVzc2FnZXNcclxuICAgICAgLm1hcChtc2cgPT4gYCR7bXNnLnJvbGUgPT09ICd1c2VyJyA/ICfwn5GkIOyCrOyaqeyekCcgOiAn8J+kliBBSSd9OiAke21zZy5jb250ZW50fWApXHJcbiAgICAgIC5qb2luKCdcXG5cXG4nKTtcclxuXHJcbiAgICAvLyBBUEkg7JqU7LKtIC0g7JqU7JW9IOuwjyDtgqTsm4zrk5wg7LaU7LacXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIG1vZGVsOiBNT0RFTCxcclxuICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcclxuICAgICAgICAgIGNvbnRlbnQ6ICfri7nsi6DsnYAg64yA7ZmUIOuCtOyaqeydhCDsmpTslb3tlZjqs6Ag7KO87JqUIO2CpOybjOuTnOulvCDstpTstpztlZjripQgYXNzaXN0YW507J6F64uI64ukLiDsmpTslb3snYAgMy0166y47J6l7Jy866GcLCDtgqTsm4zrk5zripQg7LWc64yAIDXqsJzquYzsp4Ag7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOygnOuqqTogXCIke3RpdGxlfVwiXFxuXFxu64uk7J2MIOuMgO2ZlCDrgrTsmqnsnYQg7JqU7JW97ZWY6rOgLCDqtIDroKgg7YKk7JuM65Oc66W8IOy2lOy2nO2VtOyjvOyEuOyalC4gSlNPTiDtmJXsi53snLzroZwg7J2R64u17ZW07JW8IO2VqeuLiOuLpC4g64uk7J2MIO2YleyLneycvOuhnCDsnZHri7XtlZjshLjsmpQ6IHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX06XFxuXFxuJHtjb252ZXJzYXRpb25UZXh0fWBcclxuICAgICAgICB9XHJcbiAgICAgIF0sXHJcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjUsXHJcbiAgICAgIG1heF90b2tlbnM6IDQwMCxcclxuICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7IHR5cGU6IFwianNvbl9vYmplY3RcIiB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDsnZHri7Ug7LKY66asXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCB8fCAnJztcclxuICAgICAgY29uc29sZS5sb2coJ0FQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBbXSxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7IuxIOyYpOulmDonLCBwYXJzZUVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ+2MjOyLsSDsi6TtjKjtlZwg64K07JqpOicsIHJlc3BvbnNlLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1bW1hcnk6ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgICAgbW9kZWxVc2VkOiBNT0RFTFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+uMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog6ri0IOuMgO2ZlOulvCDsmpTslb3tlZjripQg7ZWo7IiYICjthqDtgbAg7KCc7ZWc7JeQIOqxuOumrOuKlCDqsr3smrAg7IKs7JqpKVxyXG4gKiBAcGFyYW0gdGl0bGUg64yA7ZmUIOygnOuqqVxyXG4gKiBAcGFyYW0gbWVzc2FnZXMg64yA7ZmUIOuplOyLnOyngCDrsLDsl7RcclxuICogQHJldHVybnMg7JqU7JW965CcIOuCtOyaqeqzvCDtgqTsm4zrk5wsIOyCrOyaqeuQnCDrqqjrjbgg7KCV67O0XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbihcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbik6IFByb21pc2U8U3VtbWFyeVJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrjIDtmZTrpbwg7Jes65+sIO2MjO2KuOuhnCDrgpjriITquLAgKDEw6rCcIOuplOyLnOyngOyUqSlcclxuICAgIGNvbnN0IG1lc3NhZ2VQYXJ0czogQ2hhdE1lc3NhZ2VbXVtdID0gW107XHJcbiAgICBjb25zdCBwYXJ0U2l6ZSA9IDEwO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VzLmxlbmd0aDsgaSArPSBwYXJ0U2l6ZSkge1xyXG4gICAgICBtZXNzYWdlUGFydHMucHVzaChtZXNzYWdlcy5zbGljZShpLCBpICsgcGFydFNpemUpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g6rCBIO2MjO2KuOuzhOuhnCDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBwYXJ0U3VtbWFyaWVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgbGV0IGFsbEtleXdvcmRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lc3NhZ2VQYXJ0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihcclxuICAgICAgICAgIGAke3RpdGxlfSAo7YyM7Yq4ICR7aSsxfS8ke21lc3NhZ2VQYXJ0cy5sZW5ndGh9KWAsXHJcbiAgICAgICAgICBtZXNzYWdlUGFydHNbaV1cclxuICAgICAgICApO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTogJHtyZXN1bHQuc3VtbWFyeX1gKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDtgqTsm4zrk5wg7IiY7KeRXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0LmtleXdvcmRzKSkge1xyXG4gICAgICAgICAgYWxsS2V5d29yZHMgPSBbLi4uYWxsS2V5d29yZHMsIC4uLnJlc3VsdC5rZXl3b3Jkc107XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYO2MjO2KuCAke2krMX0g7JqU7JW9IOykkSDsmKTrpZg6YCwgZXJyb3IpO1xyXG4gICAgICAgIHBhcnRTdW1tYXJpZXMucHVzaChg7YyM7Yq4ICR7aSsxfTog7JqU7JW9IOyLpO2MqGApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIOu2gOu2hCDsmpTslb3rk6TsnYQg7KGw7ZWp7ZWY7JesIOy1nOyihSDsmpTslb0g7IOd7ISxXHJcbiAgICBjb25zdCBmaW5hbFJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgbW9kZWw6IE1PREVMLFxyXG4gICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxyXG4gICAgICAgICAgY29udGVudDogJ+yXrOufrCDrjIDtmZQg7JqU7JW97J2EIO2VmOuCmOydmCDthrXtlanrkJwg7JqU7JW97Jy866GcIOunjOuTpOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5zrpbwgNeqwnCDsnbTrgrTroZwg7LaU7Lac7ZW07KO87IS47JqULiBKU09OIO2YleyLneycvOuhnCDsnZHri7XtlbTso7zshLjsmpQuJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogYOuLpOydjOydgCDquLQg64yA7ZmU66W8IOuCmOuIiCDrtoDrtoTrs4Qg7JqU7JW97J6F64uI64ukLiDsnbTrk6TsnYQg6rKw7ZWp7ZWY7JesIOyghOyytCDrjIDtmZTsnZgg7ZW17Ius7J2EIOuLtOydgCDthrXtlakg7JqU7JW97J2EIDXrrLjsnqUg7J2064K066GcIOyekeyEse2VmOqzoCwg6rCA7J6lIOykkeyalO2VnCDtgqTsm4zrk5wgNeqwnOulvCDstpTstpztlbTso7zshLjsmpQuIEpTT04g7ZiV7Iud7Jy866GcIOydkeuLte2VtOyVvCDtlanri4jri6QuIHtcInN1bW1hcnlcIjogXCLsmpTslb0g64K07JqpLi4uXCIsIFwia2V5d29yZHNcIjogW1wi7YKk7JuM65OcMVwiLCBcIu2CpOybjOuTnDJcIiwgLi4uXX0g7ZiV7Iud7Jy866GcIOydkeuLte2VmOyEuOyalDpcXG5cXG4ke3BhcnRTdW1tYXJpZXMuam9pbignXFxuXFxuJyl9YFxyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgdGVtcGVyYXR1cmU6IDAuNSxcclxuICAgICAgbWF4X3Rva2VuczogNDAwLFxyXG4gICAgICByZXNwb25zZV9mb3JtYXQ6IHsgdHlwZTogXCJqc29uX29iamVjdFwiIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnO1xyXG4gICAgICBjb25zb2xlLmxvZygn7LWc7KKFIEFQSSDsnZHri7Ug64K07JqpOicsIGNvbnRlbnQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFyc2VkQ29udGVudCA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogcGFyc2VkQ29udGVudC5zdW1tYXJ5IHx8ICfsmpTslb3snYQg7IOd7ISx7ZWgIOyImCDsl4bsirXri4jri6QuJyxcclxuICAgICAgICBrZXl3b3JkczogQXJyYXkuaXNBcnJheShwYXJzZWRDb250ZW50LmtleXdvcmRzKSA/IHBhcnNlZENvbnRlbnQua2V5d29yZHMgOiBhbGxLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyihSDsmpTslb0gSlNPTiDtjIzsi7Eg7Jik66WYOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICBjb25zb2xlLmxvZygn7YyM7IuxIOyLpO2MqO2VnCDrgrTsmqk6JywgZmluYWxSZXNwb25zZS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50KTtcclxuICAgICAgXHJcbiAgICAgIC8vIO2CpOybjOuTnCDspJHrs7Ug7KCc6rGwIOuwjyDstZzrjIAgNeqwnOuhnCDsoJztlZxcclxuICAgICAgY29uc3QgdW5pcXVlS2V5d29yZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoYWxsS2V5d29yZHMpKS5zbGljZSgwLCA1KTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICAgIGtleXdvcmRzOiB1bmlxdWVLZXl3b3JkcyxcclxuICAgICAgICBtb2RlbFVzZWQ6IE1PREVMXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcign6ri0IOuMgO2ZlCDsmpTslb0g7KSRIOyYpOulmCDrsJzsg506JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogJ+yalOyVveydhCDsg53shLHtlaAg7IiYIOyXhuyKteuLiOuLpC4nLFxyXG4gICAgICBrZXl3b3JkczogW10sXHJcbiAgICAgIG1vZGVsVXNlZDogTU9ERUxcclxuICAgIH07XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJPcGVuQUkiLCJvcGVuYWkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJNT0RFTCIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsInRpdGxlIiwibWVzc2FnZXMiLCJjb252ZXJzYXRpb25UZXh0IiwibWFwIiwibXNnIiwicm9sZSIsImNvbnRlbnQiLCJqb2luIiwicmVzcG9uc2UiLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInJlc3BvbnNlX2Zvcm1hdCIsInR5cGUiLCJjaG9pY2VzIiwibWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZWRDb250ZW50IiwiSlNPTiIsInBhcnNlIiwic3VtbWFyeSIsImtleXdvcmRzIiwiQXJyYXkiLCJpc0FycmF5IiwibW9kZWxVc2VkIiwicGFyc2VFcnJvciIsImVycm9yIiwic3VtbWFyaXplTG9uZ0NvbnZlcnNhdGlvbiIsIm1lc3NhZ2VQYXJ0cyIsInBhcnRTaXplIiwiaSIsImxlbmd0aCIsInB1c2giLCJzbGljZSIsInBhcnRTdW1tYXJpZXMiLCJhbGxLZXl3b3JkcyIsInJlc3VsdCIsImZpbmFsUmVzcG9uc2UiLCJ1bmlxdWVLZXl3b3JkcyIsImZyb20iLCJTZXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/utils/openai.ts\n");

/***/ }),

/***/ "(rsc)/./src/types.ts":
/*!**********************!*\
  !*** ./src/types.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatSource: () => (/* binding */ ChatSource)\n/* harmony export */ });\n// import { SummaryResult } from '@/lib/utils/openai';\nvar ChatSource;\n(function(ChatSource) {\n    ChatSource[\"CHATGPT\"] = \"chatgpt\";\n    ChatSource[\"USER_INPUT\"] = \"user_input\";\n    ChatSource[\"API\"] = \"api\";\n})(ChatSource || (ChatSource = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdHlwZXMudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHNEQUFzRDs7VUFFMUNBOzs7O0dBQUFBLGVBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvdHlwZXMudHM/MjY5YyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBTdW1tYXJ5UmVzdWx0IH0gZnJvbSAnQC9saWIvdXRpbHMvb3BlbmFpJztcclxuXHJcbmV4cG9ydCBlbnVtIENoYXRTb3VyY2Uge1xyXG4gIENIQVRHUFQgPSAnY2hhdGdwdCcsXHJcbiAgVVNFUl9JTlBVVCA9ICd1c2VyX2lucHV0JyxcclxuICBBUEkgPSAnYXBpJyxcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0TWVzc2FnZSB7XHJcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbiAgbmFtZT86IHN0cmluZztcclxuICBmdW5jdGlvbl9jYWxsPzogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbnZlcnNhdGlvbiB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXTtcclxuICBjcmVhdGVkQXQ6IERhdGUgfCBzdHJpbmc7XHJcbiAgc291cmNlOiBDaGF0U291cmNlO1xyXG4gIHRhZ3M/OiBzdHJpbmdbXTtcclxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29udmVyc2F0aW9uU3VtbWFyeSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0aXRsZTogc3RyaW5nO1xyXG4gIHN1bW1hcnk6IHN0cmluZztcclxuICBjcmVhdGVkQXQ6IHN0cmluZztcclxuICBzb3VyY2U6IENoYXRTb3VyY2U7XHJcbiAgdGFncz86IHN0cmluZ1tdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzIHtcclxuICBvYnNpZGlhblZhdWx0UGF0aDogc3RyaW5nO1xyXG4gIG9wZW5haUFwaUtleTogc3RyaW5nO1xyXG4gIGRlZmF1bHRUYWdzOiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBcGlSZXNwb25zZTxUID0gYW55PiB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBkYXRhPzogVDtcclxuICBlcnJvcj86IHN0cmluZztcclxuICBtZXNzYWdlPzogc3RyaW5nO1xyXG4gIGR1cGxpY2F0ZT86IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU3VtbWFyeVJlc3VsdCB7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG4gIGtleXdvcmRzOiBzdHJpbmdbXTtcclxuICBtb2RlbFVzZWQ6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0Q2h1bmsge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgY2hhdF9zZXNzaW9uX2lkOiBzdHJpbmc7XHJcbiAgY2h1bmtfaW5kZXg6IG51bWJlcjtcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbiAgZW1iZWRkaW5nPzogbnVtYmVyW107XHJcbiAgc2ltaWxhcml0eT86IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDaGF0U2Vzc2lvbiB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHN1bW1hcnk/OiBzdHJpbmc7XHJcbiAgbWVzc2FnZXM/OiBDaGF0TWVzc2FnZVtdO1xyXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICBjcmVhdGVkX2F0Pzogc3RyaW5nO1xyXG4gIGVtYmVkZGluZz86IG51bWJlcltdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhZ1NvdXJjZSB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgdGl0bGU/OiBzdHJpbmc7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHNpbWlsYXJpdHk/OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmFnUmVzcG9uc2Uge1xyXG4gIGFuc3dlcjogc3RyaW5nO1xyXG4gIHNvdXJjZXM6IFJhZ1NvdXJjZVtdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNhdmVPcHRpb25zIHtcclxuICBzYXZlVG9TdXBhYmFzZT86IGJvb2xlYW47XHJcbiAgc2F2ZVRvT2JzaWRpYW4/OiBib29sZWFuO1xyXG4gIHNhdmVBc0pzb24/OiBib29sZWFuO1xyXG4gIHNraXBEdXBsaWNhdGVDaGVjaz86IGJvb2xlYW47XHJcbn0gIl0sIm5hbWVzIjpbIkNoYXRTb3VyY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/types.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/automation.ts":
/*!*********************************!*\
  !*** ./src/utils/automation.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   commitToGitHub: () => (/* binding */ commitToGitHub),\n/* harmony export */   saveToObsidian: () => (/* binding */ saveToObsidian)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _supabaseHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./supabaseHandler */ \"(rsc)/./src/utils/supabaseHandler.ts\");\n// 전역 MCP 타입 선언 추가\n\n\n\n\n// fs 함수를 Promise 기반으로 변환\nconst writeFileAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().writeFile));\nconst mkdirAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().mkdir));\nconst readFileAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().readFile));\nconst existsAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)((fs__WEBPACK_IMPORTED_MODULE_0___default().exists));\n// 기본 저장 경로 설정 (Obsidian Vault 경로)\nconst DEFAULT_VAULT_PATH = \"C:/Users/user/Documents/Obsidian Vault\";\nconst CHATGPT_FOLDER = \"ChatGPT\";\nconst CONVERSATIONS_FOLDER = \"conversations\";\n/**\r\n * MCP가 사용 가능한지 확인합니다.\r\n */ function isMcpAvailable(mcpFunction) {\n    return typeof global.mcp !== \"undefined\" && typeof global.mcp[mcpFunction] === \"function\";\n}\n/**\r\n * 디렉토리가 존재하는지 확인하고 없으면 생성합니다.\r\n */ async function ensureDirectoryExists(dirPath) {\n    try {\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(dirPath)) {\n            await mkdirAsync(dirPath, {\n                recursive: true\n            });\n        }\n    } catch (error) {\n        console.error(`디렉토리 생성 오류 (${dirPath}):`, error);\n        throw error;\n    }\n}\n/**\r\n * URL이 이미 저장된 JSON 파일이 있는지 확인합니다.\r\n */ async function checkJsonFileExists(url) {\n    try {\n        // conversations 폴더 경로\n        const projectConversationPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), CONVERSATIONS_FOLDER);\n        // 폴더가 없으면 false 반환\n        if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(projectConversationPath)) {\n            return false;\n        }\n        // URL 정규화 (쿼리 파라미터 등 제거)\n        const parsedUrl = new URL(url);\n        const normalizedUrl = parsedUrl.origin + parsedUrl.pathname;\n        const shareId = parsedUrl.pathname.split(\"/\").pop() || \"\";\n        // 모든 JSON 파일 목록 가져오기\n        const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(projectConversationPath).filter((file)=>file.endsWith(\".json\"));\n        // 각 파일을 확인하여 URL이 일치하는지 검사\n        for (const file of files){\n            const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(projectConversationPath, file);\n            const content = await readFileAsync(filePath, \"utf8\");\n            const data = JSON.parse(content);\n            if (data.url) {\n                // 완전히 일치하는 경우\n                if (data.url === url) {\n                    console.log(`완전히 일치하는 URL 발견: ${file}`);\n                    return true;\n                }\n                // 경로의 마지막 부분 (share ID) 비교\n                try {\n                    const existingParsedUrl = new URL(data.url);\n                    const existingShareId = existingParsedUrl.pathname.split(\"/\").pop() || \"\";\n                    if (shareId && existingShareId && shareId === existingShareId) {\n                        console.log(`공유 ID가 일치하는 URL 발견: ${file}`);\n                        return true;\n                    }\n                    // 정규화된 URL로 비교\n                    const existingNormalizedUrl = existingParsedUrl.origin + existingParsedUrl.pathname;\n                    if (normalizedUrl === existingNormalizedUrl) {\n                        console.log(`정규화된 URL이 일치하는 파일 발견: ${file}`);\n                        return true;\n                    }\n                } catch (parseError) {\n                    // URL 파싱 오류, 계속 진행\n                    console.error(\"기존 URL 파싱 오류:\", parseError);\n                }\n            }\n        }\n        return false;\n    } catch (error) {\n        console.error(\"JSON 파일 중복 확인 중 오류:\", error);\n        // 오류 발생 시 안전하게 중복이 아닌 것으로 처리\n        return false;\n    }\n}\n/**\r\n * 로컬 파일 시스템에 대화를 저장합니다.\r\n */ async function saveToFileSystem(fileName, markdownContent, rawText, conversation, summaryResult, url, skipJsonSave = false) {\n    try {\n        // Obsidian Vault 경로와 프로젝트 폴더 경로\n        const obsidianFolderPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(DEFAULT_VAULT_PATH, CHATGPT_FOLDER);\n        const projectConversationPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), CONVERSATIONS_FOLDER);\n        // 필요한 폴더 생성\n        await ensureDirectoryExists(obsidianFolderPath);\n        await ensureDirectoryExists(projectConversationPath);\n        // 마크다운 파일 저장 (Obsidian Vault에)\n        const markdownFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(obsidianFolderPath, fileName);\n        await writeFileAsync(markdownFilePath, markdownContent, \"utf8\");\n        console.log(`마크다운 파일 저장 완료: ${markdownFilePath}`);\n        // 원본 텍스트 저장 (Obsidian Vault에)\n        const textFileName = fileName.replace(\".md\", \"-original.txt\");\n        const textFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(obsidianFolderPath, textFileName);\n        await writeFileAsync(textFilePath, rawText, \"utf8\");\n        console.log(`원본 텍스트 파일 저장 완료: ${textFilePath}`);\n        // JSON 파일 저장 여부 확인 (중복 URL이면 저장하지 않음)\n        if (skipJsonSave) {\n            console.log(\"중복 URL이므로 JSON 파일 저장을 건너뜁니다.\");\n            return {\n                success: true,\n                files: {\n                    markdown: markdownFilePath,\n                    text: textFilePath\n                },\n                duplicate: true\n            };\n        }\n        // URL 중복 체크 (Supabase 및 로컬 JSON 파일)\n        const { exists: dbExists } = await (0,_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.checkUrlExists)(url);\n        const jsonExists = await checkJsonFileExists(url);\n        if (dbExists || jsonExists) {\n            console.log(\"이미 저장된 URL이므로 JSON 파일 저장을 건너뜁니다.\");\n            return {\n                success: true,\n                files: {\n                    markdown: markdownFilePath,\n                    text: textFilePath\n                },\n                duplicate: true\n            };\n        }\n        // JSON 형식으로 대화 저장 (PMKProject/conversations에)\n        const jsonFileName = `${conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\")}-${Date.now()}.json`;\n        const jsonFilePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(projectConversationPath, jsonFileName);\n        // 메타데이터에 model 필드 추가 또는 수정\n        const metadataWithModel = {\n            ...conversation.metadata || {},\n            model: conversation.metadata?.model || \"gpt-4.1-nano\",\n            savedAt: new Date().toISOString()\n        };\n        await writeFileAsync(jsonFilePath, JSON.stringify({\n            title: conversation.title,\n            url,\n            summary: summaryResult.summary,\n            keywords: summaryResult.keywords,\n            messages: conversation.messages,\n            metadata: metadataWithModel,\n            createdAt: new Date().toISOString()\n        }, null, 2), \"utf8\");\n        console.log(`JSON 파일 저장 완료: ${jsonFilePath}`);\n        return {\n            success: true,\n            files: {\n                markdown: markdownFilePath,\n                text: textFilePath,\n                json: jsonFilePath\n            }\n        };\n    } catch (error) {\n        console.error(\"파일 시스템 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * Obsidian Vault에 마크다운 노트를 생성합니다.\r\n */ async function saveToObsidian(conversation, summaryResult, rawText, url, skipDuplicateCheck = false) {\n    try {\n        // URL 중복 체크 (skipDuplicateCheck가 false일 때만)\n        if (!skipDuplicateCheck && url) {\n            // Supabase에서 중복 체크\n            const { exists, session } = await (0,_supabaseHandler__WEBPACK_IMPORTED_MODULE_3__.checkUrlExists)(url);\n            // 로컬 JSON 파일에서 중복 체크\n            const jsonExists = await checkJsonFileExists(url);\n            if (exists || jsonExists) {\n                console.log(`URL이 이미 존재합니다: ${url}`);\n                return {\n                    success: true,\n                    fileName: `${conversation.title.substring(0, 30)}.md (중복)`,\n                    duplicate: true,\n                    message: \"이미 저장된 대화입니다.\"\n                };\n            }\n        }\n        // 파일명 생성 (제목을 파일명으로 변환)\n        const fileName = conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100) + \".md\";\n        // 태그 목록 준비 (요약에서 추출한 키워드 + ChatGPT 모델)\n        const tags = [\n            ...summaryResult.keywords || [],\n            \"gpt-4.1-nano\"\n        ].filter(Boolean); // 빈 값 제거\n        // YAML 프론트매터 생성\n        const frontmatter = `---\r\ntitle: ${conversation.title}\r\ndate: ${new Date().toISOString()}\r\nsource: ${url}\r\ntags: [${tags.map((tag)=>`\"${tag}\"`).join(\", \")}]\r\nmodel: gpt-4.1-nano\r\n---\r\n\r\n`;\n        // 대화 내용을 마크다운으로 변환\n        let markdownContent = frontmatter;\n        // 대화 내용 추가\n        markdownContent += `# ${conversation.title}\\n\\n`;\n        // URL과 날짜 정보 추가\n        markdownContent += `> [원본 URL](${url})\\n\\n`;\n        markdownContent += `> 저장 시간: ${new Date().toLocaleString(\"ko-KR\")}\\n\\n`;\n        if (tags.length > 0) {\n            markdownContent += `> 태그: ${tags.join(\", \")}\\n\\n`;\n        }\n        markdownContent += `---\\n\\n`;\n        // 사용자-어시스턴트 대화 내용을 마크다운으로 포맷팅\n        conversation.messages.forEach((message, index)=>{\n            const isUser = message.role === \"user\";\n            const messageHeader = isUser ? \"## \\uD83D\\uDC64 사용자\" : \"## \\uD83E\\uDD16 assistant\";\n            // 역할과 내용을 구분하여 표시\n            markdownContent += `${messageHeader}\\n\\n${message.content}\\n\\n`;\n            // 마지막 메시지가 아니면 구분선 추가\n            if (index < conversation.messages.length - 1) {\n                markdownContent += `---\\n\\n`;\n            }\n        });\n        // 요약 섹션 추가\n        markdownContent += `\\n\\n---\\n\\n## 💡 요약\\n\\n${summaryResult.summary}\\n`;\n        // 키워드 섹션 추가\n        if (summaryResult.keywords && summaryResult.keywords.length > 0) {\n            markdownContent += `\\n## 🔑 키워드\\n\\n${summaryResult.keywords.map((k)=>`\\`${k}\\``).join(\" \")}\\n`;\n        }\n        // MCP 사용이 가능한지 확인\n        if (isMcpAvailable(\"obsidian-mcp_create-note\")) {\n            try {\n                // Obsidian MCP로 파일 저장\n                await new Promise((resolve, reject)=>{\n                    try {\n                        // @ts-ignore - MCP 타입 정의 없음\n                        global.mcp[\"obsidian-mcp_create-note\"]({\n                            vault: \"obsidian-vault\",\n                            folder: \"ChatGPT\",\n                            filename: fileName,\n                            content: markdownContent\n                        }, (result)=>{\n                            if (result.error) {\n                                reject(new Error(`Obsidian 저장 실패: ${result.error}`));\n                            } else {\n                                resolve(result);\n                            }\n                        });\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n                // 원본 텍스트 내용 저장\n                const textFileName = fileName.replace(\".md\", \"-original.txt\");\n                await new Promise((resolve, reject)=>{\n                    try {\n                        // @ts-ignore - MCP 타입 정의 없음\n                        global.mcp[\"obsidian-mcp_create-note\"]({\n                            vault: \"obsidian-vault\",\n                            folder: \"ChatGPT\",\n                            filename: textFileName,\n                            content: rawText\n                        }, (result)=>{\n                            if (result.error) {\n                                reject(new Error(`Obsidian 원본 텍스트 저장 실패: ${result.error}`));\n                            } else {\n                                resolve(result);\n                            }\n                        });\n                    } catch (error) {\n                        reject(error);\n                    }\n                });\n                return {\n                    success: true,\n                    fileName,\n                    method: \"mcp\"\n                };\n            } catch (mcpError) {\n                console.error(\"MCP 저장 실패, 파일 시스템으로 대체합니다:\", mcpError);\n            // MCP 실패 시 아래의 파일 시스템 방식으로 진행\n            }\n        }\n        // MCP가 없거나 실패한 경우, 파일 시스템 사용하여 저장\n        console.log(\"MCP를 사용할 수 없습니다. 파일 시스템을 사용하여 저장합니다.\");\n        // 파일 시스템에 저장 (URL 중복 여부 전달)\n        const fileSystemResult = await saveToFileSystem(fileName, markdownContent, rawText, conversation, summaryResult, url, skipDuplicateCheck // 중복 URL이면 JSON 저장 건너뛰기\n        );\n        return {\n            success: true,\n            fileName,\n            method: \"filesystem\",\n            files: fileSystemResult.files,\n            duplicate: fileSystemResult.duplicate\n        };\n    } catch (error) {\n        console.error(\"Obsidian 저장 중 오류:\", error);\n        // 오류가 발생해도 RAG 시스템 진행에는 영향을 주지 않도록 성공 상태 반환\n        return {\n            success: true,\n            fileName: `${conversation.title.substring(0, 30)}.md (저장 실패)`,\n            error: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n/**\r\n * GitHub 저장소에 변경사항을 커밋하고 푸시합니다.\r\n */ async function commitToGitHub(message = \"Update ChatGPT conversations\") {\n    try {\n        // MCP 사용이 가능한지 확인\n        if (isMcpAvailable(\"mcp_github_push_files\")) {\n            // GitHub 저장소의 변경사항 확인\n            const result = await new Promise((resolve, reject)=>{\n                try {\n                    // @ts-ignore - MCP 타입 정의 없음\n                    global.mcp[\"mcp_github_push_files\"]({\n                        repo: \"PKMProjet\",\n                        branch: \"main\",\n                        message,\n                        files: [\n                            {\n                                path: \"ChatGPT\",\n                                recursive: true // 하위 파일 포함\n                            }\n                        ]\n                    }, (result)=>{\n                        if (result.error) {\n                            reject(new Error(`GitHub 커밋 실패: ${result.error}`));\n                        } else {\n                            resolve(result);\n                        }\n                    });\n                } catch (error) {\n                    reject(error);\n                }\n            });\n            return {\n                success: true,\n                result,\n                method: \"mcp\"\n            };\n        } else {\n            // MCP를 사용할 수 없는 경우 로그만 남기고 성공으로 처리\n            console.log(\"GitHub MCP를 사용할 수 없습니다. 커밋 작업은 건너뜁니다.\");\n            return {\n                success: true,\n                method: \"skipped\",\n                message: \"GitHub 커밋 기능은 MCP 환경에서만 사용 가능합니다.\"\n            };\n        }\n    } catch (error) {\n        console.error(\"GitHub 커밋 중 오류:\", error);\n        // 오류가 발생해도 RAG 시스템 진행에는 영향을 주지 않도록 성공 상태 반환\n        return {\n            success: true,\n            method: \"failed\",\n            error: error instanceof Error ? error.message : \"알 수 없는 오류\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTQztnQkFDekMsSUFBSTtvQkFDRiw0QkFBNEI7b0JBQzVCNUYsT0FBT0MsR0FBRyxDQUFDLHdCQUF3QixDQUFDO3dCQUNsQ3FHLE1BQU07d0JBQ05DLFFBQVE7d0JBQ1IzQjt3QkFDQXRELE9BQU87NEJBQ0w7Z0NBQ0V0QyxNQUFNO2dDQUNOcUIsV0FBVyxLQUFXLFdBQVc7NEJBQ25DO3lCQUNEO29CQUNILEdBQUcsQ0FBQzJGO3dCQUNGLElBQUlBLE9BQU8xRixLQUFLLEVBQUU7NEJBQ2hCc0YsT0FBTyxJQUFJSyxNQUFNLENBQUMsY0FBYyxFQUFFRCxPQUFPMUYsS0FBSyxDQUFDLENBQUM7d0JBQ2xELE9BQU87NEJBQ0xxRixRQUFRSzt3QkFDVjtvQkFDRjtnQkFDRixFQUFFLE9BQU8xRixPQUFPO29CQUNkc0YsT0FBT3RGO2dCQUNUO1lBQ0Y7WUFFQSxPQUFPO2dCQUFFMkMsU0FBUztnQkFBTStDO2dCQUFRRSxRQUFRO1lBQU07UUFDaEQsT0FBTztZQUNMLG1DQUFtQztZQUNuQzNGLFFBQVF5QixHQUFHLENBQUM7WUFDWixPQUFPO2dCQUNMaUIsU0FBUztnQkFDVGlELFFBQVE7Z0JBQ1J0QixTQUFTO1lBQ1g7UUFDRjtJQUNGLEVBQUUsT0FBT3RFLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsNENBQTRDO1FBQzVDLE9BQU87WUFDTDJDLFNBQVM7WUFDVGlELFFBQVE7WUFDUjVGLE9BQU9BLGlCQUFpQjJGLFFBQVEzRixNQUFNc0UsT0FBTyxHQUFHO1FBQ2xEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL3V0aWxzL2F1dG9tYXRpb24udHM/ZjE5YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDsoITsl60gTUNQIO2DgOyehSDshKDslrgg7LaU6rCAXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgIG1jcDogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZDtcclxuICB9XHJcbiAgdmFyIG1jcDogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZDtcclxufVxyXG5cclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuaW1wb3J0IHsgU3VtbWFyeVJlc3VsdCB9IGZyb20gJ0AvbGliL3V0aWxzL29wZW5haSc7XHJcbmltcG9ydCBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IHsgY2hlY2tVcmxFeGlzdHMgfSBmcm9tICcuL3N1cGFiYXNlSGFuZGxlcic7XHJcblxyXG4vLyBmcyDtlajsiJjrpbwgUHJvbWlzZSDquLDrsJjsnLzroZwg67OA7ZmYXHJcbmNvbnN0IHdyaXRlRmlsZUFzeW5jID0gcHJvbWlzaWZ5KGZzLndyaXRlRmlsZSk7XHJcbmNvbnN0IG1rZGlyQXN5bmMgPSBwcm9taXNpZnkoZnMubWtkaXIpO1xyXG5jb25zdCByZWFkRmlsZUFzeW5jID0gcHJvbWlzaWZ5KGZzLnJlYWRGaWxlKTtcclxuY29uc3QgZXhpc3RzQXN5bmMgPSBwcm9taXNpZnkoZnMuZXhpc3RzKTtcclxuXHJcbi8vIOq4sOuzuCDsoIDsnqUg6rK966GcIOyEpOyglSAoT2JzaWRpYW4gVmF1bHQg6rK966GcKVxyXG5jb25zdCBERUZBVUxUX1ZBVUxUX1BBVEggPSBcIkM6L1VzZXJzL3VzZXIvRG9jdW1lbnRzL09ic2lkaWFuIFZhdWx0XCI7XHJcbmNvbnN0IENIQVRHUFRfRk9MREVSID0gJ0NoYXRHUFQnO1xyXG5jb25zdCBDT05WRVJTQVRJT05TX0ZPTERFUiA9ICdjb252ZXJzYXRpb25zJztcclxuXHJcbi8qKlxyXG4gKiBNQ1DqsIAg7IKs7JqpIOqwgOuKpe2VnOyngCDtmZXsnbjtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc01jcEF2YWlsYWJsZShtY3BGdW5jdGlvbjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHR5cGVvZiBnbG9iYWwubWNwICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZ2xvYmFsLm1jcFttY3BGdW5jdGlvbl0gPT09ICdmdW5jdGlvbic7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrlJTroInthqDrpqzqsIAg7KG07J6s7ZWY64qU7KeAIO2ZleyduO2VmOqzoCDsl4bsnLzrqbQg7IOd7ISx7ZWp64uI64ukLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGlyZWN0b3J5RXhpc3RzKGRpclBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyUGF0aCkpIHtcclxuICAgICAgYXdhaXQgbWtkaXJBc3luYyhkaXJQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihg65SU66CJ7Yag66asIOyDneyEsSDsmKTrpZggKCR7ZGlyUGF0aH0pOmAsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVSTOydtCDsnbTrr7gg7KCA7J6l65CcIEpTT04g7YyM7J287J20IOyeiOuKlOyngCDtmZXsnbjtlanri4jri6QuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBjaGVja0pzb25GaWxlRXhpc3RzKHVybDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIGNvbnZlcnNhdGlvbnMg7Y+0642UIOqyveuhnFxyXG4gICAgY29uc3QgcHJvamVjdENvbnZlcnNhdGlvblBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgQ09OVkVSU0FUSU9OU19GT0xERVIpO1xyXG4gICAgXHJcbiAgICAvLyDtj7TrjZTqsIAg7JeG7Jy866m0IGZhbHNlIOuwmO2ZmFxyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHByb2plY3RDb252ZXJzYXRpb25QYXRoKSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFVSTCDsoJXqt5ztmZQgKOy/vOumrCDtjIzrnbzrr7jthLAg65OxIOygnOqxsClcclxuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBwYXJzZWRVcmwub3JpZ2luICsgcGFyc2VkVXJsLnBhdGhuYW1lO1xyXG4gICAgY29uc3Qgc2hhcmVJZCA9IHBhcnNlZFVybC5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpIHx8ICcnO1xyXG4gICAgXHJcbiAgICAvLyDrqqjrk6AgSlNPTiDtjIzsnbwg66qp66GdIOqwgOyguOyYpOq4sFxyXG4gICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhwcm9qZWN0Q29udmVyc2F0aW9uUGF0aCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5lbmRzV2l0aCgnLmpzb24nKSk7XHJcbiAgICBcclxuICAgIC8vIOqwgSDtjIzsnbzsnYQg7ZmV7J247ZWY7JesIFVSTOydtCDsnbzsuZjtlZjripTsp4Ag6rKA7IKsXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4ocHJvamVjdENvbnZlcnNhdGlvblBhdGgsIGZpbGUpO1xyXG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVhZEZpbGVBc3luYyhmaWxlUGF0aCwgJ3V0ZjgnKTtcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZGF0YS51cmwpIHtcclxuICAgICAgICAvLyDsmYTsoITtnogg7J287LmY7ZWY64qUIOqyveyasFxyXG4gICAgICAgIGlmIChkYXRhLnVybCA9PT0gdXJsKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg7JmE7KCE7Z6IIOydvOy5mO2VmOuKlCBVUkwg67Cc6rKsOiAke2ZpbGV9YCk7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g6rK966Gc7J2YIOuniOyngOuniSDrtoDrtoQgKHNoYXJlIElEKSDruYTqtZBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgZXhpc3RpbmdQYXJzZWRVcmwgPSBuZXcgVVJMKGRhdGEudXJsKTtcclxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nU2hhcmVJZCA9IGV4aXN0aW5nUGFyc2VkVXJsLnBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCkgfHwgJyc7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmIChzaGFyZUlkICYmIGV4aXN0aW5nU2hhcmVJZCAmJiBzaGFyZUlkID09PSBleGlzdGluZ1NoYXJlSWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOqzteycoCBJROqwgCDsnbzsuZjtlZjripQgVVJMIOuwnOqyrDogJHtmaWxlfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8g7KCV6rec7ZmU65CcIFVSTOuhnCDruYTqtZBcclxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTm9ybWFsaXplZFVybCA9IGV4aXN0aW5nUGFyc2VkVXJsLm9yaWdpbiArIGV4aXN0aW5nUGFyc2VkVXJsLnBhdGhuYW1lO1xyXG4gICAgICAgICAgaWYgKG5vcm1hbGl6ZWRVcmwgPT09IGV4aXN0aW5nTm9ybWFsaXplZFVybCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg7KCV6rec7ZmU65CcIFVSTOydtCDsnbzsuZjtlZjripQg7YyM7J28IOuwnOqyrDogJHtmaWxlfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XHJcbiAgICAgICAgICAvLyBVUkwg7YyM7IuxIOyYpOulmCwg6rOE7IaNIOynhO2WiVxyXG4gICAgICAgICAgY29uc29sZS5lcnJvcign6riw7KG0IFVSTCDtjIzsi7Eg7Jik66WYOicsIHBhcnNlRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7J28IOykkeuztSDtmZXsnbgg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICAvLyDsmKTrpZgg67Cc7IOdIOyLnCDslYjsoITtlZjqsowg7KSR67O17J20IOyVhOuLjCDqsoPsnLzroZwg7LKY66asXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog66Gc7LusIO2MjOydvCDsi5zsiqTthZzsl5Ag64yA7ZmU66W8IOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNhdmVUb0ZpbGVTeXN0ZW0oXHJcbiAgZmlsZU5hbWU6IHN0cmluZyxcclxuICBtYXJrZG93bkNvbnRlbnQ6IHN0cmluZyxcclxuICByYXdUZXh0OiBzdHJpbmcsXHJcbiAgY29udmVyc2F0aW9uOiB7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5UmVzdWx0LFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIHNraXBKc29uU2F2ZTogYm9vbGVhbiA9IGZhbHNlXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBPYnNpZGlhbiBWYXVsdCDqsr3roZzsmYAg7ZSE66Gc7KCd7Yq4IO2PtOuNlCDqsr3roZxcclxuICAgIGNvbnN0IG9ic2lkaWFuRm9sZGVyUGF0aCA9IHBhdGguam9pbihERUZBVUxUX1ZBVUxUX1BBVEgsIENIQVRHUFRfRk9MREVSKTtcclxuICAgIGNvbnN0IHByb2plY3RDb252ZXJzYXRpb25QYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIENPTlZFUlNBVElPTlNfRk9MREVSKTtcclxuICAgIFxyXG4gICAgLy8g7ZWE7JqU7ZWcIO2PtOuNlCDsg53shLFcclxuICAgIGF3YWl0IGVuc3VyZURpcmVjdG9yeUV4aXN0cyhvYnNpZGlhbkZvbGRlclBhdGgpO1xyXG4gICAgYXdhaXQgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKHByb2plY3RDb252ZXJzYXRpb25QYXRoKTtcclxuICAgIFxyXG4gICAgLy8g66eI7YGs64uk7Jq0IO2MjOydvCDsoIDsnqUgKE9ic2lkaWFuIFZhdWx07JeQKVxyXG4gICAgY29uc3QgbWFya2Rvd25GaWxlUGF0aCA9IHBhdGguam9pbihvYnNpZGlhbkZvbGRlclBhdGgsIGZpbGVOYW1lKTtcclxuICAgIGF3YWl0IHdyaXRlRmlsZUFzeW5jKG1hcmtkb3duRmlsZVBhdGgsIG1hcmtkb3duQ29udGVudCwgJ3V0ZjgnKTtcclxuICAgIGNvbnNvbGUubG9nKGDrp4jtgazri6TsmrQg7YyM7J28IOyggOyepSDsmYTro4w6ICR7bWFya2Rvd25GaWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgLy8g7JuQ67O4IO2FjeyKpO2KuCDsoIDsnqUgKE9ic2lkaWFuIFZhdWx07JeQKVxyXG4gICAgY29uc3QgdGV4dEZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgnLm1kJywgJy1vcmlnaW5hbC50eHQnKTtcclxuICAgIGNvbnN0IHRleHRGaWxlUGF0aCA9IHBhdGguam9pbihvYnNpZGlhbkZvbGRlclBhdGgsIHRleHRGaWxlTmFtZSk7XHJcbiAgICBhd2FpdCB3cml0ZUZpbGVBc3luYyh0ZXh0RmlsZVBhdGgsIHJhd1RleHQsICd1dGY4Jyk7XHJcbiAgICBjb25zb2xlLmxvZyhg7JuQ67O4IO2FjeyKpO2KuCDtjIzsnbwg7KCA7J6lIOyZhOujjDogJHt0ZXh0RmlsZVBhdGh9YCk7XHJcbiAgICBcclxuICAgIC8vIEpTT04g7YyM7J28IOyggOyepSDsl6zrtoAg7ZmV7J24ICjspJHrs7UgVVJM7J2066m0IOyggOyepe2VmOyngCDslYrsnYwpXHJcbiAgICBpZiAoc2tpcEpzb25TYXZlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfspJHrs7UgVVJM7J2066+A66GcIEpTT04g7YyM7J28IOyggOyepeydhCDqsbTrhIjrnIHri4jri6QuJyk7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICAgIGZpbGVzOiB7XHJcbiAgICAgICAgICBtYXJrZG93bjogbWFya2Rvd25GaWxlUGF0aCwgXHJcbiAgICAgICAgICB0ZXh0OiB0ZXh0RmlsZVBhdGhcclxuICAgICAgICB9LFxyXG4gICAgICAgIGR1cGxpY2F0ZTogdHJ1ZVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBVUkwg7KSR67O1IOyytO2BrCAoU3VwYWJhc2Ug67CPIOuhnOy7rCBKU09OIO2MjOydvClcclxuICAgIGNvbnN0IHsgZXhpc3RzOiBkYkV4aXN0cyB9ID0gYXdhaXQgY2hlY2tVcmxFeGlzdHModXJsKTtcclxuICAgIGNvbnN0IGpzb25FeGlzdHMgPSBhd2FpdCBjaGVja0pzb25GaWxlRXhpc3RzKHVybCk7XHJcbiAgICBcclxuICAgIGlmIChkYkV4aXN0cyB8fCBqc29uRXhpc3RzKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfsnbTrr7gg7KCA7J6l65CcIFVSTOydtOuvgOuhnCBKU09OIO2MjOydvCDsoIDsnqXsnYQg6rG064SI65yB64uI64ukLicpO1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgICBmaWxlczoge1xyXG4gICAgICAgICAgbWFya2Rvd246IG1hcmtkb3duRmlsZVBhdGgsIFxyXG4gICAgICAgICAgdGV4dDogdGV4dEZpbGVQYXRoXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkdXBsaWNhdGU6IHRydWVcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSlNPTiDtmJXsi53snLzroZwg64yA7ZmUIOyggOyepSAoUE1LUHJvamVjdC9jb252ZXJzYXRpb25z7JeQKVxyXG4gICAgY29uc3QganNvbkZpbGVOYW1lID0gYCR7Y29udmVyc2F0aW9uLnRpdGxlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTnqsIAt7Z6jXS9nLCAnLScpfS0ke0RhdGUubm93KCl9Lmpzb25gO1xyXG4gICAgY29uc3QganNvbkZpbGVQYXRoID0gcGF0aC5qb2luKHByb2plY3RDb252ZXJzYXRpb25QYXRoLCBqc29uRmlsZU5hbWUpO1xyXG4gICAgXHJcbiAgICAvLyDrqZTtg4DrjbDsnbTthLDsl5AgbW9kZWwg7ZWE65OcIOy2lOqwgCDrmJDripQg7IiY7KCVXHJcbiAgICBjb25zdCBtZXRhZGF0YVdpdGhNb2RlbCA9IHtcclxuICAgICAgLi4uKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSB8fCB7fSksXHJcbiAgICAgIG1vZGVsOiBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8ICdncHQtNC4xLW5hbm8nLFxyXG4gICAgICBzYXZlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIGF3YWl0IHdyaXRlRmlsZUFzeW5jKFxyXG4gICAgICBqc29uRmlsZVBhdGgsXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5UmVzdWx0LnN1bW1hcnksXHJcbiAgICAgICAgICBrZXl3b3Jkczogc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyxcclxuICAgICAgICAgIG1lc3NhZ2VzOiBjb252ZXJzYXRpb24ubWVzc2FnZXMsXHJcbiAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGFXaXRoTW9kZWwsXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbnVsbCxcclxuICAgICAgICAyXHJcbiAgICAgICksXHJcbiAgICAgICd1dGY4J1xyXG4gICAgKTtcclxuICAgIGNvbnNvbGUubG9nKGBKU09OIO2MjOydvCDsoIDsnqUg7JmE66OMOiAke2pzb25GaWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlczoge1xyXG4gICAgICAgIG1hcmtkb3duOiBtYXJrZG93bkZpbGVQYXRoLCBcclxuICAgICAgICB0ZXh0OiB0ZXh0RmlsZVBhdGgsIFxyXG4gICAgICAgIGpzb246IGpzb25GaWxlUGF0aFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCftjIzsnbwg7Iuc7Iqk7YWcIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE9ic2lkaWFuIFZhdWx07JeQIOuniO2BrOuLpOyatCDrhbjtirjrpbwg7IOd7ISx7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVUb09ic2lkaWFuKFxyXG4gIGNvbnZlcnNhdGlvbjoge1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gICAgaWQ/OiBzdHJpbmc7XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5UmVzdWx0LFxyXG4gIHJhd1RleHQ6IHN0cmluZyxcclxuICB1cmw6IHN0cmluZyxcclxuICBza2lwRHVwbGljYXRlQ2hlY2s6IGJvb2xlYW4gPSBmYWxzZVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgLy8gVVJMIOykkeuztSDssrTtgawgKHNraXBEdXBsaWNhdGVDaGVja+qwgCBmYWxzZeydvCDrlYzrp4wpXHJcbiAgICBpZiAoIXNraXBEdXBsaWNhdGVDaGVjayAmJiB1cmwpIHtcclxuICAgICAgLy8gU3VwYWJhc2Xsl5DshJwg7KSR67O1IOyytO2BrFxyXG4gICAgICBjb25zdCB7IGV4aXN0cywgc2Vzc2lvbiB9ID0gYXdhaXQgY2hlY2tVcmxFeGlzdHModXJsKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOuhnOy7rCBKU09OIO2MjOydvOyXkOyEnCDspJHrs7Ug7LK07YGsXHJcbiAgICAgIGNvbnN0IGpzb25FeGlzdHMgPSBhd2FpdCBjaGVja0pzb25GaWxlRXhpc3RzKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXhpc3RzIHx8IGpzb25FeGlzdHMpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVVJM7J20IOydtOuvuCDsobTsnqztlanri4jri6Q6ICR7dXJsfWApO1xyXG4gICAgICAgIHJldHVybiB7IFxyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgICAgICBmaWxlTmFtZTogYCR7Y29udmVyc2F0aW9uLnRpdGxlLnN1YnN0cmluZygwLCAzMCl9Lm1kICjspJHrs7UpYCxcclxuICAgICAgICAgIGR1cGxpY2F0ZTogdHJ1ZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICfsnbTrr7gg7KCA7J6l65CcIOuMgO2ZlOyeheuLiOuLpC4nXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDtjIzsnbzrqoUg7IOd7ISxICjsoJzrqqnsnYQg7YyM7J2866qF7Jy866GcIOuzgO2ZmClcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gY29udmVyc2F0aW9uLnRpdGxlXHJcbiAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgIC5yZXBsYWNlKC9bXmEtejAtOeqwgC3tnqNdL2csICctJylcclxuICAgICAgLnJlcGxhY2UoLy0rL2csICctJylcclxuICAgICAgLnJlcGxhY2UoL14tfC0kL2csICcnKVxyXG4gICAgICAuc3Vic3RyaW5nKDAsIDEwMCkgKyAnLm1kJztcclxuICAgIFxyXG4gICAgLy8g7YOc6re4IOuqqeuhnSDspIDruYQgKOyalOyVveyXkOyEnCDstpTstpztlZwg7YKk7JuM65OcICsgQ2hhdEdQVCDrqqjrjbgpXHJcbiAgICBjb25zdCB0YWdzID0gW1xyXG4gICAgICAuLi4oc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyB8fCBbXSksXHJcbiAgICAgICdncHQtNC4xLW5hbm8nXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKTsgLy8g67mIIOqwkiDsoJzqsbBcclxuICAgIFxyXG4gICAgLy8gWUFNTCDtlITroaDtirjrp6TthLAg7IOd7ISxXHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGAtLS1cclxudGl0bGU6ICR7Y29udmVyc2F0aW9uLnRpdGxlfVxyXG5kYXRlOiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cclxuc291cmNlOiAke3VybH1cclxudGFnczogWyR7dGFncy5tYXAodGFnID0+IGBcIiR7dGFnfVwiYCkuam9pbignLCAnKX1dXHJcbm1vZGVsOiBncHQtNC4xLW5hbm9cclxuLS0tXHJcblxyXG5gO1xyXG4gICAgXHJcbiAgICAvLyDrjIDtmZQg64K07Jqp7J2EIOuniO2BrOuLpOyatOycvOuhnCDrs4DtmZhcclxuICAgIGxldCBtYXJrZG93bkNvbnRlbnQgPSBmcm9udG1hdHRlcjtcclxuICAgIFxyXG4gICAgLy8g64yA7ZmUIOuCtOyaqSDstpTqsIBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgIyAke2NvbnZlcnNhdGlvbi50aXRsZX1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICAvLyBVUkzqs7wg64Kg7KecIOygleuztCDstpTqsIBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgPiBb7JuQ67O4IFVSTF0oJHt1cmx9KVxcblxcbmA7XHJcbiAgICBtYXJrZG93bkNvbnRlbnQgKz0gYD4g7KCA7J6lIOyLnOqwhDogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdrby1LUicpfVxcblxcbmA7XHJcbiAgICBcclxuICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGA+IO2DnOq3uDogJHt0YWdzLmpvaW4oJywgJyl9XFxuXFxuYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICAvLyDsgqzsmqnsnpAt7Ja07Iuc7Iqk7YS07Yq4IOuMgO2ZlCDrgrTsmqnsnYQg66eI7YGs64uk7Jq07Jy866GcIO2PrOunt+2MhVxyXG4gICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XHJcbiAgICAgIGNvbnN0IGlzVXNlciA9IG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInO1xyXG4gICAgICBjb25zdCBtZXNzYWdlSGVhZGVyID0gaXNVc2VyID8gJyMjIPCfkaQg7IKs7Jqp7J6QJyA6ICcjIyDwn6SWIGFzc2lzdGFudCc7XHJcbiAgICAgIFxyXG4gICAgICAvLyDsl63tlaDqs7wg64K07Jqp7J2EIOq1rOu2hO2VmOyXrCDtkZzsi5xcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGAke21lc3NhZ2VIZWFkZXJ9XFxuXFxuJHttZXNzYWdlLmNvbnRlbnR9XFxuXFxuYDtcclxuICAgICAgXHJcbiAgICAgIC8vIOuniOyngOuniSDrqZTsi5zsp4DqsIAg7JWE64uI66m0IOq1rOu2hOyEoCDstpTqsIBcclxuICAgICAgaWYgKGluZGV4IDwgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICBtYXJrZG93bkNvbnRlbnQgKz0gYC0tLVxcblxcbmA7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyDsmpTslb0g7IS57IWYIOy2lOqwgFxyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGBcXG5cXG4tLS1cXG5cXG4jIyDwn5KhIOyalOyVvVxcblxcbiR7c3VtbWFyeVJlc3VsdC5zdW1tYXJ5fVxcbmA7XHJcbiAgICBcclxuICAgIC8vIO2CpOybjOuTnCDshLnshZgg7LaU6rCAXHJcbiAgICBpZiAoc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyAmJiBzdW1tYXJ5UmVzdWx0LmtleXdvcmRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbWFya2Rvd25Db250ZW50ICs9IGBcXG4jIyDwn5SRIO2CpOybjOuTnFxcblxcbiR7c3VtbWFyeVJlc3VsdC5rZXl3b3Jkcy5tYXAoayA9PiBgXFxgJHtrfVxcYGApLmpvaW4oJyAnKX1cXG5gO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBNQ1Ag7IKs7Jqp7J20IOqwgOuKpe2VnOyngCDtmZXsnbhcclxuICAgIGlmIChpc01jcEF2YWlsYWJsZSgnb2JzaWRpYW4tbWNwX2NyZWF0ZS1ub3RlJykpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBPYnNpZGlhbiBNQ1DroZwg7YyM7J28IOyggOyepVxyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgLSBNQ1Ag7YOA7J6FIOygleydmCDsl4bsnYxcclxuICAgICAgICAgICAgZ2xvYmFsLm1jcFsnb2JzaWRpYW4tbWNwX2NyZWF0ZS1ub3RlJ10oe1xyXG4gICAgICAgICAgICAgIHZhdWx0OiAnb2JzaWRpYW4tdmF1bHQnLCAvLyDsmLXsi5zrlJTslrggVmF1bHQg7J2066aEXHJcbiAgICAgICAgICAgICAgZm9sZGVyOiAnQ2hhdEdQVCcsICAgICAgICAvLyDsoIDsnqUg7Y+0642UIOqyveuhnFxyXG4gICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlTmFtZSxcclxuICAgICAgICAgICAgICBjb250ZW50OiBtYXJrZG93bkNvbnRlbnRcclxuICAgICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgT2JzaWRpYW4g7KCA7J6lIOyLpO2MqDogJHtyZXN1bHQuZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g7JuQ67O4IO2FjeyKpO2KuCDrgrTsmqkg7KCA7J6lXHJcbiAgICAgICAgY29uc3QgdGV4dEZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZSgnLm1kJywgJy1vcmlnaW5hbC50eHQnKTtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIC0gTUNQIO2DgOyehSDsoJXsnZgg7JeG7J2MXHJcbiAgICAgICAgICAgIGdsb2JhbC5tY3BbJ29ic2lkaWFuLW1jcF9jcmVhdGUtbm90ZSddKHtcclxuICAgICAgICAgICAgICB2YXVsdDogJ29ic2lkaWFuLXZhdWx0JywgLy8g7Ji17Iuc65SU7Ja4IFZhdWx0IOydtOumhFxyXG4gICAgICAgICAgICAgIGZvbGRlcjogJ0NoYXRHUFQnLCAgICAgICAgLy8g7KCA7J6lIO2PtOuNlCDqsr3roZxcclxuICAgICAgICAgICAgICBmaWxlbmFtZTogdGV4dEZpbGVOYW1lLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IHJhd1RleHRcclxuICAgICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgT2JzaWRpYW4g7JuQ67O4IO2FjeyKpO2KuCDsoIDsnqUg7Iuk7YyoOiAke3Jlc3VsdC5lcnJvcn1gKSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBmaWxlTmFtZSwgbWV0aG9kOiAnbWNwJyB9O1xyXG4gICAgICB9IGNhdGNoIChtY3BFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ01DUCDsoIDsnqUg7Iuk7YyoLCDtjIzsnbwg7Iuc7Iqk7YWc7Jy866GcIOuMgOyytO2VqeuLiOuLpDonLCBtY3BFcnJvcik7XHJcbiAgICAgICAgLy8gTUNQIOyLpO2MqCDsi5wg7JWE656Y7J2YIO2MjOydvCDsi5zsiqTthZwg67Cp7Iud7Jy866GcIOynhO2WiVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIE1DUOqwgCDsl4bqsbDrgpgg7Iuk7Yyo7ZWcIOqyveyasCwg7YyM7J28IOyLnOyKpO2FnCDsgqzsmqntlZjsl6wg7KCA7J6lXHJcbiAgICBjb25zb2xlLmxvZygnTUNQ66W8IOyCrOyaqe2VoCDsiJgg7JeG7Iq164uI64ukLiDtjIzsnbwg7Iuc7Iqk7YWc7J2EIOyCrOyaqe2VmOyXrCDsoIDsnqXtlanri4jri6QuJyk7XHJcbiAgICBcclxuICAgIC8vIO2MjOydvCDsi5zsiqTthZzsl5Ag7KCA7J6lIChVUkwg7KSR67O1IOyXrOu2gCDsoITri6wpXHJcbiAgICBjb25zdCBmaWxlU3lzdGVtUmVzdWx0ID0gYXdhaXQgc2F2ZVRvRmlsZVN5c3RlbShcclxuICAgICAgZmlsZU5hbWUsXHJcbiAgICAgIG1hcmtkb3duQ29udGVudCxcclxuICAgICAgcmF3VGV4dCxcclxuICAgICAgY29udmVyc2F0aW9uLFxyXG4gICAgICBzdW1tYXJ5UmVzdWx0LFxyXG4gICAgICB1cmwsXHJcbiAgICAgIHNraXBEdXBsaWNhdGVDaGVjayAvLyDspJHrs7UgVVJM7J2066m0IEpTT04g7KCA7J6lIOqxtOuEiOubsOq4sFxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlTmFtZSwgXHJcbiAgICAgIG1ldGhvZDogJ2ZpbGVzeXN0ZW0nLFxyXG4gICAgICBmaWxlczogZmlsZVN5c3RlbVJlc3VsdC5maWxlcyxcclxuICAgICAgZHVwbGljYXRlOiBmaWxlU3lzdGVtUmVzdWx0LmR1cGxpY2F0ZVxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignT2JzaWRpYW4g7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgLy8g7Jik66WY6rCAIOuwnOyDne2VtOuPhCBSQUcg7Iuc7Iqk7YWcIOynhO2WieyXkOuKlCDsmIHtlqXsnYQg7KO87KeAIOyViuuPhOuhnSDshLHqs7Ug7IOB7YOcIOuwmO2ZmFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBmaWxlTmFtZTogYCR7Y29udmVyc2F0aW9uLnRpdGxlLnN1YnN0cmluZygwLCAzMCl9Lm1kICjsoIDsnqUg7Iuk7YyoKWAsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfslYwg7IiYIOyXhuuKlCDsmKTrpZgnXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdpdEh1YiDsoIDsnqXshozsl5Ag67OA6rK97IKs7ZWt7J2EIOy7pOuwi+2VmOqzoCDtkbjsi5ztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29tbWl0VG9HaXRIdWIobWVzc2FnZTogc3RyaW5nID0gJ1VwZGF0ZSBDaGF0R1BUIGNvbnZlcnNhdGlvbnMnKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIE1DUCDsgqzsmqnsnbQg6rCA64ql7ZWc7KeAIO2ZleyduFxyXG4gICAgaWYgKGlzTWNwQXZhaWxhYmxlKCdtY3BfZ2l0aHViX3B1c2hfZmlsZXMnKSkge1xyXG4gICAgICAvLyBHaXRIdWIg7KCA7J6l7IaM7J2YIOuzgOqyveyCrO2VrSDtmZXsnbhcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBAdHMtaWdub3JlIC0gTUNQIO2DgOyehSDsoJXsnZgg7JeG7J2MXHJcbiAgICAgICAgICBnbG9iYWwubWNwWydtY3BfZ2l0aHViX3B1c2hfZmlsZXMnXSh7XHJcbiAgICAgICAgICAgIHJlcG86ICdQS01Qcm9qZXQnLCAgICAgICAgLy8gR2l0SHViIOyggOyepeyGjCDsnbTrpoRcclxuICAgICAgICAgICAgYnJhbmNoOiAnbWFpbicsICAgICAgICAgICAvLyDruIzrnpzsuZgg7J2066aEXHJcbiAgICAgICAgICAgIG1lc3NhZ2UsICAgICAgICAgICAgICAgICAgLy8g7Luk67CLIOuplOyLnOyngFxyXG4gICAgICAgICAgICBmaWxlczogWyAgICAgICAgICAgICAgICAgIC8vIO2RuOyLnO2VoCDtjIzsnbwg66qp66GdIChPYnNpZGlhbiBWYXVsdOydmCBDaGF0R1BUIO2PtOuNlCDrgrQg67OA6rK97IKs7ZWtKVxyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBhdGg6ICdDaGF0R1BUJywgICAgICAvLyDqsr3roZxcclxuICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZTogdHJ1ZSAgICAgICAvLyDtlZjsnIQg7YyM7J28IO2PrO2VqFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfSwgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcclxuICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBHaXRIdWIg7Luk67CLIOyLpO2MqDogJHtyZXN1bHQuZXJyb3J9YCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHJlc3VsdCwgbWV0aG9kOiAnbWNwJyB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gTUNQ66W8IOyCrOyaqe2VoCDsiJgg7JeG64qUIOqyveyasCDroZzqt7jrp4wg64Ko6riw6rOgIOyEseqzteycvOuhnCDsspjrpqxcclxuICAgICAgY29uc29sZS5sb2coJ0dpdEh1YiBNQ1Drpbwg7IKs7Jqp7ZWgIOyImCDsl4bsirXri4jri6QuIOy7pOuwiyDsnpHsl4XsnYAg6rG064SI65yB64uI64ukLicpO1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgICBtZXRob2Q6ICdza2lwcGVkJywgXHJcbiAgICAgICAgbWVzc2FnZTogJ0dpdEh1YiDsu6TrsIsg6riw64ql7J2AIE1DUCDtmZjqsr3sl5DshJzrp4wg7IKs7JqpIOqwgOuKpe2VqeuLiOuLpC4nIFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdHaXRIdWIg7Luk67CLIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgLy8g7Jik66WY6rCAIOuwnOyDne2VtOuPhCBSQUcg7Iuc7Iqk7YWcIOynhO2WieyXkOuKlCDsmIHtlqXsnYQg7KO87KeAIOyViuuPhOuhnSDshLHqs7Ug7IOB7YOcIOuwmO2ZmFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBtZXRob2Q6ICdmYWlsZWQnLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WYJ1xyXG4gICAgfTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsInByb21pc2lmeSIsImNoZWNrVXJsRXhpc3RzIiwid3JpdGVGaWxlQXN5bmMiLCJ3cml0ZUZpbGUiLCJta2RpckFzeW5jIiwibWtkaXIiLCJyZWFkRmlsZUFzeW5jIiwicmVhZEZpbGUiLCJleGlzdHNBc3luYyIsImV4aXN0cyIsIkRFRkFVTFRfVkFVTFRfUEFUSCIsIkNIQVRHUFRfRk9MREVSIiwiQ09OVkVSU0FUSU9OU19GT0xERVIiLCJpc01jcEF2YWlsYWJsZSIsIm1jcEZ1bmN0aW9uIiwiZ2xvYmFsIiwibWNwIiwiZW5zdXJlRGlyZWN0b3J5RXhpc3RzIiwiZGlyUGF0aCIsImV4aXN0c1N5bmMiLCJyZWN1cnNpdmUiLCJlcnJvciIsImNvbnNvbGUiLCJjaGVja0pzb25GaWxlRXhpc3RzIiwidXJsIiwicHJvamVjdENvbnZlcnNhdGlvblBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsInBhcnNlZFVybCIsIlVSTCIsIm5vcm1hbGl6ZWRVcmwiLCJvcmlnaW4iLCJwYXRobmFtZSIsInNoYXJlSWQiLCJzcGxpdCIsInBvcCIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaWx0ZXIiLCJmaWxlIiwiZW5kc1dpdGgiLCJmaWxlUGF0aCIsImNvbnRlbnQiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwibG9nIiwiZXhpc3RpbmdQYXJzZWRVcmwiLCJleGlzdGluZ1NoYXJlSWQiLCJleGlzdGluZ05vcm1hbGl6ZWRVcmwiLCJwYXJzZUVycm9yIiwic2F2ZVRvRmlsZVN5c3RlbSIsImZpbGVOYW1lIiwibWFya2Rvd25Db250ZW50IiwicmF3VGV4dCIsImNvbnZlcnNhdGlvbiIsInN1bW1hcnlSZXN1bHQiLCJza2lwSnNvblNhdmUiLCJvYnNpZGlhbkZvbGRlclBhdGgiLCJtYXJrZG93bkZpbGVQYXRoIiwidGV4dEZpbGVOYW1lIiwicmVwbGFjZSIsInRleHRGaWxlUGF0aCIsInN1Y2Nlc3MiLCJtYXJrZG93biIsInRleHQiLCJkdXBsaWNhdGUiLCJkYkV4aXN0cyIsImpzb25FeGlzdHMiLCJqc29uRmlsZU5hbWUiLCJ0aXRsZSIsInRvTG93ZXJDYXNlIiwiRGF0ZSIsIm5vdyIsImpzb25GaWxlUGF0aCIsIm1ldGFkYXRhV2l0aE1vZGVsIiwibWV0YWRhdGEiLCJtb2RlbCIsInNhdmVkQXQiLCJ0b0lTT1N0cmluZyIsInN0cmluZ2lmeSIsInN1bW1hcnkiLCJrZXl3b3JkcyIsIm1lc3NhZ2VzIiwiY3JlYXRlZEF0IiwianNvbiIsInNhdmVUb09ic2lkaWFuIiwic2tpcER1cGxpY2F0ZUNoZWNrIiwic2Vzc2lvbiIsInN1YnN0cmluZyIsIm1lc3NhZ2UiLCJ0YWdzIiwiQm9vbGVhbiIsImZyb250bWF0dGVyIiwibWFwIiwidGFnIiwidG9Mb2NhbGVTdHJpbmciLCJsZW5ndGgiLCJmb3JFYWNoIiwiaW5kZXgiLCJpc1VzZXIiLCJyb2xlIiwibWVzc2FnZUhlYWRlciIsImsiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInZhdWx0IiwiZm9sZGVyIiwiZmlsZW5hbWUiLCJyZXN1bHQiLCJFcnJvciIsIm1ldGhvZCIsIm1jcEVycm9yIiwiZmlsZVN5c3RlbVJlc3VsdCIsImNvbW1pdFRvR2l0SHViIiwicmVwbyIsImJyYW5jaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/automation.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/conversationHandler.ts":
/*!******************************************!*\
  !*** ./src/utils/conversationHandler.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   saveConversation: () => (/* binding */ saveConversation)\n/* harmony export */ });\n/* harmony import */ var _lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/utils/chatgpt */ \"(rsc)/./src/lib/utils/chatgpt.ts\");\n/* harmony import */ var _lib_utils_openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils/openai */ \"(rsc)/./src/lib/utils/openai.ts\");\n/* harmony import */ var _utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/supabaseHandler */ \"(rsc)/./src/utils/supabaseHandler.ts\");\n/* harmony import */ var _utils_automation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/utils/automation */ \"(rsc)/./src/utils/automation.ts\");\n/* harmony import */ var _utils_fileSystemAccess__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/utils/fileSystemAccess */ \"(rsc)/./src/utils/fileSystemAccess.ts\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// 환경 확인\nconst isVercel = process.env.VERCEL === \"1\" || process.env.NEXT_PUBLIC_VERCEL_ENV === \"production\";\n/**\r\n * ChatGPT 대화를 저장하는 통합 핸들러\r\n */ async function saveConversation(url, options = {\n    saveToSupabase: true,\n    saveToObsidian: true,\n    saveAsJson: true\n}) {\n    try {\n        console.log(`대화 저장 시작: ${url}`);\n        console.log(\"저장 옵션:\", JSON.stringify(options));\n        // URL 유효성 검사\n        if (!isValidChatGPTUrl(url)) {\n            throw new Error(\"유효한 ChatGPT 공유 URL이 아닙니다.\");\n        }\n        // URL 중복 체크 (Supabase)\n        let duplicate = false;\n        let existingSession = null;\n        if (options.saveToSupabase && !options.skipDuplicateCheck) {\n            const { exists, session } = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_2__.checkUrlExists)(url);\n            duplicate = exists;\n            existingSession = session;\n            if (duplicate) {\n                console.log(`URL 중복 감지: ${url}`);\n                return {\n                    success: true,\n                    duplicate: true,\n                    id: existingSession?.id,\n                    title: existingSession?.title,\n                    error: \"이미 저장된 대화입니다.\"\n                };\n            }\n        }\n        // 크롤링 수행\n        console.log(\"대화 크롤링 중...\");\n        const result = await (0,_lib_utils_chatgpt__WEBPACK_IMPORTED_MODULE_0__.parseChatGPTLink)(url);\n        const { conversation, rawText } = result;\n        if (!conversation.messages || conversation.messages.length === 0) {\n            throw new Error(\"대화 내용을 찾을 수 없습니다.\");\n        }\n        // 요약 생성\n        console.log(\"대화 요약 생성 중...\");\n        const summaryResult = conversation.messages.length > 20 ? await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_1__.summarizeLongConversation)(conversation.title, conversation.messages) : await (0,_lib_utils_openai__WEBPACK_IMPORTED_MODULE_1__.summarizeConversation)(conversation.title, conversation.messages);\n        let saveResults = {\n            supabase: null,\n            obsidian: null,\n            json: undefined\n        };\n        // Supabase에 저장 (벡터 검색 DB)\n        if (options.saveToSupabase) {\n            console.log(\"Supabase에 저장 중...\");\n            saveResults.supabase = await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_2__.insertChatSession)({\n                title: conversation.title,\n                url,\n                summary: summaryResult.summary,\n                messages: conversation.messages,\n                metadata: {\n                    model: summaryResult.modelUsed || conversation.metadata?.model || \"gpt-4\",\n                    keywords: summaryResult.keywords || [],\n                    createdAt: new Date().toISOString()\n                },\n                skipDuplicateCheck: true\n            });\n            // 대화 청크 처리 및 임베딩 저장\n            await (0,_utils_supabaseHandler__WEBPACK_IMPORTED_MODULE_2__.processAndInsertChunks)(saveResults.supabase.id, conversation.messages);\n        }\n        // Obsidian에 저장 (배포 환경에서는 비활성화)\n        if (options.saveToObsidian && !(0,_utils_fileSystemAccess__WEBPACK_IMPORTED_MODULE_4__.isVercelEnv)()) {\n            console.log(\"Obsidian에 저장 중...\");\n            const isRerun = options.skipDuplicateCheck || false;\n            saveResults.obsidian = await (0,_utils_automation__WEBPACK_IMPORTED_MODULE_3__.saveToObsidian)(conversation, summaryResult, rawText, url, isRerun);\n        } else if (options.saveToObsidian && (0,_utils_fileSystemAccess__WEBPACK_IMPORTED_MODULE_4__.isVercelEnv)()) {\n            console.log(\"배포 환경에서는 Obsidian 저장이 비활성화되었습니다.\");\n        }\n        // JSON 파일로 백업 (배포 환경에서는 비활성화)\n        if (options.saveAsJson && !(0,_utils_fileSystemAccess__WEBPACK_IMPORTED_MODULE_4__.isVercelEnv)()) {\n            console.log(\"JSON 파일로 백업 중...\");\n            saveResults.json = await saveAsJsonFile(conversation.title, conversation.messages, rawText, url, summaryResult);\n        } else if (options.saveAsJson && (0,_utils_fileSystemAccess__WEBPACK_IMPORTED_MODULE_4__.isVercelEnv)()) {\n            console.log(\"배포 환경에서는 JSON 백업이 비활성화되었습니다.\");\n        }\n        return {\n            success: true,\n            id: saveResults.supabase?.id,\n            title: conversation.title,\n            summary: summaryResult.summary,\n            keywords: summaryResult.keywords,\n            obsidian: saveResults.obsidian,\n            jsonBackup: saveResults.json,\n            duplicate: false\n        };\n    } catch (error) {\n        console.error(\"대화 저장 중 오류:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\"\n        };\n    }\n}\n/**\r\n * 대화를 JSON 파일로 저장\r\n */ async function saveAsJsonFile(title, messages, rawText, url, summaryResult) {\n    try {\n        // conversations 디렉토리 확인 및 생성\n        const conversationsDir = path__WEBPACK_IMPORTED_MODULE_6__.join(process.cwd(), \"conversations\");\n        await fs_promises__WEBPACK_IMPORTED_MODULE_5__.mkdir(conversationsDir, {\n            recursive: true\n        });\n        // 파일명 생성 (제목에서 유효하지 않은 문자 제거)\n        const sanitizedTitle = title.replace(/[/\\\\?%*:|\"<>]/g, \"-\").replace(/\\s+/g, \"-\").toLowerCase();\n        const fileName = `${sanitizedTitle}-${Date.now()}.json`;\n        const filePath = path__WEBPACK_IMPORTED_MODULE_6__.join(conversationsDir, fileName);\n        // 대화 데이터 저장\n        const conversationData = {\n            title,\n            url,\n            timestamp: new Date().toISOString(),\n            messages,\n            rawText,\n            summary: summaryResult.summary,\n            keywords: summaryResult.keywords\n        };\n        await fs_promises__WEBPACK_IMPORTED_MODULE_5__.writeFile(filePath, JSON.stringify(conversationData, null, 2), \"utf-8\");\n        console.log(`JSON 파일 저장 완료: ${filePath}`);\n        return filePath;\n    } catch (error) {\n        console.error(\"JSON 파일 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * ChatGPT 공유 URL 유효성 검사\r\n */ function isValidChatGPTUrl(url) {\n    try {\n        const parsedUrl = new URL(url);\n        return (parsedUrl.hostname === \"chat.openai.com\" || parsedUrl.hostname === \"chatgpt.com\") && url.includes(\"/share/\");\n    } catch (e) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTLENBQUNFLFFBQVFpRCxHQUFHLElBQUk7UUFDbEQsTUFBTXBELDhDQUFRLENBQUNrRCxrQkFBa0I7WUFBRUksV0FBVztRQUFLO1FBRW5ELDhCQUE4QjtRQUM5QixNQUFNQyxpQkFBaUI5QixNQUNwQitCLE9BQU8sQ0FBQyxrQkFBa0IsS0FDMUJBLE9BQU8sQ0FBQyxRQUFRLEtBQ2hCQyxXQUFXO1FBRWQsTUFBTUMsV0FBVyxDQUFDLEVBQUVILGVBQWUsQ0FBQyxFQUFFWCxLQUFLZSxHQUFHLEdBQUcsS0FBSyxDQUFDO1FBQ3ZELE1BQU1DLFdBQVczRCxzQ0FBUyxDQUFDaUQsa0JBQWtCUTtRQUU3QyxZQUFZO1FBQ1osTUFBTUcsbUJBQW1CO1lBQ3ZCcEM7WUFDQWpCO1lBQ0FzRCxXQUFXLElBQUlsQixPQUFPQyxXQUFXO1lBQ2pDZjtZQUNBRDtZQUNBUyxTQUFTTixjQUFjTSxPQUFPO1lBQzlCSSxVQUFVVixjQUFjVSxRQUFRO1FBQ2xDO1FBRUEsTUFBTTFDLGtEQUFZLENBQ2hCNEQsVUFDQTlDLEtBQUtDLFNBQVMsQ0FBQzhDLGtCQUFrQixNQUFNLElBQ3ZDO1FBR0ZqRCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUUrQyxTQUFTLENBQUM7UUFDeEMsT0FBT0E7SUFDVCxFQUFFLE9BQU9sQyxPQUFPO1FBQ2RkLFFBQVFjLEtBQUssQ0FBQyxvQkFBb0JBO1FBQ2xDLE1BQU1BO0lBQ1I7QUFDRjtBQUVBOztDQUVDLEdBQ0QsU0FBU1Ysa0JBQWtCUixHQUFXO0lBQ3BDLElBQUk7UUFDRixNQUFNd0QsWUFBWSxJQUFJQyxJQUFJekQ7UUFDMUIsT0FBTyxDQUNMd0QsVUFBVUUsUUFBUSxLQUFLLHFCQUN2QkYsVUFBVUUsUUFBUSxLQUFLLGFBQVksS0FDaEMxRCxJQUFJMkQsUUFBUSxDQUFDO0lBQ3BCLEVBQUUsT0FBT0MsR0FBRztRQUNWLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvdXRpbHMvY29udmVyc2F0aW9uSGFuZGxlci50cz85MTZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlQ2hhdEdQVExpbmsgfSBmcm9tICdAL2xpYi91dGlscy9jaGF0Z3B0JztcclxuaW1wb3J0IHsgc3VtbWFyaXplQ29udmVyc2F0aW9uLCBzdW1tYXJpemVMb25nQ29udmVyc2F0aW9uIH0gZnJvbSAnQC9saWIvdXRpbHMvb3BlbmFpJztcclxuaW1wb3J0IHsgaW5zZXJ0Q2hhdFNlc3Npb24sIHByb2Nlc3NBbmRJbnNlcnRDaHVua3MsIGNoZWNrVXJsRXhpc3RzIH0gZnJvbSAnQC91dGlscy9zdXBhYmFzZUhhbmRsZXInO1xyXG5pbXBvcnQgeyBzYXZlVG9PYnNpZGlhbiB9IGZyb20gJ0AvdXRpbHMvYXV0b21hdGlvbic7XHJcbmltcG9ydCB7IGlzVmVyY2VsRW52IH0gZnJvbSAnQC91dGlscy9maWxlU3lzdGVtQWNjZXNzJztcclxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xyXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcclxuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UgfSBmcm9tICdAL3R5cGVzJztcclxuXHJcbi8vIO2ZmOqyvSDtmZXsnbhcclxuY29uc3QgaXNWZXJjZWwgPSBwcm9jZXNzLmVudi5WRVJDRUwgPT09ICcxJyB8fCBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19WRVJDRUxfRU5WID09PSAncHJvZHVjdGlvbic7XHJcblxyXG5pbnRlcmZhY2UgQ29udmVyc2F0aW9uT3B0aW9ucyB7XHJcbiAgc2F2ZVRvU3VwYWJhc2U6IGJvb2xlYW47XHJcbiAgc2F2ZVRvT2JzaWRpYW46IGJvb2xlYW47XHJcbiAgc2F2ZUFzSnNvbjogYm9vbGVhbjtcclxuICBza2lwRHVwbGljYXRlQ2hlY2s/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU2F2ZVJlc3VsdCB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBpZD86IHN0cmluZztcclxuICBkdXBsaWNhdGU/OiBib29sZWFuO1xyXG4gIHRpdGxlPzogc3RyaW5nO1xyXG4gIHN1bW1hcnk/OiBzdHJpbmc7XHJcbiAga2V5d29yZHM/OiBzdHJpbmdbXTtcclxuICBvYnNpZGlhbj86IGFueTtcclxuICBqc29uQmFja3VwPzogc3RyaW5nO1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogQ2hhdEdQVCDrjIDtmZTrpbwg7KCA7J6l7ZWY64qUIO2Gte2VqSDtlbjrk6Trn6xcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQ29udmVyc2F0aW9uKFxyXG4gIHVybDogc3RyaW5nLCBcclxuICBvcHRpb25zOiBDb252ZXJzYXRpb25PcHRpb25zID0geyBcclxuICAgIHNhdmVUb1N1cGFiYXNlOiB0cnVlLCBcclxuICAgIHNhdmVUb09ic2lkaWFuOiB0cnVlLCBcclxuICAgIHNhdmVBc0pzb246IHRydWUgXHJcbiAgfVxyXG4pOiBQcm9taXNlPFNhdmVSZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYOuMgO2ZlCDsoIDsnqUg7Iuc7J6ROiAke3VybH1gKTtcclxuICAgIGNvbnNvbGUubG9nKCfsoIDsnqUg7Ji17IWYOicsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKTtcclxuXHJcbiAgICAvLyBVUkwg7Jyg7Zqo7ISxIOqygOyCrFxyXG4gICAgaWYgKCFpc1ZhbGlkQ2hhdEdQVFVybCh1cmwpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcign7Jyg7Zqo7ZWcIENoYXRHUFQg6rO17JygIFVSTOydtCDslYTri5nri4jri6QuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVVJMIOykkeuztSDssrTtgawgKFN1cGFiYXNlKVxyXG4gICAgbGV0IGR1cGxpY2F0ZSA9IGZhbHNlO1xyXG4gICAgbGV0IGV4aXN0aW5nU2Vzc2lvbiA9IG51bGw7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMuc2F2ZVRvU3VwYWJhc2UgJiYgIW9wdGlvbnMuc2tpcER1cGxpY2F0ZUNoZWNrKSB7XHJcbiAgICAgIGNvbnN0IHsgZXhpc3RzLCBzZXNzaW9uIH0gPSBhd2FpdCBjaGVja1VybEV4aXN0cyh1cmwpO1xyXG4gICAgICBkdXBsaWNhdGUgPSBleGlzdHM7XHJcbiAgICAgIGV4aXN0aW5nU2Vzc2lvbiA9IHNlc3Npb247XHJcblxyXG4gICAgICBpZiAoZHVwbGljYXRlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFVSTCDspJHrs7Ug6rCQ7KeAOiAke3VybH1gKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIGR1cGxpY2F0ZTogdHJ1ZSxcclxuICAgICAgICAgIGlkOiBleGlzdGluZ1Nlc3Npb24/LmlkLFxyXG4gICAgICAgICAgdGl0bGU6IGV4aXN0aW5nU2Vzc2lvbj8udGl0bGUsXHJcbiAgICAgICAgICBlcnJvcjogJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLidcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g7YGs66Gk66eBIOyImO2WiVxyXG4gICAgY29uc29sZS5sb2coJ+uMgO2ZlCDtgazroaTrp4Eg7KSRLi4uJyk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwYXJzZUNoYXRHUFRMaW5rKHVybCk7XHJcbiAgICBjb25zdCB7IGNvbnZlcnNhdGlvbiwgcmF3VGV4dCB9ID0gcmVzdWx0O1xyXG5cclxuICAgIGlmICghY29udmVyc2F0aW9uLm1lc3NhZ2VzIHx8IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCfrjIDtmZQg64K07Jqp7J2EIOywvuydhCDsiJgg7JeG7Iq164uI64ukLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOyalOyVvSDsg53shLFcclxuICAgIGNvbnNvbGUubG9nKCfrjIDtmZQg7JqU7JW9IOyDneyEsSDspJEuLi4nKTtcclxuICAgIGNvbnN0IHN1bW1hcnlSZXN1bHQgPSBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoID4gMjBcclxuICAgICAgPyBhd2FpdCBzdW1tYXJpemVMb25nQ29udmVyc2F0aW9uKGNvbnZlcnNhdGlvbi50aXRsZSwgY29udmVyc2F0aW9uLm1lc3NhZ2VzKVxyXG4gICAgICA6IGF3YWl0IHN1bW1hcml6ZUNvbnZlcnNhdGlvbihjb252ZXJzYXRpb24udGl0bGUsIGNvbnZlcnNhdGlvbi5tZXNzYWdlcyk7XHJcblxyXG4gICAgbGV0IHNhdmVSZXN1bHRzID0ge1xyXG4gICAgICBzdXBhYmFzZTogbnVsbCBhcyBhbnksXHJcbiAgICAgIG9ic2lkaWFuOiBudWxsIGFzIGFueSxcclxuICAgICAganNvbjogdW5kZWZpbmVkIGFzIHN0cmluZyB8IHVuZGVmaW5lZFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBTdXBhYmFzZeyXkCDsoIDsnqUgKOuyoe2EsCDqsoDsg4kgREIpXHJcbiAgICBpZiAob3B0aW9ucy5zYXZlVG9TdXBhYmFzZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnU3VwYWJhc2Xsl5Ag7KCA7J6lIOykkS4uLicpO1xyXG4gICAgICBzYXZlUmVzdWx0cy5zdXBhYmFzZSA9IGF3YWl0IGluc2VydENoYXRTZXNzaW9uKHtcclxuICAgICAgICB0aXRsZTogY29udmVyc2F0aW9uLnRpdGxlLFxyXG4gICAgICAgIHVybCxcclxuICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5UmVzdWx0LnN1bW1hcnksXHJcbiAgICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbi5tZXNzYWdlcyxcclxuICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgbW9kZWw6IHN1bW1hcnlSZXN1bHQubW9kZWxVc2VkIHx8IGNvbnZlcnNhdGlvbi5tZXRhZGF0YT8ubW9kZWwgfHwgJ2dwdC00JyxcclxuICAgICAgICAgIGtleXdvcmRzOiBzdW1tYXJ5UmVzdWx0LmtleXdvcmRzIHx8IFtdLFxyXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNraXBEdXBsaWNhdGVDaGVjazogdHJ1ZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIOuMgO2ZlCDssq3tgawg7LKY66asIOuwjyDsnoTrsqDrlKkg7KCA7J6lXHJcbiAgICAgIGF3YWl0IHByb2Nlc3NBbmRJbnNlcnRDaHVua3MoXHJcbiAgICAgICAgc2F2ZVJlc3VsdHMuc3VwYWJhc2UuaWQsXHJcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT2JzaWRpYW7sl5Ag7KCA7J6lICjrsLDtj6wg7ZmY6rK97JeQ7ISc64qUIOu5hO2ZnOyEse2ZlClcclxuICAgIGlmIChvcHRpb25zLnNhdmVUb09ic2lkaWFuICYmICFpc1ZlcmNlbEVudigpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdPYnNpZGlhbuyXkCDsoIDsnqUg7KSRLi4uJyk7XHJcbiAgICAgIGNvbnN0IGlzUmVydW4gPSBvcHRpb25zLnNraXBEdXBsaWNhdGVDaGVjayB8fCBmYWxzZTtcclxuICAgICAgc2F2ZVJlc3VsdHMub2JzaWRpYW4gPSBhd2FpdCBzYXZlVG9PYnNpZGlhbihcclxuICAgICAgICBjb252ZXJzYXRpb24sXHJcbiAgICAgICAgc3VtbWFyeVJlc3VsdCxcclxuICAgICAgICByYXdUZXh0LFxyXG4gICAgICAgIHVybCxcclxuICAgICAgICBpc1JlcnVuXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2F2ZVRvT2JzaWRpYW4gJiYgaXNWZXJjZWxFbnYoKSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn67Cw7Y+sIO2ZmOqyveyXkOyEnOuKlCBPYnNpZGlhbiDsoIDsnqXsnbQg67mE7Zmc7ISx7ZmU65CY7JeI7Iq164uI64ukLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEpTT04g7YyM7J2866GcIOuwseyXhSAo67Cw7Y+sIO2ZmOqyveyXkOyEnOuKlCDruYTtmZzshLHtmZQpXHJcbiAgICBpZiAob3B0aW9ucy5zYXZlQXNKc29uICYmICFpc1ZlcmNlbEVudigpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdKU09OIO2MjOydvOuhnCDrsLHsl4Ug7KSRLi4uJyk7XHJcbiAgICAgIHNhdmVSZXN1bHRzLmpzb24gPSBhd2FpdCBzYXZlQXNKc29uRmlsZShcclxuICAgICAgICBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLFxyXG4gICAgICAgIHJhd1RleHQsXHJcbiAgICAgICAgdXJsLFxyXG4gICAgICAgIHN1bW1hcnlSZXN1bHRcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zYXZlQXNKc29uICYmIGlzVmVyY2VsRW52KCkpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+uwsO2PrCDtmZjqsr3sl5DshJzripQgSlNPTiDrsLHsl4XsnbQg67mE7Zmc7ISx7ZmU65CY7JeI7Iq164uI64ukLicpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGlkOiBzYXZlUmVzdWx0cy5zdXBhYmFzZT8uaWQsXHJcbiAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgIHN1bW1hcnk6IHN1bW1hcnlSZXN1bHQuc3VtbWFyeSxcclxuICAgICAga2V5d29yZHM6IHN1bW1hcnlSZXN1bHQua2V5d29yZHMsXHJcbiAgICAgIG9ic2lkaWFuOiBzYXZlUmVzdWx0cy5vYnNpZGlhbixcclxuICAgICAganNvbkJhY2t1cDogc2F2ZVJlc3VsdHMuanNvbixcclxuICAgICAgZHVwbGljYXRlOiBmYWxzZVxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign64yA7ZmUIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn7JWMIOyImCDsl4bripQg7Jik66WY6rCAIOuwnOyDne2WiOyKteuLiOuLpC4nXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlOulvCBKU09OIO2MjOydvOuhnCDsoIDsnqVcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNhdmVBc0pzb25GaWxlKFxyXG4gIHRpdGxlOiBzdHJpbmcsXHJcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW10sXHJcbiAgcmF3VGV4dDogc3RyaW5nLFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIHN1bW1hcnlSZXN1bHQ6IGFueVxyXG4pOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBjb252ZXJzYXRpb25zIOuUlOugie2GoOumrCDtmZXsnbgg67CPIOyDneyEsVxyXG4gICAgY29uc3QgY29udmVyc2F0aW9uc0RpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnY29udmVyc2F0aW9ucycpO1xyXG4gICAgYXdhaXQgZnMubWtkaXIoY29udmVyc2F0aW9uc0RpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcblxyXG4gICAgLy8g7YyM7J2866qFIOyDneyEsSAo7KCc66qp7JeQ7IScIOycoO2aqO2VmOyngCDslYrsnYAg66y47J6QIOygnOqxsClcclxuICAgIGNvbnN0IHNhbml0aXplZFRpdGxlID0gdGl0bGVcclxuICAgICAgLnJlcGxhY2UoL1svXFxcXD8lKjp8XCI8Pl0vZywgJy0nKVxyXG4gICAgICAucmVwbGFjZSgvXFxzKy9nLCAnLScpXHJcbiAgICAgIC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgXHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IGAke3Nhbml0aXplZFRpdGxlfS0ke0RhdGUubm93KCl9Lmpzb25gO1xyXG4gICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oY29udmVyc2F0aW9uc0RpciwgZmlsZU5hbWUpO1xyXG5cclxuICAgIC8vIOuMgO2ZlCDrjbDsnbTthLAg7KCA7J6lXHJcbiAgICBjb25zdCBjb252ZXJzYXRpb25EYXRhID0ge1xyXG4gICAgICB0aXRsZSxcclxuICAgICAgdXJsLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbWVzc2FnZXMsXHJcbiAgICAgIHJhd1RleHQsXHJcbiAgICAgIHN1bW1hcnk6IHN1bW1hcnlSZXN1bHQuc3VtbWFyeSxcclxuICAgICAga2V5d29yZHM6IHN1bW1hcnlSZXN1bHQua2V5d29yZHNcclxuICAgIH07XHJcblxyXG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKFxyXG4gICAgICBmaWxlUGF0aCxcclxuICAgICAgSlNPTi5zdHJpbmdpZnkoY29udmVyc2F0aW9uRGF0YSwgbnVsbCwgMiksXHJcbiAgICAgICd1dGYtOCdcclxuICAgICk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYEpTT04g7YyM7J28IOyggOyepSDsmYTro4w6ICR7ZmlsZVBhdGh9YCk7XHJcbiAgICByZXR1cm4gZmlsZVBhdGg7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04g7YyM7J28IOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENoYXRHUFQg6rO17JygIFVSTCDsnKDtmqjshLEg6rKA7IKsXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1ZhbGlkQ2hhdEdQVFVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBwYXJzZWRVcmwuaG9zdG5hbWUgPT09ICdjaGF0Lm9wZW5haS5jb20nIHx8IFxyXG4gICAgICBwYXJzZWRVcmwuaG9zdG5hbWUgPT09ICdjaGF0Z3B0LmNvbSdcclxuICAgICkgJiYgdXJsLmluY2x1ZGVzKCcvc2hhcmUvJyk7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsicGFyc2VDaGF0R1BUTGluayIsInN1bW1hcml6ZUNvbnZlcnNhdGlvbiIsInN1bW1hcml6ZUxvbmdDb252ZXJzYXRpb24iLCJpbnNlcnRDaGF0U2Vzc2lvbiIsInByb2Nlc3NBbmRJbnNlcnRDaHVua3MiLCJjaGVja1VybEV4aXN0cyIsInNhdmVUb09ic2lkaWFuIiwiaXNWZXJjZWxFbnYiLCJmcyIsInBhdGgiLCJpc1ZlcmNlbCIsInByb2Nlc3MiLCJlbnYiLCJWRVJDRUwiLCJORVhUX1BVQkxJQ19WRVJDRUxfRU5WIiwic2F2ZUNvbnZlcnNhdGlvbiIsInVybCIsIm9wdGlvbnMiLCJzYXZlVG9TdXBhYmFzZSIsInNhdmVBc0pzb24iLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImlzVmFsaWRDaGF0R1BUVXJsIiwiRXJyb3IiLCJkdXBsaWNhdGUiLCJleGlzdGluZ1Nlc3Npb24iLCJza2lwRHVwbGljYXRlQ2hlY2siLCJleGlzdHMiLCJzZXNzaW9uIiwic3VjY2VzcyIsImlkIiwidGl0bGUiLCJlcnJvciIsInJlc3VsdCIsImNvbnZlcnNhdGlvbiIsInJhd1RleHQiLCJtZXNzYWdlcyIsImxlbmd0aCIsInN1bW1hcnlSZXN1bHQiLCJzYXZlUmVzdWx0cyIsInN1cGFiYXNlIiwib2JzaWRpYW4iLCJqc29uIiwidW5kZWZpbmVkIiwic3VtbWFyeSIsIm1ldGFkYXRhIiwibW9kZWwiLCJtb2RlbFVzZWQiLCJrZXl3b3JkcyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImlzUmVydW4iLCJzYXZlQXNKc29uRmlsZSIsImpzb25CYWNrdXAiLCJtZXNzYWdlIiwiY29udmVyc2F0aW9uc0RpciIsImpvaW4iLCJjd2QiLCJta2RpciIsInJlY3Vyc2l2ZSIsInNhbml0aXplZFRpdGxlIiwicmVwbGFjZSIsInRvTG93ZXJDYXNlIiwiZmlsZU5hbWUiLCJub3ciLCJmaWxlUGF0aCIsImNvbnZlcnNhdGlvbkRhdGEiLCJ0aW1lc3RhbXAiLCJ3cml0ZUZpbGUiLCJwYXJzZWRVcmwiLCJVUkwiLCJob3N0bmFtZSIsImluY2x1ZGVzIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/conversationHandler.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/embeddings.ts":
/*!*********************************!*\
  !*** ./src/utils/embeddings.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chunkMessages: () => (/* binding */ chunkMessages),\n/* harmony export */   getEmbedding: () => (/* binding */ getEmbedding),\n/* harmony export */   truncateText: () => (/* binding */ truncateText)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gpt-tokenizer */ \"(rsc)/./node_modules/gpt-tokenizer/esm/main.js\");\n\n\n// OpenAI API 클라이언트 초기화\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n/**\n * 텍스트에서 유효하지 않은 문자를 제거합니다.\n * 특히 \\u0000(NULL) 문자와 기타 PostgreSQL에서 문제를 일으킬 수 있는 문자를 제거합니다.\n */ function sanitizeText(text) {\n    if (!text) return \"\";\n    // null 문자 및 제어 문자 제거\n    let sanitized = text.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \");\n    // PostgreSQL에서 문제가 될 수 있는 특수 이스케이프 시퀀스 처리\n    sanitized = sanitized.replace(/\\\\u0000/g, \"\");\n    // 연속된 공백 제거\n    sanitized = sanitized.replace(/\\s+/g, \" \");\n    return sanitized.trim();\n}\n/**\n * 텍스트에 대한 임베딩 벡터를 생성합니다.\n * @param text 임베딩할 텍스트\n * @returns 임베딩 벡터\n */ async function getEmbedding(text) {\n    try {\n        // 텍스트 정제\n        const sanitizedText = sanitizeText(text);\n        if (!sanitizedText) {\n            console.warn(\"임베딩 생성을 위한 텍스트가 비어있습니다.\");\n            // 빈 텍스트의 경우 기본 임베딩 값 반환 (모두 0)\n            return Array(1536).fill(0);\n        }\n        // 텍스트가 너무 짧은 경우 (1-2글자) 처리\n        if (sanitizedText.length < 3) {\n            console.warn(`임베딩 생성을 위한 텍스트가 너무 짧습니다: \"${sanitizedText}\"`);\n            // 짧은 텍스트 확장 (의미를 유지하면서 컨텍스트 추가)\n            const expandedText = `질문: ${sanitizedText} 에 대한 정보를 찾습니다.`;\n            console.log(`확장된 텍스트로 임베딩 생성: \"${expandedText}\"`);\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-3-small\",\n                input: expandedText\n            });\n            return response.data[0].embedding;\n        }\n        // 일반적인 경우 임베딩 생성\n        const response = await openai.embeddings.create({\n            model: \"text-embedding-3-small\",\n            input: sanitizedText\n        });\n        return response.data[0].embedding;\n    } catch (error) {\n        console.error(\"임베딩 생성 중 오류:\", error);\n        // 오류 발생 시 재시도 (다른 모델 사용)\n        try {\n            console.log(\"대체 임베딩 모델로 재시도합니다.\");\n            const response = await openai.embeddings.create({\n                model: \"text-embedding-ada-002\",\n                input: sanitizeText(text) || \"빈 쿼리\"\n            });\n            return response.data[0].embedding;\n        } catch (retryError) {\n            console.error(\"대체 임베딩 생성 중 오류:\", retryError);\n            // 모든 시도 실패 시 기본 임베딩 반환\n            return Array(1536).fill(0);\n        }\n    }\n}\n/**\n * 토큰 제한에 맞게 텍스트를 자릅니다.\n * @param text 원본 텍스트\n * @param maxTokens 최대 토큰 수 (기본값 8000)\n * @returns 잘린 텍스트\n */ function truncateText(text, maxTokens = 8000) {\n    const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(text);\n    if (tokens.length <= maxTokens) {\n        return text;\n    }\n    // 수정된 부분\n    const truncatedTokens = tokens.slice(0, maxTokens);\n    return (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(truncatedTokens); // 잘못된 직접 구현 함수가 아니라 공식 함수 사용\n}\n/**\n * 대화 메시지를 청크로 분할합니다.\n * @param messages 메시지 배열\n * @param maxTokensPerChunk 청크당 최대 토큰 수 (기본값 500)\n * @returns 청크 배열\n */ function chunkMessages(messages, maxTokensPerChunk = 500) {\n    const chunks = [];\n    let currentChunk = \"\";\n    let currentTokens = 0;\n    let chunkIndex = 0;\n    for(let i = 0; i < messages.length; i++){\n        const message = messages[i];\n        const messageText = `[${message.role}]: ${message.content}`;\n        const messageTokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText).length;\n        // 단일 메시지가 청크 제한을 초과하는 경우 (분할 필요)\n        if (messageTokens > maxTokensPerChunk) {\n            // 현재 축적된 청크가 있다면 먼저 저장\n            if (currentTokens > 0) {\n                chunks.push({\n                    content: currentChunk.trim(),\n                    chunk_index: chunkIndex++\n                });\n                currentChunk = \"\";\n                currentTokens = 0;\n            }\n            // 긴 메시지를 여러 청크로 분할\n            const tokens = (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.encode)(messageText);\n            for(let j = 0; j < tokens.length; j += maxTokensPerChunk){\n                const chunkTokens = tokens.slice(j, j + maxTokensPerChunk);\n                chunks.push({\n                    content: (0,gpt_tokenizer__WEBPACK_IMPORTED_MODULE_0__.decode)(chunkTokens).trim(),\n                    chunk_index: chunkIndex++\n                });\n            }\n        } else if (currentTokens + messageTokens <= maxTokensPerChunk) {\n            currentChunk += (currentChunk ? \"\\n\\n\" : \"\") + messageText;\n            currentTokens += messageTokens;\n        } else {\n            chunks.push({\n                content: currentChunk.trim(),\n                chunk_index: chunkIndex++\n            });\n            currentChunk = messageText;\n            currentTokens = messageTokens;\n        }\n    }\n    // 마지막 청크 추가\n    if (currentTokens > 0) {\n        chunks.push({\n            content: currentChunk.trim(),\n            chunk_index: chunkIndex\n        });\n    }\n    return chunks;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvZW1iZWRkaW5ncy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE0QjtBQUVtQjtBQUUvQyx1QkFBdUI7QUFDdkIsTUFBTUcsU0FBUyxJQUFJSCw4Q0FBTUEsQ0FBQztJQUN4QkksUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxjQUFjO0FBQ3BDO0FBRUE7OztDQUdDLEdBQ0QsU0FBU0MsYUFBYUMsSUFBWTtJQUNoQyxJQUFJLENBQUNBLE1BQU0sT0FBTztJQUVsQixxQkFBcUI7SUFDckIsSUFBSUMsWUFBWUQsS0FBS0UsT0FBTyxDQUFDLGlDQUFpQztJQUU5RCwwQ0FBMEM7SUFDMUNELFlBQVlBLFVBQVVDLE9BQU8sQ0FBQyxZQUFZO0lBRTFDLFlBQVk7SUFDWkQsWUFBWUEsVUFBVUMsT0FBTyxDQUFDLFFBQVE7SUFFdEMsT0FBT0QsVUFBVUUsSUFBSTtBQUN2QjtBQUVBOzs7O0NBSUMsR0FDTSxlQUFlQyxhQUFhSixJQUFZO0lBQzdDLElBQUk7UUFDRixTQUFTO1FBQ1QsTUFBTUssZ0JBQWdCTixhQUFhQztRQUVuQyxJQUFJLENBQUNLLGVBQWU7WUFDbEJDLFFBQVFDLElBQUksQ0FBQztZQUNiLCtCQUErQjtZQUMvQixPQUFPQyxNQUFNLE1BQU1DLElBQUksQ0FBQztRQUMxQjtRQUVBLDJCQUEyQjtRQUMzQixJQUFJSixjQUFjSyxNQUFNLEdBQUcsR0FBRztZQUM1QkosUUFBUUMsSUFBSSxDQUFDLENBQUMsMEJBQTBCLEVBQUVGLGNBQWMsQ0FBQyxDQUFDO1lBQzFELGdDQUFnQztZQUNoQyxNQUFNTSxlQUFlLENBQUMsSUFBSSxFQUFFTixjQUFjLGVBQWUsQ0FBQztZQUMxREMsUUFBUU0sR0FBRyxDQUFDLENBQUMsa0JBQWtCLEVBQUVELGFBQWEsQ0FBQyxDQUFDO1lBRWhELE1BQU1FLFdBQVcsTUFBTW5CLE9BQU9vQixVQUFVLENBQUNDLE1BQU0sQ0FBQztnQkFDOUNDLE9BQU87Z0JBQ1BDLE9BQU9OO1lBQ1Q7WUFFQSxPQUFPRSxTQUFTSyxJQUFJLENBQUMsRUFBRSxDQUFDQyxTQUFTO1FBQ25DO1FBRUEsaUJBQWlCO1FBQ2pCLE1BQU1OLFdBQVcsTUFBTW5CLE9BQU9vQixVQUFVLENBQUNDLE1BQU0sQ0FBQztZQUM5Q0MsT0FBTztZQUNQQyxPQUFPWjtRQUNUO1FBRUEsT0FBT1EsU0FBU0ssSUFBSSxDQUFDLEVBQUUsQ0FBQ0MsU0FBUztJQUNuQyxFQUFFLE9BQU9DLE9BQU87UUFDZGQsUUFBUWMsS0FBSyxDQUFDLGdCQUFnQkE7UUFFOUIseUJBQXlCO1FBQ3pCLElBQUk7WUFDRmQsUUFBUU0sR0FBRyxDQUFDO1lBQ1osTUFBTUMsV0FBVyxNQUFNbkIsT0FBT29CLFVBQVUsQ0FBQ0MsTUFBTSxDQUFDO2dCQUM5Q0MsT0FBTztnQkFDUEMsT0FBT2xCLGFBQWFDLFNBQVM7WUFDL0I7WUFFQSxPQUFPYSxTQUFTSyxJQUFJLENBQUMsRUFBRSxDQUFDQyxTQUFTO1FBQ25DLEVBQUUsT0FBT0UsWUFBWTtZQUNuQmYsUUFBUWMsS0FBSyxDQUFDLG1CQUFtQkM7WUFDakMsdUJBQXVCO1lBQ3ZCLE9BQU9iLE1BQU0sTUFBTUMsSUFBSSxDQUFDO1FBQzFCO0lBQ0Y7QUFDRjtBQUVBOzs7OztDQUtDLEdBQ00sU0FBU2EsYUFBYXRCLElBQVksRUFBRXVCLFlBQW9CLElBQUk7SUFDakUsTUFBTUMsU0FBU2hDLHFEQUFNQSxDQUFDUTtJQUV0QixJQUFJd0IsT0FBT2QsTUFBTSxJQUFJYSxXQUFXO1FBQzlCLE9BQU92QjtJQUNUO0lBRUEsU0FBUztJQUNYLE1BQU15QixrQkFBa0JELE9BQU9FLEtBQUssQ0FBQyxHQUFHSDtJQUN4QyxPQUFPOUIscURBQU1BLENBQUNnQyxrQkFBa0IsNkJBQTZCO0FBQzdEO0FBRUE7Ozs7O0NBS0MsR0FDTSxTQUFTRSxjQUNkQyxRQUF1QixFQUN2QkMsb0JBQTRCLEdBQUc7SUFFL0IsTUFBTUMsU0FBbUQsRUFBRTtJQUMzRCxJQUFJQyxlQUFlO0lBQ25CLElBQUlDLGdCQUFnQjtJQUNwQixJQUFJQyxhQUFhO0lBRWpCLElBQUssSUFBSUMsSUFBSSxHQUFHQSxJQUFJTixTQUFTbEIsTUFBTSxFQUFFd0IsSUFBSztRQUN4QyxNQUFNQyxVQUFVUCxRQUFRLENBQUNNLEVBQUU7UUFDM0IsTUFBTUUsY0FBYyxDQUFDLENBQUMsRUFBRUQsUUFBUUUsSUFBSSxDQUFDLEdBQUcsRUFBRUYsUUFBUUcsT0FBTyxDQUFDLENBQUM7UUFDM0QsTUFBTUMsZ0JBQWdCL0MscURBQU1BLENBQUM0QyxhQUFhMUIsTUFBTTtRQUVoRCxpQ0FBaUM7UUFDakMsSUFBSTZCLGdCQUFnQlYsbUJBQW1CO1lBQ3JDLHVCQUF1QjtZQUN2QixJQUFJRyxnQkFBZ0IsR0FBRztnQkFDckJGLE9BQU9VLElBQUksQ0FBQztvQkFDVkYsU0FBU1AsYUFBYTVCLElBQUk7b0JBQzFCc0MsYUFBYVI7Z0JBQ2Y7Z0JBQ0FGLGVBQWU7Z0JBQ2ZDLGdCQUFnQjtZQUNsQjtZQUVBLG1CQUFtQjtZQUNuQixNQUFNUixTQUFTaEMscURBQU1BLENBQUM0QztZQUN0QixJQUFLLElBQUlNLElBQUksR0FBR0EsSUFBSWxCLE9BQU9kLE1BQU0sRUFBRWdDLEtBQUtiLGtCQUFtQjtnQkFDekQsTUFBTWMsY0FBY25CLE9BQU9FLEtBQUssQ0FBQ2dCLEdBQUdBLElBQUliO2dCQUN4Q0MsT0FBT1UsSUFBSSxDQUFDO29CQUNWRixTQUFTN0MscURBQU1BLENBQUNrRCxhQUFheEMsSUFBSTtvQkFDakNzQyxhQUFhUjtnQkFDZjtZQUNGO1FBQ0YsT0FFSyxJQUFJRCxnQkFBZ0JPLGlCQUFpQlYsbUJBQW1CO1lBQzNERSxnQkFBZ0IsQ0FBQ0EsZUFBZSxTQUFTLEVBQUMsSUFBS0s7WUFDL0NKLGlCQUFpQk87UUFDbkIsT0FFSztZQUNIVCxPQUFPVSxJQUFJLENBQUM7Z0JBQ1ZGLFNBQVNQLGFBQWE1QixJQUFJO2dCQUMxQnNDLGFBQWFSO1lBQ2Y7WUFDQUYsZUFBZUs7WUFDZkosZ0JBQWdCTztRQUNsQjtJQUNGO0lBRUEsWUFBWTtJQUNaLElBQUlQLGdCQUFnQixHQUFHO1FBQ3JCRixPQUFPVSxJQUFJLENBQUM7WUFDVkYsU0FBU1AsYUFBYTVCLElBQUk7WUFDMUJzQyxhQUFhUjtRQUNmO0lBQ0Y7SUFFQSxPQUFPSDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGttLXByb2plY3QvLi9zcmMvdXRpbHMvZW1iZWRkaW5ncy50cz8zNmIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCB7IENoYXRNZXNzYWdlIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgeyBlbmNvZGUsIGRlY29kZSB9IGZyb20gJ2dwdC10b2tlbml6ZXInO1xuXG4vLyBPcGVuQUkgQVBJIO2BtOudvOydtOyWuO2KuCDstIjquLDtmZRcbmNvbnN0IG9wZW5haSA9IG5ldyBPcGVuQUkoe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZLFxufSk7XG5cbi8qKlxuICog7YWN7Iqk7Yq47JeQ7IScIOycoO2aqO2VmOyngCDslYrsnYAg66y47J6Q66W8IOygnOqxsO2VqeuLiOuLpC5cbiAqIO2Kue2eiCBcXHUwMDAwKE5VTEwpIOusuOyekOyZgCDquLDtg4AgUG9zdGdyZVNRTOyXkOyEnCDrrLjsoJzrpbwg7J287Jy87YKsIOyImCDsnojripQg66y47J6Q66W8IOygnOqxsO2VqeuLiOuLpC5cbiAqL1xuZnVuY3Rpb24gc2FuaXRpemVUZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmICghdGV4dCkgcmV0dXJuICcnO1xuICBcbiAgLy8gbnVsbCDrrLjsnpAg67CPIOygnOyWtCDrrLjsnpAg7KCc6rGwXG4gIGxldCBzYW5pdGl6ZWQgPSB0ZXh0LnJlcGxhY2UoL1tcXHUwMDAwLVxcdTAwMUZcXHUwMDdGLVxcdTAwOUZdL2csICcgJyk7XG4gIFxuICAvLyBQb3N0Z3JlU1FM7JeQ7IScIOusuOygnOqwgCDrkKAg7IiYIOyeiOuKlCDtirnsiJgg7J207Iqk7LyA7J207ZSEIOyLnO2AgOyKpCDsspjrpqxcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL1xcXFx1MDAwMC9nLCAnJyk7XG4gIFxuICAvLyDsl7Dsho3rkJwg6rO167CxIOygnOqxsFxuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZSgvXFxzKy9nLCAnICcpO1xuICBcbiAgcmV0dXJuIHNhbml0aXplZC50cmltKCk7XG59XG5cbi8qKlxuICog7YWN7Iqk7Yq47JeQIOuMgO2VnCDsnoTrsqDrlKkg67Kh7YSw66W8IOyDneyEse2VqeuLiOuLpC5cbiAqIEBwYXJhbSB0ZXh0IOyehOuyoOuUqe2VoCDthY3siqTtirhcbiAqIEByZXR1cm5zIOyehOuyoOuUqSDrsqHthLBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVtYmVkZGluZyh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcltdPiB7XG4gIHRyeSB7XG4gICAgLy8g7YWN7Iqk7Yq4IOygleygnFxuICAgIGNvbnN0IHNhbml0aXplZFRleHQgPSBzYW5pdGl6ZVRleHQodGV4dCk7XG4gICAgXG4gICAgaWYgKCFzYW5pdGl6ZWRUZXh0KSB7XG4gICAgICBjb25zb2xlLndhcm4oJ+yehOuyoOuUqSDsg53shLHsnYQg7JyE7ZWcIO2FjeyKpO2KuOqwgCDruYTslrTsnojsirXri4jri6QuJyk7XG4gICAgICAvLyDruYgg7YWN7Iqk7Yq47J2YIOqyveyasCDquLDrs7gg7J6E67Kg65SpIOqwkiDrsJjtmZggKOuqqOuRkCAwKVxuICAgICAgcmV0dXJuIEFycmF5KDE1MzYpLmZpbGwoMCk7XG4gICAgfVxuICAgIFxuICAgIC8vIO2FjeyKpO2KuOqwgCDrhIjrrLQg7Ken7J2AIOqyveyasCAoMS0y6riA7J6QKSDsspjrpqxcbiAgICBpZiAoc2FuaXRpemVkVGV4dC5sZW5ndGggPCAzKSB7XG4gICAgICBjb25zb2xlLndhcm4oYOyehOuyoOuUqSDsg53shLHsnYQg7JyE7ZWcIO2FjeyKpO2KuOqwgCDrhIjrrLQg7Ken7Iq164uI64ukOiBcIiR7c2FuaXRpemVkVGV4dH1cImApO1xuICAgICAgLy8g7Ken7J2AIO2FjeyKpO2KuCDtmZXsnqUgKOydmOuvuOulvCDsnKDsp4DtlZjrqbTshJwg7Luo7YWN7Iqk7Yq4IOy2lOqwgClcbiAgICAgIGNvbnN0IGV4cGFuZGVkVGV4dCA9IGDsp4jrrLg6ICR7c2FuaXRpemVkVGV4dH0g7JeQIOuMgO2VnCDsoJXrs7Trpbwg7LC+7Iq164uI64ukLmA7XG4gICAgICBjb25zb2xlLmxvZyhg7ZmV7J6l65CcIO2FjeyKpO2KuOuhnCDsnoTrsqDrlKkg7IOd7ISxOiBcIiR7ZXhwYW5kZWRUZXh0fVwiYCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcbiAgICAgICAgbW9kZWw6ICd0ZXh0LWVtYmVkZGluZy0zLXNtYWxsJyxcbiAgICAgICAgaW5wdXQ6IGV4cGFuZGVkVGV4dCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVswXS5lbWJlZGRpbmc7XG4gICAgfVxuICAgIFxuICAgIC8vIOydvOuwmOyggeyduCDqsr3smrAg7J6E67Kg65SpIOyDneyEsVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmVtYmVkZGluZ3MuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAndGV4dC1lbWJlZGRpbmctMy1zbWFsbCcsXG4gICAgICBpbnB1dDogc2FuaXRpemVkVGV4dCxcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVswXS5lbWJlZGRpbmc7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign7J6E67Kg65SpIOyDneyEsSDspJEg7Jik66WYOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyDsmKTrpZgg67Cc7IOdIOyLnCDsnqzsi5zrj4QgKOuLpOuluCDrqqjrjbgg7IKs7JqpKVxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn64yA7LK0IOyehOuyoOuUqSDrqqjrjbjroZwg7J6s7Iuc64+E7ZWp64uI64ukLicpO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcGVuYWkuZW1iZWRkaW5ncy5jcmVhdGUoe1xuICAgICAgICBtb2RlbDogJ3RleHQtZW1iZWRkaW5nLWFkYS0wMDInLCAvLyDrjIDssrQg66qo6424XG4gICAgICAgIGlucHV0OiBzYW5pdGl6ZVRleHQodGV4dCkgfHwgJ+u5iCDsv7zrpqwnLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhWzBdLmVtYmVkZGluZztcbiAgICB9IGNhdGNoIChyZXRyeUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfrjIDssrQg7J6E67Kg65SpIOyDneyEsSDspJEg7Jik66WYOicsIHJldHJ5RXJyb3IpO1xuICAgICAgLy8g66qo65OgIOyLnOuPhCDsi6TtjKgg7IucIOq4sOuzuCDsnoTrsqDrlKkg67CY7ZmYXG4gICAgICByZXR1cm4gQXJyYXkoMTUzNikuZmlsbCgwKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDthqDtgbAg7KCc7ZWc7JeQIOunnuqyjCDthY3siqTtirjrpbwg7J6Q66aF64uI64ukLlxuICogQHBhcmFtIHRleHQg7JuQ67O4IO2FjeyKpO2KuFxuICogQHBhcmFtIG1heFRva2VucyDstZzrjIAg7Yag7YGwIOyImCAo6riw67O46rCSIDgwMDApXG4gKiBAcmV0dXJucyDsnpjrprAg7YWN7Iqk7Yq4XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZVRleHQodGV4dDogc3RyaW5nLCBtYXhUb2tlbnM6IG51bWJlciA9IDgwMDApOiBzdHJpbmcge1xuICBjb25zdCB0b2tlbnMgPSBlbmNvZGUodGV4dCk7XG4gIFxuICBpZiAodG9rZW5zLmxlbmd0aCA8PSBtYXhUb2tlbnMpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuICBcbiAgLy8g7IiY7KCV65CcIOu2gOu2hFxuY29uc3QgdHJ1bmNhdGVkVG9rZW5zID0gdG9rZW5zLnNsaWNlKDAsIG1heFRva2Vucyk7XG5yZXR1cm4gZGVjb2RlKHRydW5jYXRlZFRva2Vucyk7IC8vIOyemOuqu+uQnCDsp4HsoJEg6rWs7ZiEIO2VqOyImOqwgCDslYTri4jrnbwg6rO17IudIO2VqOyImCDsgqzsmqlcbn1cblxuLyoqXG4gKiDrjIDtmZQg66mU7Iuc7KeA66W8IOyyre2BrOuhnCDrtoTtlaDtlanri4jri6QuXG4gKiBAcGFyYW0gbWVzc2FnZXMg66mU7Iuc7KeAIOuwsOyXtFxuICogQHBhcmFtIG1heFRva2Vuc1BlckNodW5rIOyyre2BrOuLuSDstZzrjIAg7Yag7YGwIOyImCAo6riw67O46rCSIDUwMClcbiAqIEByZXR1cm5zIOyyre2BrCDrsLDsl7RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNodW5rTWVzc2FnZXMoXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdLCBcbiAgbWF4VG9rZW5zUGVyQ2h1bms6IG51bWJlciA9IDUwMFxuKToge2NvbnRlbnQ6IHN0cmluZzsgY2h1bmtfaW5kZXg6IG51bWJlcn1bXSB7XG4gIGNvbnN0IGNodW5rczoge2NvbnRlbnQ6IHN0cmluZzsgY2h1bmtfaW5kZXg6IG51bWJlcn1bXSA9IFtdO1xuICBsZXQgY3VycmVudENodW5rID0gJyc7XG4gIGxldCBjdXJyZW50VG9rZW5zID0gMDtcbiAgbGV0IGNodW5rSW5kZXggPSAwO1xuICBcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlc1tpXTtcbiAgICBjb25zdCBtZXNzYWdlVGV4dCA9IGBbJHttZXNzYWdlLnJvbGV9XTogJHttZXNzYWdlLmNvbnRlbnR9YDtcbiAgICBjb25zdCBtZXNzYWdlVG9rZW5zID0gZW5jb2RlKG1lc3NhZ2VUZXh0KS5sZW5ndGg7XG4gICAgXG4gICAgLy8g64uo7J28IOuplOyLnOyngOqwgCDssq3tgawg7KCc7ZWc7J2EIOy0iOqzvO2VmOuKlCDqsr3smrAgKOu2hO2VoCDtlYTsmpQpXG4gICAgaWYgKG1lc3NhZ2VUb2tlbnMgPiBtYXhUb2tlbnNQZXJDaHVuaykge1xuICAgICAgLy8g7ZiE7J6sIOy2leyggeuQnCDssq3tgazqsIAg7J6I64uk66m0IOuovOyggCDsoIDsnqVcbiAgICAgIGlmIChjdXJyZW50VG9rZW5zID4gMCkge1xuICAgICAgICBjaHVua3MucHVzaCh7XG4gICAgICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcbiAgICAgICAgICBjaHVua19pbmRleDogY2h1bmtJbmRleCsrXG4gICAgICAgIH0pO1xuICAgICAgICBjdXJyZW50Q2h1bmsgPSAnJztcbiAgICAgICAgY3VycmVudFRva2VucyA9IDA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOq4tCDrqZTsi5zsp4Drpbwg7Jes65+sIOyyre2BrOuhnCDrtoTtlaBcbiAgICAgIGNvbnN0IHRva2VucyA9IGVuY29kZShtZXNzYWdlVGV4dCk7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRva2Vucy5sZW5ndGg7IGogKz0gbWF4VG9rZW5zUGVyQ2h1bmspIHtcbiAgICAgICAgY29uc3QgY2h1bmtUb2tlbnMgPSB0b2tlbnMuc2xpY2UoaiwgaiArIG1heFRva2Vuc1BlckNodW5rKTtcbiAgICAgICAgY2h1bmtzLnB1c2goe1xuICAgICAgICAgIGNvbnRlbnQ6IGRlY29kZShjaHVua1Rva2VucykudHJpbSgpLCAvLyDqs7Xsi50gZGVjb2RlIOyCrOyaqVxuICAgICAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4KytcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBcbiAgICAvLyDtmITsnqwg7LKt7YGs7JeQIOuplOyLnOyngOulvCDstpTqsIDtlaAg7IiYIOyeiOuKlOyngCDtmZXsnbhcbiAgICBlbHNlIGlmIChjdXJyZW50VG9rZW5zICsgbWVzc2FnZVRva2VucyA8PSBtYXhUb2tlbnNQZXJDaHVuaykge1xuICAgICAgY3VycmVudENodW5rICs9IChjdXJyZW50Q2h1bmsgPyAnXFxuXFxuJyA6ICcnKSArIG1lc3NhZ2VUZXh0O1xuICAgICAgY3VycmVudFRva2VucyArPSBtZXNzYWdlVG9rZW5zO1xuICAgIH0gXG4gICAgLy8g7IOIIOyyre2BrCDsi5zsnpFcbiAgICBlbHNlIHtcbiAgICAgIGNodW5rcy5wdXNoKHtcbiAgICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcbiAgICAgICAgY2h1bmtfaW5kZXg6IGNodW5rSW5kZXgrK1xuICAgICAgfSk7XG4gICAgICBjdXJyZW50Q2h1bmsgPSBtZXNzYWdlVGV4dDtcbiAgICAgIGN1cnJlbnRUb2tlbnMgPSBtZXNzYWdlVG9rZW5zO1xuICAgIH1cbiAgfVxuICBcbiAgLy8g66eI7KeA66eJIOyyre2BrCDstpTqsIBcbiAgaWYgKGN1cnJlbnRUb2tlbnMgPiAwKSB7XG4gICAgY2h1bmtzLnB1c2goe1xuICAgICAgY29udGVudDogY3VycmVudENodW5rLnRyaW0oKSxcbiAgICAgIGNodW5rX2luZGV4OiBjaHVua0luZGV4XG4gICAgfSk7XG4gIH1cbiAgXG4gIHJldHVybiBjaHVua3M7XG59XG4iXSwibmFtZXMiOlsiT3BlbkFJIiwiZW5jb2RlIiwiZGVjb2RlIiwib3BlbmFpIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwic2FuaXRpemVUZXh0IiwidGV4dCIsInNhbml0aXplZCIsInJlcGxhY2UiLCJ0cmltIiwiZ2V0RW1iZWRkaW5nIiwic2FuaXRpemVkVGV4dCIsImNvbnNvbGUiLCJ3YXJuIiwiQXJyYXkiLCJmaWxsIiwibGVuZ3RoIiwiZXhwYW5kZWRUZXh0IiwibG9nIiwicmVzcG9uc2UiLCJlbWJlZGRpbmdzIiwiY3JlYXRlIiwibW9kZWwiLCJpbnB1dCIsImRhdGEiLCJlbWJlZGRpbmciLCJlcnJvciIsInJldHJ5RXJyb3IiLCJ0cnVuY2F0ZVRleHQiLCJtYXhUb2tlbnMiLCJ0b2tlbnMiLCJ0cnVuY2F0ZWRUb2tlbnMiLCJzbGljZSIsImNodW5rTWVzc2FnZXMiLCJtZXNzYWdlcyIsIm1heFRva2Vuc1BlckNodW5rIiwiY2h1bmtzIiwiY3VycmVudENodW5rIiwiY3VycmVudFRva2VucyIsImNodW5rSW5kZXgiLCJpIiwibWVzc2FnZSIsIm1lc3NhZ2VUZXh0Iiwicm9sZSIsImNvbnRlbnQiLCJtZXNzYWdlVG9rZW5zIiwicHVzaCIsImNodW5rX2luZGV4IiwiaiIsImNodW5rVG9rZW5zIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/embeddings.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/fileSystemAccess.ts":
/*!***************************************!*\
  !*** ./src/utils/fileSystemAccess.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   downloadJsonFile: () => (/* binding */ downloadJsonFile),\n/* harmony export */   downloadMarkdownFile: () => (/* binding */ downloadMarkdownFile),\n/* harmony export */   isBrowser: () => (/* binding */ isBrowser),\n/* harmony export */   isFileSystemAccessSupported: () => (/* binding */ isFileSystemAccessSupported),\n/* harmony export */   isVercelEnv: () => (/* binding */ isVercelEnv),\n/* harmony export */   saveConversationToObsidianVault: () => (/* binding */ saveConversationToObsidianVault),\n/* harmony export */   saveFileWithPicker: () => (/* binding */ saveFileWithPicker),\n/* harmony export */   saveFilesToDirectory: () => (/* binding */ saveFilesToDirectory),\n/* harmony export */   verifyPermission: () => (/* binding */ verifyPermission)\n/* harmony export */ });\n/**\r\n * File System Access API 지원 여부를 확인합니다.\r\n */ function isFileSystemAccessSupported() {\n    return  false && 0;\n}\n/**\r\n * 브라우저 환경인지 확인합니다.\r\n */ function isBrowser() {\n    return \"undefined\" !== \"undefined\";\n}\n/**\r\n * Vercel 배포 환경에서 실행 중인지 확인합니다.\r\n * 클라이언트 사이드에서도 동작할 수 있도록 수정\r\n */ function isVercelEnv() {\n    if (true) {\n        // 서버 사이드에서의 확인\n        return process.env.VERCEL === \"1\" || process.env.NEXT_PUBLIC_VERCEL_ENV === \"production\";\n    } else {}\n}\n/**\r\n * 파일 시스템 쓰기 권한을 확인합니다.\r\n */ async function verifyPermission(fileHandle, readWrite = false) {\n    const options = {};\n    if (readWrite) {\n        options.mode = \"readwrite\";\n    }\n    // 이미 권한이 있는지 확인\n    if (await fileHandle.queryPermission(options) === \"granted\") {\n        return true;\n    }\n    // 권한 요청\n    if (await fileHandle.requestPermission(options) === \"granted\") {\n        return true;\n    }\n    return false;\n}\n/**\r\n * 파일 저장 다이얼로그를 표시하고 파일을 저장합니다.\r\n */ async function saveFileWithPicker(content, options = {}) {\n    if (!isFileSystemAccessSupported()) {\n        console.error(\"File System Access API가 지원되지 않는 브라우저입니다.\");\n        return false;\n    }\n    const { fileName = \"untitled\", fileExtension = \".txt\", description = \"Text documents\", startIn = \"documents\", mimeType = \"text/plain\" } = options;\n    const suggestedName = fileName.endsWith(fileExtension) ? fileName : `${fileName}${fileExtension}`;\n    try {\n        // 파일 저장 다이얼로그 표시\n        const handle = await window.showSaveFilePicker({\n            suggestedName,\n            types: [\n                {\n                    description,\n                    accept: {\n                        [mimeType]: [\n                            fileExtension\n                        ]\n                    }\n                }\n            ],\n            startIn\n        });\n        // 파일 쓰기 권한 확인\n        const hasPermission = await verifyPermission(handle, true);\n        if (!hasPermission) {\n            throw new Error(\"파일 쓰기 권한이 거부되었습니다.\");\n        }\n        // 파일 쓰기 스트림 생성\n        const writable = await handle.createWritable();\n        // 데이터 쓰기\n        await writable.write(content);\n        // 스트림 닫기\n        await writable.close();\n        return true;\n    } catch (error) {\n        console.error(\"파일 저장 중 오류:\", error);\n        return false;\n    }\n}\n/**\r\n * 디렉토리 선택 다이얼로그를 표시하고 선택된 디렉토리에 파일을 저장합니다.\r\n */ async function saveFilesToDirectory(files, options = {}) {\n    if (!isFileSystemAccessSupported()) {\n        console.error(\"File System Access API가 지원되지 않는 브라우저입니다.\");\n        return {\n            success: false,\n            savedFiles: []\n        };\n    }\n    const { startIn = \"documents\" } = options;\n    try {\n        // 디렉토리 선택 다이얼로그 표시\n        const dirHandle = await window.showDirectoryPicker({\n            startIn,\n            id: \"obsidian-vault-selector\",\n            mode: \"readwrite\"\n        });\n        // 디렉토리 쓰기 권한 확인\n        const hasPermission = await verifyPermission(dirHandle, true);\n        if (!hasPermission) {\n            throw new Error(\"디렉토리 쓰기 권한이 거부되었습니다.\");\n        }\n        const savedFiles = [];\n        // 각 파일 저장\n        for (const file of files){\n            try {\n                let targetDir = dirHandle;\n                // 하위 폴더가 지정된 경우 해당 폴더 생성 또는 접근\n                if (file.subFolder) {\n                    const subFolders = file.subFolder.split(\"/\");\n                    for (const folder of subFolders){\n                        if (!folder) continue;\n                        targetDir = await targetDir.getDirectoryHandle(folder, {\n                            create: true\n                        });\n                    }\n                }\n                // 파일 핸들 생성\n                const fileHandle = await targetDir.getFileHandle(file.name, {\n                    create: true\n                });\n                // 파일 쓰기 스트림 생성\n                const writable = await fileHandle.createWritable();\n                // 데이터 쓰기\n                await writable.write(file.content);\n                // 스트림 닫기\n                await writable.close();\n                // 저장된 파일 경로 추가\n                savedFiles.push(file.subFolder ? `${file.subFolder}/${file.name}` : file.name);\n            } catch (fileError) {\n                console.error(`파일 저장 중 오류 (${file.name}):`, fileError);\n            }\n        }\n        return {\n            success: savedFiles.length > 0,\n            savedFiles\n        };\n    } catch (error) {\n        console.error(\"디렉토리 저장 중 오류:\", error);\n        return {\n            success: false,\n            savedFiles: []\n        };\n    }\n}\n/**\r\n * 옵시디언 볼트에 대화 내용을 저장합니다.\r\n */ async function saveConversationToObsidianVault(conversation, summaryResult, rawText, url) {\n    if (!isFileSystemAccessSupported()) {\n        console.error(\"File System Access API가 지원되지 않는 브라우저입니다.\");\n        return {\n            success: false,\n            files: []\n        };\n    }\n    try {\n        // 파일명 생성 (제목을 파일명으로 변환)\n        const baseFileName = conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100);\n        const markdownFileName = `${baseFileName}.md`;\n        const textFileName = `${baseFileName}-original.txt`;\n        const jsonFileName = `${baseFileName}-${Date.now()}.json`;\n        // 태그 목록 준비 (요약에서 추출한 키워드 + ChatGPT 모델)\n        const tags = [\n            ...summaryResult.keywords || [],\n            conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\"\n        ].filter(Boolean); // 빈 값 제거\n        // YAML 프론트매터 생성\n        const frontmatter = `---\r\ntitle: ${conversation.title}\r\ndate: ${new Date().toISOString()}\r\nsource: ${url}\r\ntags: [${tags.map((tag)=>`\"${tag}\"`).join(\", \")}]\r\nmodel: ${conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\"}\r\n---\r\n\r\n`;\n        // 대화 내용을 마크다운으로 변환\n        let markdownContent = frontmatter;\n        // 대화 내용 추가\n        markdownContent += `# ${conversation.title}\\n\\n`;\n        // URL과 날짜 정보 추가\n        markdownContent += `> [원본 URL](${url})\\n\\n`;\n        markdownContent += `> 저장 시간: ${new Date().toLocaleString(\"ko-KR\")}\\n\\n`;\n        if (tags.length > 0) {\n            markdownContent += `> 태그: ${tags.join(\", \")}\\n\\n`;\n        }\n        markdownContent += `---\\n\\n`;\n        // 사용자-어시스턴트 대화 내용을 마크다운으로 포맷팅\n        conversation.messages.forEach((message, index)=>{\n            const isUser = message.role === \"user\";\n            const messageHeader = isUser ? \"## \\uD83D\\uDC64 사용자\" : \"## \\uD83E\\uDD16 assistant\";\n            // 역할과 내용을 구분하여 표시\n            markdownContent += `${messageHeader}\\n\\n${message.content}\\n\\n`;\n            // 마지막 메시지가 아니면 구분선 추가\n            if (index < conversation.messages.length - 1) {\n                markdownContent += `---\\n\\n`;\n            }\n        });\n        // 요약 섹션 추가\n        markdownContent += `\\n\\n---\\n\\n## 💡 요약\\n\\n${summaryResult.summary}\\n`;\n        // 키워드 섹션 추가\n        if (summaryResult.keywords && summaryResult.keywords.length > 0) {\n            markdownContent += `\\n## 🔑 키워드\\n\\n${summaryResult.keywords.map((k)=>`\\`${k}\\``).join(\" \")}\\n`;\n        }\n        // JSON 파일 내용 생성\n        const jsonContent = JSON.stringify({\n            title: conversation.title,\n            url,\n            summary: summaryResult.summary,\n            keywords: summaryResult.keywords,\n            messages: conversation.messages,\n            metadata: {\n                ...conversation.metadata || {},\n                model: conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\",\n                savedAt: new Date().toISOString()\n            },\n            createdAt: new Date().toISOString()\n        }, null, 2);\n        // 파일 저장할 준비\n        const files = [\n            {\n                name: markdownFileName,\n                content: markdownContent,\n                subFolder: \"ChatGPT\"\n            },\n            {\n                name: textFileName,\n                content: rawText,\n                subFolder: \"ChatGPT\"\n            },\n            {\n                name: jsonFileName,\n                content: jsonContent,\n                subFolder: \"_data/conversations\"\n            }\n        ];\n        // 디렉토리 선택 다이얼로그 표시 및 파일 저장\n        const result = await saveFilesToDirectory(files, {\n            startIn: \"documents\"\n        });\n        return {\n            success: result.success,\n            files: result.savedFiles\n        };\n    } catch (error) {\n        console.error(\"옵시디언 저장 중 오류:\", error);\n        return {\n            success: false,\n            files: []\n        };\n    }\n}\n/**\r\n * 대화 내용을 마크다운 파일로 다운로드합니다.\r\n */ function downloadMarkdownFile(conversation, summaryResult, url) {\n    if (!isBrowser()) return;\n    // 태그 목록 준비 (요약에서 추출한 키워드 + ChatGPT 모델)\n    const tags = [\n        ...summaryResult.keywords || [],\n        conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\"\n    ].filter(Boolean); // 빈 값 제거\n    // YAML 프론트매터 생성\n    const frontmatter = `---\r\ntitle: ${conversation.title}\r\ndate: ${new Date().toISOString()}\r\nsource: ${url}\r\ntags: [${tags.map((tag)=>`\"${tag}\"`).join(\", \")}]\r\nmodel: ${conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\"}\r\n---\r\n\r\n`;\n    // 대화 내용을 마크다운으로 변환\n    let markdownContent = frontmatter;\n    // 대화 내용 추가\n    markdownContent += `# ${conversation.title}\\n\\n`;\n    // URL과 날짜 정보 추가\n    markdownContent += `> [원본 URL](${url})\\n\\n`;\n    markdownContent += `> 저장 시간: ${new Date().toLocaleString(\"ko-KR\")}\\n\\n`;\n    if (tags.length > 0) {\n        markdownContent += `> 태그: ${tags.join(\", \")}\\n\\n`;\n    }\n    markdownContent += `---\\n\\n`;\n    // 사용자-어시스턴트 대화 내용을 마크다운으로 포맷팅\n    conversation.messages.forEach((message, index)=>{\n        const isUser = message.role === \"user\";\n        const messageHeader = isUser ? \"## \\uD83D\\uDC64 사용자\" : \"## \\uD83E\\uDD16 assistant\";\n        // 역할과 내용을 구분하여 표시\n        markdownContent += `${messageHeader}\\n\\n${message.content}\\n\\n`;\n        // 마지막 메시지가 아니면 구분선 추가\n        if (index < conversation.messages.length - 1) {\n            markdownContent += `---\\n\\n`;\n        }\n    });\n    // 요약 섹션 추가\n    markdownContent += `\\n\\n---\\n\\n## 💡 요약\\n\\n${summaryResult.summary}\\n`;\n    // 키워드 섹션 추가\n    if (summaryResult.keywords && summaryResult.keywords.length > 0) {\n        markdownContent += `\\n## 🔑 키워드\\n\\n${summaryResult.keywords.map((k)=>`\\`${k}\\``).join(\" \")}\\n`;\n    }\n    // 파일명 생성 (제목을 파일명으로 변환)\n    const fileName = conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\").substring(0, 100) + \".md\";\n    // Blob 생성\n    const blob = new Blob([\n        markdownContent\n    ], {\n        type: \"text/markdown;charset=utf-8\"\n    });\n    // 다운로드 링크 생성 및 클릭\n    const url_obj = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url_obj;\n    a.download = fileName;\n    a.click();\n    // URL 객체 해제\n    setTimeout(()=>URL.revokeObjectURL(url_obj), 100);\n}\n/**\r\n * 대화 내용을 JSON 파일로 다운로드합니다.\r\n */ function downloadJsonFile(conversation, summaryResult, url) {\n    if (!isBrowser()) return;\n    // JSON 파일 내용 생성\n    const jsonContent = JSON.stringify({\n        title: conversation.title,\n        url,\n        summary: summaryResult.summary,\n        keywords: summaryResult.keywords,\n        messages: conversation.messages,\n        metadata: {\n            ...conversation.metadata || {},\n            model: conversation.metadata?.model || summaryResult.modelUsed || \"gpt-4.1-nano\",\n            savedAt: new Date().toISOString()\n        },\n        createdAt: new Date().toISOString()\n    }, null, 2);\n    // 파일명 생성\n    const fileName = `${conversation.title.toLowerCase().replace(/[^a-z0-9가-힣]/g, \"-\")}-${Date.now()}.json`;\n    // Blob 생성\n    const blob = new Blob([\n        jsonContent\n    ], {\n        type: \"application/json;charset=utf-8\"\n    });\n    // 다운로드 링크 생성 및 클릭\n    const url_obj = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url_obj;\n    a.download = fileName;\n    a.click();\n    // URL 객체 해제\n    setTimeout(()=>URL.revokeObjectURL(url_obj), 100);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZVN5c3RlbUFjY2Vzcy50cz8zNmQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYXRNZXNzYWdlIH0gZnJvbSAnQC90eXBlcyc7XHJcblxyXG4vLyDrgrTrtoAg7YOA7J6FIOygleydmCAo7J6Q7LK0IFN1bW1hcnlSZXN1bHQg7KCV7J2YKVxyXG5pbnRlcmZhY2UgU3VtbWFyeURhdGEge1xyXG4gIHN1bW1hcnk6IHN0cmluZztcclxuICBrZXl3b3Jkczogc3RyaW5nW107XHJcbiAgbW9kZWxVc2VkPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogRmlsZSBTeXN0ZW0gQWNjZXNzIEFQSSDsp4Dsm5Ag7Jes67aA66W8IO2ZleyduO2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0ZpbGVTeXN0ZW1BY2Nlc3NTdXBwb3J0ZWQoKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIFxyXG4gICAgJ3Nob3dTYXZlRmlsZVBpY2tlcicgaW4gd2luZG93ICYmIFxyXG4gICAgJ3Nob3dEaXJlY3RvcnlQaWNrZXInIGluIHdpbmRvdztcclxufVxyXG5cclxuLyoqXHJcbiAqIOu4jOudvOyasOyggCDtmZjqsr3snbjsp4Ag7ZmV7J247ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQnJvd3NlcigpOiBib29sZWFuIHtcclxuICByZXR1cm4gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWZXJjZWwg67Cw7Y+sIO2ZmOqyveyXkOyEnCDsi6Ttlokg7KSR7J247KeAIO2ZleyduO2VqeuLiOuLpC5cclxuICog7YG065287J207Ja47Yq4IOyCrOydtOuTnOyXkOyEnOuPhCDrj5nsnpHtlaAg7IiYIOyeiOuPhOuhnSDsiJjsoJVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZlcmNlbEVudigpOiBib29sZWFuIHtcclxuICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgIC8vIOyEnOuyhCDsgqzsnbTrk5zsl5DshJzsnZgg7ZmV7J24XHJcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnYuVkVSQ0VMID09PSAnMScgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfVkVSQ0VMX0VOViA9PT0gJ3Byb2R1Y3Rpb24nO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyDtgbTrnbzsnbTslrjtirgg7IKs7J2065Oc7JeQ7ISc7J2YIO2ZleyduFxyXG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZS5pbmNsdWRlcygndmVyY2VsLmFwcCcpIHx8IFxyXG4gICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2xvY2FsaG9zdCcgJiYgd2luZG93LmxvY2F0aW9uLnBvcnQgPT09ICczMDAwJztcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDtjIzsnbwg7Iuc7Iqk7YWcIOyTsOq4sCDqtoztlZzsnYQg7ZmV7J247ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBlcm1pc3Npb24oXHJcbiAgZmlsZUhhbmRsZTogRmlsZVN5c3RlbUhhbmRsZSwgXHJcbiAgcmVhZFdyaXRlOiBib29sZWFuID0gZmFsc2VcclxuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgY29uc3Qgb3B0aW9uczogRmlsZVN5c3RlbUhhbmRsZVBlcm1pc3Npb25EZXNjcmlwdG9yID0ge307XHJcbiAgaWYgKHJlYWRXcml0ZSkge1xyXG4gICAgb3B0aW9ucy5tb2RlID0gJ3JlYWR3cml0ZSc7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIOydtOuvuCDqtoztlZzsnbQg7J6I64qU7KeAIO2ZleyduFxyXG4gIGlmICgoYXdhaXQgZmlsZUhhbmRsZS5xdWVyeVBlcm1pc3Npb24ob3B0aW9ucykpID09PSAnZ3JhbnRlZCcpIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICBcclxuICAvLyDqtoztlZwg7JqU7LKtXHJcbiAgaWYgKChhd2FpdCBmaWxlSGFuZGxlLnJlcXVlc3RQZXJtaXNzaW9uKG9wdGlvbnMpKSA9PT0gJ2dyYW50ZWQnKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG4vKipcclxuICog7YyM7J28IOyggOyepSDri6TsnbTslrzroZzqt7jrpbwg7ZGc7Iuc7ZWY6rOgIO2MjOydvOydhCDsoIDsnqXtlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUZpbGVXaXRoUGlja2VyKFxyXG4gIGNvbnRlbnQ6IHN0cmluZywgXHJcbiAgb3B0aW9uczoge1xyXG4gICAgZmlsZU5hbWU/OiBzdHJpbmc7XHJcbiAgICBmaWxlRXh0ZW5zaW9uPzogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbiAgICBzdGFydEluPzogJ2RvY3VtZW50cycgfCAnZGVza3RvcCcgfCAnZG93bmxvYWRzJyB8ICdwaWN0dXJlcycgfCAnbXVzaWMnIHwgRmlsZVN5c3RlbURpcmVjdG9yeUhhbmRsZTtcclxuICAgIG1pbWVUeXBlPzogc3RyaW5nO1xyXG4gIH0gPSB7fVxyXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICBpZiAoIWlzRmlsZVN5c3RlbUFjY2Vzc1N1cHBvcnRlZCgpKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGaWxlIFN5c3RlbSBBY2Nlc3MgQVBJ6rCAIOyngOybkOuQmOyngCDslYrripQg67iM65287Jqw7KCA7J6F64uI64ukLicpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICBjb25zdCB7IFxyXG4gICAgZmlsZU5hbWUgPSAndW50aXRsZWQnLCBcclxuICAgIGZpbGVFeHRlbnNpb24gPSAnLnR4dCcsXHJcbiAgICBkZXNjcmlwdGlvbiA9ICdUZXh0IGRvY3VtZW50cycsXHJcbiAgICBzdGFydEluID0gJ2RvY3VtZW50cycsXHJcbiAgICBtaW1lVHlwZSA9ICd0ZXh0L3BsYWluJ1xyXG4gIH0gPSBvcHRpb25zO1xyXG4gIFxyXG4gIGNvbnN0IHN1Z2dlc3RlZE5hbWUgPSBmaWxlTmFtZS5lbmRzV2l0aChmaWxlRXh0ZW5zaW9uKSBcclxuICAgID8gZmlsZU5hbWUgXHJcbiAgICA6IGAke2ZpbGVOYW1lfSR7ZmlsZUV4dGVuc2lvbn1gO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyDtjIzsnbwg7KCA7J6lIOuLpOydtOyWvOuhnOq3uCDtkZzsi5xcclxuICAgIGNvbnN0IGhhbmRsZSA9IGF3YWl0IHdpbmRvdy5zaG93U2F2ZUZpbGVQaWNrZXIoe1xyXG4gICAgICBzdWdnZXN0ZWROYW1lLFxyXG4gICAgICB0eXBlczogW3tcclxuICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICBhY2NlcHQ6IHtcclxuICAgICAgICAgIFttaW1lVHlwZV06IFtmaWxlRXh0ZW5zaW9uXSxcclxuICAgICAgICB9LFxyXG4gICAgICB9XSxcclxuICAgICAgc3RhcnRJblxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIO2MjOydvCDsk7DquLAg6raM7ZWcIO2ZleyduFxyXG4gICAgY29uc3QgaGFzUGVybWlzc2lvbiA9IGF3YWl0IHZlcmlmeVBlcm1pc3Npb24oaGFuZGxlLCB0cnVlKTtcclxuICAgIGlmICghaGFzUGVybWlzc2lvbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+2MjOydvCDsk7DquLAg6raM7ZWc7J20IOqxsOu2gOuQmOyXiOyKteuLiOuLpC4nKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g7YyM7J28IOyTsOq4sCDsiqTtirjrprwg7IOd7ISxXHJcbiAgICBjb25zdCB3cml0YWJsZSA9IGF3YWl0IGhhbmRsZS5jcmVhdGVXcml0YWJsZSgpO1xyXG4gICAgXHJcbiAgICAvLyDrjbDsnbTthLAg7JOw6riwXHJcbiAgICBhd2FpdCB3cml0YWJsZS53cml0ZShjb250ZW50KTtcclxuICAgIFxyXG4gICAgLy8g7Iqk7Yq466a8IOuLq+q4sFxyXG4gICAgYXdhaXQgd3JpdGFibGUuY2xvc2UoKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+2MjOydvCDsoIDsnqUg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog65SU66CJ7Yag66asIOyEoO2DnSDri6TsnbTslrzroZzqt7jrpbwg7ZGc7Iuc7ZWY6rOgIOyEoO2DneuQnCDrlJTroInthqDrpqzsl5Ag7YyM7J287J2EIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlRmlsZXNUb0RpcmVjdG9yeShcclxuICBmaWxlczogQXJyYXk8eyBcclxuICAgIG5hbWU6IHN0cmluZzsgXHJcbiAgICBjb250ZW50OiBzdHJpbmc7IFxyXG4gICAgc3ViRm9sZGVyPzogc3RyaW5nO1xyXG4gIH0+LFxyXG4gIG9wdGlvbnM6IHtcclxuICAgIHN0YXJ0SW4/OiAnZG9jdW1lbnRzJyB8ICdkZXNrdG9wJyB8ICdkb3dubG9hZHMnIHwgRmlsZVN5c3RlbURpcmVjdG9yeUhhbmRsZTtcclxuICB9ID0ge31cclxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IHNhdmVkRmlsZXM6IHN0cmluZ1tdIH0+IHtcclxuICBpZiAoIWlzRmlsZVN5c3RlbUFjY2Vzc1N1cHBvcnRlZCgpKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGaWxlIFN5c3RlbSBBY2Nlc3MgQVBJ6rCAIOyngOybkOuQmOyngCDslYrripQg67iM65287Jqw7KCA7J6F64uI64ukLicpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIHNhdmVkRmlsZXM6IFtdIH07XHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IHsgc3RhcnRJbiA9ICdkb2N1bWVudHMnIH0gPSBvcHRpb25zO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyDrlJTroInthqDrpqwg7ISg7YOdIOuLpOydtOyWvOuhnOq3uCDtkZzsi5xcclxuICAgIGNvbnN0IGRpckhhbmRsZSA9IGF3YWl0IHdpbmRvdy5zaG93RGlyZWN0b3J5UGlja2VyKHtcclxuICAgICAgc3RhcnRJbixcclxuICAgICAgaWQ6ICdvYnNpZGlhbi12YXVsdC1zZWxlY3RvcicsXHJcbiAgICAgIG1vZGU6ICdyZWFkd3JpdGUnXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8g65SU66CJ7Yag66asIOyTsOq4sCDqtoztlZwg7ZmV7J24XHJcbiAgICBjb25zdCBoYXNQZXJtaXNzaW9uID0gYXdhaXQgdmVyaWZ5UGVybWlzc2lvbihkaXJIYW5kbGUsIHRydWUpO1xyXG4gICAgaWYgKCFoYXNQZXJtaXNzaW9uKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcign65SU66CJ7Yag66asIOyTsOq4sCDqtoztlZzsnbQg6rGw67aA65CY7JeI7Iq164uI64ukLicpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBzYXZlZEZpbGVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICAvLyDqsIEg7YyM7J28IOyggOyepVxyXG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgbGV0IHRhcmdldERpciA9IGRpckhhbmRsZTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDtlZjsnIQg7Y+0642U6rCAIOyngOygleuQnCDqsr3smrAg7ZW064u5IO2PtOuNlCDsg53shLEg65iQ64qUIOygkeq3vFxyXG4gICAgICAgIGlmIChmaWxlLnN1YkZvbGRlcikge1xyXG4gICAgICAgICAgY29uc3Qgc3ViRm9sZGVycyA9IGZpbGUuc3ViRm9sZGVyLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IGZvbGRlciBvZiBzdWJGb2xkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmICghZm9sZGVyKSBjb250aW51ZTtcclxuICAgICAgICAgICAgdGFyZ2V0RGlyID0gYXdhaXQgdGFyZ2V0RGlyLmdldERpcmVjdG9yeUhhbmRsZShmb2xkZXIsIHsgY3JlYXRlOiB0cnVlIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyDtjIzsnbwg7ZW465OkIOyDneyEsVxyXG4gICAgICAgIGNvbnN0IGZpbGVIYW5kbGUgPSBhd2FpdCB0YXJnZXREaXIuZ2V0RmlsZUhhbmRsZShmaWxlLm5hbWUsIHsgY3JlYXRlOiB0cnVlIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIO2MjOydvCDsk7DquLAg7Iqk7Yq466a8IOyDneyEsVxyXG4gICAgICAgIGNvbnN0IHdyaXRhYmxlID0gYXdhaXQgZmlsZUhhbmRsZS5jcmVhdGVXcml0YWJsZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOuNsOydtO2EsCDsk7DquLBcclxuICAgICAgICBhd2FpdCB3cml0YWJsZS53cml0ZShmaWxlLmNvbnRlbnQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOyKpO2KuOumvCDri6vquLBcclxuICAgICAgICBhd2FpdCB3cml0YWJsZS5jbG9zZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOyggOyepeuQnCDtjIzsnbwg6rK966GcIOy2lOqwgFxyXG4gICAgICAgIHNhdmVkRmlsZXMucHVzaChmaWxlLnN1YkZvbGRlciA/IGAke2ZpbGUuc3ViRm9sZGVyfS8ke2ZpbGUubmFtZX1gIDogZmlsZS5uYW1lKTtcclxuICAgICAgfSBjYXRjaCAoZmlsZUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg7YyM7J28IOyggOyepSDspJEg7Jik66WYICgke2ZpbGUubmFtZX0pOmAsIGZpbGVFcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHNhdmVkRmlsZXMubGVuZ3RoID4gMCwgXHJcbiAgICAgIHNhdmVkRmlsZXMgXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfrlJTroInthqDrpqwg7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIHNhdmVkRmlsZXM6IFtdIH07XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog7Ji17Iuc65SU7Ja4IOuzvO2KuOyXkCDrjIDtmZQg64K07Jqp7J2EIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQ29udmVyc2F0aW9uVG9PYnNpZGlhblZhdWx0KFxyXG4gIGNvbnZlcnNhdGlvbjoge1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xyXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIH0sXHJcbiAgc3VtbWFyeVJlc3VsdDogU3VtbWFyeURhdGEsXHJcbiAgcmF3VGV4dDogc3RyaW5nLFxyXG4gIHVybDogc3RyaW5nXHJcbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyBmaWxlczogc3RyaW5nW10gfT4ge1xyXG4gIGlmICghaXNGaWxlU3lzdGVtQWNjZXNzU3VwcG9ydGVkKCkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0ZpbGUgU3lzdGVtIEFjY2VzcyBBUEnqsIAg7KeA7JuQ65CY7KeAIOyViuuKlCDruIzrnbzsmrDsoIDsnoXri4jri6QuJyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZmlsZXM6IFtdIH07XHJcbiAgfVxyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyDtjIzsnbzrqoUg7IOd7ISxICjsoJzrqqnsnYQg7YyM7J2866qF7Jy866GcIOuzgO2ZmClcclxuICAgIGNvbnN0IGJhc2VGaWxlTmFtZSA9IGNvbnZlcnNhdGlvbi50aXRsZVxyXG4gICAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgICAucmVwbGFjZSgvW15hLXowLTnqsIAt7Z6jXS9nLCAnLScpXHJcbiAgICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpXHJcbiAgICAgIC5yZXBsYWNlKC9eLXwtJC9nLCAnJylcclxuICAgICAgLnN1YnN0cmluZygwLCAxMDApO1xyXG4gICAgXHJcbiAgICBjb25zdCBtYXJrZG93bkZpbGVOYW1lID0gYCR7YmFzZUZpbGVOYW1lfS5tZGA7XHJcbiAgICBjb25zdCB0ZXh0RmlsZU5hbWUgPSBgJHtiYXNlRmlsZU5hbWV9LW9yaWdpbmFsLnR4dGA7XHJcbiAgICBjb25zdCBqc29uRmlsZU5hbWUgPSBgJHtiYXNlRmlsZU5hbWV9LSR7RGF0ZS5ub3coKX0uanNvbmA7XHJcbiAgICBcclxuICAgIC8vIO2DnOq3uCDrqqnroZ0g7KSA67mEICjsmpTslb3sl5DshJwg7LaU7Lac7ZWcIO2CpOybjOuTnCArIENoYXRHUFQg66qo6424KVxyXG4gICAgY29uc3QgdGFncyA9IFtcclxuICAgICAgLi4uKHN1bW1hcnlSZXN1bHQua2V5d29yZHMgfHwgW10pLFxyXG4gICAgICBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8IHN1bW1hcnlSZXN1bHQubW9kZWxVc2VkIHx8ICdncHQtNC4xLW5hbm8nXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKTsgLy8g67mIIOqwkiDsoJzqsbBcclxuICAgIFxyXG4gICAgLy8gWUFNTCDtlITroaDtirjrp6TthLAg7IOd7ISxXHJcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGAtLS1cclxudGl0bGU6ICR7Y29udmVyc2F0aW9uLnRpdGxlfVxyXG5kYXRlOiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cclxuc291cmNlOiAke3VybH1cclxudGFnczogWyR7dGFncy5tYXAodGFnID0+IGBcIiR7dGFnfVwiYCkuam9pbignLCAnKX1dXHJcbm1vZGVsOiAke2NvbnZlcnNhdGlvbi5tZXRhZGF0YT8ubW9kZWwgfHwgc3VtbWFyeVJlc3VsdC5tb2RlbFVzZWQgfHwgJ2dwdC00LjEtbmFubyd9XHJcbi0tLVxyXG5cclxuYDtcclxuICAgIFxyXG4gICAgLy8g64yA7ZmUIOuCtOyaqeydhCDrp4jtgazri6TsmrTsnLzroZwg67OA7ZmYXHJcbiAgICBsZXQgbWFya2Rvd25Db250ZW50ID0gZnJvbnRtYXR0ZXI7XHJcbiAgICBcclxuICAgIC8vIOuMgO2ZlCDrgrTsmqkg7LaU6rCAXHJcbiAgICBtYXJrZG93bkNvbnRlbnQgKz0gYCMgJHtjb252ZXJzYXRpb24udGl0bGV9XFxuXFxuYDtcclxuICAgIFxyXG4gICAgLy8gVVJM6rO8IOuCoOynnCDsoJXrs7Qg7LaU6rCAXHJcbiAgICBtYXJrZG93bkNvbnRlbnQgKz0gYD4gW+ybkOuzuCBVUkxdKCR7dXJsfSlcXG5cXG5gO1xyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGA+IOyggOyepSDsi5zqsIQ6ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygna28tS1InKX1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICBpZiAodGFncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgPiDtg5zqt7g6ICR7dGFncy5qb2luKCcsICcpfVxcblxcbmA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgLS0tXFxuXFxuYDtcclxuICAgIFxyXG4gICAgLy8g7IKs7Jqp7J6QLeyWtOyLnOyKpO2EtO2KuCDrjIDtmZQg64K07Jqp7J2EIOuniO2BrOuLpOyatOycvOuhnCDtj6zrp7ftjIVcclxuICAgIGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlLCBpbmRleCkgPT4ge1xyXG4gICAgICBjb25zdCBpc1VzZXIgPSBtZXNzYWdlLnJvbGUgPT09ICd1c2VyJztcclxuICAgICAgY29uc3QgbWVzc2FnZUhlYWRlciA9IGlzVXNlciA/ICcjIyDwn5GkIOyCrOyaqeyekCcgOiAnIyMg8J+kliBhc3Npc3RhbnQnO1xyXG4gICAgICBcclxuICAgICAgLy8g7Jet7ZWg6rO8IOuCtOyaqeydhCDqtazrtoTtlZjsl6wg7ZGc7IucXHJcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgJHttZXNzYWdlSGVhZGVyfVxcblxcbiR7bWVzc2FnZS5jb250ZW50fVxcblxcbmA7XHJcbiAgICAgIFxyXG4gICAgICAvLyDrp4jsp4Drp4kg66mU7Iuc7KeA6rCAIOyVhOuLiOuptCDqtazrtoTshKAg7LaU6rCAXHJcbiAgICAgIGlmIChpbmRleCA8IGNvbnZlcnNhdGlvbi5tZXNzYWdlcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8g7JqU7JW9IOyEueyFmCDstpTqsIBcclxuICAgIG1hcmtkb3duQ29udGVudCArPSBgXFxuXFxuLS0tXFxuXFxuIyMg8J+SoSDsmpTslb1cXG5cXG4ke3N1bW1hcnlSZXN1bHQuc3VtbWFyeX1cXG5gO1xyXG4gICAgXHJcbiAgICAvLyDtgqTsm4zrk5wg7IS57IWYIOy2lOqwgFxyXG4gICAgaWYgKHN1bW1hcnlSZXN1bHQua2V5d29yZHMgJiYgc3VtbWFyeVJlc3VsdC5rZXl3b3Jkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG1hcmtkb3duQ29udGVudCArPSBgXFxuIyMg8J+UkSDtgqTsm4zrk5xcXG5cXG4ke3N1bW1hcnlSZXN1bHQua2V5d29yZHMubWFwKGsgPT4gYFxcYCR7a31cXGBgKS5qb2luKCcgJyl9XFxuYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSlNPTiDtjIzsnbwg64K07JqpIOyDneyEsVxyXG4gICAgY29uc3QganNvbkNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShcclxuICAgICAge1xyXG4gICAgICAgIHRpdGxlOiBjb252ZXJzYXRpb24udGl0bGUsXHJcbiAgICAgICAgdXJsLFxyXG4gICAgICAgIHN1bW1hcnk6IHN1bW1hcnlSZXN1bHQuc3VtbWFyeSxcclxuICAgICAgICBrZXl3b3Jkczogc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyxcclxuICAgICAgICBtZXNzYWdlczogY29udmVyc2F0aW9uLm1lc3NhZ2VzLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAuLi4oY29udmVyc2F0aW9uLm1ldGFkYXRhIHx8IHt9KSxcclxuICAgICAgICAgIG1vZGVsOiBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8IHN1bW1hcnlSZXN1bHQubW9kZWxVc2VkIHx8ICdncHQtNC4xLW5hbm8nLFxyXG4gICAgICAgICAgc2F2ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9LFxyXG4gICAgICBudWxsLFxyXG4gICAgICAyXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICAvLyDtjIzsnbwg7KCA7J6l7ZWgIOykgOu5hFxyXG4gICAgY29uc3QgZmlsZXMgPSBbXHJcbiAgICAgIHsgXHJcbiAgICAgICAgbmFtZTogbWFya2Rvd25GaWxlTmFtZSwgXHJcbiAgICAgICAgY29udGVudDogbWFya2Rvd25Db250ZW50LCBcclxuICAgICAgICBzdWJGb2xkZXI6ICdDaGF0R1BUJ1xyXG4gICAgICB9LFxyXG4gICAgICB7IFxyXG4gICAgICAgIG5hbWU6IHRleHRGaWxlTmFtZSwgXHJcbiAgICAgICAgY29udGVudDogcmF3VGV4dCwgXHJcbiAgICAgICAgc3ViRm9sZGVyOiAnQ2hhdEdQVCdcclxuICAgICAgfSxcclxuICAgICAgeyBcclxuICAgICAgICBuYW1lOiBqc29uRmlsZU5hbWUsIFxyXG4gICAgICAgIGNvbnRlbnQ6IGpzb25Db250ZW50LCBcclxuICAgICAgICBzdWJGb2xkZXI6ICdfZGF0YS9jb252ZXJzYXRpb25zJ1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICAvLyDrlJTroInthqDrpqwg7ISg7YOdIOuLpOydtOyWvOuhnOq3uCDtkZzsi5wg67CPIO2MjOydvCDsoIDsnqVcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNhdmVGaWxlc1RvRGlyZWN0b3J5KGZpbGVzLCB7IHN0YXJ0SW46ICdkb2N1bWVudHMnIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiByZXN1bHQuc3VjY2VzcyxcclxuICAgICAgZmlsZXM6IHJlc3VsdC5zYXZlZEZpbGVzXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfsmLXsi5zrlJTslrgg7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGZpbGVzOiBbXSB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlCDrgrTsmqnsnYQg66eI7YGs64uk7Jq0IO2MjOydvOuhnCDri6TsmrTroZzrk5ztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZG93bmxvYWRNYXJrZG93bkZpbGUoXHJcbiAgY29udmVyc2F0aW9uOiB7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5RGF0YSxcclxuICB1cmw6IHN0cmluZ1xyXG4pOiB2b2lkIHtcclxuICBpZiAoIWlzQnJvd3NlcigpKSByZXR1cm47XHJcblxyXG4gIC8vIO2DnOq3uCDrqqnroZ0g7KSA67mEICjsmpTslb3sl5DshJwg7LaU7Lac7ZWcIO2CpOybjOuTnCArIENoYXRHUFQg66qo6424KVxyXG4gIGNvbnN0IHRhZ3MgPSBbXHJcbiAgICAuLi4oc3VtbWFyeVJlc3VsdC5rZXl3b3JkcyB8fCBbXSksXHJcbiAgICBjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8IHN1bW1hcnlSZXN1bHQubW9kZWxVc2VkIHx8ICdncHQtNC4xLW5hbm8nXHJcbiAgXS5maWx0ZXIoQm9vbGVhbik7IC8vIOu5iCDqsJIg7KCc6rGwXHJcbiAgXHJcbiAgLy8gWUFNTCDtlITroaDtirjrp6TthLAg7IOd7ISxXHJcbiAgY29uc3QgZnJvbnRtYXR0ZXIgPSBgLS0tXHJcbnRpdGxlOiAke2NvbnZlcnNhdGlvbi50aXRsZX1cclxuZGF0ZTogJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9XHJcbnNvdXJjZTogJHt1cmx9XHJcbnRhZ3M6IFske3RhZ3MubWFwKHRhZyA9PiBgXCIke3RhZ31cImApLmpvaW4oJywgJyl9XVxyXG5tb2RlbDogJHtjb252ZXJzYXRpb24ubWV0YWRhdGE/Lm1vZGVsIHx8IHN1bW1hcnlSZXN1bHQubW9kZWxVc2VkIHx8ICdncHQtNC4xLW5hbm8nfVxyXG4tLS1cclxuXHJcbmA7XHJcbiAgXHJcbiAgLy8g64yA7ZmUIOuCtOyaqeydhCDrp4jtgazri6TsmrTsnLzroZwg67OA7ZmYXHJcbiAgbGV0IG1hcmtkb3duQ29udGVudCA9IGZyb250bWF0dGVyO1xyXG4gIFxyXG4gIC8vIOuMgO2ZlCDrgrTsmqkg7LaU6rCAXHJcbiAgbWFya2Rvd25Db250ZW50ICs9IGAjICR7Y29udmVyc2F0aW9uLnRpdGxlfVxcblxcbmA7XHJcbiAgXHJcbiAgLy8gVVJM6rO8IOuCoOynnCDsoJXrs7Qg7LaU6rCAXHJcbiAgbWFya2Rvd25Db250ZW50ICs9IGA+IFvsm5Drs7ggVVJMXSgke3VybH0pXFxuXFxuYDtcclxuICBtYXJrZG93bkNvbnRlbnQgKz0gYD4g7KCA7J6lIOyLnOqwhDogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdrby1LUicpfVxcblxcbmA7XHJcbiAgXHJcbiAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGA+IO2DnOq3uDogJHt0YWdzLmpvaW4oJywgJyl9XFxuXFxuYDtcclxuICB9XHJcbiAgXHJcbiAgbWFya2Rvd25Db250ZW50ICs9IGAtLS1cXG5cXG5gO1xyXG4gIFxyXG4gIC8vIOyCrOyaqeyekC3slrTsi5zsiqTthLTtirgg64yA7ZmUIOuCtOyaqeydhCDrp4jtgazri6TsmrTsnLzroZwg7Y+s66e37YyFXHJcbiAgY29udmVyc2F0aW9uLm1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UsIGluZGV4KSA9PiB7XHJcbiAgICBjb25zdCBpc1VzZXIgPSBtZXNzYWdlLnJvbGUgPT09ICd1c2VyJztcclxuICAgIGNvbnN0IG1lc3NhZ2VIZWFkZXIgPSBpc1VzZXIgPyAnIyMg8J+RpCDsgqzsmqnsnpAnIDogJyMjIPCfpJYgYXNzaXN0YW50JztcclxuICAgIFxyXG4gICAgLy8g7Jet7ZWg6rO8IOuCtOyaqeydhCDqtazrtoTtlZjsl6wg7ZGc7IucXHJcbiAgICBtYXJrZG93bkNvbnRlbnQgKz0gYCR7bWVzc2FnZUhlYWRlcn1cXG5cXG4ke21lc3NhZ2UuY29udGVudH1cXG5cXG5gO1xyXG4gICAgXHJcbiAgICAvLyDrp4jsp4Drp4kg66mU7Iuc7KeA6rCAIOyVhOuLiOuptCDqtazrtoTshKAg7LaU6rCAXHJcbiAgICBpZiAoaW5kZXggPCBjb252ZXJzYXRpb24ubWVzc2FnZXMubGVuZ3RoIC0gMSkge1xyXG4gICAgICBtYXJrZG93bkNvbnRlbnQgKz0gYC0tLVxcblxcbmA7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgLy8g7JqU7JW9IOyEueyFmCDstpTqsIBcclxuICBtYXJrZG93bkNvbnRlbnQgKz0gYFxcblxcbi0tLVxcblxcbiMjIPCfkqEg7JqU7JW9XFxuXFxuJHtzdW1tYXJ5UmVzdWx0LnN1bW1hcnl9XFxuYDtcclxuICBcclxuICAvLyDtgqTsm4zrk5wg7IS57IWYIOy2lOqwgFxyXG4gIGlmIChzdW1tYXJ5UmVzdWx0LmtleXdvcmRzICYmIHN1bW1hcnlSZXN1bHQua2V5d29yZHMubGVuZ3RoID4gMCkge1xyXG4gICAgbWFya2Rvd25Db250ZW50ICs9IGBcXG4jIyDwn5SRIO2CpOybjOuTnFxcblxcbiR7c3VtbWFyeVJlc3VsdC5rZXl3b3Jkcy5tYXAoayA9PiBgXFxgJHtrfVxcYGApLmpvaW4oJyAnKX1cXG5gO1xyXG4gIH1cclxuXHJcbiAgLy8g7YyM7J2866qFIOyDneyEsSAo7KCc66qp7J2EIO2MjOydvOuqheycvOuhnCDrs4DtmZgpXHJcbiAgY29uc3QgZmlsZU5hbWUgPSBjb252ZXJzYXRpb24udGl0bGVcclxuICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAucmVwbGFjZSgvW15hLXowLTnqsIAt7Z6jXS9nLCAnLScpXHJcbiAgICAucmVwbGFjZSgvLSsvZywgJy0nKVxyXG4gICAgLnJlcGxhY2UoL14tfC0kL2csICcnKVxyXG4gICAgLnN1YnN0cmluZygwLCAxMDApICsgJy5tZCc7XHJcblxyXG4gIC8vIEJsb2Ig7IOd7ISxXHJcbiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFttYXJrZG93bkNvbnRlbnRdLCB7IHR5cGU6ICd0ZXh0L21hcmtkb3duO2NoYXJzZXQ9dXRmLTgnIH0pO1xyXG4gIFxyXG4gIC8vIOuLpOyatOuhnOuTnCDrp4Htgawg7IOd7ISxIOuwjyDtgbTrpq1cclxuICBjb25zdCB1cmxfb2JqID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIGEuaHJlZiA9IHVybF9vYmo7XHJcbiAgYS5kb3dubG9hZCA9IGZpbGVOYW1lO1xyXG4gIGEuY2xpY2soKTtcclxuICBcclxuICAvLyBVUkwg6rCd7LK0IO2VtOygnFxyXG4gIHNldFRpbWVvdXQoKCkgPT4gVVJMLnJldm9rZU9iamVjdFVSTCh1cmxfb2JqKSwgMTAwKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlCDrgrTsmqnsnYQgSlNPTiDtjIzsnbzroZwg64uk7Jq066Gc65Oc7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRvd25sb2FkSnNvbkZpbGUoXHJcbiAgY29udmVyc2F0aW9uOiB7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XHJcbiAgfSxcclxuICBzdW1tYXJ5UmVzdWx0OiBTdW1tYXJ5RGF0YSxcclxuICB1cmw6IHN0cmluZ1xyXG4pOiB2b2lkIHtcclxuICBpZiAoIWlzQnJvd3NlcigpKSByZXR1cm47XHJcblxyXG4gIC8vIEpTT04g7YyM7J28IOuCtOyaqSDsg53shLFcclxuICBjb25zdCBqc29uQ29udGVudCA9IEpTT04uc3RyaW5naWZ5KFxyXG4gICAge1xyXG4gICAgICB0aXRsZTogY29udmVyc2F0aW9uLnRpdGxlLFxyXG4gICAgICB1cmwsXHJcbiAgICAgIHN1bW1hcnk6IHN1bW1hcnlSZXN1bHQuc3VtbWFyeSxcclxuICAgICAga2V5d29yZHM6IHN1bW1hcnlSZXN1bHQua2V5d29yZHMsXHJcbiAgICAgIG1lc3NhZ2VzOiBjb252ZXJzYXRpb24ubWVzc2FnZXMsXHJcbiAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgLi4uKGNvbnZlcnNhdGlvbi5tZXRhZGF0YSB8fCB7fSksXHJcbiAgICAgICAgbW9kZWw6IGNvbnZlcnNhdGlvbi5tZXRhZGF0YT8ubW9kZWwgfHwgc3VtbWFyeVJlc3VsdC5tb2RlbFVzZWQgfHwgJ2dwdC00LjEtbmFubycsXHJcbiAgICAgICAgc2F2ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0sXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9LFxyXG4gICAgbnVsbCxcclxuICAgIDJcclxuICApO1xyXG5cclxuICAvLyDtjIzsnbzrqoUg7IOd7ISxXHJcbiAgY29uc3QgZmlsZU5hbWUgPSBgJHtjb252ZXJzYXRpb24udGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOeqwgC3tnqNdL2csICctJyl9LSR7RGF0ZS5ub3coKX0uanNvbmA7XHJcblxyXG4gIC8vIEJsb2Ig7IOd7ISxXHJcbiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtqc29uQ29udGVudF0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcgfSk7XHJcbiAgXHJcbiAgLy8g64uk7Jq066Gc65OcIOunge2BrCDsg53shLEg67CPIO2BtOumrVxyXG4gIGNvbnN0IHVybF9vYmogPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG4gIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgYS5ocmVmID0gdXJsX29iajtcclxuICBhLmRvd25sb2FkID0gZmlsZU5hbWU7XHJcbiAgYS5jbGljaygpO1xyXG4gIFxyXG4gIC8vIFVSTCDqsJ3ssrQg7ZW07KCcXHJcbiAgc2V0VGltZW91dCgoKSA9PiBVUkwucmV2b2tlT2JqZWN0VVJMKHVybF9vYmopLCAxMDApO1xyXG59ICJdLCJuYW1lcyI6WyJpc0ZpbGVTeXN0ZW1BY2Nlc3NTdXBwb3J0ZWQiLCJ3aW5kb3ciLCJpc0Jyb3dzZXIiLCJpc1ZlcmNlbEVudiIsInByb2Nlc3MiLCJlbnYiLCJWRVJDRUwiLCJORVhUX1BVQkxJQ19WRVJDRUxfRU5WIiwibG9jYXRpb24iLCJob3N0bmFtZSIsImluY2x1ZGVzIiwicG9ydCIsInZlcmlmeVBlcm1pc3Npb24iLCJmaWxlSGFuZGxlIiwicmVhZFdyaXRlIiwib3B0aW9ucyIsIm1vZGUiLCJxdWVyeVBlcm1pc3Npb24iLCJyZXF1ZXN0UGVybWlzc2lvbiIsInNhdmVGaWxlV2l0aFBpY2tlciIsImNvbnRlbnQiLCJjb25zb2xlIiwiZXJyb3IiLCJmaWxlTmFtZSIsImZpbGVFeHRlbnNpb24iLCJkZXNjcmlwdGlvbiIsInN0YXJ0SW4iLCJtaW1lVHlwZSIsInN1Z2dlc3RlZE5hbWUiLCJlbmRzV2l0aCIsImhhbmRsZSIsInNob3dTYXZlRmlsZVBpY2tlciIsInR5cGVzIiwiYWNjZXB0IiwiaGFzUGVybWlzc2lvbiIsIkVycm9yIiwid3JpdGFibGUiLCJjcmVhdGVXcml0YWJsZSIsIndyaXRlIiwiY2xvc2UiLCJzYXZlRmlsZXNUb0RpcmVjdG9yeSIsImZpbGVzIiwic3VjY2VzcyIsInNhdmVkRmlsZXMiLCJkaXJIYW5kbGUiLCJzaG93RGlyZWN0b3J5UGlja2VyIiwiaWQiLCJmaWxlIiwidGFyZ2V0RGlyIiwic3ViRm9sZGVyIiwic3ViRm9sZGVycyIsInNwbGl0IiwiZm9sZGVyIiwiZ2V0RGlyZWN0b3J5SGFuZGxlIiwiY3JlYXRlIiwiZ2V0RmlsZUhhbmRsZSIsIm5hbWUiLCJwdXNoIiwiZmlsZUVycm9yIiwibGVuZ3RoIiwic2F2ZUNvbnZlcnNhdGlvblRvT2JzaWRpYW5WYXVsdCIsImNvbnZlcnNhdGlvbiIsInN1bW1hcnlSZXN1bHQiLCJyYXdUZXh0IiwidXJsIiwiYmFzZUZpbGVOYW1lIiwidGl0bGUiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJzdWJzdHJpbmciLCJtYXJrZG93bkZpbGVOYW1lIiwidGV4dEZpbGVOYW1lIiwianNvbkZpbGVOYW1lIiwiRGF0ZSIsIm5vdyIsInRhZ3MiLCJrZXl3b3JkcyIsIm1ldGFkYXRhIiwibW9kZWwiLCJtb2RlbFVzZWQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZnJvbnRtYXR0ZXIiLCJ0b0lTT1N0cmluZyIsIm1hcCIsInRhZyIsImpvaW4iLCJtYXJrZG93bkNvbnRlbnQiLCJ0b0xvY2FsZVN0cmluZyIsIm1lc3NhZ2VzIiwiZm9yRWFjaCIsIm1lc3NhZ2UiLCJpbmRleCIsImlzVXNlciIsInJvbGUiLCJtZXNzYWdlSGVhZGVyIiwic3VtbWFyeSIsImsiLCJqc29uQ29udGVudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzYXZlZEF0IiwiY3JlYXRlZEF0IiwicmVzdWx0IiwiZG93bmxvYWRNYXJrZG93bkZpbGUiLCJibG9iIiwiQmxvYiIsInR5cGUiLCJ1cmxfb2JqIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiYSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJkb3dubG9hZCIsImNsaWNrIiwic2V0VGltZW91dCIsInJldm9rZU9iamVjdFVSTCIsImRvd25sb2FkSnNvbkZpbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/fileSystemAccess.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/supabaseHandler.ts":
/*!**************************************!*\
  !*** ./src/utils/supabaseHandler.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkUrlExists: () => (/* binding */ checkUrlExists),\n/* harmony export */   getAllChatSessions: () => (/* binding */ getAllChatSessions),\n/* harmony export */   getChatSessionById: () => (/* binding */ getChatSessionById),\n/* harmony export */   getChunksBySessionId: () => (/* binding */ getChunksBySessionId),\n/* harmony export */   insertChatSession: () => (/* binding */ insertChatSession),\n/* harmony export */   processAndInsertChunks: () => (/* binding */ processAndInsertChunks),\n/* harmony export */   searchChatSessions: () => (/* binding */ searchChatSessions),\n/* harmony export */   searchSimilarChunks: () => (/* binding */ searchSimilarChunks),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _embeddings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./embeddings */ \"(rsc)/./src/utils/embeddings.ts\");\n\n\n// Supabase 클라이언트 재사용\nconst supabase = _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin;\n/**\r\n * JSON 데이터를 안전하게 처리합니다.\r\n * PostgreSQL에 저장하기 전 유효하지 않은 문자나 구조를 제거합니다.\r\n */ function sanitizeJsonData(data) {\n    if (!data) return null;\n    if (typeof data === \"string\") {\n        // 문자열에서 제어 문자 제거 및 유니코드 문자 처리 개선\n        return data.replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, \" \") // 제어 문자 제거\n        .replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, (match)=>match) // 올바른 유니코드 이모지 유지\n        .replace(/\\uFFFD/g, \"\") // 대체 문자 제거\n        .replace(/\\s+/g, \" \") // 연속된 공백 제거\n        .trim();\n    }\n    if (Array.isArray(data)) {\n        // 배열의 각 항목 정제\n        return data.map((item)=>sanitizeJsonData(item));\n    }\n    if (typeof data === \"object\" && data !== null) {\n        // 객체의 각 필드 정제\n        const sanitized = {};\n        for(const key in data){\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                sanitized[key] = sanitizeJsonData(data[key]);\n            }\n        }\n        return sanitized;\n    }\n    // 기본 자료형은 그대로 반환\n    return data;\n}\n/**\r\n * URL이 이미 저장되어 있는지 확인합니다.\r\n * @param url 확인할 URL\r\n * @returns 중복 여부와 기존 세션 정보\r\n */ async function checkUrlExists(url) {\n    try {\n        // URL 정규화 (쿼리 파라미터 등 제거)\n        const normalizedUrl = new URL(url).origin + new URL(url).pathname;\n        // 정규화된 URL로 시작하는 세션 검색\n        const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at\").ilike(\"url\", `${normalizedUrl}%`).limit(1);\n        if (error) {\n            console.error(\"URL 중복 확인 중 오류:\", error);\n            throw error;\n        }\n        if (data && data.length > 0) {\n            return {\n                exists: true,\n                session: data[0]\n            };\n        }\n        return {\n            exists: false\n        };\n    } catch (error) {\n        console.error(\"URL 중복 확인 중 오류:\", error);\n        // 오류 발생 시 안전하게 중복이 아닌 것으로 처리\n        return {\n            exists: false\n        };\n    }\n}\n/**\r\n * 대화 세션을 Supabase에 저장합니다.\r\n */ async function insertChatSession({ title, url, summary, messages, metadata = {}, skipDuplicateCheck = false }) {\n    try {\n        // URL 중복 확인 (skipDuplicateCheck가 false일 때만)\n        if (!skipDuplicateCheck && url) {\n            const { exists, session } = await checkUrlExists(url);\n            if (exists) {\n                console.log(`URL이 이미 존재합니다: ${url}`);\n                console.log(`기존 세션 정보: ${session?.title} (${session?.id})`);\n                return {\n                    id: session?.id,\n                    duplicate: true,\n                    message: \"이미 저장된 대화입니다.\"\n                };\n            }\n        }\n        // 데이터 정제\n        const sanitizedTitle = sanitizeJsonData(title);\n        const sanitizedSummary = sanitizeJsonData(summary);\n        const sanitizedMessages = sanitizeJsonData(messages);\n        const sanitizedMetadata = sanitizeJsonData(metadata);\n        // 요약 텍스트 임베딩 생성\n        const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedSummary);\n        // 세션 데이터 삽입\n        const { data, error } = await supabase.from(\"chat_sessions\").insert({\n            title: sanitizedTitle,\n            url,\n            summary: sanitizedSummary,\n            messages: sanitizedMessages,\n            metadata: sanitizedMetadata,\n            embedding\n        }).select(\"id\").single();\n        if (error) throw error;\n        return {\n            ...data,\n            duplicate: false\n        };\n    } catch (error) {\n        console.error(\"대화 세션 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 대화 청크를 생성하고 Supabase에 저장합니다.\r\n */ async function processAndInsertChunks(sessionId, messages) {\n    try {\n        // 메시지 정제\n        const sanitizedMessages = sanitizeJsonData(messages);\n        // 메시지를 청크로 분할\n        const chunks = (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.chunkMessages)(sanitizedMessages);\n        console.log(\"\\uD83E\\uDDF1 분할된 청크:\", chunks);\n        // 각 청크에 대해 임베딩 생성 및 저장\n        const chunkPromises = chunks.map(async (chunk)=>{\n            // 청크 내용 정제\n            const sanitizedContent = sanitizeJsonData(chunk.content);\n            const embedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedContent);\n            return {\n                chat_session_id: sessionId,\n                chunk_index: chunk.chunk_index,\n                content: sanitizedContent,\n                embedding\n            };\n        });\n        // 모든 청크 임베딩 처리 완료 대기\n        const chunksWithEmbeddings = await Promise.all(chunkPromises);\n        // 청크 데이터 삽입 (최대 1MB 제한으로 청크 10개씩 배치 처리)\n        const batchSize = 10;\n        const results = [];\n        for(let i = 0; i < chunksWithEmbeddings.length; i += batchSize){\n            const batch = chunksWithEmbeddings.slice(i, i + batchSize);\n            try {\n                const { data, error } = await supabase.from(\"chat_chunks\").insert(batch);\n                if (error) throw error;\n                results.push(data);\n            } catch (error) {\n                console.error(`청크 배치 ${i}/${chunksWithEmbeddings.length} 저장 중 오류:`, error);\n            // 개별 청크 에러를 기록하되 전체 프로세스는 계속 진행\n            }\n        }\n        return {\n            success: true,\n            count: chunksWithEmbeddings.length\n        };\n    } catch (error) {\n        console.error(\"청크 처리 및 저장 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 유사한 청크를 검색합니다.\r\n */ async function searchSimilarChunks(query, similarity = 0.3, limit = 10) {\n    try {\n        // 메타 질문 감지 (예: \"이 대화의 핵심이 뭐야?\", \"요약해줘\" 등)\n        const metaQuestionPatterns = [\n            /이\\s*대화의?\\s*(핵심|요약|내용|주제)/i,\n            /대화를?\\s*(요약|정리)/i,\n            /요약해\\s*줘/i,\n            /핵심\\s*(내용|포인트)/i,\n            /주요\\s*(내용|포인트)/i\n        ];\n        const isMetaQuestion = metaQuestionPatterns.some((pattern)=>pattern.test(query));\n        if (isMetaQuestion) {\n            console.log(\"메타 질문 감지됨, 모든 세션의 요약 정보를 검색합니다.\");\n            // 메타 질문인 경우 가장 최근 세션의 요약 정보를 가져오기\n            const { data: sessionData, error: sessionError } = await supabase.from(\"chat_sessions\").select(\"id, title, summary\").order(\"created_at\", {\n                ascending: false\n            }).limit(1);\n            if (sessionError || !sessionData || sessionData.length === 0) {\n                console.warn(\"세션 데이터를 찾을 수 없습니다.\");\n                return [];\n            }\n            // 세션의 요약 정보를 청크로 변환하여 반환\n            const session = sessionData[0];\n            const fakeChunk = {\n                id: \"meta-question-chunk\",\n                chat_session_id: session.id,\n                chunk_index: 0,\n                content: `[요약]: ${session.summary}`,\n                similarity: 1.0\n            };\n            return [\n                fakeChunk\n            ];\n        }\n        console.log(`검색 쿼리: \"${query}\", 유사도 임계값: ${similarity}, 제한: ${limit}`);\n        // 쿼리 텍스트 정제\n        const sanitizedQuery = sanitizeJsonData(query);\n        console.log(`정제된 쿼리: \"${sanitizedQuery}\"`);\n        if (!sanitizedQuery || sanitizedQuery.trim().length < 2) {\n            console.warn(\"쿼리가 너무 짧거나 비어 있습니다\");\n            return [];\n        }\n        // 쿼리 텍스트 임베딩 생성\n        const queryEmbedding = await (0,_embeddings__WEBPACK_IMPORTED_MODULE_1__.getEmbedding)(sanitizedQuery);\n        console.log(`임베딩 생성 완료: ${queryEmbedding.length} 차원`);\n        // 유사한 청크 검색\n        const { data, error } = await supabase.rpc(\"match_chunks\", {\n            query_embedding: queryEmbedding,\n            match_threshold: similarity,\n            match_count: limit\n        });\n        if (error) {\n            console.error(\"유사 청크 검색 오류:\", error);\n            throw error;\n        }\n        console.log(`검색된 청크 수: ${data?.length || 0}`);\n        // 검색 결과가 없는 경우 유사도 임계값을 낮춰서 다시 시도 (2단계로 낮춤)\n        if (!data || data.length === 0) {\n            // 첫 번째 재시도: 임계값을 50% 낮춤\n            const lowerThreshold = similarity * 0.5;\n            console.log(`결과가 없어 유사도 임계값을 ${lowerThreshold.toFixed(2)}로 낮춰 재시도`);\n            const { data: retryData, error: retryError } = await supabase.rpc(\"match_chunks\", {\n                query_embedding: queryEmbedding,\n                match_threshold: lowerThreshold,\n                match_count: limit\n            });\n            if (retryError) {\n                console.error(\"낮은 임계값으로 재시도 중 오류:\", retryError);\n            } else if (retryData && retryData.length > 0) {\n                console.log(`낮은 임계값으로 ${retryData.length}개 청크 검색됨`);\n                return retryData;\n            } else {\n                // 두 번째 재시도: 매우 낮은 임계값 (0.1)으로 시도\n                const lowestThreshold = 0.1;\n                console.log(`결과가 여전히 없어 최저 임계값 ${lowestThreshold.toFixed(2)}로 재시도`);\n                const { data: lastRetryData, error: lastRetryError } = await supabase.rpc(\"match_chunks\", {\n                    query_embedding: queryEmbedding,\n                    match_threshold: lowestThreshold,\n                    match_count: limit\n                });\n                if (lastRetryError) {\n                    console.error(\"최저 임계값으로 재시도 중 오류:\", lastRetryError);\n                } else if (lastRetryData && lastRetryData.length > 0) {\n                    console.log(`최저 임계값으로 ${lastRetryData.length}개 청크 검색됨`);\n                    return lastRetryData;\n                }\n            }\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"유사 청크 검색 중 오류:\", error);\n        throw error;\n    }\n}\n/**\r\n * 세션 ID로 대화 세션을 조회합니다.\r\n */ async function getChatSessionById(id) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"*\").eq(\"id\", id).single();\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 모든 대화 세션을 조회합니다.\r\n * 요약 정보만 반환합니다 (전체 메시지는 제외).\r\n */ async function getAllChatSessions() {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 대화 세션의 모든 청크를 가져옵니다.\r\n */ async function getChunksBySessionId(sessionId) {\n    const { data, error } = await supabase.from(\"chat_chunks\").select(\"*\").eq(\"chat_session_id\", sessionId).order(\"chunk_index\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data;\n}\n/**\r\n * 키워드로 대화 세션을 검색합니다.\r\n */ async function searchChatSessions(keyword) {\n    const { data, error } = await supabase.from(\"chat_sessions\").select(\"id, title, url, summary, created_at, metadata\").or(`title.ilike.%${keyword}%,summary.ilike.%${keyword}%`).order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvc3VwYWJhc2VIYW5kbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStDO0FBRVk7QUFFM0QscUJBQXFCO0FBQ2QsTUFBTUcsV0FBV0gsd0RBQWFBLENBQUM7QUFFdEM7OztDQUdDLEdBQ0QsU0FBU0ksaUJBQWlCQyxJQUFTO0lBQ2pDLElBQUksQ0FBQ0EsTUFBTSxPQUFPO0lBRWxCLElBQUksT0FBT0EsU0FBUyxVQUFVO1FBQzVCLGlDQUFpQztRQUNqQyxPQUFPQSxLQUNKQyxPQUFPLENBQUMsaUNBQWlDLEtBQU0sV0FBVztTQUMxREEsT0FBTyxDQUFDLG1DQUFtQ0MsQ0FBQUEsUUFBU0EsT0FBTyxrQkFBa0I7U0FDN0VELE9BQU8sQ0FBQyxXQUFXLElBQUksV0FBVztTQUNsQ0EsT0FBTyxDQUFDLFFBQVEsS0FBSyxZQUFZO1NBQ2pDRSxJQUFJO0lBQ1Q7SUFFQSxJQUFJQyxNQUFNQyxPQUFPLENBQUNMLE9BQU87UUFDdkIsY0FBYztRQUNkLE9BQU9BLEtBQUtNLEdBQUcsQ0FBQ0MsQ0FBQUEsT0FBUVIsaUJBQWlCUTtJQUMzQztJQUVBLElBQUksT0FBT1AsU0FBUyxZQUFZQSxTQUFTLE1BQU07UUFDN0MsY0FBYztRQUNkLE1BQU1RLFlBQWlDLENBQUM7UUFDeEMsSUFBSyxNQUFNQyxPQUFPVCxLQUFNO1lBQ3RCLElBQUlVLE9BQU9DLFNBQVMsQ0FBQ0MsY0FBYyxDQUFDQyxJQUFJLENBQUNiLE1BQU1TLE1BQU07Z0JBQ25ERCxTQUFTLENBQUNDLElBQUksR0FBR1YsaUJBQWlCQyxJQUFJLENBQUNTLElBQUk7WUFDN0M7UUFDRjtRQUNBLE9BQU9EO0lBQ1Q7SUFFQSxpQkFBaUI7SUFDakIsT0FBT1I7QUFDVDtBQUVBOzs7O0NBSUMsR0FDTSxlQUFlYyxlQUFlQyxHQUFXO0lBQzlDLElBQUk7UUFDRix5QkFBeUI7UUFDekIsTUFBTUMsZ0JBQWdCLElBQUlDLElBQUlGLEtBQUtHLE1BQU0sR0FBRyxJQUFJRCxJQUFJRixLQUFLSSxRQUFRO1FBRWpFLHVCQUF1QjtRQUN2QixNQUFNLEVBQUVuQixJQUFJLEVBQUVvQixLQUFLLEVBQUUsR0FBRyxNQUFNdEIsU0FDM0J1QixJQUFJLENBQUMsaUJBQ0xDLE1BQU0sQ0FBQyx1Q0FDUEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFUCxjQUFjLENBQUMsQ0FBQyxFQUNoQ1EsS0FBSyxDQUFDO1FBRVQsSUFBSUosT0FBTztZQUNUSyxRQUFRTCxLQUFLLENBQUMsbUJBQW1CQTtZQUNqQyxNQUFNQTtRQUNSO1FBRUEsSUFBSXBCLFFBQVFBLEtBQUswQixNQUFNLEdBQUcsR0FBRztZQUMzQixPQUFPO2dCQUFFQyxRQUFRO2dCQUFNQyxTQUFTNUIsSUFBSSxDQUFDLEVBQUU7WUFBQztRQUMxQztRQUVBLE9BQU87WUFBRTJCLFFBQVE7UUFBTTtJQUN6QixFQUFFLE9BQU9QLE9BQU87UUFDZEssUUFBUUwsS0FBSyxDQUFDLG1CQUFtQkE7UUFDakMsNkJBQTZCO1FBQzdCLE9BQU87WUFBRU8sUUFBUTtRQUFNO0lBQ3pCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVFLGtCQUFrQixFQUN0Q0MsS0FBSyxFQUNMZixHQUFHLEVBQ0hnQixPQUFPLEVBQ1BDLFFBQVEsRUFDUkMsV0FBVyxDQUFDLENBQUMsRUFDYkMscUJBQXFCLEtBQUssRUFRM0I7SUFDQyxJQUFJO1FBQ0YsNENBQTRDO1FBQzVDLElBQUksQ0FBQ0Esc0JBQXNCbkIsS0FBSztZQUM5QixNQUFNLEVBQUVZLE1BQU0sRUFBRUMsT0FBTyxFQUFFLEdBQUcsTUFBTWQsZUFBZUM7WUFFakQsSUFBSVksUUFBUTtnQkFDVkYsUUFBUVUsR0FBRyxDQUFDLENBQUMsZUFBZSxFQUFFcEIsSUFBSSxDQUFDO2dCQUNuQ1UsUUFBUVUsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFUCxTQUFTRSxNQUFNLEVBQUUsRUFBRUYsU0FBU1EsR0FBRyxDQUFDLENBQUM7Z0JBQzFELE9BQU87b0JBQ0xBLElBQUlSLFNBQVNRO29CQUNiQyxXQUFXO29CQUNYQyxTQUFTO2dCQUNYO1lBQ0Y7UUFDRjtRQUVBLFNBQVM7UUFDVCxNQUFNQyxpQkFBaUJ4QyxpQkFBaUIrQjtRQUN4QyxNQUFNVSxtQkFBbUJ6QyxpQkFBaUJnQztRQUMxQyxNQUFNVSxvQkFBb0IxQyxpQkFBaUJpQztRQUMzQyxNQUFNVSxvQkFBb0IzQyxpQkFBaUJrQztRQUUzQyxnQkFBZ0I7UUFDaEIsTUFBTVUsWUFBWSxNQUFNL0MseURBQVlBLENBQUM0QztRQUVyQyxZQUFZO1FBQ1osTUFBTSxFQUFFeEMsSUFBSSxFQUFFb0IsS0FBSyxFQUFFLEdBQUcsTUFBTXRCLFNBQzNCdUIsSUFBSSxDQUFDLGlCQUNMdUIsTUFBTSxDQUFDO1lBQ05kLE9BQU9TO1lBQ1B4QjtZQUNBZ0IsU0FBU1M7WUFDVFIsVUFBVVM7WUFDVlIsVUFBVVM7WUFDVkM7UUFDRixHQUNDckIsTUFBTSxDQUFDLE1BQ1B1QixNQUFNO1FBRVQsSUFBSXpCLE9BQU8sTUFBTUE7UUFFakIsT0FBTztZQUFFLEdBQUdwQixJQUFJO1lBQUVxQyxXQUFXO1FBQU07SUFDckMsRUFBRSxPQUFPakIsT0FBTztRQUNkSyxRQUFRTCxLQUFLLENBQUMsa0JBQWtCQTtRQUNoQyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWUwQix1QkFDcEJDLFNBQWlCLEVBQ2pCZixRQUF1QjtJQUV2QixJQUFJO1FBQ0YsU0FBUztRQUNULE1BQU1TLG9CQUFvQjFDLGlCQUFpQmlDO1FBRTNDLGNBQWM7UUFDZCxNQUFNZ0IsU0FBU25ELDBEQUFhQSxDQUFDNEM7UUFDN0JoQixRQUFRVSxHQUFHLENBQUMsd0JBQWNhO1FBRTFCLHVCQUF1QjtRQUN2QixNQUFNQyxnQkFBZ0JELE9BQU8xQyxHQUFHLENBQUMsT0FBTzRDO1lBQ3RDLFdBQVc7WUFDWCxNQUFNQyxtQkFBbUJwRCxpQkFBaUJtRCxNQUFNRSxPQUFPO1lBQ3ZELE1BQU1ULFlBQVksTUFBTS9DLHlEQUFZQSxDQUFDdUQ7WUFFckMsT0FBTztnQkFDTEUsaUJBQWlCTjtnQkFDakJPLGFBQWFKLE1BQU1JLFdBQVc7Z0JBQzlCRixTQUFTRDtnQkFDVFI7WUFDRjtRQUNGO1FBRUEscUJBQXFCO1FBQ3JCLE1BQU1ZLHVCQUF1QixNQUFNQyxRQUFRQyxHQUFHLENBQUNSO1FBRS9DLHdDQUF3QztRQUN4QyxNQUFNUyxZQUFZO1FBQ2xCLE1BQU1DLFVBQVUsRUFBRTtRQUVsQixJQUFLLElBQUlDLElBQUksR0FBR0EsSUFBSUwscUJBQXFCN0IsTUFBTSxFQUFFa0MsS0FBS0YsVUFBVztZQUMvRCxNQUFNRyxRQUFRTixxQkFBcUJPLEtBQUssQ0FBQ0YsR0FBR0EsSUFBSUY7WUFFaEQsSUFBSTtnQkFDRixNQUFNLEVBQUUxRCxJQUFJLEVBQUVvQixLQUFLLEVBQUUsR0FBRyxNQUFNdEIsU0FDM0J1QixJQUFJLENBQUMsZUFDTHVCLE1BQU0sQ0FBQ2lCO2dCQUVWLElBQUl6QyxPQUFPLE1BQU1BO2dCQUNqQnVDLFFBQVFJLElBQUksQ0FBQy9EO1lBQ2YsRUFBRSxPQUFPb0IsT0FBTztnQkFDZEssUUFBUUwsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFd0MsRUFBRSxDQUFDLEVBQUVMLHFCQUFxQjdCLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRU47WUFDcEUsZ0NBQWdDO1lBQ2xDO1FBQ0Y7UUFFQSxPQUFPO1lBQUU0QyxTQUFTO1lBQU1DLE9BQU9WLHFCQUFxQjdCLE1BQU07UUFBQztJQUM3RCxFQUFFLE9BQU9OLE9BQU87UUFDZEssUUFBUUwsS0FBSyxDQUFDLG9CQUFvQkE7UUFDbEMsTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlOEMsb0JBQ3BCQyxLQUFhLEVBQ2JDLGFBQXFCLEdBQUcsRUFDeEI1QyxRQUFnQixFQUFFO0lBRWxCLElBQUk7UUFDRiwwQ0FBMEM7UUFDMUMsTUFBTTZDLHVCQUF1QjtZQUMzQjtZQUNBO1lBQ0E7WUFDQTtZQUNBO1NBQ0Q7UUFFRCxNQUFNQyxpQkFBaUJELHFCQUFxQkUsSUFBSSxDQUFDQyxDQUFBQSxVQUFXQSxRQUFRQyxJQUFJLENBQUNOO1FBRXpFLElBQUlHLGdCQUFnQjtZQUNsQjdDLFFBQVFVLEdBQUcsQ0FBQztZQUNaLGtDQUFrQztZQUNsQyxNQUFNLEVBQUVuQyxNQUFNMEUsV0FBVyxFQUFFdEQsT0FBT3VELFlBQVksRUFBRSxHQUFHLE1BQU03RSxTQUN0RHVCLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLHNCQUNQc0QsS0FBSyxDQUFDLGNBQWM7Z0JBQUVDLFdBQVc7WUFBTSxHQUN2Q3JELEtBQUssQ0FBQztZQUVULElBQUltRCxnQkFBZ0IsQ0FBQ0QsZUFBZUEsWUFBWWhELE1BQU0sS0FBSyxHQUFHO2dCQUM1REQsUUFBUXFELElBQUksQ0FBQztnQkFDYixPQUFPLEVBQUU7WUFDWDtZQUVBLHlCQUF5QjtZQUN6QixNQUFNbEQsVUFBVThDLFdBQVcsQ0FBQyxFQUFFO1lBQzlCLE1BQU1LLFlBQXVCO2dCQUMzQjNDLElBQUk7Z0JBQ0ppQixpQkFBaUJ6QixRQUFRUSxFQUFFO2dCQUMzQmtCLGFBQWE7Z0JBQ2JGLFNBQVMsQ0FBQyxNQUFNLEVBQUV4QixRQUFRRyxPQUFPLENBQUMsQ0FBQztnQkFDbkNxQyxZQUFZO1lBQ2Q7WUFFQSxPQUFPO2dCQUFDVzthQUFVO1FBQ3BCO1FBRUF0RCxRQUFRVSxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUVnQyxNQUFNLFlBQVksRUFBRUMsV0FBVyxNQUFNLEVBQUU1QyxNQUFNLENBQUM7UUFFckUsWUFBWTtRQUNaLE1BQU13RCxpQkFBaUJqRixpQkFBaUJvRTtRQUN4QzFDLFFBQVFVLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRTZDLGVBQWUsQ0FBQyxDQUFDO1FBRXpDLElBQUksQ0FBQ0Esa0JBQWtCQSxlQUFlN0UsSUFBSSxHQUFHdUIsTUFBTSxHQUFHLEdBQUc7WUFDdkRELFFBQVFxRCxJQUFJLENBQUM7WUFDYixPQUFPLEVBQUU7UUFDWDtRQUVBLGdCQUFnQjtRQUNoQixNQUFNRyxpQkFBaUIsTUFBTXJGLHlEQUFZQSxDQUFDb0Y7UUFDMUN2RCxRQUFRVSxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUU4QyxlQUFldkQsTUFBTSxDQUFDLEdBQUcsQ0FBQztRQUVwRCxZQUFZO1FBQ1osTUFBTSxFQUFFMUIsSUFBSSxFQUFFb0IsS0FBSyxFQUFFLEdBQUcsTUFBTXRCLFNBQVNvRixHQUFHLENBQ3hDLGdCQUNBO1lBQ0VDLGlCQUFpQkY7WUFDakJHLGlCQUFpQmhCO1lBQ2pCaUIsYUFBYTdEO1FBQ2Y7UUFHRixJQUFJSixPQUFPO1lBQ1RLLFFBQVFMLEtBQUssQ0FBQyxnQkFBZ0JBO1lBQzlCLE1BQU1BO1FBQ1I7UUFFQUssUUFBUVUsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFbkMsTUFBTTBCLFVBQVUsRUFBRSxDQUFDO1FBRTVDLDRDQUE0QztRQUM1QyxJQUFJLENBQUMxQixRQUFRQSxLQUFLMEIsTUFBTSxLQUFLLEdBQUc7WUFDOUIsd0JBQXdCO1lBQ3hCLE1BQU00RCxpQkFBaUJsQixhQUFhO1lBQ3BDM0MsUUFBUVUsR0FBRyxDQUFDLENBQUMsZ0JBQWdCLEVBQUVtRCxlQUFlQyxPQUFPLENBQUMsR0FBRyxRQUFRLENBQUM7WUFFbEUsTUFBTSxFQUFFdkYsTUFBTXdGLFNBQVMsRUFBRXBFLE9BQU9xRSxVQUFVLEVBQUUsR0FBRyxNQUFNM0YsU0FBU29GLEdBQUcsQ0FDL0QsZ0JBQ0E7Z0JBQ0VDLGlCQUFpQkY7Z0JBQ2pCRyxpQkFBaUJFO2dCQUNqQkQsYUFBYTdEO1lBQ2Y7WUFHRixJQUFJaUUsWUFBWTtnQkFDZGhFLFFBQVFMLEtBQUssQ0FBQyxzQkFBc0JxRTtZQUN0QyxPQUFPLElBQUlELGFBQWFBLFVBQVU5RCxNQUFNLEdBQUcsR0FBRztnQkFDNUNELFFBQVFVLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRXFELFVBQVU5RCxNQUFNLENBQUMsUUFBUSxDQUFDO2dCQUNsRCxPQUFPOEQ7WUFDVCxPQUFPO2dCQUNMLGlDQUFpQztnQkFDakMsTUFBTUUsa0JBQWtCO2dCQUN4QmpFLFFBQVFVLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFdUQsZ0JBQWdCSCxPQUFPLENBQUMsR0FBRyxLQUFLLENBQUM7Z0JBRWxFLE1BQU0sRUFBRXZGLE1BQU0yRixhQUFhLEVBQUV2RSxPQUFPd0UsY0FBYyxFQUFFLEdBQUcsTUFBTTlGLFNBQVNvRixHQUFHLENBQ3ZFLGdCQUNBO29CQUNFQyxpQkFBaUJGO29CQUNqQkcsaUJBQWlCTTtvQkFDakJMLGFBQWE3RDtnQkFDZjtnQkFHRixJQUFJb0UsZ0JBQWdCO29CQUNsQm5FLFFBQVFMLEtBQUssQ0FBQyxzQkFBc0J3RTtnQkFDdEMsT0FBTyxJQUFJRCxpQkFBaUJBLGNBQWNqRSxNQUFNLEdBQUcsR0FBRztvQkFDcERELFFBQVFVLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRXdELGNBQWNqRSxNQUFNLENBQUMsUUFBUSxDQUFDO29CQUN0RCxPQUFPaUU7Z0JBQ1Q7WUFDRjtRQUNGO1FBRUEsT0FBTzNGLFFBQVEsRUFBRTtJQUNuQixFQUFFLE9BQU9vQixPQUFPO1FBQ2RLLFFBQVFMLEtBQUssQ0FBQyxrQkFBa0JBO1FBQ2hDLE1BQU1BO0lBQ1I7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZXlFLG1CQUFtQnpELEVBQVU7SUFDakQsTUFBTSxFQUFFcEMsSUFBSSxFQUFFb0IsS0FBSyxFQUFFLEdBQUcsTUFBTXRCLFNBQzNCdUIsSUFBSSxDQUFDLGlCQUNMQyxNQUFNLENBQUMsS0FDUHdFLEVBQUUsQ0FBQyxNQUFNMUQsSUFDVFMsTUFBTTtJQUVULElBQUl6QixPQUFPLE1BQU1BO0lBRWpCLE9BQU9wQjtBQUNUO0FBRUE7OztDQUdDLEdBQ00sZUFBZStGO0lBQ3BCLE1BQU0sRUFBRS9GLElBQUksRUFBRW9CLEtBQUssRUFBRSxHQUFHLE1BQU10QixTQUMzQnVCLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLGlEQUNQc0QsS0FBSyxDQUFDLGNBQWM7UUFBRUMsV0FBVztJQUFNO0lBRTFDLElBQUl6RCxPQUFPLE1BQU1BO0lBRWpCLE9BQU9wQjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlZ0cscUJBQXFCakQsU0FBaUI7SUFDMUQsTUFBTSxFQUFFL0MsSUFBSSxFQUFFb0IsS0FBSyxFQUFFLEdBQUcsTUFBTXRCLFNBQzNCdUIsSUFBSSxDQUFDLGVBQ0xDLE1BQU0sQ0FBQyxLQUNQd0UsRUFBRSxDQUFDLG1CQUFtQi9DLFdBQ3RCNkIsS0FBSyxDQUFDLGVBQWU7UUFBRUMsV0FBVztJQUFLO0lBRTFDLElBQUl6RCxPQUFPLE1BQU1BO0lBRWpCLE9BQU9wQjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlaUcsbUJBQW1CQyxPQUFlO0lBQ3RELE1BQU0sRUFBRWxHLElBQUksRUFBRW9CLEtBQUssRUFBRSxHQUFHLE1BQU10QixTQUMzQnVCLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLGlEQUNQNkUsRUFBRSxDQUFDLENBQUMsYUFBYSxFQUFFRCxRQUFRLGlCQUFpQixFQUFFQSxRQUFRLENBQUMsQ0FBQyxFQUN4RHRCLEtBQUssQ0FBQyxjQUFjO1FBQUVDLFdBQVc7SUFBTTtJQUUxQyxJQUFJekQsT0FBTyxNQUFNQTtJQUVqQixPQUFPcEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BrbS1wcm9qZWN0Ly4vc3JjL3V0aWxzL3N1cGFiYXNlSGFuZGxlci50cz85YmZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XHJcbmltcG9ydCB7IENoYXRNZXNzYWdlLCBDaGF0Q2h1bmssIENoYXRTZXNzaW9uIH0gZnJvbSAnQC90eXBlcyc7XHJcbmltcG9ydCB7IGdldEVtYmVkZGluZywgY2h1bmtNZXNzYWdlcyB9IGZyb20gJy4vZW1iZWRkaW5ncyc7XHJcblxyXG4vLyBTdXBhYmFzZSDtgbTrnbzsnbTslrjtirgg7J6s7IKs7JqpXHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IHN1cGFiYXNlQWRtaW47XHJcblxyXG4vKipcclxuICogSlNPTiDrjbDsnbTthLDrpbwg7JWI7KCE7ZWY6rKMIOyymOumrO2VqeuLiOuLpC5cclxuICogUG9zdGdyZVNRTOyXkCDsoIDsnqXtlZjquLAg7KCEIOycoO2aqO2VmOyngCDslYrsnYAg66y47J6Q64KYIOq1rOyhsOulvCDsoJzqsbDtlanri4jri6QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYW5pdGl6ZUpzb25EYXRhKGRhdGE6IGFueSk6IGFueSB7XHJcbiAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcclxuICBcclxuICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAvLyDrrLjsnpDsl7Tsl5DshJwg7KCc7Ja0IOusuOyekCDsoJzqsbAg67CPIOycoOuLiOy9lOuTnCDrrLjsnpAg7LKY66asIOqwnOyEoFxyXG4gICAgcmV0dXJuIGRhdGFcclxuICAgICAgLnJlcGxhY2UoL1tcXHUwMDAwLVxcdTAwMUZcXHUwMDdGLVxcdTAwOUZdL2csICcgJykgIC8vIOygnOyWtCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9bXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdL2csIG1hdGNoID0+IG1hdGNoKSAvLyDsmKzrsJTrpbgg7Jyg64uI7L2U65OcIOydtOuqqOyngCDsnKDsp4BcclxuICAgICAgLnJlcGxhY2UoL1xcdUZGRkQvZywgJycpIC8vIOuMgOyytCDrrLjsnpAg7KCc6rGwXHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8g7Jew7IaN65CcIOqzteuwsSDsoJzqsbBcclxuICAgICAgLnRyaW0oKTtcclxuICB9XHJcbiAgXHJcbiAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcclxuICAgIC8vIOuwsOyXtOydmCDqsIEg7ZWt66qpIOygleygnFxyXG4gICAgcmV0dXJuIGRhdGEubWFwKGl0ZW0gPT4gc2FuaXRpemVKc29uRGF0YShpdGVtKSk7XHJcbiAgfVxyXG4gIFxyXG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkge1xyXG4gICAgLy8g6rCd7LK07J2YIOqwgSDtlYTrk5wg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWQ6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XHJcbiAgICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZUpzb25EYXRhKGRhdGFba2V5XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBzYW5pdGl6ZWQ7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIOq4sOuzuCDsnpDro4ztmJXsnYAg6re464yA66GcIOuwmO2ZmFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICogVVJM7J20IOydtOuvuCDsoIDsnqXrkJjslrQg7J6I64qU7KeAIO2ZleyduO2VqeuLiOuLpC5cclxuICogQHBhcmFtIHVybCDtmZXsnbjtlaAgVVJMXHJcbiAqIEByZXR1cm5zIOykkeuztSDsl6zrtoDsmYAg6riw7KG0IOyEuOyFmCDsoJXrs7RcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1VybEV4aXN0cyh1cmw6IHN0cmluZyk6IFByb21pc2U8eyBleGlzdHM6IGJvb2xlYW47IHNlc3Npb24/OiBQYXJ0aWFsPENoYXRTZXNzaW9uPiB9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFVSTCDsoJXqt5ztmZQgKOy/vOumrCDtjIzrnbzrr7jthLAg65OxIOygnOqxsClcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSBuZXcgVVJMKHVybCkub3JpZ2luICsgbmV3IFVSTCh1cmwpLnBhdGhuYW1lO1xyXG4gICAgXHJcbiAgICAvLyDsoJXqt5ztmZTrkJwgVVJM66GcIOyLnOyeke2VmOuKlCDshLjshZgg6rKA7IOJXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0JylcclxuICAgICAgLmlsaWtlKCd1cmwnLCBgJHtub3JtYWxpemVkVXJsfSVgKVxyXG4gICAgICAubGltaXQoMSk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXR1cm4geyBleGlzdHM6IHRydWUsIHNlc3Npb246IGRhdGFbMF0gfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgZXhpc3RzOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVUkwg7KSR67O1IO2ZleyduCDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIC8vIOyYpOulmCDrsJzsg50g7IucIOyViOyghO2VmOqyjCDspJHrs7XsnbQg7JWE64uMIOqyg+ycvOuhnCDsspjrpqxcclxuICAgIHJldHVybiB7IGV4aXN0czogZmFsc2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDrjIDtmZQg7IS47IWY7J2EIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRDaGF0U2Vzc2lvbih7XHJcbiAgdGl0bGUsXHJcbiAgdXJsLFxyXG4gIHN1bW1hcnksXHJcbiAgbWVzc2FnZXMsXHJcbiAgbWV0YWRhdGEgPSB7fSxcclxuICBza2lwRHVwbGljYXRlQ2hlY2sgPSBmYWxzZVxyXG59OiB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XHJcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIHNraXBEdXBsaWNhdGVDaGVjaz86IGJvb2xlYW47XHJcbn0pIHtcclxuICB0cnkge1xyXG4gICAgLy8gVVJMIOykkeuztSDtmZXsnbggKHNraXBEdXBsaWNhdGVDaGVja+qwgCBmYWxzZeydvCDrlYzrp4wpXHJcbiAgICBpZiAoIXNraXBEdXBsaWNhdGVDaGVjayAmJiB1cmwpIHtcclxuICAgICAgY29uc3QgeyBleGlzdHMsIHNlc3Npb24gfSA9IGF3YWl0IGNoZWNrVXJsRXhpc3RzKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFVSTOydtCDsnbTrr7gg7KG07J6s7ZWp64uI64ukOiAke3VybH1gKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhg6riw7KG0IOyEuOyFmCDsoJXrs7Q6ICR7c2Vzc2lvbj8udGl0bGV9ICgke3Nlc3Npb24/LmlkfSlgKTtcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgIGlkOiBzZXNzaW9uPy5pZCwgXHJcbiAgICAgICAgICBkdXBsaWNhdGU6IHRydWUsIFxyXG4gICAgICAgICAgbWVzc2FnZTogJ+ydtOuvuCDsoIDsnqXrkJwg64yA7ZmU7J6F64uI64ukLicgXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDrjbDsnbTthLAg7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRUaXRsZSA9IHNhbml0aXplSnNvbkRhdGEodGl0bGUpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkU3VtbWFyeSA9IHNhbml0aXplSnNvbkRhdGEoc3VtbWFyeSk7XHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgY29uc3Qgc2FuaXRpemVkTWV0YWRhdGEgPSBzYW5pdGl6ZUpzb25EYXRhKG1ldGFkYXRhKTtcclxuICAgIFxyXG4gICAgLy8g7JqU7JW9IO2FjeyKpO2KuCDsnoTrsqDrlKkg7IOd7ISxXHJcbiAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkU3VtbWFyeSk7XHJcbiAgICBcclxuICAgIC8vIOyEuOyFmCDrjbDsnbTthLAg7IK97J6FXHJcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgIHRpdGxlOiBzYW5pdGl6ZWRUaXRsZSxcclxuICAgICAgICB1cmwsXHJcbiAgICAgICAgc3VtbWFyeTogc2FuaXRpemVkU3VtbWFyeSxcclxuICAgICAgICBtZXNzYWdlczogc2FuaXRpemVkTWVzc2FnZXMsXHJcbiAgICAgICAgbWV0YWRhdGE6IHNhbml0aXplZE1ldGFkYXRhLFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9KVxyXG4gICAgICAuc2VsZWN0KCdpZCcpXHJcbiAgICAgIC5zaW5nbGUoKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgIFxyXG4gICAgcmV0dXJuIHsgLi4uZGF0YSwgZHVwbGljYXRlOiBmYWxzZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfrjIDtmZQg7IS47IWYIOyggOyepSDspJEg7Jik66WYOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOuMgO2ZlCDssq3tgazrpbwg7IOd7ISx7ZWY6rOgIFN1cGFiYXNl7JeQIOyggOyepe2VqeuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzQW5kSW5zZXJ0Q2h1bmtzKFxyXG4gIHNlc3Npb25JZDogc3RyaW5nLFxyXG4gIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdXHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTsi5zsp4Ag7KCV7KCcXHJcbiAgICBjb25zdCBzYW5pdGl6ZWRNZXNzYWdlcyA9IHNhbml0aXplSnNvbkRhdGEobWVzc2FnZXMpO1xyXG4gICAgXHJcbiAgICAvLyDrqZTsi5zsp4Drpbwg7LKt7YGs66GcIOu2hO2VoFxyXG4gICAgY29uc3QgY2h1bmtzID0gY2h1bmtNZXNzYWdlcyhzYW5pdGl6ZWRNZXNzYWdlcyk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+nsSDrtoTtlaDrkJwg7LKt7YGsOicsIGNodW5rcyk7XHJcbiAgICBcclxuICAgIC8vIOqwgSDssq3tgazsl5Ag64yA7ZW0IOyehOuyoOuUqSDsg53shLEg67CPIOyggOyepVxyXG4gICAgY29uc3QgY2h1bmtQcm9taXNlcyA9IGNodW5rcy5tYXAoYXN5bmMgKGNodW5rKSA9PiB7XHJcbiAgICAgIC8vIOyyre2BrCDrgrTsmqkg7KCV7KCcXHJcbiAgICAgIGNvbnN0IHNhbml0aXplZENvbnRlbnQgPSBzYW5pdGl6ZUpzb25EYXRhKGNodW5rLmNvbnRlbnQpO1xyXG4gICAgICBjb25zdCBlbWJlZGRpbmcgPSBhd2FpdCBnZXRFbWJlZGRpbmcoc2FuaXRpemVkQ29udGVudCk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGNoYXRfc2Vzc2lvbl9pZDogc2Vzc2lvbklkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiBjaHVuay5jaHVua19pbmRleCxcclxuICAgICAgICBjb250ZW50OiBzYW5pdGl6ZWRDb250ZW50LFxyXG4gICAgICAgIGVtYmVkZGluZ1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIOuqqOuToCDssq3tgawg7J6E67Kg65SpIOyymOumrCDsmYTro4wg64yA6riwXHJcbiAgICBjb25zdCBjaHVua3NXaXRoRW1iZWRkaW5ncyA9IGF3YWl0IFByb21pc2UuYWxsKGNodW5rUHJvbWlzZXMpO1xyXG4gICAgXHJcbiAgICAvLyDssq3tgawg642w7J207YSwIOyCveyehSAo7LWc64yAIDFNQiDsoJztlZzsnLzroZwg7LKt7YGsIDEw6rCc7JSpIOuwsOy5mCDsspjrpqwpXHJcbiAgICBjb25zdCBiYXRjaFNpemUgPSAxMDtcclxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7XHJcbiAgICAgIGNvbnN0IGJhdGNoID0gY2h1bmtzV2l0aEVtYmVkZGluZ3Muc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnY2hhdF9jaHVua3MnKVxyXG4gICAgICAgICAgLmluc2VydChiYXRjaCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICByZXN1bHRzLnB1c2goZGF0YSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg7LKt7YGsIOuwsOy5mCAke2l9LyR7Y2h1bmtzV2l0aEVtYmVkZGluZ3MubGVuZ3RofSDsoIDsnqUg7KSRIOyYpOulmDpgLCBlcnJvcik7XHJcbiAgICAgICAgLy8g6rCc67OEIOyyre2BrCDsl5Drn6zrpbwg6riw66Gd7ZWY65CYIOyghOyytCDtlITroZzshLjsiqTripQg6rOE7IaNIOynhO2WiVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGNvdW50OiBjaHVua3NXaXRoRW1iZWRkaW5ncy5sZW5ndGggfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7LKt7YGsIOyymOumrCDrsI8g7KCA7J6lIOykkSDsmKTrpZg6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog7Jyg7IKs7ZWcIOyyre2BrOulvCDqsoDsg4ntlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoU2ltaWxhckNodW5rcyhcclxuICBxdWVyeTogc3RyaW5nLFxyXG4gIHNpbWlsYXJpdHk6IG51bWJlciA9IDAuMywgIC8vIOq4sOuzuOqwkiAwLjXsl5DshJwgMC4z7Jy866GcIOuNlCDrgq7stqRcclxuICBsaW1pdDogbnVtYmVyID0gMTBcclxuKTogUHJvbWlzZTxDaGF0Q2h1bmtbXT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDrqZTtg4Ag7KeI66y4IOqwkOyngCAo7JiIOiBcIuydtCDrjIDtmZTsnZgg7ZW17Ius7J20IOutkOyVvD9cIiwgXCLsmpTslb3tlbTspJhcIiDrk7EpXHJcbiAgICBjb25zdCBtZXRhUXVlc3Rpb25QYXR0ZXJucyA9IFtcclxuICAgICAgL+ydtFxccyrrjIDtmZTsnZg/XFxzKijtlbXsi6x87JqU7JW9fOuCtOyaqXzso7zsoJwpL2ksXHJcbiAgICAgIC/rjIDtmZTrpbw/XFxzKijsmpTslb187KCV66asKS9pLFxyXG4gICAgICAv7JqU7JW97ZW0XFxzKuykmC9pLFxyXG4gICAgICAv7ZW17IusXFxzKijrgrTsmql87Y+s7J247Yq4KS9pLFxyXG4gICAgICAv7KO87JqUXFxzKijrgrTsmql87Y+s7J247Yq4KS9pXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBjb25zdCBpc01ldGFRdWVzdGlvbiA9IG1ldGFRdWVzdGlvblBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QocXVlcnkpKTtcclxuICAgIFxyXG4gICAgaWYgKGlzTWV0YVF1ZXN0aW9uKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfrqZTtg4Ag7KeI66y4IOqwkOyngOuQqCwg66qo65OgIOyEuOyFmOydmCDsmpTslb0g7KCV67O066W8IOqygOyDie2VqeuLiOuLpC4nKTtcclxuICAgICAgLy8g66mU7YOAIOyniOusuOyduCDqsr3smrAg6rCA7J6lIOy1nOq3vCDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDqsIDsoLjsmKTquLBcclxuICAgICAgY29uc3QgeyBkYXRhOiBzZXNzaW9uRGF0YSwgZXJyb3I6IHNlc3Npb25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnY2hhdF9zZXNzaW9ucycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQsIHRpdGxlLCBzdW1tYXJ5JylcclxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcclxuICAgICAgICAubGltaXQoMSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uRGF0YSB8fCBzZXNzaW9uRGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ+yEuOyFmCDrjbDsnbTthLDrpbwg7LC+7J2EIOyImCDsl4bsirXri4jri6QuJyk7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyDshLjshZjsnZgg7JqU7JW9IOygleuztOulvCDssq3tgazroZwg67OA7ZmY7ZWY7JesIOuwmO2ZmFxyXG4gICAgICBjb25zdCBzZXNzaW9uID0gc2Vzc2lvbkRhdGFbMF07XHJcbiAgICAgIGNvbnN0IGZha2VDaHVuazogQ2hhdENodW5rID0ge1xyXG4gICAgICAgIGlkOiAnbWV0YS1xdWVzdGlvbi1jaHVuaycsXHJcbiAgICAgICAgY2hhdF9zZXNzaW9uX2lkOiBzZXNzaW9uLmlkLFxyXG4gICAgICAgIGNodW5rX2luZGV4OiAwLFxyXG4gICAgICAgIGNvbnRlbnQ6IGBb7JqU7JW9XTogJHtzZXNzaW9uLnN1bW1hcnl9YCxcclxuICAgICAgICBzaW1pbGFyaXR5OiAxLjBcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBbZmFrZUNodW5rXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOqygOyDiSDsv7zrpqw6IFwiJHtxdWVyeX1cIiwg7Jyg7IKs64+EIOyehOqzhOqwkjogJHtzaW1pbGFyaXR5fSwg7KCc7ZWcOiAke2xpbWl0fWApO1xyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOygleygnFxyXG4gICAgY29uc3Qgc2FuaXRpemVkUXVlcnkgPSBzYW5pdGl6ZUpzb25EYXRhKHF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsoJXsoJzrkJwg7L+866asOiBcIiR7c2FuaXRpemVkUXVlcnl9XCJgKTtcclxuICAgIFxyXG4gICAgaWYgKCFzYW5pdGl6ZWRRdWVyeSB8fCBzYW5pdGl6ZWRRdWVyeS50cmltKCkubGVuZ3RoIDwgMikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+y/vOumrOqwgCDrhIjrrLQg7Ken6rGw64KYIOu5hOyWtCDsnojsirXri4jri6QnKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDsv7zrpqwg7YWN7Iqk7Yq4IOyehOuyoOuUqSDsg53shLFcclxuICAgIGNvbnN0IHF1ZXJ5RW1iZWRkaW5nID0gYXdhaXQgZ2V0RW1iZWRkaW5nKHNhbml0aXplZFF1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGDsnoTrsqDrlKkg7IOd7ISxIOyZhOujjDogJHtxdWVyeUVtYmVkZGluZy5sZW5ndGh9IOywqOybkGApO1xyXG4gICAgXHJcbiAgICAvLyDsnKDsgqztlZwg7LKt7YGsIOqygOyDiVxyXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UucnBjKFxyXG4gICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAge1xyXG4gICAgICAgIHF1ZXJ5X2VtYmVkZGluZzogcXVlcnlFbWJlZGRpbmcsXHJcbiAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBzaW1pbGFyaXR5LFxyXG4gICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7Jik66WYOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGDqsoDsg4nrkJwg7LKt7YGsIOyImDogJHtkYXRhPy5sZW5ndGggfHwgMH1gKTtcclxuICAgIFxyXG4gICAgLy8g6rKA7IOJIOqysOqzvOqwgCDsl4bripQg6rK97JqwIOycoOyCrOuPhCDsnoTqs4TqsJLsnYQg64Ku7Law7IScIOuLpOyLnCDsi5zrj4QgKDLri6jqs4TroZwg64Ku7LakKVxyXG4gICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIC8vIOyyqyDrsojsp7gg7J6s7Iuc64+EOiDsnoTqs4TqsJLsnYQgNTAlIOuCruy2pFxyXG4gICAgICBjb25zdCBsb3dlclRocmVzaG9sZCA9IHNpbWlsYXJpdHkgKiAwLjU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDqsrDqs7zqsIAg7JeG7Ja0IOycoOyCrOuPhCDsnoTqs4TqsJLsnYQgJHtsb3dlclRocmVzaG9sZC50b0ZpeGVkKDIpfeuhnCDrgq7strAg7J6s7Iuc64+EYCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB7IGRhdGE6IHJldHJ5RGF0YSwgZXJyb3I6IHJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAnbWF0Y2hfY2h1bmtzJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgbWF0Y2hfdGhyZXNob2xkOiBsb3dlclRocmVzaG9sZCxcclxuICAgICAgICAgIG1hdGNoX2NvdW50OiBsaW1pdFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXRyeUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign64Ku7J2AIOyehOqzhOqwkuycvOuhnCDsnqzsi5zrj4Qg7KSRIOyYpOulmDonLCByZXRyeUVycm9yKTtcclxuICAgICAgfSBlbHNlIGlmIChyZXRyeURhdGEgJiYgcmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg64Ku7J2AIOyehOqzhOqwkuycvOuhnCAke3JldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICByZXR1cm4gcmV0cnlEYXRhO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIOuRkCDrsojsp7gg7J6s7Iuc64+EOiDrp6TsmrAg64Ku7J2AIOyehOqzhOqwkiAoMC4xKeycvOuhnCDsi5zrj4RcclxuICAgICAgICBjb25zdCBsb3dlc3RUaHJlc2hvbGQgPSAwLjE7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOqysOqzvOqwgCDsl6zsoITtnogg7JeG7Ja0IOy1nOyggCDsnoTqs4TqsJIgJHtsb3dlc3RUaHJlc2hvbGQudG9GaXhlZCgyKX3roZwg7J6s7Iuc64+EYCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBsYXN0UmV0cnlEYXRhLCBlcnJvcjogbGFzdFJldHJ5RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYyhcclxuICAgICAgICAgICdtYXRjaF9jaHVua3MnLFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBxdWVyeV9lbWJlZGRpbmc6IHF1ZXJ5RW1iZWRkaW5nLFxyXG4gICAgICAgICAgICBtYXRjaF90aHJlc2hvbGQ6IGxvd2VzdFRocmVzaG9sZCxcclxuICAgICAgICAgICAgbWF0Y2hfY291bnQ6IGxpbWl0XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGFzdFJldHJ5RXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+y1nOyggCDsnoTqs4TqsJLsnLzroZwg7J6s7Iuc64+EIOykkSDsmKTrpZg6JywgbGFzdFJldHJ5RXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGFzdFJldHJ5RGF0YSAmJiBsYXN0UmV0cnlEYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDstZzsoIAg7J6E6rOE6rCS7Jy866GcICR7bGFzdFJldHJ5RGF0YS5sZW5ndGh96rCcIOyyre2BrCDqsoDsg4nrkKhgKTtcclxuICAgICAgICAgIHJldHVybiBsYXN0UmV0cnlEYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZGF0YSB8fCBbXTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign7Jyg7IKsIOyyre2BrCDqsoDsg4kg7KSRIOyYpOulmDonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDshLjshZggSUTroZwg64yA7ZmUIOyEuOyFmOydhCDsobDtmoztlanri4jri6QuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdFNlc3Npb25CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPENoYXRTZXNzaW9uPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdpZCcsIGlkKVxyXG4gICAgLnNpbmdsZSgpO1xyXG4gICAgXHJcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICBcclxuICByZXR1cm4gZGF0YTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOuqqOuToCDrjIDtmZQg7IS47IWY7J2EIOyhsO2ajO2VqeuLiOuLpC5cclxuICog7JqU7JW9IOygleuztOunjCDrsJjtmZjtlanri4jri6QgKOyghOyytCDrqZTsi5zsp4DripQg7KCc7Jm4KS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxDaGF0U2Vzc2lvbnMoKTogUHJvbWlzZTxQYXJ0aWFsPENoYXRTZXNzaW9uPltdPiB7XHJcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKCdjaGF0X3Nlc3Npb25zJylcclxuICAgIC5zZWxlY3QoJ2lkLCB0aXRsZSwgdXJsLCBzdW1tYXJ5LCBjcmVhdGVkX2F0LCBtZXRhZGF0YScpXHJcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog64yA7ZmUIOyEuOyFmOydmCDrqqjrk6Ag7LKt7YGs66W8IOqwgOyguOyYteuLiOuLpC5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaHVua3NCeVNlc3Npb25JZChzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Q2hhdENodW5rW10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfY2h1bmtzJylcclxuICAgIC5zZWxlY3QoJyonKVxyXG4gICAgLmVxKCdjaGF0X3Nlc3Npb25faWQnLCBzZXNzaW9uSWQpXHJcbiAgICAub3JkZXIoJ2NodW5rX2luZGV4JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcbiAgICBcclxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG4gIFxyXG4gIHJldHVybiBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog7YKk7JuM65Oc66GcIOuMgO2ZlCDshLjshZjsnYQg6rKA7IOJ7ZWp64uI64ukLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaENoYXRTZXNzaW9ucyhrZXl3b3JkOiBzdHJpbmcpOiBQcm9taXNlPFBhcnRpYWw8Q2hhdFNlc3Npb24+W10+IHtcclxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgLmZyb20oJ2NoYXRfc2Vzc2lvbnMnKVxyXG4gICAgLnNlbGVjdCgnaWQsIHRpdGxlLCB1cmwsIHN1bW1hcnksIGNyZWF0ZWRfYXQsIG1ldGFkYXRhJylcclxuICAgIC5vcihgdGl0bGUuaWxpa2UuJSR7a2V5d29yZH0lLHN1bW1hcnkuaWxpa2UuJSR7a2V5d29yZH0lYClcclxuICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuICAgIFxyXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGE7XHJcbn0gIl0sIm5hbWVzIjpbInN1cGFiYXNlQWRtaW4iLCJnZXRFbWJlZGRpbmciLCJjaHVua01lc3NhZ2VzIiwic3VwYWJhc2UiLCJzYW5pdGl6ZUpzb25EYXRhIiwiZGF0YSIsInJlcGxhY2UiLCJtYXRjaCIsInRyaW0iLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJpdGVtIiwic2FuaXRpemVkIiwia2V5IiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiY2hlY2tVcmxFeGlzdHMiLCJ1cmwiLCJub3JtYWxpemVkVXJsIiwiVVJMIiwib3JpZ2luIiwicGF0aG5hbWUiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJpbGlrZSIsImxpbWl0IiwiY29uc29sZSIsImxlbmd0aCIsImV4aXN0cyIsInNlc3Npb24iLCJpbnNlcnRDaGF0U2Vzc2lvbiIsInRpdGxlIiwic3VtbWFyeSIsIm1lc3NhZ2VzIiwibWV0YWRhdGEiLCJza2lwRHVwbGljYXRlQ2hlY2siLCJsb2ciLCJpZCIsImR1cGxpY2F0ZSIsIm1lc3NhZ2UiLCJzYW5pdGl6ZWRUaXRsZSIsInNhbml0aXplZFN1bW1hcnkiLCJzYW5pdGl6ZWRNZXNzYWdlcyIsInNhbml0aXplZE1ldGFkYXRhIiwiZW1iZWRkaW5nIiwiaW5zZXJ0Iiwic2luZ2xlIiwicHJvY2Vzc0FuZEluc2VydENodW5rcyIsInNlc3Npb25JZCIsImNodW5rcyIsImNodW5rUHJvbWlzZXMiLCJjaHVuayIsInNhbml0aXplZENvbnRlbnQiLCJjb250ZW50IiwiY2hhdF9zZXNzaW9uX2lkIiwiY2h1bmtfaW5kZXgiLCJjaHVua3NXaXRoRW1iZWRkaW5ncyIsIlByb21pc2UiLCJhbGwiLCJiYXRjaFNpemUiLCJyZXN1bHRzIiwiaSIsImJhdGNoIiwic2xpY2UiLCJwdXNoIiwic3VjY2VzcyIsImNvdW50Iiwic2VhcmNoU2ltaWxhckNodW5rcyIsInF1ZXJ5Iiwic2ltaWxhcml0eSIsIm1ldGFRdWVzdGlvblBhdHRlcm5zIiwiaXNNZXRhUXVlc3Rpb24iLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJzZXNzaW9uRGF0YSIsInNlc3Npb25FcnJvciIsIm9yZGVyIiwiYXNjZW5kaW5nIiwid2FybiIsImZha2VDaHVuayIsInNhbml0aXplZFF1ZXJ5IiwicXVlcnlFbWJlZGRpbmciLCJycGMiLCJxdWVyeV9lbWJlZGRpbmciLCJtYXRjaF90aHJlc2hvbGQiLCJtYXRjaF9jb3VudCIsImxvd2VyVGhyZXNob2xkIiwidG9GaXhlZCIsInJldHJ5RGF0YSIsInJldHJ5RXJyb3IiLCJsb3dlc3RUaHJlc2hvbGQiLCJsYXN0UmV0cnlEYXRhIiwibGFzdFJldHJ5RXJyb3IiLCJnZXRDaGF0U2Vzc2lvbkJ5SWQiLCJlcSIsImdldEFsbENoYXRTZXNzaW9ucyIsImdldENodW5rc0J5U2Vzc2lvbklkIiwic2VhcmNoQ2hhdFNlc3Npb25zIiwia2V5d29yZCIsIm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/supabaseHandler.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/gpt-tokenizer","vendor-chunks/@supabase","vendor-chunks/openai","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/webidl-conversions","vendor-chunks/abort-controller","vendor-chunks/ms","vendor-chunks/humanize-ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fconversations%2Froute&page=%2Fapi%2Fconversations%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fconversations%2Froute.ts&appDir=C%3A%5CpmkProject%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CpmkProject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();